window.__require=function t(e,o,r){function n(a,s){if(!o[a]){if(!e[a]){var c=a.split("/");if(c=c[c.length-1],!e[c]){var l="function"==typeof __require&&__require;if(!s&&l)return l(c,!0);if(i)return i(c,!0);throw new Error("Cannot find module '"+a+"'")}a=c}var u=o[a]={exports:{}};e[a][0].call(u.exports,function(t){return n(e[a][1][t]||t)},u,u.exports,t,e,o,r)}return o[a].exports}for(var i="function"==typeof __require&&__require,a=0;a<r.length;a++)n(r[a]);return n}({Action:[function(t,e,o){"use strict";cc._RF.push(e,"ff494hxGRpK0ryocio9sDIh","Action");var r,n=this&&this.__extends||(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),i=this&&this.__decorate||function(t,e,o,r){var n,i=arguments.length,a=i<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,o):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,o,r);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(a=(i<3?n(a):i>3?n(e,o,a):n(e,o))||a);return i>3&&a&&Object.defineProperty(e,o,a),a};Object.defineProperty(o,"__esModule",{value:!0}),o.Action=o.BattlerInfo=void 0;var a=t("../../CoreModule/Data/BaseData"),s=t("./Result"),c=function(t){function e(e,o){var r=t.call(this,e)||this;return r.camp=0,r.pos=0,r.action=o,r}return n(e,t),Object.defineProperty(e.prototype,"battle",{get:function(){var t;return null===(t=this.action)||void 0===t?void 0:t.battle},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"battler",{get:function(){var t;return null===(t=this.battle)||void 0===t?void 0:t.getBattler(this)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"opponents",{get:function(){var t;return null===(t=this.battle)||void 0===t?void 0:t.getOpponents(this)},enumerable:!1,configurable:!0}),e.create=function(t,o){var r=new e(null,t);return r.camp=o.camp,r.pos=o.pos,r},i([a.field],e.prototype,"camp",void 0),i([a.field],e.prototype,"pos",void 0),e}(a.BaseData);o.BattlerInfo=c;var l=function(t){function e(e,o){var r=t.call(this,e)||this;return r.time=0,r.battle=null,r.battle=o,r}return n(e,t),e.prototype.setSubject=function(t){this.subject=c.create(this,t)},e.prototype.setTarget=function(t){this.target=c.create(this,t)},e.prototype.setSkill=function(t){this._skillInfo=t,this.skillId=t.skillId},Object.defineProperty(e.prototype,"subjectBattler",{get:function(){return this.battle.getBattler(this.subject)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"targetBattler",{get:function(){return this.battle.getBattler(this.target)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"skill",{get:function(){return this.skillInfo.skill},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"skillInfo",{get:function(){var t=this;return this._skillInfo||(this._skillInfo=this.subjectBattler.skills.find(function(e){return e.skillId==t.skillId}))},enumerable:!1,configurable:!0}),e.prototype.apply=function(){this.skillInfo.use()},e.prototype.makeResult=function(){},i([a.field],e.prototype,"time",void 0),i([a.field(c)],e.prototype,"subject",void 0),i([a.field(c)],e.prototype,"target",void 0),i([a.field(Number)],e.prototype,"skillId",void 0),i([a.field(s.Result)],e.prototype,"result",void 0),e}(a.BaseData);o.Action=l,cc._RF.pop()},{"../../CoreModule/Data/BaseData":"BaseData","./Result":"Result"}],AlertManager:[function(t,e,o){"use strict";cc._RF.push(e,"66e61liB2ZH5ZtAVl65rnCy","AlertManager");var r,n=this&&this.__extends||(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),i=this&&this.__decorate||function(t,e,o,r){var n,i=arguments.length,a=i<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,o):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,o,r);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(a=(i<3?n(a):i>3?n(e,o,a):n(e,o))||a);return i>3&&a&&Object.defineProperty(e,o,a),a},a=this&&this.__awaiter||function(t,e,o,r){return new(o||(o=Promise))(function(n,i){function a(t){try{c(r.next(t))}catch(e){i(e)}}function s(t){try{c(r.throw(t))}catch(e){i(e)}}function c(t){var e;t.done?n(t.value):(e=t.value,e instanceof o?e:new o(function(t){t(e)})).then(a,s)}c((r=r.apply(t,e||[])).next())})},s=this&&this.__generator||function(t,e){var o,r,n,i,a={label:0,sent:function(){if(1&n[0])throw n[1];return n[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(t){return function(e){return c([t,e])}}function c(i){if(o)throw new TypeError("Generator is already executing.");for(;a;)try{if(o=1,r&&(n=2&i[0]?r.return:i[0]?r.throw||((n=r.return)&&n.call(r),0):r.next)&&!(n=n.call(r,i[1])).done)return n;switch(r=0,n&&(i=[2&i[0],n.value]),i[0]){case 0:case 1:n=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,r=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(n=(n=a.trys).length>0&&n[n.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!n||i[1]>n[0]&&i[1]<n[3])){a.label=i[1];break}if(6===i[0]&&a.label<n[1]){a.label=n[1],n=i;break}if(n&&a.label<n[2]){a.label=n[2],a.ops.push(i);break}n[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(s){i=[6,s],r=0}finally{o=n=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}};Object.defineProperty(o,"__esModule",{value:!0}),o.AlertTask=o.AlertResult=o.AlertDialogType=o.GameError=o.handleError=o.catchAsError=o.alertMgr=void 0;var c=t("./BaseManager");function l(){return c.getManager(f)}o.alertMgr=l,o.catchAsError=function(t,e){return function(o,r,n){var i=n.value;n.value=function(){for(var o=[],r=0;r<arguments.length;r++)o[r]=arguments[r];return a(this,void 0,void 0,function(){var r,n;return s(this,function(a){switch(a.label){case 0:return a.trys.push([0,2,,3]),[4,i.apply(this,o)];case 1:return[2,a.sent()];case 2:if(r=a.sent(),console.error("Catch",{e:r}),r instanceof Error&&r.code)throw r;return e||(e="string"==typeof r?r:null==r?void 0:r.detail),n=(null==r?void 0:r.data)||r,t(e,n),[3,3];case 3:return[2]}})})}}},o.handleError=function(t,e,o){var r=!1,n=function(t,e,o){var n=o.value;o.value=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return a(this,void 0,void 0,function(){var e;return s(this,function(o){switch(o.label){case 0:return o.trys.push([0,2,,3]),[4,n.apply(this,t)];case 1:return[2,o.sent()];case 2:if(e=o.sent(),l().handleError(e),r)throw e;return[3,3];case 3:return[2]}})})}};if("boolean"==typeof t)return r=t,n;n(0,0,o)};var u,p=function(t){function e(e,o,r,n){var i=t.call(this,e+": "+o)||this;return i.code=e,i.errMsg=o,i.detail=r,i.data=n,i}return n(e,t),e}(Error);o.GameError=p,function(t){t[t.Prompt=0]="Prompt",t[t.OK=1]="OK",t[t.OKCancel=2]="OKCancel"}(u=o.AlertDialogType||(o.AlertDialogType={}));var f=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.alertQueue=[],e}return n(e,t),e.prototype.handleError=function(t){if(!t.handled){t.handled=!0;var e="ERR"+(t.status?t.status+"_":"")+t.code,o=h.i18nMgr().makeStr(e,t.errMsg),r=e+"_DETAIL",n=t.detail||h.i18nMgr().makeStr(r);console.error("Handled error: ",{error:t,title:o,detail:n}),this.alert(o,n,u.OK).then()}},e.prototype.alert=function(t,e,o){var r=this;return"string"!=typeof t?this.alert(t.title,t.message,t.type):new Promise(function(n){var i=new d(t,e,o,n);r.alertQueue.push(i)})},e.prototype.hasAlert=function(){return this.alertQueue.length>0},e.prototype.popAlertTask=function(){if(0==this.alertQueue.length)return null;var t=this.alertQueue[0];return this.alertQueue.splice(0,1),t},i([c.manager],e)}(c.BaseManager);(function(t){t[t.OK=0]="OK",t[t.CANCEL=1]="CANCEL"})(o.AlertResult||(o.AlertResult={}));var d=function(){function t(t,e,o,r){this.title=t,this.message=e,this.type=o,this.promiseResolve=r}return t.prototype.feedback=function(t){this.promiseResolve(t)},t}();o.AlertTask=d;var h=t("./I18nManager");cc._RF.pop()},{"./BaseManager":"BaseManager","./I18nManager":"I18nManager"}],AlertWindow:[function(t,e,o){"use strict";cc._RF.push(e,"d15ceLfJrJLRKVn2kwZWdpy","AlertWindow");var r,n=this&&this.__extends||(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),i=this&&this.__decorate||function(t,e,o,r){var n,i=arguments.length,a=i<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,o):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,o,r);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(a=(i<3?n(a):i>3?n(e,o,a):n(e,o))||a);return i>3&&a&&Object.defineProperty(e,o,a),a};Object.defineProperty(o,"__esModule",{value:!0});var a=cc._decorator.ccclass,s=cc.Label,c=cc._decorator.property,l=cc.Button,u=cc.Node,p=t("../Managers/AlertManager"),f=cc.Layout,d=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.update=function(){p.alertMgr().hasAlert()&&!this.isShowing()&&(this.currentTask=p.alertMgr().popAlertTask(),this.show(),this.titleLabel.string=this.currentTask.title,this.messageLabel.string=this.currentTask.message,this.setupType(this.currentTask.type))},e.prototype.show=function(){this.window.active=!0},e.prototype.dismiss=function(){this.window.active=!1},e.prototype.isShowing=function(){return this.window.active},e.prototype.setupType=function(t){switch(t){case p.AlertDialogType.Prompt:this.buttonGroup.active=!1;break;case p.AlertDialogType.OK:this.buttonGroup.active=!0,this.okButton.node.active=!0,this.cancelButton.node.active=!1;break;case p.AlertDialogType.OKCancel:this.buttonGroup.active=!0,this.okButton.node.active=!0,this.cancelButton.node.active=!0}this.window.getComponentsInChildren(f).forEach(function(t){t.updateLayout()})},e.prototype.btnOKClicked=function(){this.currentTask.feedback(p.AlertResult.OK),this.dismiss()},e.prototype.btnCancelClicked=function(){this.currentTask.feedback(p.AlertResult.CANCEL),this.dismiss()},e.prototype.backgroundClicked=function(){this.currentTask.type==p.AlertDialogType.Prompt&&(this.dismiss(),this.currentTask.feedback(p.AlertResult.OK))},i([c(u)],e.prototype,"window",void 0),i([c(s)],e.prototype,"titleLabel",void 0),i([c(s)],e.prototype,"messageLabel",void 0),i([c(u)],e.prototype,"buttonGroup",void 0),i([c(l)],e.prototype,"okButton",void 0),i([c(l)],e.prototype,"cancelButton",void 0),i([a],e)}(cc.Component);o.default=d,cc._RF.pop()},{"../Managers/AlertManager":"AlertManager"}],AnimationBridge:[function(t,e,o){"use strict";cc._RF.push(e,"7129b6q11hPrrU6PxBfPbDT","AnimationBridge");var r,n=this&&this.__extends||(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),i=this&&this.__decorate||function(t,e,o,r){var n,i=arguments.length,a=i<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,o):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,o,r);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(a=(i<3?n(a):i>3?n(e,o,a):n(e,o))||a);return i>3&&a&&Object.defineProperty(e,o,a),a};Object.defineProperty(o,"__esModule",{value:!0});var a=cc._decorator.requireComponent,s=cc.Animation,c=cc._decorator.menu,l=cc._decorator,u=l.ccclass,p=(l.property,function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.animation=null,e}return n(e,t),e.prototype.start=function(){this.animation=this.getComponent(s)},e.prototype.play=function(){this.animation.play()},i([u,a(s),c("\u5176\u4ed6\u7ec4\u4ef6/\u539f\u751f\u52a8\u753b\u5c01\u88c5")],e)}(cc.Component));o.default=p,cc._RF.pop()},{}],AnimationPlayer:[function(t,e,o){"use strict";cc._RF.push(e,"0a03c2p0qRAurnTB7VSsXdl","AnimationPlayer");var r,n=this&&this.__extends||(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),i=this&&this.__decorate||function(t,e,o,r){var n,i=arguments.length,a=i<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,o):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,o,r);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(a=(i<3?n(a):i>3?n(e,o,a):n(e,o))||a);return i>3&&a&&Object.defineProperty(e,o,a),a};Object.defineProperty(o,"__esModule",{value:!0});var a=t("../ItemPrefabs/PreviewPictureDisplay"),s=cc.Component,c=sp.Skeleton,l=cc._decorator,u=l.ccclass,p=l.property,f=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.skeleton=null,e.aniName="",e}return n(e,t),e.prototype.play=function(){this.skeleton.clearTrack(0),this.skeleton.setAnimation(0,this.aniName,!1),this.skeleton.addAnimation(0,a.DefaultStand,!0)},i([p(c)],e.prototype,"skeleton",void 0),i([p],e.prototype,"aniName",void 0),i([u],e)}(s);o.default=f,cc._RF.pop()},{"../ItemPrefabs/PreviewPictureDisplay":"PreviewPictureDisplay"}],AssetBundleManager:[function(t,e,o){"use strict";cc._RF.push(e,"185f6w6LFNAJb/whnu2u1gh","AssetBundleManager");var r,n=this&&this.__extends||(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),i=this&&this.__decorate||function(t,e,o,r){var n,i=arguments.length,a=i<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,o):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,o,r);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(a=(i<3?n(a):i>3?n(e,o,a):n(e,o))||a);return i>3&&a&&Object.defineProperty(e,o,a),a},a=this&&this.__awaiter||function(t,e,o,r){return new(o||(o=Promise))(function(n,i){function a(t){try{c(r.next(t))}catch(e){i(e)}}function s(t){try{c(r.throw(t))}catch(e){i(e)}}function c(t){var e;t.done?n(t.value):(e=t.value,e instanceof o?e:new o(function(t){t(e)})).then(a,s)}c((r=r.apply(t,e||[])).next())})},s=this&&this.__generator||function(t,e){var o,r,n,i,a={label:0,sent:function(){if(1&n[0])throw n[1];return n[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(t){return function(e){return c([t,e])}}function c(i){if(o)throw new TypeError("Generator is already executing.");for(;a;)try{if(o=1,r&&(n=2&i[0]?r.return:i[0]?r.throw||((n=r.return)&&n.call(r),0):r.next)&&!(n=n.call(r,i[1])).done)return n;switch(r=0,n&&(i=[2&i[0],n.value]),i[0]){case 0:case 1:n=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,r=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(n=(n=a.trys).length>0&&n[n.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!n||i[1]>n[0]&&i[1]<n[3])){a.label=i[1];break}if(6===i[0]&&a.label<n[1]){a.label=n[1],n=i;break}if(n&&a.label<n[2]){a.label=n[2],a.ops.push(i);break}n[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(s){i=[6,s],r=0}finally{o=n=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}};Object.defineProperty(o,"__esModule",{value:!0}),o.assetMgr=o.BundleName=void 0;var c=t("./BaseManager"),l=t("../Common/CoreCommon"),u=t("./LoadingManager");o.BundleName={Data:"data",Sprites:"sprites"},o.assetMgr=function(){return c.getManager(p)};var p=function(t){function e(){var e=t.call(this)||this;return e.bundlePool={},e.assetPool={},e.initializeBundles(),e}return n(e,t),e.prototype.initializeBundles=function(){for(var t in o.BundleName){var e=o.BundleName[t];console.log("Loading Bundle: ",t," -> ",e),this._loadBundle(e).then()}},e.prototype.loadBundle=function(t){return a(this,void 0,Promise,function(){var e;return s(this,function(o){switch(o.label){case 0:return(e=this.bundlePool[t])?[3,2]:[4,this._loadBundle(t)];case 1:e=o.sent(),o.label=2;case 2:return[2,e]}})})},e.prototype._loadBundle=function(t){return a(this,void 0,void 0,function(){return s(this,function(e){switch(e.label){case 0:return[4,this._loadBundlePromise(t)];case 1:return[2,e.sent()]}})})},e.prototype._loadBundlePromise=function(t){var e=this;return new Promise(function(o){cc.assetManager.loadBundle(t,function(r,n){r?(console.error("Load Bundle: ",t," ERROR! ",r),o(null)):(console.log("Load Bundle: ",t," FINISHED! ",n),o(e.bundlePool[t]=n))})})},e.prototype.loadAsset=function(t,e,o){return a(this,void 0,Promise,function(){var r,n,i;return s(this,function(a){switch(a.label){case 0:return[4,this.loadBundle(e)];case 1:return(r=a.sent())?(n=this._getAssetKey(r,o),(i=this.assetPool[n])?[3,3]:[4,this._loadAsset(t,r,o)]):[2,null];case 2:i=a.sent(),a.label=3;case 3:return[2,i]}})})},e.prototype._getAssetKey=function(t,e){return t.name+"."+e},e.prototype._loadAsset=function(t,e,o){return a(this,void 0,Promise,function(){return s(this,function(r){switch(r.label){case 0:return[4,this._loadAssetPromise(t,e,o)];case 1:return[2,r.sent()]}})})},e.prototype._loadAssetPromise=function(t,e,o){var r=this;return new Promise(function(n){e.load(o,t,function(t,i){if(t)console.warn("Load Asset: ",e," -> ",o," ERROR! ",t),n(null);else{console.log("Load Asset: ",e," -> ",o," FINISHED! ",i);var a=r._getAssetKey(e,o);n(r.assetPool[a]=i)}})})},i([u.showLoading(l.CoreLoading.GetAsset)],e.prototype,"loadBundle",null),i([u.showLoading(l.CoreLoading.GetAsset)],e.prototype,"loadAsset",null),i([c.manager],e)}(c.BaseManager);cc._RF.pop()},{"../Common/CoreCommon":"CoreCommon","./BaseManager":"BaseManager","./LoadingManager":"LoadingManager"}],BaseConfig:[function(t,e,o){"use strict";cc._RF.push(e,"ee17bV94alM8JpCRAYQ3gYS","BaseConfig");var r,n=this&&this.__extends||(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)});Object.defineProperty(o,"__esModule",{value:!0}),o.BaseConfig=o.config=void 0;var i=t("./BaseData"),a=t("../Managers/ConfigManager");o.config=function(t){return function(e){a.configMgr().registerConfig(e,t)}};var s=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e}(i.BaseData);o.BaseConfig=s,cc._RF.pop()},{"../Managers/ConfigManager":"ConfigManager","./BaseData":"BaseData"}],BaseContext:[function(t,e,o){"use strict";cc._RF.push(e,"6b8d6UYPO1HEY1QnmP9b96m","BaseContext"),Object.defineProperty(o,"__esModule",{value:!0}),o.BaseContext=void 0;var r=function(){function t(){this.contents=[]}return t.prototype.create=function(t,e){var o=this.find(t);o?o.value=e:this.contents.push({clazz:t,value:e}),console.log("["+this.contentName+" ADD]",{clazz:t,value:e})},t.prototype.remove=function(t){var e=this.find(t);e&&(e.value=null),console.log("["+this.contentName+" REMOVE]",{clazz:t})},t.prototype.instance=function(t){var e;if(!t)return null;var o=null===(e=this.find(t))||void 0===e?void 0:e.value;return o||console.warn("["+this.contentName+" GET MISS]",{clazz:t,res:o}),o},t.prototype.find=function(t){return this.contents.find(function(e){return e.clazz==t})},t}();o.BaseContext=r,cc._RF.pop()},{}],BaseData:[function(t,e,o){"use strict";cc._RF.push(e,"948afBFqyFNKqJ1zdDDW55c","BaseData");var r,n=this&&this.__extends||(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),i=this&&this.__decorate||function(t,e,o,r){var n,i=arguments.length,a=i<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,o):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,o,r);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(a=(i<3?n(a):i>3?n(e,o,a):n(e,o))||a);return i>3&&a&&Object.defineProperty(e,o,a),a},a=this&&this.__awaiter||function(t,e,o,r){return new(o||(o=Promise))(function(n,i){function a(t){try{c(r.next(t))}catch(e){i(e)}}function s(t){try{c(r.throw(t))}catch(e){i(e)}}function c(t){var e;t.done?n(t.value):(e=t.value,e instanceof o?e:new o(function(t){t(e)})).then(a,s)}c((r=r.apply(t,e||[])).next())})},s=this&&this.__generator||function(t,e){var o,r,n,i,a={label:0,sent:function(){if(1&n[0])throw n[1];return n[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(t){return function(e){return c([t,e])}}function c(i){if(o)throw new TypeError("Generator is already executing.");for(;a;)try{if(o=1,r&&(n=2&i[0]?r.return:i[0]?r.throw||((n=r.return)&&n.call(r),0):r.next)&&!(n=n.call(r,i[1])).done)return n;switch(r=0,n&&(i=[2&i[0],n.value]),i[0]){case 0:case 1:n=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,r=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(n=(n=a.trys).length>0&&n[n.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!n||i[1]>n[0]&&i[1]<n[3])){a.label=i[1];break}if(6===i[0]&&a.label<n[1]){a.label=n[1],n=i;break}if(n&&a.label<n[2]){a.label=n[2],a.ops.push(i);break}n[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(s){i=[6,s],r=0}finally{o=n=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}};Object.defineProperty(o,"__esModule",{value:!0}),o.GameData=o.BaseData=o.dataPK=o.assetField=o.field=o.pkType=void 0;var c=t("../Managers/AssetBundleManager"),l=t("../Utils/DataLoader");function u(){return String}function p(t,e){var o,r=e&&"function"!=typeof t,n=r?null===(o=t[e])||void 0===o?void 0:o.constructor:t,i=function(t,e){var o=t.constructor,r=l.DataLoader.getSetting(o);r.default=new o,r.properties[e]={type:n,default:r.default[e]}};if(!r)return i;i(t,e)}o.pkType=u,o.field=p,o.assetField=function(t,e,o){return function(r,n){l.DataLoader.getSetting(r.constructor).assetFields[n]={type:t,bundleName:e,assetPath:o}}},o.dataPK=function(t,e){var o=t.constructor,r=l.DataLoader.getSetting(o);if(r.dataPK)throw o.name+"\u91cd\u590d\u5b9a\u4e49\u4e3b\u952e\uff01\uff01\u5df2\u6709\u4e3b\u952e\uff1a"+r.dataPK+"\uff0c\u7b2c\u4e8c\u6b21\u6ce8\u660e\u7684\u4e3b\u952e\uff1a"+e;r.dataPK=e};var f=function(){function t(t){void 0===t&&(t=null),this.index=-1,this.isLoaded=!1,this._loadTasks=[],this.index=t}return t.prototype.onCreated=function(){},t.prototype.loadTasks=function(){return this._loadTasks},t.prototype.toJSON=function(){return l.DataLoader.convert(this)},t.prototype.clone=function(t){void 0===t&&(t=!1);var e=this.constructor;return t?l.DataLoader.load(e,l.DataLoader.convert(this)):Object.assign(new e,this)},t.prototype.addLoadTask=function(t,e,o,r){this._loadTasks.push(this.loadAssetToField(t,e,o,r))},t.prototype.loadAssetToField=function(t,e,o,r){return a(this,void 0,void 0,function(){var n,i,a,l,u;return s(this,function(s){switch(s.label){case 0:return i=(n=/\${(.+?)}/g).exec(r),(a=this[i[1]])&&(r=r.replace(n,a)),l=this,u=e,[4,c.assetMgr().loadAsset(t,o,r)];case 1:return[2,l[u]=s.sent()]}})})},t}();o.BaseData=f;var d=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e._id=null,e}return n(e,t),Object.defineProperty(e.prototype,"dataId",{get:function(){return this._id.toString()},enumerable:!1,configurable:!0}),i([p(u())],e.prototype,"_id",void 0),e}(f);o.GameData=d,cc._RF.pop()},{"../Managers/AssetBundleManager":"AssetBundleManager","../Utils/DataLoader":"DataLoader"}],BaseManager:[function(t,e,o){"use strict";cc._RF.push(e,"69490TIA45E8aRbYso8nG2f","BaseManager");var r,n=this&&this.__extends||(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),i=this&&this.__decorate||function(t,e,o,r){var n,i=arguments.length,a=i<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,o):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,o,r);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(a=(i<3?n(a):i>3?n(e,o,a):n(e,o))||a);return i>3&&a&&Object.defineProperty(e,o,a),a};Object.defineProperty(o,"__esModule",{value:!0}),o.BaseManager=o.updateContext=o.getManager=o.managerGetter=o.managerValue=o.manager=o.ManagerContext=void 0;var a=t("../Utils/SingletonUtils"),s=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),Object.defineProperty(e.prototype,"contentName",{get:function(){return"Manager"},enumerable:!1,configurable:!0}),e.prototype.update=function(t){this.contents.forEach(function(e){var o;return null===(o=e.value)||void 0===o?void 0:o.update(t)})},i([a.singleton],e)}(t("../../../Utils/BaseContext").BaseContext);function c(){return a.getSingleton(s)}function l(t){return c().instance(t)}o.ManagerContext=s,o.manager=function(t){return c().create(t,new t),t},o.managerValue=function(t){return function(e,o){console.log("[USE] ",{clazz:t,target:e,key:o}),e[o]=l(t)}},o.managerGetter=function(t){return function(e,o,r){r.value=function(){var r;return e[r=o+"_CACHE"]||(e[r]=l(t))}}},o.getManager=l,o.updateContext=function(t){c().update(t)};var u=function(){function t(){this.deltaTime=-1}return t.prototype.update=function(t){this.deltaTime=t},t}();o.BaseManager=u,cc._RF.pop()},{"../../../Utils/BaseContext":"BaseContext","../Utils/SingletonUtils":"SingletonUtils"}],BasePlatform:[function(t,e,o){"use strict";cc._RF.push(e,"86b1dXIh/tMVL2sE3tzXX9B","BasePlatform");var r,n=this&&this.__extends||(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),i=this&&this.__awaiter||function(t,e,o,r){return new(o||(o=Promise))(function(n,i){function a(t){try{c(r.next(t))}catch(e){i(e)}}function s(t){try{c(r.throw(t))}catch(e){i(e)}}function c(t){var e;t.done?n(t.value):(e=t.value,e instanceof o?e:new o(function(t){t(e)})).then(a,s)}c((r=r.apply(t,e||[])).next())})},a=this&&this.__generator||function(t,e){var o,r,n,i,a={label:0,sent:function(){if(1&n[0])throw n[1];return n[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(t){return function(e){return c([t,e])}}function c(i){if(o)throw new TypeError("Generator is already executing.");for(;a;)try{if(o=1,r&&(n=2&i[0]?r.return:i[0]?r.throw||((n=r.return)&&n.call(r),0):r.next)&&!(n=n.call(r,i[1])).done)return n;switch(r=0,n&&(i=[2&i[0],n.value]),i[0]){case 0:case 1:n=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,r=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(n=(n=a.trys).length>0&&n[n.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!n||i[1]>n[0]&&i[1]<n[3])){a.label=i[1];break}if(6===i[0]&&a.label<n[1]){a.label=n[1],n=i;break}if(n&&a.label<n[2]){a.label=n[2],a.ops.push(i);break}n[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(s){i=[6,s],r=0}finally{o=n=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}};Object.defineProperty(o,"__esModule",{value:!0}),o.platform=o.MiniGamePlatform=o.BasePlatform=o.AdsUnitId=o.MaxAdsDayCount=o.UserInfoDesc=void 0;var s=t("../Modules/CoreModule/Managers/PlatformManager");o.UserInfoDesc="\u4e2a\u4eba\u4fe1\u606f\u4ec5\u7528\u4e8e\u6392\u884c\u699c\u5c55\u793a",o.MaxAdsDayCount=15,o.AdsUnitId="fruit";var c=function(){function t(t){this.adsEnable=!1,this.adsCheckCount=5,this.type=t,this.initAds()}return t.prototype.getUserData=function(){return i(this,void 0,void 0,function(){var t;return a(this,function(e){switch(e.label){case 0:return t={type:this.type},[4,this.getOpenid()];case 1:return t.openid=e.sent(),[4,this.getUserInfo()];case 2:return[2,(t.userInfo=e.sent(),t)]}})})},t.prototype.initAds=function(){this.loadAds().then()},t.prototype.loadAds=function(){return i(this,void 0,void 0,function(){var t,e;return a(this,function(o){switch(o.label){case 0:return o.trys.push([0,2,,3]),t=this,[4,this.doLoadAds()];case 1:return t.adsData=o.sent(),console.log("loadAds: Success: ",this.adsData),[3,3];case 2:return e=o.sent(),console.error("loadAds: Error: ",e),[3,3];case 3:return[2]}})})},t.prototype.doLoadAds=function(){return i(this,void 0,Promise,function(){return a(this,function(){return this.onLoad(),[2,{}]})})},t.prototype.onLoad=function(){this.adsEnable=!0},t.prototype.showAds=function(){return i(this,void 0,Promise,function(){return a(this,function(t){switch(t.label){case 0:return[4,this.pendingAds()];case 1:if(!t.sent())throw new Error("\u6682\u65e0\u5e7f\u544a\u53ef\u7528");return[4,this.doShowAds()];case 2:return[2,t.sent()]}})})},t.prototype.pendingAds=function(){var t=this;return new Promise(function(e){var o=0,r=function(){return i(t,void 0,void 0,function(){return a(this,function(t){switch(t.label){case 0:return[4,this.loadAds()];case 1:return t.sent(),this.adsEnable||++o>=this.adsCheckCount?e(this.adsEnable):r().then(),[2]}})})};r().then()})},t.prototype.doShowAds=function(){return i(this,void 0,Promise,function(){return a(this,function(){return this.adsEnable=!1,[2,!0]})})},t}();o.BasePlatform=c;var l=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.initAds=function(){this.adsObject=this.createAdsObject(o.AdsUnitId),this.adsObject.onLoad(this.onLoad.bind(this)),this.loadAds().then()},e.prototype.doLoadAds=function(){return i(this,void 0,Promise,function(){return a(this,function(t){switch(t.label){case 0:return this.adsEnable=!1,[4,this.adsObject.load()];case 1:return[2,t.sent()]}})})},e.prototype.doShowAds=function(){return i(this,void 0,Promise,function(){var e=this;return a(this,function(o){switch(o.label){case 0:return[4,t.prototype.doShowAds.call(this)];case 1:return o.sent()?[4,this.adsObject.show()]:[2,!1];case 2:return o.sent(),[4,new Promise(function(t){e.adsObject.onClose(function(o){e.adsObject.offClose(),t(o&&o.isEnded||!o)})})];case 3:return[2,o.sent()]}})})},e}(c);o.MiniGamePlatform=l,o.platform=function(t){return function(e){return s.platformMgr().registerPlatform(t,e),e}},cc._RF.pop()},{"../Modules/CoreModule/Managers/PlatformManager":"PlatformManager"}],BaseRepository:[function(t,e,o){"use strict";cc._RF.push(e,"9abcaJMo4dBy7aBSxgAXN64","BaseRepository");var r,n=this&&this.__extends||(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),i=this&&this.__decorate||function(t,e,o,r){var n,i=arguments.length,a=i<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,o):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,o,r);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(a=(i<3?n(a):i>3?n(e,o,a):n(e,o))||a);return i>3&&a&&Object.defineProperty(e,o,a),a},a=this&&this.__spreadArrays||function(){for(var t=0,e=0,o=arguments.length;e<o;e++)t+=arguments[e].length;var r=Array(t),n=0;for(e=0;e<o;e++)for(var i=arguments[e],a=0,s=i.length;a<s;a++,n++)r[n]=i[a];return r};Object.defineProperty(o,"__esModule",{value:!0}),o.BaseRepository=o.DefaultThrowFunc=o.throwMessage=o.filterKeys=o.getRepository=o.repository=o.RepositoryContext=void 0;var s=t("../../../Utils/BaseContext"),c=t("../Utils/SingletonUtils"),l=t("../Managers/DataManager"),u=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),Object.defineProperty(e.prototype,"contentName",{get:function(){return"Repository"},enumerable:!1,configurable:!0}),i([c.singleton],e)}(s.BaseContext);function p(){return c.getSingleton(u)}function f(t,e){return function(o,r){var n=o.constructor;n.throwFuncs||(n.throwFuncs={}),n.throwFuncs[r]=function(){if("string"==typeof t)throw t;t(e)}}}o.RepositoryContext=u,o.repository=function(t){return p().create(t,new t),t},o.getRepository=function(t){return p().instance(t)},o.filterKeys=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return function(e,o){var r=e.constructor;r.defaultKeys||(r.defaultKeys={}),r.defaultKeys[o]=t}},o.throwMessage=f,o.DefaultThrowFunc=function(t){throw console.error(t),"Ensure/Get Error!"};var d=function(){function t(){this.idMap={},this.processFuncs()}return Object.defineProperty(t.prototype,"list",{get:function(){return l.dataMgr().getDataList(this.clazz)},enumerable:!1,configurable:!0}),t.prototype.doc=function(t){return l.dataMgr().getDataById(this.clazz,t)},t.prototype.find=function(t){void 0===t&&(t={});var e=Object.keys(t);return e.length<=0?this.list:this.list.filter(function(o){return e.every(function(e){return o[e]==t[e]})})},t.prototype.findOne=function(t){var e;void 0===t&&(t={});var o=Object.keys(t);if(o.length<=0)return this.list[0];if("id"in t){var r=t.id,n=(e=this.idMap)[r]||(e[r]=this.list.find(function(t){return t.id==r})._id),i=this.doc(n);return o.every(function(e){return i[e]==t[e]})?i:null}return this.list.find(function(e){return o.every(function(o){return e[o]==t[o]})})},t.prototype.getOne=function(t,e){void 0===t&&(t={}),void 0===e&&(e=o.DefaultThrowFunc);var r=this.findOne(t);return null==r&&e({repo:this,filter:t}),r},t.prototype.getById=function(t){return this.getOne({id:t})},t.prototype.count=function(t){return void 0===t&&(t={}),this.find(t).length},t.prototype.exist=function(t){return void 0===t&&(t={}),this.count(t)>0},t.prototype.ensure=function(t,e){void 0===t&&(t={}),void 0===e&&(e=o.DefaultThrowFunc),this.findOne(t)||e({repo:this,filter:t})},t.prototype.ensureNot=function(t,e){void 0===t&&(t={}),void 0===e&&(e=o.DefaultThrowFunc),this.findOne(t)&&e({repo:this,filter:t})},t.prototype.processFuncs=function(){var t=this,e=this.constructor.prototype;Object.getOwnPropertyNames(e).forEach(function(e){return t.processFunc(e)})},t.prototype.processFunc=function(t){var e=this.getNewFunc(t);e&&(this[t]=e)},t.prototype.getNewFunc=function(t){var e=this.getKeysFromName(t);return t.startsWith("findOne")?this.getFindOneFunc(t,e):t.startsWith("find")?this.getFindFunc(t,e):t.startsWith("get")?this.getGetOneFunc(t,e):t.startsWith("count")?this.getCountFunc(t,e):t.startsWith("exist")?this.getExistFunc(t,e):t.startsWith("ensure")?this.getEnsureFunc(t,e):t.startsWith("ensureNot")?this.getEnsureNotFunc(t,e):null},t.prototype.getKeysFromName=function(t){var e=this.constructor.defaultKeys;return(e?e[t]:null)||this.analyseByClause(t)},t.prototype.analyseByClause=function(t){var e;return(null===(e=t.split("By")[1])||void 0===e?void 0:e.split("And"))||[]},t.prototype.makeFilter=function(t){for(var e=this,o=[],r=1;r<arguments.length;r++)o[r-1]=arguments[r];var n={};return t.forEach(function(t,r){return n[e.convertKey(t)]=o[r]}),n},t.prototype.convertKey=function(t){return t.charAt(0).toLowerCase()+t.slice(1)},t.prototype.getFindFunc=function(t,e){var o=this;return function(){for(var t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];return o.find(o.makeFilter.apply(o,a([e],t)))}},t.prototype.getFindOneFunc=function(t,e){var o=this;return function(){for(var t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];return o.findOne(o.makeFilter.apply(o,a([e],t)))}},t.prototype.getGetOneFunc=function(t,e){var o=this,r=this.getThrowFunc(t);return function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];return o.getOne(o.makeFilter.apply(o,a([e],t)),r)}},t.prototype.getCountFunc=function(t,e){var o=this;return function(){for(var t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];return o.count(o.makeFilter.apply(o,a([e],t)))}},t.prototype.getExistFunc=function(t,e){var o=this;return function(){for(var t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];return o.exist(o.makeFilter.apply(o,a([e],t)))}},t.prototype.getEnsureFunc=function(t,e){var o=this,r=this.getThrowFunc(t);return function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];return o.ensure(o.makeFilter.apply(o,a([e],t)),r)}},t.prototype.getEnsureNotFunc=function(t,e){var o=this,r=this.getThrowFunc(t);return function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];return o.ensureNot(o.makeFilter.apply(o,a([e],t)),r)}},t.prototype.getThrowFunc=function(t){var e=this.constructor.throwFuncs;return(e?e[t]:null)||function(){throw null}},i([f("\u627e\u4e0d\u5230\u6307\u5b9aID\u7684\u6570\u636e")],t.prototype,"getById",null),t}();o.BaseRepository=d,cc._RF.pop()},{"../../../Utils/BaseContext":"BaseContext","../Managers/DataManager":"DataManager","../Utils/SingletonUtils":"SingletonUtils"}],BaseScene:[function(t,e,o){"use strict";cc._RF.push(e,"9b6d6G2rypCaKmhA/PKc2id","BaseScene");var r,n=this&&this.__extends||(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)});Object.defineProperty(o,"__esModule",{value:!0}),o.BaseScene=void 0;var i=t("../Modules/CoreModule/Managers/BaseManager"),a=cc.Component,s=t("../Modules/CoreModule/Managers/SceneManager"),c=t("../Modules/NFTModule/Managers/NFTManager"),l=t("../Modules/PlayerModule/Managers/PlayerManager"),u=cc._decorator,p=(u.ccclass,u.property,function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.onLoad=function(){s.sceneMgr().curScene=this},e.prototype.onDestroy=function(){s.sceneMgr().curScene=null},Object.defineProperty(e.prototype,"autoConnect",{get:function(){return!0},enumerable:!1,configurable:!0}),e.prototype.start=function(){c.Web3Enable?c.nftMgr().init(this.autoConnect).then():l.playerMgr().autoLogin().then()},e.prototype.update=function(t){i.updateContext(t)},e}(a));o.BaseScene=p,cc._RF.pop()},{"../Modules/CoreModule/Managers/BaseManager":"BaseManager","../Modules/CoreModule/Managers/SceneManager":"SceneManager","../Modules/NFTModule/Managers/NFTManager":"NFTManager","../Modules/PlayerModule/Managers/PlayerManager":"PlayerManager"}],BattleAnimationsController:[function(t,e,o){"use strict";cc._RF.push(e,"ff277ps1NBMnI8By5+HU6Ae","BattleAnimationsController");var r,n=this&&this.__extends||(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),i=this&&this.__decorate||function(t,e,o,r){var n,i=arguments.length,a=i<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,o):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,o,r);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(a=(i<3?n(a):i>3?n(e,o,a):n(e,o))||a);return i>3&&a&&Object.defineProperty(e,o,a),a};Object.defineProperty(o,"__esModule",{value:!0});var a,s=cc.Animation,c=t("../../../Scenes/BattleScene"),l=cc._decorator,u=l.ccclass,p=l.property,f=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.animations=[],e.speeds=[],e}return n(e,t),e.prototype.start=function(){var t=this;this.animations.forEach(function(){return t.speeds.push(1)})},e.prototype.update=function(){var t=this,e=c.battleScene().battleSpeed;this.animations.forEach(function(o,r){o.getAnimationState(o.defaultClip.name).speed=e*t.speeds[r],o.node.active&&!o.getAnimationState(o.defaultClip.name).isPlaying&&(o.node.active=!1)})},e.prototype.play=function(t,e,o,r){if(void 0===e&&(e=0),void 0===o&&(o=0),void 0===r&&(r=0),this.animations[a[t]]){var n=this.animations[a[t]];e>0&&(this.speeds[a[t]]=n.defaultClip._duration/e),n.node.active=!0,n.node.x=o,n.node.y=r,n.play()}},i([p([s])],e.prototype,"animations",void 0),i([u],e)}(cc.Component);o.default=f,function(t){t[t.bossComing=0]="bossComing",t[t.attack=1]="attack",t[t.death=2]="death"}(a||(a={})),cc._RF.pop()},{"../../../Scenes/BattleScene":"BattleScene"}],BattleCommon:[function(t,e,o){"use strict";cc._RF.push(e,"77b5aL/oTdODoGqj5QgyxZi","BattleCommon");var r=this&&this.__decorate||function(t,e,o,r){var n,i=arguments.length,a=i<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,o):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,o,r);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(a=(i<3?n(a):i>3?n(e,o,a):n(e,o))||a);return i>3&&a&&Object.defineProperty(e,o,a),a},n=this&&this.__awaiter||function(t,e,o,r){return new(o||(o=Promise))(function(n,i){function a(t){try{c(r.next(t))}catch(e){i(e)}}function s(t){try{c(r.throw(t))}catch(e){i(e)}}function c(t){var e;t.done?n(t.value):(e=t.value,e instanceof o?e:new o(function(t){t(e)})).then(a,s)}c((r=r.apply(t,e||[])).next())})},i=this&&this.__generator||function(t,e){var o,r,n,i,a={label:0,sent:function(){if(1&n[0])throw n[1];return n[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(t){return function(e){return c([t,e])}}function c(i){if(o)throw new TypeError("Generator is already executing.");for(;a;)try{if(o=1,r&&(n=2&i[0]?r.return:i[0]?r.throw||((n=r.return)&&n.call(r),0):r.next)&&!(n=n.call(r,i[1])).done)return n;switch(r=0,n&&(i=[2&i[0],n.value]),i[0]){case 0:case 1:n=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,r=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(n=(n=a.trys).length>0&&n[n.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!n||i[1]>n[0]&&i[1]<n[3])){a.label=i[1];break}if(6===i[0]&&a.label<n[1]){a.label=n[1],n=i;break}if(n&&a.label<n[2]){a.label=n[2],a.ops.push(i);break}n[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(s){i=[6,s],r=0}finally{o=n=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}};Object.defineProperty(o,"__esModule",{value:!0}),o.BattleInterface=o.BattleThrow=void 0;var a=t("../CoreModule/Common/CoreCommon"),s=function(){function t(){}return t.prototype.test=function(){},r([a.error(1,"")],t.prototype,"test",null),t}();o.BattleThrow=s;var c=function(){function t(){}return t.StartMainBattle=function(){return n(this,void 0,Promise,function(){return i(this,function(){return[2]})})},t.StartMainBattleAction=function(){return n(this,void 0,Promise,function(){return i(this,function(){return[2]})})},t.EndMainBattle=function(){return n(this,void 0,Promise,function(){return i(this,function(){return[2]})})},t.BoostMainBattle=function(){return n(this,void 0,Promise,function(){return i(this,function(){return[2]})})},t.GetPVPPlayerCount=function(){return n(this,void 0,Promise,function(){return i(this,function(){return[2]})})},t.GetPVPPlayers=function(){return n(this,void 0,Promise,function(){return i(this,function(){return[2]})})},t.StartPVP=function(){return n(this,void 0,Promise,function(){return i(this,function(){return[2]})})},t.StartPVPAction=function(){return n(this,void 0,Promise,function(){return i(this,function(){return[2]})})},t.SkipPVP=function(){return n(this,void 0,Promise,function(){return i(this,function(){return[2]})})},t.BoostPVP=function(){return n(this,void 0,Promise,function(){return i(this,function(){return[2]})})},t.EndPVP=function(){return n(this,void 0,Promise,function(){return i(this,function(){return[2]})})},t.StartCopy=function(){return n(this,void 0,Promise,function(){return i(this,function(){return[2]})})},t.BuyBattleChance=function(){return n(this,void 0,Promise,function(){return i(this,function(){return[2]})})},t.StartTest=function(){return n(this,void 0,Promise,function(){return i(this,function(){return[2]})})},t.NextTest=function(){return n(this,void 0,Promise,function(){return i(this,function(){return[2]})})},t.EndTest=function(){return n(this,void 0,Promise,function(){return i(this,function(){return[2]})})},r([a.post("/battle/main/start")],t,"StartMainBattle",null),r([a.post("/battle/main/action")],t,"StartMainBattleAction",null),r([a.post("/battle/main/end")],t,"EndMainBattle",null),r([a.post("/battle/main/boost")],t,"BoostMainBattle",null),r([a.post("/battle/pvp/player_count")],t,"GetPVPPlayerCount",null),r([a.post("/battle/pvp/get_player")],t,"GetPVPPlayers",null),r([a.post("/battle/pvp/start")],t,"StartPVP",null),r([a.post("/battle/pvp/action")],t,"StartPVPAction",null),r([a.post("/battle/pvp/skip")],t,"SkipPVP",null),r([a.post("/battle/pvp/boost")],t,"BoostPVP",null),r([a.post("/battle/pvp/end")],t,"EndPVP",null),r([a.post("/battle/copy/start")],t,"StartCopy",null),r([a.post("/battle/copy/buy_battle_chance")],t,"BuyBattleChance",null),r([a.post("/battle/test/start")],t,"StartTest",null),r([a.post("/battle/test/next")],t,"NextTest",null),r([a.post("/battle/test/end")],t,"EndTest",null),t}();o.BattleInterface=c,cc._RF.pop()},{"../CoreModule/Common/CoreCommon":"CoreCommon"}],BattleConfig:[function(t,e,o){"use strict";cc._RF.push(e,"06978RIBFFHCqiJeISLRnim","BattleConfig");var r,n=this&&this.__extends||(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),i=this&&this.__decorate||function(t,e,o,r){var n,i=arguments.length,a=i<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,o):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,o,r);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(a=(i<3?n(a):i>3?n(e,o,a):n(e,o))||a);return i>3&&a&&Object.defineProperty(e,o,a),a};Object.defineProperty(o,"__esModule",{value:!0}),o.BattleConfig=void 0;var a=t("../../CoreModule/Data/BaseConfig"),s=t("../../CoreModule/Data/BaseData"),c=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.hit={defaultBase:.1,baseHitRate:.97,float:[.9,1.1]},e.crit={minRate:.03,damageRate:2},e.restraint={rates:[1,4,.5]},e}return n(e,t),i([s.field],e.prototype,"hit",void 0),i([s.field],e.prototype,"crit",void 0),i([s.field],e.prototype,"restraint",void 0),i([a.config("BattleConfig")],e)}(a.BaseConfig);o.BattleConfig=c,cc._RF.pop()},{"../../CoreModule/Data/BaseConfig":"BaseConfig","../../CoreModule/Data/BaseData":"BaseData"}],BattleDisplay:[function(t,e,o){"use strict";cc._RF.push(e,"fa5b2yb1OpEwrwt+PCwMQPu","BattleDisplay");var r,n=this&&this.__extends||(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),i=this&&this.__decorate||function(t,e,o,r){var n,i=arguments.length,a=i<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,o):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,o,r);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(a=(i<3?n(a):i>3?n(e,o,a):n(e,o))||a);return i>3&&a&&Object.defineProperty(e,o,a),a};Object.defineProperty(o,"__esModule",{value:!0});var a=t("../../CoreModule/Components/ItemDisplay"),s=t("./BattleAnimationsController"),c=cc.Node,l=cc._decorator,u=l.ccclass,p=l.property,f=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.battlerNodes=[null,null,null,null],e.battlers=[],e.isSettled=!1,e.animation=null,e}return n(e,t),e.prototype.start=function(){t.prototype.start.call(this)},e.prototype.onLoad=function(){var t=this;this.battlerNodes.forEach(function(e){return t.battlers.push(e.getComponent(h.default))}),this.battlers.forEach(function(e){return e.battle=t}),console.log("BattleDisplay onLoad",this,this.battlerNodes,this.battlers)},e.prototype.getDisplay=function(t){return t&&this.battlers.find(function(e){return e.camp==t.camp&&e.index==t.pos})},e.prototype.refresh=function(){var e=this;t.prototype.refresh.call(this),console.log("BattleDisplay refresh",this,this.item),this.battlers.forEach(function(t){return t.clearItems()}),this.item.battlers.forEach(function(t){var o;return null===(o=e.getDisplay(t))||void 0===o?void 0:o.addItem(t)}),this.isSettled=!1},e.prototype.update=function(){this.item&&(this.updateAnimationSpeed(),this.updateBattleAnimation())},e.prototype.updateAnimationSpeed=function(){this.battlers.forEach(function(t){return t.skeleton.timeScale=d.battleScene().battleSpeed})},e.prototype.updateBattleAnimation=function(){var t=this,e=this.item.getCurrentAnimationTimes();this.item.getCurrentAnimations().forEach(function(o,r){return t.animation.play(o,e[r])})},e.prototype.playNormalAnimation=function(t,e,o,r){this.animation.play(t,e,o,r)},i([p([c])],e.prototype,"battlerNodes",void 0),i([p(s.default)],e.prototype,"animation",void 0),i([u],e)}(a.ItemDisplay);o.default=f;var d=t("../../../Scenes/BattleScene"),h=t("./BattlerDisplay");cc._RF.pop()},{"../../../Scenes/BattleScene":"BattleScene","../../CoreModule/Components/ItemDisplay":"ItemDisplay","./BattleAnimationsController":"BattleAnimationsController","./BattlerDisplay":"BattlerDisplay"}],BattleManager:[function(t,e,o){"use strict";cc._RF.push(e,"fd4f2lxstVNzKaGZUqESO4B","BattleManager");var r,n=this&&this.__extends||(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),i=this&&this.__decorate||function(t,e,o,r){var n,i=arguments.length,a=i<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,o):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,o,r);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(a=(i<3?n(a):i>3?n(e,o,a):n(e,o))||a);return i>3&&a&&Object.defineProperty(e,o,a),a},a=this&&this.__awaiter||function(t,e,o,r){return new(o||(o=Promise))(function(n,i){function a(t){try{c(r.next(t))}catch(e){i(e)}}function s(t){try{c(r.throw(t))}catch(e){i(e)}}function c(t){var e;t.done?n(t.value):(e=t.value,e instanceof o?e:new o(function(t){t(e)})).then(a,s)}c((r=r.apply(t,e||[])).next())})},s=this&&this.__generator||function(t,e){var o,r,n,i,a={label:0,sent:function(){if(1&n[0])throw n[1];return n[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(t){return function(e){return c([t,e])}}function c(i){if(o)throw new TypeError("Generator is already executing.");for(;a;)try{if(o=1,r&&(n=2&i[0]?r.return:i[0]?r.throw||((n=r.return)&&n.call(r),0):r.next)&&!(n=n.call(r,i[1])).done)return n;switch(r=0,n&&(i=[2&i[0],n.value]),i[0]){case 0:case 1:n=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,r=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(n=(n=a.trys).length>0&&n[n.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!n||i[1]>n[0]&&i[1]<n[3])){a.label=i[1];break}if(6===i[0]&&a.label<n[1]){a.label=n[1],n=i;break}if(n&&a.label<n[2]){a.label=n[2],a.ops.push(i);break}n[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(s){i=[6,s],r=0}finally{o=n=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}};Object.defineProperty(o,"__esModule",{value:!0}),o.BattleManager=o.battleMgr=void 0;var c=t("../../CoreModule/Managers/BaseManager"),l=t("../../CoreModule/Utils/DataLoader");function u(){return c.getManager(p)}o.battleMgr=u;var p=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.battles=[],e}return n(e,t),e.prototype.startMainBattle=function(){return a(this,void 0,void 0,function(){var t,e;return s(this,function(o){switch(o.label){case 0:return[4,d.BattleInterface.StartMainBattle()];case 1:return t=o.sent(),(e=l.DataLoader.load(h.Battle,t.battle)).battlers.forEach(function(t){return t.isEntering&&t.enter()}),[4,this.getBattleNFTs(e)];case 2:return o.sent(),this.startBattle(e).start(),u().startMainFirstAction(e).then(),[2,e]}})})},e.prototype.startMainFirstAction=function(t){return a(this,void 0,void 0,function(){var e,o;return s(this,function(r){switch(r.label){case 0:return[4,d.BattleInterface.StartMainBattleAction({battleId:t.battleId})];case 1:return e=r.sent(),o=l.DataLoader.load(y.Action,e.action),t.addAction(o),[2]}})})},e.prototype.nextMainBattle=function(){return a(this,void 0,void 0,function(){return s(this,function(){return[2]})})},e.prototype.startCopy=function(){return a(this,void 0,void 0,function(){var t,e;return s(this,function(o){switch(o.label){case 0:return[4,d.BattleInterface.StartCopy({copyId:11})];case 1:return t=o.sent(),(e=l.DataLoader.load(h.Battle,t.battle)).battlers.forEach(function(t){return t.isEntering&&t.enter()}),this.startBattle(e).start(),[2,e]}})})},e.prototype.test=function(t){this.startBattle(t).start()},e.prototype.startBattle=function(t){var e=f.createProcessor(t);return this.battles.push(e),e},e.prototype.getBattleNFTs=function(t){return a(this,void 0,void 0,function(){var e,o,r,n;return s(this,function(i){switch(i.label){case 0:e=t.battlers.filter(function(t){return t.isHero}),o=0,r=e,i.label=1;case 1:return o<r.length?(n=r[o],[4,v.heroMgr().getOneFromServer(n.nftId)]):[3,4];case 2:i.sent(),n.refresh(),i.label=3;case 3:return o++,[3,1];case 4:return[2]}})})},e.prototype.update=function(e){t.prototype.update.call(this,e),this.battles.forEach(function(t){return t.update(e*g.battleScene().battleSpeed)})},e.prototype.startPVPBattle=function(t,e,o){return a(this,void 0,void 0,function(){var r,n;return s(this,function(i){switch(i.label){case 0:return[4,d.BattleInterface.StartPVP({selfNftId:t,roomId:e,enemyNftId:o})];case 1:return r=i.sent(),(n=l.DataLoader.load(h.Battle,r.battle)).battlers.forEach(function(t){return t.isEntering&&t.enter()}),[4,this.getBattleNFTs(n)];case 2:return i.sent(),this.startBattle(n).start(),u().startPVPFirstAction(n).then(),[2,n]}})})},e.prototype.startPVPFirstAction=function(t){return a(this,void 0,void 0,function(){var e,o;return s(this,function(r){switch(r.label){case 0:return console.log(123456),[4,d.BattleInterface.StartPVPAction({battleId:t.battleId})];case 1:return e=r.sent(),o=l.DataLoader.load(y.Action,e.action),t.addAction(o),[2]}})})},i([c.manager],e)}(c.BaseManager);o.BattleManager=p;var f=t("../Utils/BattleProcessor"),d=t("../BattleCommon"),h=t("../Data/Battle"),y=t("../Data/Action"),g=t("../../../Scenes/BattleScene"),v=t("../../HeroModule/Managers/HeroManager");cc._RF.pop()},{"../../../Scenes/BattleScene":"BattleScene","../../CoreModule/Managers/BaseManager":"BaseManager","../../CoreModule/Utils/DataLoader":"DataLoader","../../HeroModule/Managers/HeroManager":"HeroManager","../BattleCommon":"BattleCommon","../Data/Action":"Action","../Data/Battle":"Battle","../Utils/BattleProcessor":"BattleProcessor"}],BattleProcessor:[function(t,e,o){"use strict";cc._RF.push(e,"251a87HiktGVpcc1wrlxCN7","BattleProcessor");var r,n=this&&this.__extends||(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),i=this&&this.__decorate||function(t,e,o,r){var n,i=arguments.length,a=i<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,o):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,o,r);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(a=(i<3?n(a):i>3?n(e,o,a):n(e,o))||a);return i>3&&a&&Object.defineProperty(e,o,a),a},a=this&&this.__awaiter||function(t,e,o,r){return new(o||(o=Promise))(function(n,i){function a(t){try{c(r.next(t))}catch(e){i(e)}}function s(t){try{c(r.throw(t))}catch(e){i(e)}}function c(t){var e;t.done?n(t.value):(e=t.value,e instanceof o?e:new o(function(t){t(e)})).then(a,s)}c((r=r.apply(t,e||[])).next())})},s=this&&this.__generator||function(t,e){var o,r,n,i,a={label:0,sent:function(){if(1&n[0])throw n[1];return n[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(t){return function(e){return c([t,e])}}function c(i){if(o)throw new TypeError("Generator is already executing.");for(;a;)try{if(o=1,r&&(n=2&i[0]?r.return:i[0]?r.throw||((n=r.return)&&n.call(r),0):r.next)&&!(n=n.call(r,i[1])).done)return n;switch(r=0,n&&(i=[2&i[0],n.value]),i[0]){case 0:case 1:n=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,r=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(n=(n=a.trys).length>0&&n[n.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!n||i[1]>n[0]&&i[1]<n[3])){a.label=i[1];break}if(6===i[0]&&a.label<n[1]){a.label=n[1],n=i;break}if(n&&a.label<n[2]){a.label=n[2],a.ops.push(i);break}n[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(s){i=[6,s],r=0}finally{o=n=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}};Object.defineProperty(o,"__esModule",{value:!0}),o.PVPBattleProcessor=o.BossBattleProcessor=o.CopyBattleProcessor=o.MainBattleProcessor=o.BattleProcessor=o.createProcessor=o.battleProcessor=void 0;var c=t("../Data/Action"),l=t("../Data/Battle"),u=t("../BattleCommon"),p=t("../../CoreModule/Utils/DataLoader"),f=t("../Data/Battler"),d=t("../../../Utils/PromiseUtils"),h=t("../../CopyModule/Data/Copy"),y=t("../../PlayerModule/Managers/PlayerManager"),g=t("../../CopyModule/Data/PlayerCopy"),v=l.PlayerCamp;function b(t){return function(e){m.processorSettings[t]=e}}o.battleProcessor=b,o.createProcessor=function(t){var e=m.processorSettings[t.type];return e?new e(t):null};var m=function(){function t(t){var e=this;this.battle=t,this.battle.onActionStartListener=function(t){return e.onActionStart(t)},this.battle.onActionEndListener=function(t){return e.onActionEnd(t)},this.battle.onBattleEndListener=function(t){return e.onBattleEnd(t)}}return Object.defineProperty(t.prototype,"isResult",{get:function(){return this.battle.winner>=0},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"isWin",{get:function(){return this.battle.winner==v},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"isLose",{get:function(){return this.battle.winner==1-v},enumerable:!1,configurable:!0}),t.prototype.start=function(){this.battle.start(),this.onStarted()},t.prototype.terminate=function(){this.battle.terminate(),this.onTerminated()},t.prototype.onStarted=function(){},t.prototype.onTerminated=function(){this.processRewards()},t.prototype.onActionStart=function(){},t.prototype.onActionEnd=function(){},t.prototype.onBattleEnd=function(){},t.prototype.rewards=function(){return null},t.prototype.processRewards=function(){if(this.isResult){var t=this.rewards();t&&(t.gold.value*=this.battle.campBonusParam(v,f.BonusParamType.Gold),t.invoke())}},t.prototype.update=function(t){this.updateBattle(t)},t.prototype.updateBattle=function(t){this.battle.update(t)},t.prototype.printBattle=function(){console.log("=== Battle "+this.battle.battleId+" ==="),console.log("state: ",l.BattleState[this.battle.state]),console.log("elapsedTime: ",this.battle.elapsedTime,"actionTime: ",this.battle.actionTime),console.log("== battlers =="),console.log("camp","pos","state","hp","action","motions"),this.battle.battlers.forEach(function(t){return console.log(t.camp,t.pos,f.BattlerState[t.state],t.hp,t.action,t.motions)}),console.log("== actions =="),console.log("time","subject","target","skillId"),this.battle.actions.forEach(function(t){return console.log(t.time,t.subject,t.target,t.skillId)})},t.processorSettings={},t}();o.BattleProcessor=m;var _=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.rewards=function(){return h.copyRepo().main().level(this.battle.level).calcRewards(this.isWin,this.battle.isFirst)},e.prototype.onActionEnd=function(e){return a(this,void 0,void 0,function(){var o,r,n=this;return s(this,function(i){switch(i.label){case 0:return t.prototype.onActionEnd.call(this,e),[4,d.PromiseUtils.waitForRetry(function(){return u.BattleInterface.StartMainBattleAction({battleId:n.battle.battleId})})];case 1:return o=i.sent(),this.resultBattle=p.DataLoader.load(l.Battle,o.battle),r=p.DataLoader.load(c.Action,o.action),this.battle.setActionTime(this.resultBattle.actionTime),this.battle.addAction(r),[2]}})})},e.prototype.onBattleEnd=function(e){return a(this,void 0,void 0,function(){var o;return s(this,function(r){switch(r.label){case 0:return t.prototype.onBattleEnd.call(this,e),[4,u.BattleInterface.EndMainBattle({battleId:this.battle.battleId})];case 1:return o=r.sent(),this.resultBattle=p.DataLoader.load(l.Battle,o.battle),this.terminate(),[2]}})})},e.prototype.onTerminated=function(){t.prototype.onTerminated.call(this);var e=y.playerMgr().getPlayerData(g.PlayerCopy);this.isWin&&e.mainCopy().next(),this.isLose&&e.mainCopy().prev()},i([b(l.BattleType.Main)],e)}(function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),Object.defineProperty(e.prototype,"round",{get:function(){return this.battle.actionTime},enumerable:!1,configurable:!0}),e.prototype.updateBattle=function(e){t.prototype.updateBattle.call(this,e)},e}(m));o.MainBattleProcessor=_;var P=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.onActionEnd=function(e){t.prototype.onActionEnd.call(this,e),this.battle.actions.find(function(t){return t.time==e.time})&&this.battle.nextRound()},i([b(l.BattleType.Copy)],e)}(m);o.CopyBattleProcessor=P;var M=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),i([b(l.BattleType.Boss)],e)}(P);o.BossBattleProcessor=M;var C=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.onActionEnd=function(e){return a(this,void 0,void 0,function(){var o,r,n=this;return s(this,function(i){switch(i.label){case 0:return t.prototype.onActionEnd.call(this,e),[4,d.PromiseUtils.waitForRetry(function(){return u.BattleInterface.StartPVPAction({battleId:n.battle.battleId})})];case 1:return o=i.sent(),this.resultBattle=p.DataLoader.load(l.Battle,o.battle),r=p.DataLoader.load(c.Action,o.action),this.battle.setActionTime(this.resultBattle.actionTime),this.battle.addAction(r),[2]}})})},e.prototype.onBattleEnd=function(e){return a(this,void 0,void 0,function(){var o;return s(this,function(r){switch(r.label){case 0:return t.prototype.onBattleEnd.call(this,e),[4,u.BattleInterface.EndPVP({battleId:this.battle.battleId})];case 1:return o=r.sent(),this.resultBattle=p.DataLoader.load(l.Battle,o.battle),this.terminate(),[2]}})})},e.prototype.onTerminated=function(){t.prototype.onTerminated.call(this)},i([b(l.BattleType.PVP)],e)}(m);o.PVPBattleProcessor=C,cc._RF.pop()},{"../../../Utils/PromiseUtils":"PromiseUtils","../../CopyModule/Data/Copy":"Copy","../../CopyModule/Data/PlayerCopy":"PlayerCopy","../../CoreModule/Utils/DataLoader":"DataLoader","../../PlayerModule/Managers/PlayerManager":"PlayerManager","../BattleCommon":"BattleCommon","../Data/Action":"Action","../Data/Battle":"Battle","../Data/Battler":"Battler"}],BattleRewardContainer:[function(t,e,o){"use strict";cc._RF.push(e,"5164760AvhMW5AO0if6k1in","BattleRewardContainer");var r,n=this&&this.__extends||(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),i=this&&this.__decorate||function(t,e,o,r){var n,i=arguments.length,a=i<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,o):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,o,r);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(a=(i<3?n(a):i>3?n(e,o,a):n(e,o))||a);return i>3&&a&&Object.defineProperty(e,o,a),a};Object.defineProperty(o,"__esModule",{value:!0});var a=t("../../../CoreModule/Components/ItemContainer"),s=cc._decorator,c=s.ccclass,l=s.property,u=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.coldDownTime=.1,e}return n(e,t),e.prototype.start=function(){},e.prototype.onItemsChanged=function(){var e=this;t.prototype.onItemsChanged.call(this),this.items.forEach(function(t,o){e.itemsComponents[o].delayTime=e.coldDownTime*(o+1)})},i([l(Number)],e.prototype,"coldDownTime",void 0),i([c],e)}(a.ItemContainer);o.default=u,cc._RF.pop()},{"../../../CoreModule/Components/ItemContainer":"ItemContainer"}],BattleRewardDisplay:[function(t,e,o){"use strict";cc._RF.push(e,"3936fHSk7xKAImmO+p1jIts","BattleRewardDisplay");var r,n=this&&this.__extends||(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),i=this&&this.__decorate||function(t,e,o,r){var n,i=arguments.length,a=i<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,o):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,o,r);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(a=(i<3?n(a):i>3?n(e,o,a):n(e,o))||a);return i>3&&a&&Object.defineProperty(e,o,a),a};Object.defineProperty(o,"__esModule",{value:!0});var a=t("../../../CoreModule/Components/ItemDisplay"),s=cc.Sprite,c=cc.Label,l=t("../../../../Utils/NumberUtils"),u=cc._decorator,p=u.ccclass,f=u.property,d=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.icon=null,e.value=null,e.animationTime=.2,e.delayTime=0,e.timer=0,e}return n(e,t),e.prototype.start=function(){},e.prototype.update=function(t){this.updateNodeAnimation(t)},e.prototype.onItemChanged=function(){t.prototype.onItemChanged.call(this),this.updateLabels(),this.resetTimers()},e.prototype.updateLabels=function(){this.value.string=this.item.value.toString()},e.prototype.updateNodeAnimation=function(t){if(this.timer<this.delayTime+this.animationTime)return this.node.opacity=Math.max(0,255*(this.timer-this.delayTime)/this.animationTime),this.node.scale=Math.min(1.2,1.2-.2*(this.timer-this.delayTime)/this.animationTime),void(this.timer+=t);this.node.opacity=255,this.node.scale=1},e.prototype.resetTimers=function(){this.timer=0},i([f(s)],e.prototype,"icon",void 0),i([f(c)],e.prototype,"value",void 0),i([l.autoUnitConvert],e.prototype,"updateLabels",null),i([f(Number)],e.prototype,"animationTime",void 0),i([p],e)}(a.ItemDisplay);o.default=d,cc._RF.pop()},{"../../../../Utils/NumberUtils":"NumberUtils","../../../CoreModule/Components/ItemDisplay":"ItemDisplay"}],BattleScene:[function(t,e,o){"use strict";cc._RF.push(e,"e52b0HQKvpEGKIM3An3X3Tp","BattleScene");var r,n=this&&this.__extends||(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),i=this&&this.__decorate||function(t,e,o,r){var n,i=arguments.length,a=i<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,o):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,o,r);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(a=(i<3?n(a):i>3?n(e,o,a):n(e,o))||a);return i>3&&a&&Object.defineProperty(e,o,a),a},a=this&&this.__awaiter||function(t,e,o,r){return new(o||(o=Promise))(function(n,i){function a(t){try{c(r.next(t))}catch(e){i(e)}}function s(t){try{c(r.throw(t))}catch(e){i(e)}}function c(t){var e;t.done?n(t.value):(e=t.value,e instanceof o?e:new o(function(t){t(e)})).then(a,s)}c((r=r.apply(t,e||[])).next())})},s=this&&this.__generator||function(t,e){var o,r,n,i,a={label:0,sent:function(){if(1&n[0])throw n[1];return n[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(t){return function(e){return c([t,e])}}function c(i){if(o)throw new TypeError("Generator is already executing.");for(;a;)try{if(o=1,r&&(n=2&i[0]?r.return:i[0]?r.throw||((n=r.return)&&n.call(r),0):r.next)&&!(n=n.call(r,i[1])).done)return n;switch(r=0,n&&(i=[2&i[0],n.value]),i[0]){case 0:case 1:n=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,r=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(n=(n=a.trys).length>0&&n[n.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!n||i[1]>n[0]&&i[1]<n[3])){a.label=i[1];break}if(6===i[0]&&a.label<n[1]){a.label=n[1],n=i;break}if(n&&a.label<n[2]){a.label=n[2],a.ops.push(i);break}n[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(s){i=[6,s],r=0}finally{o=n=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}};Object.defineProperty(o,"__esModule",{value:!0}),o.battleScene=void 0;var c=t("../Modules/CoreModule/Utils/SingletonUtils"),l=t("./BaseScene"),u=cc.Node,p=t("../Modules/CopyModule/Managers/CopyManager"),f=t("../Modules/PlayerModule/Managers/PlayerManager"),d=t("../Modules/CoreModule/Managers/DataManager"),h=t("../Modules/BattleModule/Managers/BattleManager"),y=t("../Modules/NFTModule/Managers/NFTManager"),g=cc.Prefab,v=cc._decorator,b=v.ccclass,m=v.property;o.battleScene=function(){return c.getSingleton(_)};var _=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.heroesInTeam=[],e.battleSpeed=1,e.battleEnded=!1,e.myTeamFrameNode=null,e.cultivateWindowNode=null,e.settlementWindowNode=null,e.mainBattleNode=null,e.pvpBattleNode=null,e.currentPVPRoomIndex=-1,e.roomSelected=!1,e.currentTargetSelect=null,e.currentPVPSelect=null,e.heroSelected=!1,e.loading=null,e}return n(e,t),e.prototype.onLoad=function(){t.prototype.onLoad.call(this)},e.prototype.start=function(){t.prototype.start.call(this),y.Web3Enable&&y.nftMgr().connect().then(),this.setSingleComponents(),this.startMainBattle().then()},e.prototype.update=function(e){var o,r;t.prototype.update.call(this,e),this.battleSpeed=Date.now()<(null===(o=p.copyMgr().getMainPlayerCopySettings())||void 0===o?void 0:o.speedUpTime)?2:1,(null===(r=this.mainBattle.item)||void 0===r?void 0:r.isEnded)&&!this.battleEnded&&this.nextMainBattle()},e.prototype.setSingleComponents=function(){this.myTeamFrame=this.myTeamFrameNode.getComponent("MyTeamFrame"),this.cultivateWindow=this.cultivateWindowNode.getComponent("CultivateWindowController"),this.settlementWindow=this.settlementWindowNode.getComponent("SettlementWindowController"),this.mainBattle=this.mainBattleNode.getComponent("MainBattleDisplay"),this.pvpBattle=this.pvpBattleNode.getComponent("PVPBattleDisplay")},e.prototype.startMainBattle=function(){return a(this,void 0,void 0,function(){var t;return s(this,function(e){switch(e.label){case 0:return[4,h.battleMgr().startMainBattle()];case 1:return t=e.sent(),this.mainBattle.setItem(t),[2]}})})},e.prototype.nextMainBattle=function(){var t=this;this.battleEnded=!0,h.battleMgr().startMainBattle().then(function(e){t.mainBattle.setItem(e),t.battleEnded=!1})},e.prototype.startPVPBattle=function(t){return void 0===t&&(t=void 0),a(this,void 0,void 0,function(){var e,o;return s(this,function(r){switch(r.label){case 0:return t?[4,h.battleMgr().startPVPBattle(this.currentPVPSelect.nftId,-1,t)]:[3,2];case 1:return e=r.sent(),this.pvpBattleNode.active=!0,this.pvpBattle.setItem(e),[2];case 2:return!this.currentPVPSelect.nftId||this.currentPVPRoomIndex<0||!this.currentTargetSelect.nftId?[2]:[4,h.battleMgr().startPVPBattle(this.currentPVPSelect.nftId,this.currentPVPRoomIndex,this.currentTargetSelect.nftId)];case 3:return o=r.sent(),this.pvpBattleNode.active=!0,this.pvpBattle.setItem(o),[2]}})})},i([f.waitForLogin,d.waitForDataLoad],e.prototype,"startMainBattle",null),i([m(u)],e.prototype,"myTeamFrameNode",void 0),i([m(u)],e.prototype,"cultivateWindowNode",void 0),i([m(u)],e.prototype,"settlementWindowNode",void 0),i([m(u)],e.prototype,"mainBattleNode",void 0),i([m(u)],e.prototype,"pvpBattleNode",void 0),i([m(g)],e.prototype,"loading",void 0),i([b,c.singleton],e)}(l.BaseScene);o.default=_,cc._RF.pop()},{"../Modules/BattleModule/Managers/BattleManager":"BattleManager","../Modules/CopyModule/Managers/CopyManager":"CopyManager","../Modules/CoreModule/Managers/DataManager":"DataManager","../Modules/CoreModule/Utils/SingletonUtils":"SingletonUtils","../Modules/NFTModule/Managers/NFTManager":"NFTManager","../Modules/PlayerModule/Managers/PlayerManager":"PlayerManager","./BaseScene":"BaseScene"}],BattlerDisplay:[function(t,e,o){"use strict";cc._RF.push(e,"4acb26RWmBIrK496BPmZf/8","BattlerDisplay");var r,n=this&&this.__extends||(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),i=this&&this.__decorate||function(t,e,o,r){var n,i=arguments.length,a=i<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,o):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,o,r);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(a=(i<3?n(a):i>3?n(e,o,a):n(e,o))||a);return i>3&&a&&Object.defineProperty(e,o,a),a};Object.defineProperty(o,"__esModule",{value:!0});var a=sp.Skeleton,s=cc.Animation,c=cc.Vec2,l=cc.Node,u=cc.Prefab,p=cc.ProgressBar,f=t("../../CoreModule/Components/ItemDisplay"),d=t("../Utils/Vec1"),h=t("./IndependentController/HitDamage"),y=t("../../../Utils/SpineUtils"),g=cc._decorator,v=g.ccclass,b=g.property,m=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.camp=0,e.index=0,e.heroScale=.2,e.skeleton=null,e.animation=null,e.hpBar=null,e.shadowNode=null,e.hit=null,e.itemList=[],e}return n(e,t),Object.defineProperty(e.prototype,"pos",{get:function(){return new c(this.node.x,this.node.y)},set:function(t){this.node.setPosition(t)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"angle",{get:function(){return new d.Vec1(this.skeletonNode.angle)},set:function(t){this.skeletonNode.angle=t.x},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"scale",{get:function(){return new c(this.skeletonNode.scaleX,this.skeletonNode.scaleY)},set:function(t){this.skeletonNode.setScale(t)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"color",{get:function(){return this.skeletonNode.color},set:function(t){this.skeletonNode.color=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"flip",{get:function(){return 1==this.camp},enumerable:!1,configurable:!0}),e.prototype.start=function(){this.oriPos=new c(this.node.x,this.node.y),this.oriAngle=new d.Vec1(this.node.angle),this.oriScale=new c(this.node.scaleX,this.node.scaleY),this.node.scaleX=this.flip?1:-1},e.prototype.refresh=function(){t.prototype.refresh.call(this),this.drawSkeleton(this.item.entity)},e.prototype.drawSkeleton=function(t){if(t.parts){var e=new l("node"),o=e.addComponent(a),r=new y.HeroSkeleton(this.skeleton,o,_.heroMgr().getCacheOneFromServer(t.nftId).heroTypeId);t.parts.forEach(function(t){r.addPart(t)}),r.refresh().then(function(){return e.destroy()})}else this.skeleton.skeletonData=t.skeleton},Object.defineProperty(e.prototype,"subjectDisplay",{get:function(){return this.battle.getDisplay(this.item.subject)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"targetDisplay",{get:function(){return this.battle.getDisplay(this.item.target)},enumerable:!1,configurable:!0}),e.prototype.update=function(){this.item&&(this.updateTranslate(),this.updateColor(),this.updateOpacity(),this.updateAnimation(),this.updateResult(),this.sizeFilter(),this.updateHp(),this.updateItemList())},e.prototype.updateTranslate=function(){this.scale=this.item.scale,this.angle=this.item.angle;var t=this.convertPosition(this.item.startPos),e=this.convertPosition(this.item.targetPos),o=new c;c.lerp(o,t,e,this.item.posRate.x),o.y+=this.item.z,o.x+=this.item.shakePos.x,o.y+=this.item.shakePos.y,this.pos=o},e.prototype.convertPosition=function(t){var e=t.offset.clone();return this.flip&&(e.x=-e.x),"self"==t.origin?this.oriPos.clone().add(e):"target"==t.origin&&this.targetDisplay?this.targetDisplay.oriPos.clone().add(e):t.offset},e.prototype.updateColor=function(){this.color=this.item.color},e.prototype.updateOpacity=function(){this.skeletonNode.opacity=this.item.opacity,this.shadowNode.opacity=this.item.opacity,this.hpBar&&(this.hpBar.node.opacity=this.item.opacity)},e.prototype.updateAnimation=function(){switch(this.item.state){case P.BattlerState.Idle:if("stand"==this.skeleton.animation)return;return void this.setAnimation("stand",!0);case P.BattlerState.Dead:this.setAnimation(null,!1)}this.updateNormalAnimation();var t=this.item.animation;t&&this.setAnimation(t)},e.prototype.updateNormalAnimation=function(){var t=this,e=this.item.normalAnimationTimes;this.item.normalAnimations.forEach(function(o,r){return t.battle.playNormalAnimation(o,e[r],t.node.x+t.skeletonNode.x,t.node.y+t.skeletonNode.y+t.skeletonNode.height*t.heroScale/2)})},e.prototype.setAnimation=function(t,e){void 0===e&&(e=!1),this.skeleton.clearTracks(),t&&this.skeleton.setAnimation(0,t,e)},e.prototype.updateResult=function(){var t=this.item.result;t&&t.hpDamage>=0&&this.showDamage(t)},e.prototype.showDamage=function(t){var e=cc.instantiate(this.hit);e.parent=this.node.parent;var o=e.getComponent(h.default);o.setValue(t.hpDamage),t.isCritical&&o.setType(h.HitType.Critical),t.isMiss&&o.setType(h.HitType.Miss),o.setPosition(this.node.x+this.skeletonNode.x,this.node.y+this.skeletonNode.y+this.skeletonNode.height*this.heroScale)},e.prototype.sizeFilter=function(){this.skeleton.node.scaleX=this.heroScale,this.skeleton.node.scaleY=this.heroScale,this.skeleton.node.y=-this.skeleton.node.height*this.heroScale/3,this.shadowNode&&(this.shadowNode.active=!0,this.shadowNode.y=-this.skeleton.node.height*this.heroScale/3,this.shadowNode.scale=this.skeleton.node.height*this.heroScale/this.shadowNode.width/2)},e.prototype.updateHp=function(){this.hpBar&&(this.skeleton.skeletonData?(this.hpBar.node.y=20+this.skeletonNode.height/2*this.skeletonNode.scaleY,this.hpBar.node.active=!0,this.hpBar.node.scaleX=this.flip?1:-1,this.hpBar.progress=cc.misc.lerp(this.hpBar.progress,this.item.hp/this.item.mhp,.1)):this.hpBar.node.active=!1)},e.prototype.updateItemList=function(){this.item.isDead&&(this.itemList.shift(),this.itemList[0]&&this.setItem(this.itemList[0]))},e.prototype.addItem=function(t){this.node.active=!0,this.itemList.push(t),1==this.itemList.length&&this.setItem(t)},e.prototype.clearItems=function(){this.itemList=[],this.node.active=!1},i([b],e.prototype,"camp",void 0),i([b],e.prototype,"index",void 0),i([b],e.prototype,"heroScale",void 0),i([b(l)],e.prototype,"skeletonNode",void 0),i([b(a)],e.prototype,"skeleton",void 0),i([b(s)],e.prototype,"animation",void 0),i([b(p)],e.prototype,"hpBar",void 0),i([b(l)],e.prototype,"shadowNode",void 0),i([b(u)],e.prototype,"hit",void 0),i([v],e)}(f.ItemDisplay);o.default=m;var _=t("../../HeroModule/Managers/HeroManager"),P=t("../Data/Battler");cc._RF.pop()},{"../../../Utils/SpineUtils":"SpineUtils","../../CoreModule/Components/ItemDisplay":"ItemDisplay","../../HeroModule/Managers/HeroManager":"HeroManager","../Data/Battler":"Battler","../Utils/Vec1":"Vec1","./IndependentController/HitDamage":"HitDamage"}],Battler:[function(t,e,o){"use strict";cc._RF.push(e,"f9841PZ4ltEGqDXLjfaCNHT","Battler");var r,n=this&&this.__extends||(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),i=this&&this.__decorate||function(t,e,o,r){var n,i=arguments.length,a=i<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,o):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,o,r);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(a=(i<3?n(a):i>3?n(e,o,a):n(e,o))||a);return i>3&&a&&Object.defineProperty(e,o,a),a};Object.defineProperty(o,"__esModule",{value:!0}),o.Battler=o.SkillInfo=o.BattlerState=o.BonusParamType=void 0;var a,s,c=t("../../CoreModule/Data/BaseData"),l=cc.Vec2,u=cc.Color,p=t("../../../Utils/MathUtils"),f=t("../Utils/MotionProcessor"),d=t("../Utils/Vec1"),h=t("../../HeroModule/Data/Skill"),y=t("./MotionGroup"),g=t("../../CopyModule/Data/Enemy");(function(t){t[t.ATK=1]="ATK",t[t.DEF=2]="DEF",t[t.Gold=3]="Gold",t[t.AVO=4]="AVO"})(a=o.BonusParamType||(o.BonusParamType={})),function(t){t[t.Hidden=0]="Hidden",t[t.Entering=1]="Entering",t[t.Idle=2]="Idle",t[t.Acting=3]="Acting",t[t.Frozen=4]="Frozen",t[t.Dying=5]="Dying",t[t.Dead=6]="Dead"}(s=o.BattlerState||(o.BattlerState={}));var v=function(t){function e(e,o){var r=t.call(this,e)||this;return r.level=1,r.skillId=-1,r.useCount=0,r.boostCount=0,r.lastTime=-1,r.battler=o,r}return n(e,t),Object.defineProperty(e.prototype,"skill",{get:function(){return h.skillRepo().getById(this.skillId)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"boostCost",{get:function(){return this.skill.boostCost},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"freezeTime",{get:function(){return this.skill.freezeTime},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"frozenTime",{get:function(){return this.battler.elapsedTime-this.lastTime},enumerable:!1,configurable:!0}),e.prototype.effects=function(){var t=this;return this.skill.effects.map(function(e){return e.applyLevel(t.level)})},e.prototype.traits=function(){var t=this;return this.skill.traits.map(function(e){return e.applyLevel(t.level)})},e.prototype.boostConditions=function(){return P.ConditionGroup.create(P.cGte(P.ConditionType.Gold,this.boostCost))},Object.defineProperty(e.prototype,"isUsable",{get:function(){return this.skill.freezeTime<=0||this.frozenTime/this.freezeTime>=1},enumerable:!1,configurable:!0}),e.prototype.boost=function(){this.boostCount++,this.lastTime=0},e.prototype.use=function(){return!!this.isUsable&&(this.lastTime=Date.now(),this.useCount++,!0)},e.testData=function(t){var o=new e;return o.skillId=t.id,o.level=1,o},i([c.field],e.prototype,"level",void 0),i([c.field],e.prototype,"skillId",void 0),i([c.field],e.prototype,"useCount",void 0),i([c.field],e.prototype,"boostCount",void 0),i([c.field],e.prototype,"lastTime",void 0),e}(c.BaseData);o.SkillInfo=v;var b=function(t){function e(e,o){var r=t.call(this,e)||this;return r.camp=0,r.pos=0,r.hp=0,r.params=[],r.bonusParams=[],r.skills=[],r.state=s.Hidden,r.startPos={origin:"self",offset:l.ZERO},r.targetPos={origin:"self",offset:l.ZERO},r.posRate=d.Vec1.ONE,r.shakePos=l.ZERO,r.z=0,r.scale=l.ONE,r.angle=d.Vec1.ZERO,r.color=u.WHITE,r.opacity=255,r._normalAnimations=[],r._normalAnimationTimes=[],r.action=null,r.motions=[],r.motionProcessors=[],r.preparingMotion=!1,r.battle=o,r}return n(e,t),Object.defineProperty(e.prototype,"animation",{get:function(){var t=this._animation;return this._animation=null,t},set:function(t){this._animation=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"normalAnimations",{get:function(){var t=this._normalAnimations;return this._normalAnimations=[],t},set:function(t){this._normalAnimations.push(t)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"normalAnimationTimes",{get:function(){var t=this._normalAnimationTimes;return this._normalAnimationTimes=[],t},set:function(t){this._normalAnimationTimes.push(t)},enumerable:!1,configurable:!0}),e.prototype.onCreated=function(){t.prototype.onCreated.call(this),this.refreshEntity()},Object.defineProperty(e.prototype,"battler",{get:function(){return this},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"opponents",{get:function(){var t;return null===(t=this.battle)||void 0===t?void 0:t.getOpponents(this)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isHero",{get:function(){return!!this.nftId},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isEnemy",{get:function(){return!!this.enemyId},enumerable:!1,configurable:!0}),e.prototype.hero=function(){return this.nftId&&m.heroMgr().getCacheOneFromServer(this.nftId)},e.prototype.enemy=function(){return this.enemyId&&g.enemyRepo().getById(this.enemyId)},e.prototype.skill=function(t){return this.skills.find(function(e){return e.skillId==t})},e.prototype.traits=function(){var t=new M.TraitGroup;return this.skills.forEach(function(e){return t.add.apply(t,e.traits())}),t},Object.defineProperty(e.prototype,"isHidden",{get:function(){return this.state==s.Hidden},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isEntering",{get:function(){return this.state==s.Entering},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isIdle",{get:function(){return this.state==s.Idle},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isActing",{get:function(){return this.state==s.Acting},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isFrozen",{get:function(){return this.state==s.Frozen},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isDying",{get:function(){return this.state==s.Dying},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isDead",{get:function(){return this.state==s.Dead},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"level",{get:function(){var t=this.entity.battleLevel;return this.isEnemy?this.enemyLevel*t:t},enumerable:!1,configurable:!0}),e.prototype.param=function(t){var e=this.params[t]||0;switch(t){case _.ParamType.ATK:e*=this.battle.campBonusParam(this.camp,a.ATK);break;case _.ParamType.DEF:e*=this.battle.campBonusParam(this.camp,a.DEF);break;case _.ParamType.AVO:e+=this.bonusParam(a.AVO)-1}return e},e.prototype.bonusParam=function(t){return(this.bonusParams[t]||1)+this.traitBonusParam(t)},e.prototype.traitBonusParam=function(t){return this.traits().filter(M.TraitType.BonusParam).sum(0,t)},Object.defineProperty(e.prototype,"cp",{get:function(){return this.param(_.ParamType.CP)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"cpb",{get:function(){return this.param(_.ParamType.CPB)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"hid",{get:function(){return this.param(_.ParamType.HID)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"pow",{get:function(){return this.param(_.ParamType.POW)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"agi",{get:function(){return this.param(_.ParamType.AGI)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"int",{get:function(){return this.param(_.ParamType.INT)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"powb",{get:function(){return this.param(_.ParamType.POWB)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"agib",{get:function(){return this.param(_.ParamType.AGIB)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"intb",{get:function(){return this.param(_.ParamType.INTB)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"atk",{get:function(){return this.param(_.ParamType.ATK)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"cri",{get:function(){return this.param(_.ParamType.CRI)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"dmg",{get:function(){return this.param(_.ParamType.DMG)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"atkb",{get:function(){return this.param(_.ParamType.ATKB)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"crib",{get:function(){return this.param(_.ParamType.CRIB)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"dmgb",{get:function(){return this.param(_.ParamType.DMGB)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"def",{get:function(){return this.param(_.ParamType.DEF)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"avo",{get:function(){return this.param(_.ParamType.AVO)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"eva",{get:function(){return this.param(_.ParamType.EVA)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"defb",{get:function(){return this.param(_.ParamType.DEFB)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"avob",{get:function(){return this.param(_.ParamType.AVOB)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"evab",{get:function(){return this.param(_.ParamType.EVAB)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"mhp",{get:function(){return this.param(_.ParamType.MHP)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"spd",{get:function(){return this.param(_.ParamType.SPD)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"hit",{get:function(){return this.param(_.ParamType.HIT)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"mhpb",{get:function(){return this.param(_.ParamType.MHPB)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"spdb",{get:function(){return this.param(_.ParamType.SPDB)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"hitb",{get:function(){return this.param(_.ParamType.HITB)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"ab1",{get:function(){return this.param(_.ParamType.AB1)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"ab2",{get:function(){return this.param(_.ParamType.AB2)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"ab3",{get:function(){return this.param(_.ParamType.AB3)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"ab4",{get:function(){return this.param(_.ParamType.AB4)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"bp",{get:function(){return this.param(_.ParamType.BP)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"bpb",{get:function(){return this.param(_.ParamType.BPB)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isHPDead",{get:function(){return this.hp<=0},enumerable:!1,configurable:!0}),e.prototype.addHP=function(t){this.hp+=t,this.refreshHp()},e.prototype.resetHp=function(){this.hp=this.mhp},e.prototype.judgeDie=function(){this.isDead||this.isDying||!this.isHPDead||this.die()},e.prototype.die=function(){this.addMotion(y.DieMotionGroupId,this.onDie.bind(this),this.onDead.bind(this))},e.prototype.onDie=function(){this.state=s.Dying},e.prototype.onDead=function(){this.state=s.Dead,this.battle.enterNextBattler(this)},e.prototype.enter=function(){this.isHidden&&(this.state=s.Entering)},e.prototype.onEntered=function(){this.state=s.Idle},e.prototype.updateEntering=function(){this.isEntering&&!this.motion&&this.addMotion(this.isEnemy&&this.enemy().type==g.EnemyType.Boss?y.BossEnterMotionGroupId:y.EnterMotionGroupId,null,this.onEntered.bind(this))},Object.defineProperty(e.prototype,"subject",{get:function(){var t;return null===(t=this.action)||void 0===t?void 0:t.subject.battler},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"target",{get:function(){var t;return null===(t=this.action)||void 0===t?void 0:t.target.battler},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isSubject",{get:function(){return this==this.subject},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isTarget",{get:function(){return this==this.target},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"canInvokeAction",{get:function(){return this.isIdle},enumerable:!1,configurable:!0}),e.prototype.inputAction=function(t,e,o){return t||(t=this.generateTarget()),e||(e=this.generateSkill()),this.battle.addAction(this,t,e,o)},e.prototype.generateTarget=function(){return p.MathUtils.randomPick(this.opponents)},e.prototype.generateSkill=function(){for(var t=0,e=this.skills;t<e.length;t++){var o=e[t];if(o.isUsable)return o}return this.skills[this.skills.length-1]},e.prototype.invokeAction=function(t){if(this.canInvokeAction){this.action=t,t.apply();var e=t.skill;if(e.subjectMotionId==h.PartAttackId){if(this.isHero){var o=this.entity.weaponPart,r=o?o.attackMotionId:y.AttackMotionGroupId;this.addMotion(r,this.onActionStart.bind(this),this.onActionEnd.bind(this),t)}this.isEnemy&&this.addMotion(this.enemy().attackMotionId,this.onActionStart.bind(this),this.onActionEnd.bind(this),t)}else this.addMotion(e.subjectMotionId,this.onActionStart.bind(this),this.onActionEnd.bind(this),t)}},e.prototype.onActionStart=function(){this.state=s.Acting},e.prototype.onActionEnd=function(){this.state=s.Idle,this.action=null},Object.defineProperty(e.prototype,"result",{get:function(){var t=this._result;return this._result=null,t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"canApplyResult",{get:function(){return this.isIdle},enumerable:!1,configurable:!0}),e.prototype.processResult=function(t){this.addHP(-t.hpDamage),this.addHP(t.hpRecover),this.addHP(-t.hpDrain),t.action.subjectBattler.addHP(t.hpDrain),this.refresh()},e.prototype.applyResult=function(t){!this.canApplyResult||t.result.isMiss?this.showResult(t.result):this.addMotion(t.skill.targetMotionId,this.onResultApply.bind(this),this.onResultEnd.bind(this),t,!0)},e.prototype.showResult=function(t){this.processResult(this._result=t),this.judgeDie()},e.prototype.onResultApply=function(){this.state=s.Frozen},e.prototype.onResultEnd=function(){this.state=s.Idle},Object.defineProperty(e.prototype,"motion",{get:function(){return this.motions[0]},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"curMotion",{get:function(){var t;return(null===(t=this.motion)||void 0===t?void 0:t.played)?null:this.motion},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"elapsedTime",{get:function(){return this.battle.elapsedTime},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isMotionsFinished",{get:function(){return!this.preparingMotion&&!this.motion},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isCurMotionFinished",{get:function(){return this.elapsedTime>=this.motionEndTime},enumerable:!1,configurable:!0}),e.prototype.addMotion=function(t,e,o,r,n){return void 0===n&&(n=!1),this.motions.push({motion:y.motionGroupRepo().getById(t),onStart:e,onFinish:o,action:r,isResult:n})},e.prototype.playMotion=function(t){var e=this;this.motionProcessors=t.motion.motions.map(function(o){return f.createProcessor(e,o,t.action,t.isResult)}),this.scheduleMotions(),this.onMotionStart(t)},e.prototype.scheduleMotions=function(){for(var t=this.elapsedTime,e=this.elapsedTime,o=0,r=this.motionProcessors;o<r.length;o++){var n=r[o];"after"==n.motion.playType&&(t=e),n.startTime=t+n.motion.offset,e=Math.max(e,n.totalEndTime)}this.motionEndTime=e},e.prototype.updateMotions=function(){this.motion&&(this.motion.played?this.isCurMotionFinished&&this.onMotionFinish(this.motion):this.playMotion(this.motion),this.motionProcessors.forEach(function(t){return t.update()}))},e.prototype.onMotionStart=function(t){t.onStart&&t.onStart(),t.played=!0},e.prototype.onMotionFinish=function(t){t.onFinish&&t.onFinish(),this.motions.shift()},e.prototype.refresh=function(){this.refreshEntity(),this.refreshParams(),this.refreshHp()},e.prototype.refreshEntity=function(){this.isHero&&(this.entity=this.hero()),this.isEnemy&&(this.entity=this.enemy())},e.prototype.refreshParams=function(){this.params=this.entity.battleParams.slice(0),this.isEnemy&&(this.params[_.ParamType.ATK]*=this.enemyLevel,this.params[_.ParamType.MHP]*=this.enemyLevel)},e.prototype.refreshHp=function(){this.hp=p.MathUtils.clamp(this.hp,0,this.mhp)},e.prototype.update=function(){this.updateMotions(),this.updateEntering()},e.testData=function(t,o,r,n){var i=new e;i.camp=t,i.pos=o,i.nftId=r,i.enemyId=n;var a=h.skillRepo().normalAttack(),s=v.testData(a);return i.skills.push(s),s.battler=i,i.enter(),i.refreshEntity(),i.entity.battleParams=[10,125,10,5],i.refresh(),i.resetHp(),i},i([c.field(String)],e.prototype,"nftId",void 0),i([c.field(Number)],e.prototype,"enemyId",void 0),i([c.field(Number)],e.prototype,"enemyLevel",void 0),i([c.field],e.prototype,"camp",void 0),i([c.field],e.prototype,"pos",void 0),i([c.field],e.prototype,"hp",void 0),i([c.field([Number])],e.prototype,"params",void 0),i([c.field([Number])],e.prototype,"bonusParams",void 0),i([c.field([v])],e.prototype,"skills",void 0),i([c.field],e.prototype,"state",void 0),e}(c.BaseData);o.Battler=b;var m=t("../../HeroModule/Managers/HeroManager"),_=t("../../HeroModule/Data/Param"),P=t("../../PlayerModule/Data/Condition"),M=t("./Trait");cc._RF.pop()},{"../../../Utils/MathUtils":"MathUtils","../../CopyModule/Data/Enemy":"Enemy","../../CoreModule/Data/BaseData":"BaseData","../../HeroModule/Data/Param":"Param","../../HeroModule/Data/Skill":"Skill","../../HeroModule/Managers/HeroManager":"HeroManager","../../PlayerModule/Data/Condition":"Condition","../Utils/MotionProcessor":"MotionProcessor","../Utils/Vec1":"Vec1","./MotionGroup":"MotionGroup","./Trait":"Trait"}],Battle:[function(t,e,o){"use strict";cc._RF.push(e,"15337YXXARLQ7vH+1Ip/b6L","Battle");var r,n=this&&this.__extends||(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),i=this&&this.__decorate||function(t,e,o,r){var n,i=arguments.length,a=i<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,o):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,o,r);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(a=(i<3?n(a):i>3?n(e,o,a):n(e,o))||a);return i>3&&a&&Object.defineProperty(e,o,a),a},a=this&&this.__awaiter||function(t,e,o,r){return new(o||(o=Promise))(function(n,i){function a(t){try{c(r.next(t))}catch(e){i(e)}}function s(t){try{c(r.throw(t))}catch(e){i(e)}}function c(t){var e;t.done?n(t.value):(e=t.value,e instanceof o?e:new o(function(t){t(e)})).then(a,s)}c((r=r.apply(t,e||[])).next())})},s=this&&this.__generator||function(t,e){var o,r,n,i,a={label:0,sent:function(){if(1&n[0])throw n[1];return n[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(t){return function(e){return c([t,e])}}function c(i){if(o)throw new TypeError("Generator is already executing.");for(;a;)try{if(o=1,r&&(n=2&i[0]?r.return:i[0]?r.throw||((n=r.return)&&n.call(r),0):r.next)&&!(n=n.call(r,i[1])).done)return n;switch(r=0,n&&(i=[2&i[0],n.value]),i[0]){case 0:case 1:n=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,r=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(n=(n=a.trys).length>0&&n[n.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!n||i[1]>n[0]&&i[1]<n[3])){a.label=i[1];break}if(6===i[0]&&a.label<n[1]){a.label=n[1],n=i;break}if(n&&a.label<n[2]){a.label=n[2],a.ops.push(i);break}n[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(s){i=[6,s],r=0}finally{o=n=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}};Object.defineProperty(o,"__esModule",{value:!0}),o.Battle=o.BattleResult=o.MainIndex=o.EnemyCamp=o.PlayerCamp=o.BattleState=o.BattleType=void 0;var c,l,u=t("../../CoreModule/Data/BaseData"),p=t("../../PlayerModule/Data/Reward"),f=t("./Battler"),d=t("./Action"),h=t("../../CoreModule/Data/DynamicData");(function(t){t[t.Main=0]="Main",t[t.PVP=1]="PVP",t[t.Copy=2]="Copy",t[t.Boss=3]="Boss"})(c=o.BattleType||(o.BattleType={})),function(t){t[t.NotStarted=0]="NotStarted",t[t.Starting=1]="Starting",t[t.Idle=2]="Idle",t[t.Acting=3]="Acting",t[t.Ending=4]="Ending",t[t.Ended=5]="Ended"}(l=o.BattleState||(o.BattleState={})),o.PlayerCamp=0,o.EnemyCamp=1,o.MainIndex=0;var y=function(t){function e(e,o){var r=t.call(this,e)||this;return r.rewards=[],r.battle=o,r}return n(e,t),i([u.field([p.Reward])],e.prototype,"rewards",void 0),i([u.field(Number)],e.prototype,"winner",void 0),e}(u.BaseData);o.BattleResult=y;var g=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.battlers=[],e.actions=[],e.inputtingBattlers=[],e.inputIndex=0,e.elapsedTime=-1,e.actionTime=-1,e.battleAnimations=[],e.battleAnimationTimes=[],e.state=l.NotStarted,e}return n(e,t),e.prototype.getCurrentAnimations=function(){var t=this.battleAnimations;return this.battleAnimations=[],t},e.prototype.getCurrentAnimationTimes=function(){var t=this.battleAnimationTimes;return this.battleAnimationTimes=[],t},Object.defineProperty(e.prototype,"isStarting",{get:function(){return this.state==l.Starting},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isRunning",{get:function(){return this.state>=l.Starting},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isIdle",{get:function(){return this.state==l.Idle},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isActing",{get:function(){return this.state==l.Acting},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isEnding",{get:function(){return this.state==l.Ending},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isEnded",{get:function(){return this.state==l.Ended},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"inputtingBattler",{get:function(){var t;return null===(t=this.inputtingBattlers[this.inputIndex])||void 0===t?void 0:t.battler},enumerable:!1,configurable:!0}),e.prototype.start=function(){this.isRunning||(this.elapsedTime=this.actionTime=0,this.state=l.Starting)},e.prototype.terminate=function(){this.isEnded||(this.elapsedTime=this.actionTime=-1,this.state=l.Ended)},e.prototype.updateProgress=function(){this.isStarting&&this.isAllBattlersIdle()&&(this.state=l.Idle,this.nextRound())},e.prototype.onBattleEnd=function(t){this.state=l.Ending,this.winner=t,this.onBattleEndListener&&this.onBattleEndListener(t)},e.prototype.isNextRound=function(){return this.inputIndex>=this.inputtingBattlers.length},e.prototype.next=function(){if(!(this.getBattlers().length<=0)){do{this.inputIndex++}while(this.inputtingBattler&&!this.inputtingBattler.isIdle);this.isNextRound()&&(this.nextRound(),this.next())}},e.prototype.nextRound=function(t){void 0===t&&(t=1),this.setActionTime(this.actionTime+t)},e.prototype.setActionTime=function(t){this.actionTime!=t&&(this.actionTime=t,this.generateInputtingBattlers())},e.prototype.generateInputtingBattlers=function(){this.inputIndex=-1,this.inputtingBattlersGenerator?this.inputtingBattlers=this.inputtingBattlersGenerator(this):this.inputtingBattlers=[]},e.prototype.getBattlers=function(){return this.battlers.filter(function(t){return!t.isHidden&&!t.isDead})},e.prototype.getBattler=function(t){return this.battlers.find(function(e){return!e.isHidden&&!e.isDead&&e.camp==t.camp&&e.pos==t.pos})},e.prototype.getNextBattler=function(t){return this.battlers.find(function(e){return e.isHidden&&e.camp==t.camp&&e.pos==t.pos})},e.prototype.getOpponents=function(t){return this.getCampBattlers(1-t.camp)},e.prototype.getCampBattlers=function(t){return this.battlers.filter(function(e){return!e.isHidden&&!e.isDead&&e.camp==t})},e.prototype.getCampAllBattlers=function(t){return this.battlers.filter(function(e){return e.camp==t})},e.prototype.isAllBattlersIdle=function(){return this.getBattlers().every(function(t){return t.isIdle})},e.prototype.isCampDead=function(t){return this.getCampBattlers(t).every(function(t){return t.isDead})},e.prototype.campBonusParam=function(t,e){return this.getCampBattlers(t).reduce(function(t,o){return t+o.bonusParam(e)-1},1)},e.prototype.isMotionsFinished=function(){return this.battlers.every(function(t){return t.isMotionsFinished})},e.prototype.addBattler=function(t){t.battle=this,this.battlers.push(t)},e.prototype.judgeWinner=function(){return this.isCampDead(0)?1:this.isCampDead(1)?0:-1},e.prototype.updateBattlers=function(){this.battlers.forEach(function(t){return t.update()})},e.prototype.enterNextBattler=function(t){null==(t=this.getNextBattler(t))||t.enter(),this.nextRound()},Object.defineProperty(e.prototype,"action",{get:function(){return this.actions[0]},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"curAction",{get:function(){var t;return this.actionTime>=(null===(t=this.action)||void 0===t?void 0:t.time)?this.action:void 0},enumerable:!1,configurable:!0}),e.prototype.addAction=function(t,e,o,r){var n;return t instanceof d.Action?(n=t,t.index=this.actions.length,t.battle=this):((n=new d.Action(this.actions.length,this)).time=r||this.actionTime,n.setSubject(t),n.setTarget(e),n.setSkill(o),n.makeResult()),this.actions.push(n),this.actions.sort(function(t,e){return t.time-e.time}),n},e.prototype.updateActions=function(){this.curAction&&(this.isIdle&&this.invokeAction(),this.isActing&&this.isMotionsFinished()&&this.onActionEnd())},e.prototype.invokeAction=function(){var t=this.action,e=t.subject.battler;e?(e.invokeAction(t),this.onActionStart()):this.actions.shift()},e.prototype.onActionStart=function(){this.state=l.Acting,this.onActionStartListener&&this.onActionStartListener(this.action)},e.prototype.onActionEnd=function(){this.actions.shift();var t=this.judgeWinner();t>=0?this.onBattleEnd(t):(this.onActionEndListener&&this.onActionEndListener(this.action),this.state=l.Idle)},e.prototype.update=function(t){this.isEnding||this.isEnded||(this.elapsedTime+=t,this.updateProgress(),this.updateActions(),this.updateBattlers())},e.testData=function(t){return void 0===t&&(t=c.Main),a(this,void 0,void 0,function(){var o,r,n,i;return s(this,function(a){switch(a.label){case 0:return(o=new e).type=t,[4,v.heroMgr().getOneFromServer("194")];case 1:return a.sent(),[4,v.heroMgr().getOneFromServer("203")];case 2:return a.sent(),[4,v.heroMgr().getOneFromServer("195")];case 3:return a.sent(),[4,f.Battler.testData(0,0,"194")];case 4:return r=a.sent(),[4,f.Battler.testData(0,1,"203")];case 5:return n=a.sent(),[4,f.Battler.testData(1,0,"195")];case 6:return i=a.sent(),o.addBattler(r),o.addBattler(n),o.addBattler(i),r.inputAction(i,void 0,0),i.inputAction(r,void 0,0),n.inputAction(i,void 0,0),i.inputAction(n,void 0,0),i.inputAction(r,void 0,1),r.inputAction(i,void 0,1),n.inputAction(i,void 0,1),i.inputAction(n,void 0,1),[2,o]}})})},i([u.field(String),u.dataPK],e.prototype,"battleId",void 0),i([u.field(String)],e.prototype,"uuid",void 0),i([u.field(Number)],e.prototype,"type",void 0),i([u.field(Number)],e.prototype,"copyId",void 0),i([u.field(Number)],e.prototype,"level",void 0),i([u.field(Boolean)],e.prototype,"isFirst",void 0),i([u.field([f.Battler])],e.prototype,"battlers",void 0),i([u.field([d.Action])],e.prototype,"actions",void 0),i([u.field(y)],e.prototype,"result",void 0),i([u.field(Number)],e.prototype,"createdAt",void 0),i([u.field(Number)],e.prototype,"endAt",void 0),i([u.field([d.BattlerInfo])],e.prototype,"inputtingBattlers",void 0),i([u.field],e.prototype,"inputIndex",void 0),i([u.field],e.prototype,"elapsedTime",void 0),i([u.field],e.prototype,"actionTime",void 0),i([u.field],e.prototype,"battleAnimations",void 0),i([u.field],e.prototype,"battleAnimationTimes",void 0),e}(h.DynamicData);o.Battle=g;var v=t("../../HeroModule/Managers/HeroManager");cc._RF.pop()},{"../../CoreModule/Data/BaseData":"BaseData","../../CoreModule/Data/DynamicData":"DynamicData","../../HeroModule/Managers/HeroManager":"HeroManager","../../PlayerModule/Data/Reward":"Reward","./Action":"Action","./Battler":"Battler"}],BottomListHeroContainer:[function(t,e,o){"use strict";cc._RF.push(e,"b383bo0CTJC7ZNnsEzR3FJ9","BottomListHeroContainer");var r,n=this&&this.__extends||(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),i=this&&this.__decorate||function(t,e,o,r){var n,i=arguments.length,a=i<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,o):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,o,r);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(a=(i<3?n(a):i>3?n(e,o,a):n(e,o))||a);return i>3&&a&&Object.defineProperty(e,o,a),a},a=this&&this.__awaiter||function(t,e,o,r){return new(o||(o=Promise))(function(n,i){function a(t){try{c(r.next(t))}catch(e){i(e)}}function s(t){try{c(r.throw(t))}catch(e){i(e)}}function c(t){var e;t.done?n(t.value):(e=t.value,e instanceof o?e:new o(function(t){t(e)})).then(a,s)}c((r=r.apply(t,e||[])).next())})},s=this&&this.__generator||function(t,e){var o,r,n,i,a={label:0,sent:function(){if(1&n[0])throw n[1];return n[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(t){return function(e){return c([t,e])}}function c(i){if(o)throw new TypeError("Generator is already executing.");for(;a;)try{if(o=1,r&&(n=2&i[0]?r.return:i[0]?r.throw||((n=r.return)&&n.call(r),0):r.next)&&!(n=n.call(r,i[1])).done)return n;switch(r=0,n&&(i=[2&i[0],n.value]),i[0]){case 0:case 1:n=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,r=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(n=(n=a.trys).length>0&&n[n.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!n||i[1]>n[0]&&i[1]<n[3])){a.label=i[1];break}if(6===i[0]&&a.label<n[1]){a.label=n[1],n=i;break}if(n&&a.label<n[2]){a.label=n[2],a.ops.push(i);break}n[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(s){i=[6,s],r=0}finally{o=n=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}};Object.defineProperty(o,"__esModule",{value:!0});var c=t("../../../CoreModule/Components/ItemContainer"),l=t("../../../CoreModule/Managers/DataManager"),u=t("../../../PlayerModule/Managers/PlayerManager"),p=t("../../../HeroModule/Managers/HeroManager"),f=t("../../../../Scenes/BattleScene"),d=cc.Button,h=cc.Node,y=cc.Component.EventHandler,g=cc._decorator,v=g.ccclass,b=g.property,m=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.cultivateController=null,e.totalHeroes=[],e.page=0,e.heroFrame=null,e}return n(e,t),e.prototype.start=function(){this.cultivateController=f.battleScene().cultivateWindow,this.setup().then()},e.prototype.setup=function(){return a(this,void 0,void 0,function(){var t,e;return s(this,function(o){switch(o.label){case 0:return t=u.playerMgr().player.account,e=this,[4,p.heroMgr().getListFromServer()];case 1:return e.totalHeroes=o.sent().filter(function(e){return e.ownerAccount==t}),this.onPageChange(),[2]}})})},e.prototype.update=function(){this.updateNodes()},e.prototype.updateNodes=function(){var t=this.items.findIndex(function(t){return t==f.battleScene().cultivateWindow.currentHero});-1!=t?(this.heroFrame.active=!0,this.heroFrame.x=125*t-250):this.heroFrame.active=!1},e.prototype.onItemsChanged=function(){var e=this;t.prototype.onItemsChanged.call(this),this.itemsComponents.forEach(function(t,o){var r=new y;r.target=e.node,r.component="BottomListHeroContainer",r.handler="onItemClicked",r.customEventData=""+o,t.getComponent(d).clickEvents=[],t.getComponent(d).clickEvents.push(r)})},e.prototype.nextPage=function(){this.totalHeroes.length>5*(this.page+1)&&this.page++,this.onPageChange()},e.prototype.lastPage=function(){this.page>0&&this.page--,this.onPageChange()},e.prototype.onPageChange=function(){var t=this,e=this.totalHeroes.filter(function(e,o){return Math.floor(o/5)==t.page});this.setItems(e)},e.prototype.onItemClicked=function(t,e){this.cultivateController.currentHero=this.items[e],this.cultivateController.refreshHero=!0},i([l.waitForDataLoad,u.waitForLogin],e.prototype,"setup",null),i([b(h)],e.prototype,"heroFrame",void 0),i([v],e)}(c.ItemContainer);o.default=m,cc._RF.pop()},{"../../../../Scenes/BattleScene":"BattleScene","../../../CoreModule/Components/ItemContainer":"ItemContainer","../../../CoreModule/Managers/DataManager":"DataManager","../../../HeroModule/Managers/HeroManager":"HeroManager","../../../PlayerModule/Managers/PlayerManager":"PlayerManager"}],ButtonFlash:[function(t,e,o){"use strict";cc._RF.push(e,"8f727dLRSZCNb9tNLQMpERj","ButtonFlash");var r,n=this&&this.__extends||(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),i=this&&this.__decorate||function(t,e,o,r){var n,i=arguments.length,a=i<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,o):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,o,r);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(a=(i<3?n(a):i>3?n(e,o,a):n(e,o))||a);return i>3&&a&&Object.defineProperty(e,o,a),a};Object.defineProperty(o,"__esModule",{value:!0});var a=cc._decorator.requireComponent,s=cc.Button,c=cc.Sprite,l=cc.Node,u=cc._decorator,p=u.ccclass,f=(u.property,function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.button=null,e.sprite=null,e}return n(e,t),e.prototype.start=function(){var t=this;this.button=this.getComponent(s),this.sprite=this.getComponent(c),this.node.on(l.EventType.TOUCH_START,function(){return t.lightOn()}),this.node.on(l.EventType.TOUCH_CANCEL,function(){return t.lightOff()}),this.node.on(l.EventType.TOUCH_END,function(){return t.lightOff()})},e.prototype.lightOn=function(){this.sprite.dstBlendFactor=cc.macro.ONE},e.prototype.lightOff=function(){this.sprite.dstBlendFactor=cc.macro.ONE_MINUS_SRC_ALPHA},i([p,a(s),a(c)],e)}(cc.Component));o.default=f,cc._RF.pop()},{}],CanvasAdapter:[function(t,e,o){"use strict";cc._RF.push(e,"a3b487aBGdJD4K5M7nl05v5","CanvasAdapter");var r,n=this&&this.__extends||(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),i=this&&this.__decorate||function(t,e,o,r){var n,i=arguments.length,a=i<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,o):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,o,r);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(a=(i<3?n(a):i>3?n(e,o,a):n(e,o))||a);return i>3&&a&&Object.defineProperty(e,o,a),a};Object.defineProperty(o,"__esModule",{value:!0});var a=cc.Node,s=cc.Widget,c=t("../../../Modules/NFTModule/Managers/NFTManager"),l=t("../SelectorScene"),u=cc._decorator,p=u.ccclass,f=u.property,d=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.canvas=null,e.previewUI=null,e.selectUI=null,e.createUI=null,e.descriptionUI=null,e.main=null,e.fixed=null,e.windowWidth=1200,e.isDebug=!0,e.testWidth=1200,e}return n(e,t),e.prototype.start=function(){},e.prototype.update=function(){if(!l.selectorScene().editorMode){if(this.fixed.top=this.canvas.y-400,c.nftMgr().data.windowSize||!this.isDebug){if(c.nftMgr().data.windowSize[0]==this.windowWidth)return;this.windowWidth=c.nftMgr().data.windowSize[0],this.isDebug=!1}else{if(this.testWidth=window.document.documentElement.clientWidth,this.testWidth==this.windowWidth)return;this.windowWidth=Math.min(1200,this.testWidth)}this.windowWidth>=880?(this.canvas.width=this.windowWidth,this.canvas.height=this.getHeightByWidth(),this.previewUI.isAlignLeft=!0,this.previewUI.left=0,this.selectUI.top=150,this.selectUI.left=450,this.createUI.top=600,this.createUI.right=this.windowWidth-450,this.descriptionUI.top=760,this.descriptionUI.left=450,this.descriptionUI.right=30,this.descriptionUI.node.height=1200==this.windowWidth?330:570):(this.canvas.width=Math.max(450,this.windowWidth),this.canvas.height=this.getHeightByWidth(),this.previewUI.isAlignHorizontalCenter=!0,this.previewUI.horizontalCenter=0,this.selectUI.top=650,this.selectUI.left=30,this.createUI.top=1250,this.createUI.right=0,this.descriptionUI.top=1600,this.descriptionUI.left=20,this.descriptionUI.right=20,this.descriptionUI.node.height=this.windowWidth>780?330:570),this.windowWidth<450?this.canvas.scale=this.windowWidth/450:this.canvas.scale=1}},e.prototype.getHeightByWidth=function(t){return void 0===t&&(t=this.windowWidth),t>=1200?1100:t>=880?1350:t>=780?1950:2200},i([f(a)],e.prototype,"canvas",void 0),i([f(s)],e.prototype,"previewUI",void 0),i([f(s)],e.prototype,"selectUI",void 0),i([f(s)],e.prototype,"createUI",void 0),i([f(s)],e.prototype,"descriptionUI",void 0),i([f(s)],e.prototype,"main",void 0),i([f(s)],e.prototype,"fixed",void 0),i([f(Number)],e.prototype,"testWidth",void 0),i([p],e)}(cc.Component);o.default=d,cc._RF.pop()},{"../../../Modules/NFTModule/Managers/NFTManager":"NFTManager","../SelectorScene":"SelectorScene"}],ClickAnimation:[function(t,e,o){"use strict";cc._RF.push(e,"6e1bcVdDl1Mmr7C5b2Sk97s","ClickAnimation");var r,n=this&&this.__extends||(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),i=this&&this.__decorate||function(t,e,o,r){var n,i=arguments.length,a=i<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,o):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,o,r);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(a=(i<3?n(a):i>3?n(e,o,a):n(e,o))||a);return i>3&&a&&Object.defineProperty(e,o,a),a};Object.defineProperty(o,"__esModule",{value:!0});var a=cc.Prefab,s=cc.Component,c=cc.instantiate,l=cc.Vec3,u=cc._decorator,p=u.ccclass,f=u.property,d=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.clickObj=null,e.isLoad=!1,e}return n(e,t),e.prototype.update=function(){var t=this;this.isLoad||(this.node.on(cc.Node.EventType.TOUCH_END,function(e){t.click(e)}),this.node._touchListener.setSwallowTouches(!1),this.isLoad=!0)},e.prototype.click=function(t){var e=c(this.clickObj);e.parent=this.node,e.position=new l(Number(t.touch._point.x)-this.node.width/2,Number(t.touch._point.y)-this.node.height/2,0),setTimeout(function(){e.destroy()},400)},i([f(a)],e.prototype,"clickObj",void 0),i([p],e)}(s);o.default=d,cc._RF.pop()},{}],ColorAssembler:[function(t,e,o){"use strict";cc._RF.push(e,"3d52ePrxW9OgbhqQI/YnEOE","ColorAssembler");var r,n=this&&this.__extends||(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),i=this&&this.__decorate||function(t,e,o,r){var n,i=arguments.length,a=i<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,o):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,o,r);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(a=(i<3?n(a):i>3?n(e,o,a):n(e,o))||a);return i>3&&a&&Object.defineProperty(e,o,a),a};Object.defineProperty(o,"__esModule",{value:!0});var a=cc._decorator.executeInEditMode,s=cc.Color,c=cc.director,l=cc._decorator.requireComponent,u=cc.RenderComponent,p=cc.Director,f=cc._decorator,d=f.ccclass,h=f.property,y=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.colors=[null,null,null,null],e}return n(e,t),e.prototype.onEnable=function(){c.once(p.EVENT_AFTER_DRAW,this.updateColors,this)},e.prototype.onDisable=function(){c.off(p.EVENT_AFTER_DRAW,this.updateColors,this),this.node._renderFlag|=cc.RenderFlow.FLAG_COLOR},e.prototype.updateColors=function(){var t=this.getComponent(cc.RenderComponent);if(t){var e=t._assembler;if(e instanceof cc.Assembler2D){var o=e._renderData.uintVDatas[0];if(o)for(var r=this.node.color,n=e.floatsPerVert,i=0,a=e.colorOffset,s=o.length;a<s;a+=n)o[a]=(this.colors[i++]||r)._val}}},i([h([s])],e.prototype,"colors",void 0),i([d,a,l(u)],e)}(cc.Component);o.default=y,cc._RF.pop()},{}],CompositingWindowDisplay:[function(t,e,o){"use strict";cc._RF.push(e,"dcaa04jkSdL0LEFzkD0M5Ro","CompositingWindowDisplay");var r,n=this&&this.__extends||(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),i=this&&this.__decorate||function(t,e,o,r){var n,i=arguments.length,a=i<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,o):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,o,r);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(a=(i<3?n(a):i>3?n(e,o,a):n(e,o))||a);return i>3&&a&&Object.defineProperty(e,o,a),a};Object.defineProperty(o,"__esModule",{value:!0});var a=t("../HeroInfoDisplay"),s=t("../../../../PlayerModule/Managers/PlayerManager"),c=t("../../../../EconomicModule/Data/PlayerMoney"),l=cc.Label,u=t("./HeroCompositingDisplay"),p=t("../../../../../Scenes/BattleScene"),f=cc._decorator,d=f.ccclass,h=f.property,y=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.heroInfo=null,e.lastTime=null,e.mainHero=null,e.secondHero=null,e.priceValues=[],e.balanceValues=[],e.cultivateController=null,e}return n(e,t),e.prototype.start=function(){this.cultivateController=p.battleScene().cultivateWindow,this.mainHero.setItem(null),this.secondHero.setItem(null)},e.prototype.update=function(){this.updateLabels(),this.updatePictures()},e.prototype.updateLabels=function(){this.priceValues[0].string="1000",this.priceValues[1].string="1",this.balanceValues[0].string="\\L[SShop14]:"+s.playerMgr().getPlayerData(c.PlayerMoney).gold.toString(),this.balanceValues[1].string="\\L[SShop14]:"+s.playerMgr().getPlayerData(c.PlayerMoney).token.toString(),this.lastTime.string="16:22"},e.prototype.updatePictures=function(){},e.prototype.onEnable=function(){this.heroInfo.node.active=!1},e.prototype.onDisable=function(){this.mainHero.setItem(null),this.secondHero.setItem(null),this.mainHero.node.active=!1,this.secondHero.node.active=!1},e.prototype.onHeroChange=function(){this.cultivateController.refreshHero=!0},e.prototype.selectHero=function(t){return this.mainHero.item?this.secondHero.item?void 0:(this.secondHero.node.active=!0,void this.secondHero.setItem(t)):(this.mainHero.node.active=!0,void this.mainHero.setItem(t))},e.prototype.deselectMainHero=function(){this.mainHero.setItem(null),this.mainHero.node.active=!1},e.prototype.deselectSecondHero=function(){this.secondHero.setItem(null),this.secondHero.node.active=!1},e.prototype.compositingBtn=function(){this.onHeroChange()},i([h(a.default)],e.prototype,"heroInfo",void 0),i([h(l)],e.prototype,"lastTime",void 0),i([h(u.default)],e.prototype,"mainHero",void 0),i([h(u.default)],e.prototype,"secondHero",void 0),i([h(l)],e.prototype,"priceValues",void 0),i([h(l)],e.prototype,"balanceValues",void 0),i([d],e)}(cc.Component);o.default=y,cc._RF.pop()},{"../../../../../Scenes/BattleScene":"BattleScene","../../../../EconomicModule/Data/PlayerMoney":"PlayerMoney","../../../../PlayerModule/Managers/PlayerManager":"PlayerManager","../HeroInfoDisplay":"HeroInfoDisplay","./HeroCompositingDisplay":"HeroCompositingDisplay"}],ConditionProcessor:[function(t,e,o){"use strict";cc._RF.push(e,"57ebaBpi0RJ36lNDjPXe+7n","ConditionProcessor");var r,n=this&&this.__extends||(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),i=this&&this.__decorate||function(t,e,o,r){var n,i=arguments.length,a=i<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,o):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,o,r);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(a=(i<3?n(a):i>3?n(e,o,a):n(e,o))||a);return i>3&&a&&Object.defineProperty(e,o,a),a};Object.defineProperty(o,"__esModule",{value:!0}),o.ConditionProcessor=o.createProcessor=o.conditionProcessor=void 0;var a=t("../Data/Condition");function s(t){return function(e){c.processorSettings[t]=e}}o.conditionProcessor=s,o.createProcessor=function(t){return new(0,c.processorSettings[t.type])(t)};var c=function(){function t(t){this.condition=t}return Object.defineProperty(t.prototype,"value",{get:function(){return this.condition.value},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"compare",{get:function(){return this.condition.compare},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"consumable",{get:function(){return this.condition.consumable},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"errMsg",{get:function(){return this.condition.errMsg},enumerable:!1,configurable:!0}),t.prototype.judge=function(){this.preprocess();var t=this.playerValue;switch(this.compare){case"eq":return t==this.value;case"neq":return t!=this.value;case"gt":return t>this.value;case"gte":return t>=this.value;case"lt":return t<this.value;case"lte":return t<=this.value;default:return!1}},t.prototype.check=function(){this.judge()||this.throwFunc(this.errMsg)},t.prototype.consume=function(){this.consumable&&this.doConsume()},t.prototype.preprocess=function(){},t.prototype.doConsume=function(){},t.processorSettings={},t}();o.ConditionProcessor=c,function(t){function e(){return null!==t&&t.apply(this,arguments)||this}n(e,t),Object.defineProperty(e.prototype,"playerValue",{get:function(){return 0},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"throwFunc",{get:function(){return this.condition.params.throwFunc},enumerable:!1,configurable:!0}),e.prototype.judge=function(){return this.condition.params.jFunc()},e=i([s(a.ConditionType.Func)],e)}(c),cc._RF.pop()},{"../Data/Condition":"Condition"}],Condition:[function(t,e,o){"use strict";cc._RF.push(e,"e82abPndGFKIp4ckb+K7JiK","Condition");var r,n,i=this&&this.__extends||(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),a=this&&this.__decorate||function(t,e,o,r){var n,i=arguments.length,a=i<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,o):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,o,r);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(a=(i<3?n(a):i>3?n(e,o,a):n(e,o))||a);return i>3&&a&&Object.defineProperty(e,o,a),a};Object.defineProperty(o,"__esModule",{value:!0}),o.ConditionGroup=o.Condition=o.cFun=o.cLt=o.cLte=o.cGt=o.cGte=o.cNeq=o.cEq=o.DefaultThrowFunc=o.ConditionType=void 0,function(t){t.Func="func",t.Gold="gold",t.Diamond="diamond",t.Medal="medal",t.Fragment="fragment",t.Token="token",t.ReturnTime="returnTime"}(n=o.ConditionType||(o.ConditionType={})),o.DefaultThrowFunc=function(){throw"Condition not met\uff01"},o.cEq=function(t,e,o,r,n){return void 0===o&&(o=!0),void 0===r&&(r={}),c.eq(t,e,o,r,n)},o.cNeq=function(t,e,o,r,n){return void 0===o&&(o=!0),void 0===r&&(r={}),c.neq(t,e,o,r,n)},o.cGte=function(t,e,o,r,n){return void 0===o&&(o=!0),void 0===r&&(r={}),c.gte(t,e,o,r,n)},o.cGt=function(t,e,o,r,n){return void 0===o&&(o=!0),void 0===r&&(r={}),c.gt(t,e,o,r,n)},o.cLte=function(t,e,o,r,n){return void 0===o&&(o=!0),void 0===r&&(r={}),c.lte(t,e,o,r,n)},o.cLt=function(t,e,o,r,n){return void 0===o&&(o=!0),void 0===r&&(r={}),c.lt(t,e,o,r,n)},o.cFun=function(t,e,r){return void 0===e&&(e=o.DefaultThrowFunc),c.fun(t,e,r)};var s=t("../../CoreModule/Data/BaseData"),c=function(t){function e(e,o,r,i,a,s){var c=t.call(this)||this;return c.type=n.Gold,c.value=100,c.params={},c.compare="gte",c.consumable=!0,c.type=e,c.value=o,c.compare=r,c.consumable=i,c.params=a,c.errMsg=s,c}return i(e,t),e.eq=function(t,o,r,n,i){return void 0===r&&(r=!0),void 0===n&&(n={}),new e(t,o,"eq",r,n,i)},e.neq=function(t,o,r,n,i){return void 0===r&&(r=!0),void 0===n&&(n={}),new e(t,o,"neq",r,n,i)},e.gte=function(t,o,r,n,i){return void 0===r&&(r=!0),void 0===n&&(n={}),new e(t,o,"gte",r,n,i)},e.gt=function(t,o,r,n,i){return void 0===r&&(r=!0),void 0===n&&(n={}),new e(t,o,"gt",r,n,i)},e.lte=function(t,o,r,n,i){return void 0===r&&(r=!1),void 0===n&&(n={}),new e(t,o,"lte",r,n,i)},e.lt=function(t,o,r,n,i){return void 0===r&&(r=!1),void 0===n&&(n={}),new e(t,o,"lt",r,n,i)},e.fun=function(t,r,i){return void 0===r&&(r=o.DefaultThrowFunc),new e(n.Func,null,null,!1,{jFunc:t,tFunc:r},i)},a([s.field],e.prototype,"type",void 0),a([s.field],e.prototype,"value",void 0),a([s.field(Object)],e.prototype,"params",void 0),a([s.field],e.prototype,"compare",void 0),a([s.field],e.prototype,"consumable",void 0),a([s.field(String)],e.prototype,"errMsg",void 0),e}(s.BaseData);o.Condition=c;var l=t("../Utils/ConditionProcessor"),u=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.conditions=[],e}return i(e,t),e.create=function(){for(var t=[],o=0;o<arguments.length;o++)t[o]=arguments[o];var r=new e;return t.forEach(function(t){return r.add(t)}),r},e.prototype.add=function(t){var e=this;if(t instanceof c)if(t.type!=n.Func){var o=this.find(t.type);o?o.value+=t.value:this.conditions.push(t.clone())}else this.conditions.push(t.clone());else t.conditions.forEach(function(t){return e.add(t)})},e.prototype.process=function(){for(var t=this.conditions.map(function(t){return l.createProcessor(t)}),e=0,o=t;e<o.length;e++)o[e].check();for(var r=0,n=t;r<n.length;r++)n[r].consume()},e.prototype.check=function(){for(var t=0,e=this.conditions.map(function(t){return l.createProcessor(t)});t<e.length;t++)e[t].check()},e.prototype.judge=function(){return this.conditions.map(function(t){return l.createProcessor(t)}).every(function(t){return t.judge()})},e.prototype.find=function(t){return this.conditions.find(function(e){return e.type==t})},Object.defineProperty(e.prototype,"gold",{get:function(){return this.find(n.Gold)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"diamond",{get:function(){return this.find(n.Diamond)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"medal",{get:function(){return this.find(n.Medal)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"token",{get:function(){return this.find(n.Token)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"fragment",{get:function(){return this.find(n.Fragment)},enumerable:!1,configurable:!0}),a([s.field([c])],e.prototype,"conditions",void 0),e}(s.BaseData);o.ConditionGroup=u,cc._RF.pop()},{"../../CoreModule/Data/BaseData":"BaseData","../Utils/ConditionProcessor":"ConditionProcessor"}],ConfigManager:[function(t,e,o){"use strict";cc._RF.push(e,"f84e0/AXG1GAo/fFcrUlww/","ConfigManager");var r,n=this&&this.__extends||(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),i=this&&this.__decorate||function(t,e,o,r){var n,i=arguments.length,a=i<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,o):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,o,r);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(a=(i<3?n(a):i>3?n(e,o,a):n(e,o))||a);return i>3&&a&&Object.defineProperty(e,o,a),a},a=this&&this.__awaiter||function(t,e,o,r){return new(o||(o=Promise))(function(n,i){function a(t){try{c(r.next(t))}catch(e){i(e)}}function s(t){try{c(r.throw(t))}catch(e){i(e)}}function c(t){var e;t.done?n(t.value):(e=t.value,e instanceof o?e:new o(function(t){t(e)})).then(a,s)}c((r=r.apply(t,e||[])).next())})},s=this&&this.__generator||function(t,e){var o,r,n,i,a={label:0,sent:function(){if(1&n[0])throw n[1];return n[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(t){return function(e){return c([t,e])}}function c(i){if(o)throw new TypeError("Generator is already executing.");for(;a;)try{if(o=1,r&&(n=2&i[0]?r.return:i[0]?r.throw||((n=r.return)&&n.call(r),0):r.next)&&!(n=n.call(r,i[1])).done)return n;switch(r=0,n&&(i=[2&i[0],n.value]),i[0]){case 0:case 1:n=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,r=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(n=(n=a.trys).length>0&&n[n.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!n||i[1]>n[0]&&i[1]<n[3])){a.label=i[1];break}if(6===i[0]&&a.label<n[1]){a.label=n[1],n=i;break}if(n&&a.label<n[2]){a.label=n[2],a.ops.push(i);break}n[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(s){i=[6,s],r=0}finally{o=n=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}};Object.defineProperty(o,"__esModule",{value:!0}),o.ConfigManager=o.configMgr=void 0;var c=t("./BaseManager"),l=t("../Common/CoreCommon"),u=t("../Utils/DataLoader");o.configMgr=function(){return c.getManager(p)};var p=function(t){function e(){var e=t.call(this)||this;return e.configs={},e.isLoaded=!1,e._initializeData().then(),e}return n(e,t),e.prototype._initializeData=function(){return a(this,void 0,void 0,function(){var t,e,o;return s(this,function(r){switch(r.label){case 0:return this.isLoaded=!1,[4,l.CoreInterface.GetConfig()];case 1:for(e in t=r.sent(),this.configs)o=this.configs[e],this.configs[e].config=u.DataLoader.load(o.clazz,t.configs[e]);return this.isLoaded=!0,[2]}})})},e.prototype.registerConfig=function(t,e){t.configName=e,this.configs[e]={clazz:t,name:e}},e.prototype.getConfigCache=function(t){return"string"!=typeof t&&(t=t.configName),this.configs[t]},e.prototype.config=function(t){var e=this.getConfigCache(t);return e.config||(e.config=new e.clazz)},i([c.manager],e)}(c.BaseManager);o.ConfigManager=p,cc._RF.pop()},{"../Common/CoreCommon":"CoreCommon","../Utils/DataLoader":"DataLoader","./BaseManager":"BaseManager"}],CopyCommon:[function(t,e,o){"use strict";cc._RF.push(e,"cb4d0WJjQxHoITBL5RTsW12","CopyCommon");var r=this&&this.__decorate||function(t,e,o,r){var n,i=arguments.length,a=i<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,o):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,o,r);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(a=(i<3?n(a):i>3?n(e,o,a):n(e,o))||a);return i>3&&a&&Object.defineProperty(e,o,a),a};Object.defineProperty(o,"__esModule",{value:!0}),o.CopyInterface=void 0;var n=t("../CoreModule/Common/CoreCommon"),i=function(){function t(){}return t.AdjustHeroes=function(){},r([n.post("/copy/setting/adjust_heroes")],t,"AdjustHeroes",null),t}();o.CopyInterface=i,cc._RF.pop()},{"../CoreModule/Common/CoreCommon":"CoreCommon"}],CopyManager:[function(t,e,o){"use strict";cc._RF.push(e,"f94a0tO+zxMPq/ubZ3no9+L","CopyManager");var r,n=this&&this.__extends||(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),i=this&&this.__decorate||function(t,e,o,r){var n,i=arguments.length,a=i<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,o):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,o,r);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(a=(i<3?n(a):i>3?n(e,o,a):n(e,o))||a);return i>3&&a&&Object.defineProperty(e,o,a),a};Object.defineProperty(o,"__esModule",{value:!0}),o.copyMgr=void 0;var a=t("../../CoreModule/Managers/BaseManager"),s=t("../Data/PlayerCopy"),c=t("../../PlayerModule/Managers/PlayerManager");o.copyMgr=function(){return a.getManager(l)};var l=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.getMainPlayerCopy=function(){return c.playerMgr().getPlayerData(s.PlayerCopy).mainCopy()},e.prototype.getMainPlayerCopySettings=function(){var t;return null===(t=c.playerMgr().getPlayerData(s.PlayerCopy))||void 0===t?void 0:t.mainSetting()},e.prototype.getPlayerCopy=function(){return c.playerMgr().getPlayerData(s.PlayerCopy)},i([a.manager],e)}(a.BaseManager);cc._RF.pop()},{"../../CoreModule/Managers/BaseManager":"BaseManager","../../PlayerModule/Managers/PlayerManager":"PlayerManager","../Data/PlayerCopy":"PlayerCopy"}],Copy:[function(t,e,o){"use strict";cc._RF.push(e,"114fb4CuKtExryNOZbic9UK","Copy");var r,n=this&&this.__extends||(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),i=this&&this.__decorate||function(t,e,o,r){var n,i=arguments.length,a=i<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,o):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,o,r);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(a=(i<3?n(a):i>3?n(e,o,a):n(e,o))||a);return i>3&&a&&Object.defineProperty(e,o,a),a};Object.defineProperty(o,"__esModule",{value:!0}),o.CopyRepo=o.copyRepo=o.Copy=o.CopyLevel=o.CopyType=void 0;var a,s=t("../../PlayerModule/Data/Reward"),c=t("../../CoreModule/Data/BaseData"),l=t("../../PlayerModule/Data/Condition"),u=t("../../CoreModule/Data/BaseRepository"),p=t("./Enemy"),f=t("../../CoreModule/Data/StaticData"),d=t("../../CoreModule/Managers/AssetBundleManager"),h=cc.SpriteFrame;(function(t){t[t.Main=0]="Main",t[t.Copy=1]="Copy",t[t.Boss=2]="Boss"})(a=o.CopyType||(o.CopyType={}));var y=100,g=function(t){function e(e,o){var r=t.call(this,e)||this;return r.mapIdx=0,r.enemyIds=[],r.firstRewards=[],r.winRewards=[],r.loseRewards=[],r.copy=o,r}return n(e,t),Object.defineProperty(e.prototype,"displayName",{get:function(){return"\\L[CopyLevel"+this.mapIdx+"]"},enumerable:!1,configurable:!0}),e.prototype.enemies=function(){return this.enemyIds.map(function(t){return p.enemyRepo().getById(t)})},e.prototype.calcRewards=function(t,e){void 0===e&&(e=!1);var o=s.RewardGroup.create.apply(s.RewardGroup,t?this.winRewards:this.loseRewards);return t&&e&&this.firstRewards.forEach(function(t){return o.add(t)}),o},Object.defineProperty(e.prototype,"mapName",{get:function(){switch(this.copy.type){case a.Main:return"main_"+this.mapIdx;case a.Boss:return"boss_"+this.mapIdx;case a.Copy:return"copy_"+this.mapIdx}},enumerable:!1,configurable:!0}),i([c.field],e.prototype,"mapIdx",void 0),i([c.field([Number])],e.prototype,"enemyIds",void 0),i([c.field([s.Reward])],e.prototype,"firstRewards",void 0),i([c.field([s.Reward])],e.prototype,"winRewards",void 0),i([c.field([s.Reward])],e.prototype,"loseRewards",void 0),i([c.assetField(h,d.BundleName.Sprites,"battlemaps/${mapName}")],e.prototype,"mapPicture",void 0),e}(c.BaseData);o.CopyLevel=g;var v=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.type=a.Copy,e.pictureName="",e.maxRound=y,e.maxLevel=0,e.levels=[],e.difficulty=1,e.conditions=[],e}return n(e,t),e.prototype.level=function(t){return this.levels[(t+1)%this.levels.length]},i([c.field],e.prototype,"type",void 0),i([c.field],e.prototype,"pictureName",void 0),i([c.field],e.prototype,"maxRound",void 0),i([c.field],e.prototype,"maxLevel",void 0),i([c.field([g])],e.prototype,"levels",void 0),i([c.field],e.prototype,"difficulty",void 0),i([c.field([l.Condition])],e.prototype,"conditions",void 0),i([f.data("Copy")],e)}(f.StaticData);o.Copy=v,o.copyRepo=function(){return u.getRepository(b)};var b=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),Object.defineProperty(e.prototype,"clazz",{get:function(){return v},enumerable:!1,configurable:!0}),e.prototype.getByType=function(){},e.prototype.main=function(){return this.getByType(a.Main)},i([u.repository],e)}(u.BaseRepository);o.CopyRepo=b,cc._RF.pop()},{"../../CoreModule/Data/BaseData":"BaseData","../../CoreModule/Data/BaseRepository":"BaseRepository","../../CoreModule/Data/StaticData":"StaticData","../../CoreModule/Managers/AssetBundleManager":"AssetBundleManager","../../PlayerModule/Data/Condition":"Condition","../../PlayerModule/Data/Reward":"Reward","./Enemy":"Enemy"}],CoreCommon:[function(t,e,o){"use strict";cc._RF.push(e,"d4258F1xDlG9ZOKu/Ah/EdF","CoreCommon");var r=this&&this.__decorate||function(t,e,o,r){var n,i=arguments.length,a=i<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,o):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,o,r);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(a=(i<3?n(a):i>3?n(e,o,a):n(e,o))||a);return i>3&&a&&Object.defineProperty(e,o,a),a};function n(t,e){return function(o,r,n){n.value=function(o,r){throw new d.GameError(t,e,o,r)}}}function i(t,e,o,r){return void 0===o&&(o=1),void 0===r&&(r=!1),function(n,i,a){a.value=function(n){return new f.GameLoading(t,e,n,o,r)}}}function a(t,e,o,r){var n=c("post",t,e,o,r);return function(t,e,o){o.value=function(t){return h.networkMgr().request(new h.Interface(n),t)}}}function s(t,e,o,r){var n=c("get",t,e,o,r);return function(t,e,o){o.value=function(t){return h.networkMgr().request(new h.Interface(n),t)}}}function c(t,e,o,r,n){void 0===n&&(n=!0);var i={method:t,route:e};return"string"==typeof o?(i.host=e,i.route=o,i.loading=r,i.useToken=i.useEncrypt=!1):(i.loading=o,i.useToken=r,i.useEncrypt=n),void 0===i.useToken&&(i.useToken=!0),i}Object.defineProperty(o,"__esModule",{value:!0}),o.CoreInterface=o.CoreLoading=o.CoreThrow=o.get=o.post=o.loading=o.error=void 0,o.error=n,o.loading=i,o.post=a,o.get=s;var l=function(){function t(){}return t.SystemError=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e]},r([n(1e5,"\u7cfb\u7edf\u9519\u8bef")],t,"SystemError",null),t}();o.CoreThrow=l;var u=function(){function t(){}return t.Default=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e]},t.GetAsset=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e]},t.Request=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e]},t.GetData=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e]},r([i(1e5,"")],t,"Default",null),r([i(100001,"Loading assets")],t,"GetAsset",null),r([i(100002,"Waiting for response")],t,"Request",null),r([i(100003,"Loading data")],t,"GetData",null),t}();o.CoreLoading=u;var p=function(){function t(){}return t.GetData=function(){},t.GetConfig=function(){},t.UpdateToken=function(){},r([s("/core/data/get",u.GetData,!1)],t,"GetData",null),r([s("/core/config/get",u.GetData,!1)],t,"GetConfig",null),r([a("/core/token/update",!1)],t,"UpdateToken",null),t}();o.CoreInterface=p;var f=t("../Managers/LoadingManager"),d=t("../Managers/AlertManager"),h=t("../Managers/NetworkManager");cc._RF.pop()},{"../Managers/AlertManager":"AlertManager","../Managers/LoadingManager":"LoadingManager","../Managers/NetworkManager":"NetworkManager"}],CreatedWindow:[function(t,e,o){"use strict";cc._RF.push(e,"2fae7jKbNdGobeajklZGaL8","CreatedWindow");var r,n=this&&this.__extends||(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),i=this&&this.__decorate||function(t,e,o,r){var n,i=arguments.length,a=i<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,o):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,o,r);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(a=(i<3?n(a):i>3?n(e,o,a):n(e,o))||a);return i>3&&a&&Object.defineProperty(e,o,a),a};Object.defineProperty(o,"__esModule",{value:!0});var a=cc.Sprite,s=cc.Label,c=cc.Animation,l=cc.SpriteFrame,u=cc.Color,p=cc._decorator,f=p.ccclass,d=p.property,h=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.picture=null,e.light=null,e.frame=null,e.tips=null,e.sf=[],e.tipContents=["\\L[SCreate31]\\L[SCreate36]\\L[SCreate37]","\\L[SCreate31]\\L[SCreate35]\\L[SCreate37]","\\L[SCreate31]\\L[SCreate34]\\L[SCreate37]","\\L[SCreate31]\\L[SCreate33]\\L[SCreate37]","\\L[SCreate31]\\L[SCreate32]\\L[SCreate37]"],e.colors=[new u(35,229,160),new u(23,179,226),new u(160,69,246),new u(216,91,225),new u(254,189,74)],e}return n(e,t),e.prototype.setPicture=function(t){if(this.picture){var e=new Image;e.src=t;var o=this;e.onload=function(){var t=new cc.Texture2D;t.initWithElement(e),t.handleLoadedTexture(),o.picture.spriteFrame=new cc.SpriteFrame(t)}}},e.prototype.setQuality=function(t){var e=5-t;this.light.spriteFrame=this.sf[e],this.tips.string=this.tipContents[e],this.frame.node.color=this.colors[e]},e.prototype.show=function(){this.light.node.getComponent(c).play(),this.node.active=!0},e.prototype.shut=function(){this.node.active=!1},e.prototype.jump=function(){window.parent.location.href="/mynft"},i([d(a)],e.prototype,"picture",void 0),i([d(a)],e.prototype,"light",void 0),i([d(a)],e.prototype,"frame",void 0),i([d(s)],e.prototype,"tips",void 0),i([d([l])],e.prototype,"sf",void 0),i([d([String])],e.prototype,"tipContents",void 0),i([d([u])],e.prototype,"colors",void 0),i([f],e)}(cc.Component);o.default=h,cc._RF.pop()},{}],CultivateSelectionGroup:[function(t,e,o){"use strict";cc._RF.push(e,"b2723pPF9FCJJPuK+/1bYNu","CultivateSelectionGroup");var r,n=this&&this.__extends||(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),i=this&&this.__decorate||function(t,e,o,r){var n,i=arguments.length,a=i<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,o):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,o,r);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(a=(i<3?n(a):i>3?n(e,o,a):n(e,o))||a);return i>3&&a&&Object.defineProperty(e,o,a),a};Object.defineProperty(o,"__esModule",{value:!0});var a=t("../../../CoreModule/Components/SelectableGroup"),s=cc._decorator,c=s.ccclass,l=(s.property,function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),i([c],e)}(a.SelectableGroup));o.default=l,cc._RF.pop()},{"../../../CoreModule/Components/SelectableGroup":"SelectableGroup"}],CultivateSelection:[function(t,e,o){"use strict";cc._RF.push(e,"ad8bfuSTAFCxL5zbVvfvR21","CultivateSelection");var r,n=this&&this.__extends||(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),i=this&&this.__decorate||function(t,e,o,r){var n,i=arguments.length,a=i<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,o):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,o,r);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(a=(i<3?n(a):i>3?n(e,o,a):n(e,o))||a);return i>3&&a&&Object.defineProperty(e,o,a),a};Object.defineProperty(o,"__esModule",{value:!0});var a=t("../../../CoreModule/Components/SelectableObject"),s=cc.Sprite,c=cc.SpriteFrame,l=cc.Node,u=cc.Color,p=cc._decorator,f=p.ccclass,d=p.property,h=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.picture=null,e.labelNode=null,e.redPoint=null,e.pictures=[],e.controller=null,e}return n(e,t),e.prototype.start=function(){},e.prototype.update=function(){this.redPoint.active=!1},e.prototype.onDeselected=function(){this.refresh(!1)},e.prototype.onSelected=function(){this.controller.onSelectionCardChange(),this.refresh(!0)},e.prototype.refresh=function(t){this.picture.spriteFrame=this.pictures[t?1:0],this.labelNode.color=t?new u(0,0,0):new u(62,50,36),this.labelNode.scale=1+(t?.07:0)},i([d(s)],e.prototype,"picture",void 0),i([d(l)],e.prototype,"labelNode",void 0),i([d(l)],e.prototype,"redPoint",void 0),i([d([c])],e.prototype,"pictures",void 0),i([f],e)}(a.SelectableObject);o.default=h,cc._RF.pop()},{"../../../CoreModule/Components/SelectableObject":"SelectableObject"}],CultivateWindowController:[function(t,e,o){"use strict";cc._RF.push(e,"d82e9NtVvNJIq+EgwhMPzZx","CultivateWindowController");var r,n=this&&this.__extends||(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),i=this&&this.__decorate||function(t,e,o,r){var n,i=arguments.length,a=i<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,o):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,o,r);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(a=(i<3?n(a):i>3?n(e,o,a):n(e,o))||a);return i>3&&a&&Object.defineProperty(e,o,a),a};Object.defineProperty(o,"__esModule",{value:!0});var a=cc.Node,s=t("./CultivateSelection"),c=t("./CultivateSelectionGroup"),l=cc.Animation,u=cc._decorator,p=u.ccclass,f=u.property,d=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.window=null,e.selectionCards=[],e.selectionGroup=null,e.outNodes=[],e.inNodes=[],e.currentHero=null,e.refreshHero=!1,e}return n(e,t),e.prototype.start=function(){},e.prototype.initSelectionGroup=function(){var t=this;this.selectionGroup=new c.default(!1),this.selectionCards.forEach(function(e){e.selectableGroup=t.selectionGroup,e.controller=t,t.selectionGroup.addElement(e)})},e.prototype.onSelectionCardChange=function(){var t=this.selectionCards.findIndex(function(t){return t.selectableGroup.isSelected(t)});this.outNodes.forEach(function(e,o){return e.active=o==t}),this.inNodes.forEach(function(e,o){return e.active=o==t}),this.refreshHero=!0},e.prototype.open=function(t){this.selectionGroup||this.initSelectionGroup(),this.currentHero=t,this.refreshHero=!0,this.selectionGroup.select(this.selectionCards[0]),this.window.active=!0,this.getComponent(l).play()},e.prototype.quit=function(){this.window.active=!1},i([f(a)],e.prototype,"window",void 0),i([f([s.default])],e.prototype,"selectionCards",void 0),i([f([a])],e.prototype,"outNodes",void 0),i([f([a])],e.prototype,"inNodes",void 0),i([p],e)}(cc.Component);o.default=d,cc._RF.pop()},{"./CultivateSelection":"CultivateSelection","./CultivateSelectionGroup":"CultivateSelectionGroup"}],DataLoader:[function(t,e,o){"use strict";cc._RF.push(e,"fece27JtH1IeKgeqoTH8yT3","DataLoader");var r=this&&this.__awaiter||function(t,e,o,r){return new(o||(o=Promise))(function(n,i){function a(t){try{c(r.next(t))}catch(e){i(e)}}function s(t){try{c(r.throw(t))}catch(e){i(e)}}function c(t){var e;t.done?n(t.value):(e=t.value,e instanceof o?e:new o(function(t){t(e)})).then(a,s)}c((r=r.apply(t,e||[])).next())})},n=this&&this.__generator||function(t,e){var o,r,n,i,a={label:0,sent:function(){if(1&n[0])throw n[1];return n[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(t){return function(e){return c([t,e])}}function c(i){if(o)throw new TypeError("Generator is already executing.");for(;a;)try{if(o=1,r&&(n=2&i[0]?r.return:i[0]?r.throw||((n=r.return)&&n.call(r),0):r.next)&&!(n=n.call(r,i[1])).done)return n;switch(r=0,n&&(i=[2&i[0],n.value]),i[0]){case 0:case 1:n=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,r=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(n=(n=a.trys).length>0&&n[n.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!n||i[1]>n[0]&&i[1]<n[3])){a.label=i[1];break}if(6===i[0]&&a.label<n[1]){a.label=n[1],n=i;break}if(n&&a.label<n[2]){a.label=n[2],a.ops.push(i);break}n[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(s){i=[6,s],r=0}finally{o=n=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}};Object.defineProperty(o,"__esModule",{value:!0}),o.DataLoader=void 0;var i=t("../Managers/AssetBundleManager"),a=t("../Common/CoreCommon"),s=cc.JsonAsset,c=cc.js.isChildClassOf,l=t("../../../Utils/TypeUtils"),u=function(){function t(){}return t.getSetting=function(t){return l.getMetaData(t,"dataSetting",{default:new t,properties:{},assetFields:{},occasions:{},dataPK:void 0})},t.getDefault=function(t){return this.getSetting(t).default},t.getProperties=function(t){return this.getSetting(t).properties},t.getDataPK=function(t){return this.getSetting(t).dataPK},t.getAssetFields=function(t){return this.getSetting(t).assetFields},t.load=function(t,e,o,r){if(void 0===e&&(e=null),void 0===o&&(o=null),void 0===r&&(r=null),null==e)return e;var n=new t(o,r);if(e){var i=this.getProperties(t);for(var a in i)a in e&&this.loadProp(n,a,i[a],e[a])}var s=this.getAssetFields(t);for(var a in s)this.loadAsset(n,a,s[a]);return Promise.all(n.loadTasks()).then(function(){return n.isLoaded=!0}),n.onCreated(),n},t.loadFromAssetBundle=function(t,e,o){return r(this,void 0,Promise,function(){var r;return n(this,function(n){switch(n.label){case 0:return[4,i.assetMgr().loadAsset(s,t,e)];case 1:return(r=n.sent())?[2,this.loadFromJSON(r.json,o)]:[2,{}]}})})},t.loadFromJSON=function(t,e){t||console.error(t,e);var o=t?t.map(this.load.bind(this,e)):[],r={};return o.forEach(function(t){return r[t._id]=t}),r},t.loadProp=function(t,e,o,r){var n;try{var i=o.type||(null===(n=o.default)||void 0===n?void 0:n.constructor);t[e]=this.loadType(i,r,t)}catch(a){console.error(a,t,e,r,o)}},t.loadAsset=function(t,e,o){t.addLoadTask(o.type,e,o.bundleName,o.assetPath)},t.loadType=function(t,e,o,r){var n=this;if(void 0===r&&(r=null),null===e)return null;if(t instanceof Array){this.ensureType(Array,e);var i=t[0];return e.map(function(t,e){return n.loadType(i,t,o,e)})}return this.ensureType(t,e),cc.js.isChildClassOf(t,p.BaseData)?this.load(t,e,r,o):e},t.ensureType=function(t,e){if(t){var o=cc.js.isChildClassOf(t,p.BaseData);o&&e.constructor!=Object&&a.CoreThrow.SystemError("Data type error: value = "+e+"\uff0ctype = "+t),o||c(e.constructor,t)||a.CoreThrow.SystemError("Data type error: value = "+e+"\uff0ctype = "+t)}},t.convert=function(t,e){var o;if(t instanceof Function?o=t:(e=t,t instanceof p.BaseData&&(o=e.constructor)),!e)return null;var r={};if(o){var n=this.getProperties(o);for(var i in n)i in e&&this.convertProp(r,i,n[i],e[i])}else for(var a=0,s=Object.keys(e);a<s.length;a++)i=s[a],this.convertProp(r,i,null,e[i]);return r},t.convertProp=function(t,e,o,r){var n;try{var i=(null==o?void 0:o.type)||(null===(n=null==o?void 0:o.default)||void 0===n?void 0:n.constructor)||(null==r?void 0:r.constructor);t[e]=this.convertType(i,r)}catch(a){console.error(a,t,e,r,o)}},t.convertType=function(t,e){var o=this;return null===e?null:t instanceof Array?e.map(function(e){return o.convertType(t[0],e)}):c(t,p.BaseData)?this.convert(e):e},t}();o.DataLoader=u;var p=t("../Data/BaseData");cc._RF.pop()},{"../../../Utils/TypeUtils":"TypeUtils","../Common/CoreCommon":"CoreCommon","../Data/BaseData":"BaseData","../Managers/AssetBundleManager":"AssetBundleManager"}],DataManager:[function(t,e,o){"use strict";cc._RF.push(e,"89a44rXE9lLu6tr3KbGCjLe","DataManager");var r,n=this&&this.__extends||(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),i=this&&this.__decorate||function(t,e,o,r){var n,i=arguments.length,a=i<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,o):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,o,r);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(a=(i<3?n(a):i>3?n(e,o,a):n(e,o))||a);return i>3&&a&&Object.defineProperty(e,o,a),a},a=this&&this.__awaiter||function(t,e,o,r){return new(o||(o=Promise))(function(n,i){function a(t){try{c(r.next(t))}catch(e){i(e)}}function s(t){try{c(r.throw(t))}catch(e){i(e)}}function c(t){var e;t.done?n(t.value):(e=t.value,e instanceof o?e:new o(function(t){t(e)})).then(a,s)}c((r=r.apply(t,e||[])).next())})},s=this&&this.__generator||function(t,e){var o,r,n,i,a={label:0,sent:function(){if(1&n[0])throw n[1];return n[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(t){return function(e){return c([t,e])}}function c(i){if(o)throw new TypeError("Generator is already executing.");for(;a;)try{if(o=1,r&&(n=2&i[0]?r.return:i[0]?r.throw||((n=r.return)&&n.call(r),0):r.next)&&!(n=n.call(r,i[1])).done)return n;switch(r=0,n&&(i=[2&i[0],n.value]),i[0]){case 0:case 1:n=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,r=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(n=(n=a.trys).length>0&&n[n.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!n||i[1]>n[0]&&i[1]<n[3])){a.label=i[1];break}if(6===i[0]&&a.label<n[1]){a.label=n[1],n=i;break}if(n&&a.label<n[2]){a.label=n[2],a.ops.push(i);break}n[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(s){i=[6,s],r=0}finally{o=n=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}};Object.defineProperty(o,"__esModule",{value:!0}),o.dataMgr=o.waitForDataLoad=void 0;var c=t("../Common/CoreCommon"),l=t("./BaseManager"),u=t("../../../Utils/PromiseUtils"),p=t("../Utils/DataLoader");function f(){return l.getManager(d)}o.waitForDataLoad=function(t,e,o){var r=o.value;o.value=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return a(this,void 0,void 0,function(){return s(this,function(e){switch(e.label){case 0:return[4,u.PromiseUtils.waitFor(function(){return f().loadingProgress()>=1})];case 1:return e.sent(),[2,r.apply(this,t)]}})})}},o.dataMgr=f;var d=function(t){function e(){var e=t.call(this)||this;return e.database={},e.isLoaded=!1,e._initializeData().then(),e}return n(e,t),e.prototype._initializeData=function(){return a(this,void 0,void 0,function(){var t;return s(this,function(e){switch(e.label){case 0:return this.isLoaded=!1,[4,c.CoreInterface.GetData()];case 1:return t=e.sent(),[4,this._initializeDatabase(t.data)];case 2:return e.sent(),this.isLoaded=!0,[2]}})})},e.prototype._initializeDatabase=function(t){return a(this,void 0,void 0,function(){var e,o,r,n,i,a;return s(this,function(s){switch(s.label){case 0:for(o in e=[],this.database)e.push(o);r=0,s.label=1;case 1:return r<e.length?(n=e[r],i=this.database[n],a=i,[4,p.DataLoader.loadFromJSON(t[i.name],i.clazz)]):[3,4];case 2:a.data=s.sent(),s.label=3;case 3:return r++,[3,1];case 4:return console.log("Database: ",this.database),[2]}})})},e.prototype.registerData=function(t,e){return a(this,void 0,void 0,function(){return s(this,function(){return t.dataName=e,this.database[e]={clazz:t,name:e,data:[]},[2]})})},e.prototype.getData=function(t,e,o){return void 0===o&&(o="_id"),"_id"!=o?this.getDataList(t).find(function(t){return t[o]==e}):"string"==typeof e?this.getDataById(t,e):this.getDataByIndex(t,e)},e.prototype.getDataByIndex=function(t,e){return this.getDataList(t)[e]},e.prototype.getDataById=function(t,e){return this.getDataDict(t)[e]},e.prototype.getDataList=function(t){var e=this.getDataDict(t);return Object.values(e)},e.prototype.getDataDict=function(t){return"string"!=typeof t&&(t=this.getDataName(t)),this.database[t].data},e.prototype.getDataName=function(t){return t.dataName},e.prototype.allData=function(){var t=[];for(var e in this.database)t=t.concat(Object.values(this.database[e].data));return t},e.prototype.loadingProgress=function(){if(!this.isLoaded)return 0;var t=this.allData();return t.reduce(function(t,e){return t+(e.isLoaded?1:0)},0)/t.length},i([l.manager],e)}(l.BaseManager);cc._RF.pop()},{"../../../Utils/PromiseUtils":"PromiseUtils","../Common/CoreCommon":"CoreCommon","../Utils/DataLoader":"DataLoader","./BaseManager":"BaseManager"}],DateUtils:[function(t,e,o){"use strict";cc._RF.push(e,"dffd8QFIFpFQrPWvSp1067I","DateUtils"),Object.defineProperty(o,"__esModule",{value:!0}),o.DateUtils=void 0;var r=function(){function t(){}return t.time2DateStr=function(t){var e=new Date(t);return e.getFullYear().toString()+"/"+(e.getMonth()+1).toString().padStart(2,"0")+"/"+e.getDate().toString().padStart(2,"0")},t.time2Str=function(t){var e=new Date(t);return e.getFullYear().toString()+"/"+(e.getMonth()+1).toString().padStart(2,"0")+"/"+e.getDate().toString().padStart(2,"0")+" "+e.getHours().toString().padStart(2,"0")+":"+e.getMinutes().toString().padStart(2,"0")+":"+e.getSeconds().toString().padStart(2,"0")},t.time2StrInFile=function(t){var e=new Date(t);return""+(e.getMonth()+1).toString().padStart(2,"0")+e.getDate().toString().padStart(2,"0")+"-"+e.getHours().toString().padStart(2,"0")+e.getMinutes().toString().padStart(2,"0")+e.getSeconds().toString().padStart(2,"0")},t.sec2Str=function(t){return t<60?t.toString():Math.floor(t/60)+":"+(t%60).toString().padStart(2,"0")},t.date2DayStart=function(t){var e=new Date(t);return e.setHours(0,0,0,0),e},t.isToday=function(t){return 0==this.dayDiff(new Date,t)},t.dayDiff=function(t,e){return"number"==typeof t&&t<=0?Number.NEGATIVE_INFINITY:"number"==typeof e&&e<=0?Number.POSITIVE_INFINITY:(this.date2DayStart(t).getTime()-this.date2DayStart(e).getTime())/this.DayTime},t.DayTime=864e5,t}();o.DateUtils=r,cc._RF.pop()},{}],DecoratorUtils:[function(t,e,o){"use strict";cc._RF.push(e,"dd9c7IJg0tGuYMryPkbc1GT","DecoratorUtils"),Object.defineProperty(o,"__esModule",{value:!0}),o.cache=void 0,o.cache=function(t,e,o){var r=o.value;o.value=function(){var t=this;if(this[e+"_CACHE"])return this[e+"_CACHE"];var o=r.apply(this);return o instanceof Promise?o.then(function(o){return t[e+"_CACHE"]=o}):this[e+"_CACHE"]=o}},cc._RF.pop()},{}],DoublePicturesButton:[function(t,e,o){"use strict";cc._RF.push(e,"a79bdifcbhHCKhZo9TfkzEa","DoublePicturesButton");var r,n=this&&this.__extends||(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),i=this&&this.__decorate||function(t,e,o,r){var n,i=arguments.length,a=i<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,o):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,o,r);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(a=(i<3?n(a):i>3?n(e,o,a):n(e,o))||a);return i>3&&a&&Object.defineProperty(e,o,a),a};Object.defineProperty(o,"__esModule",{value:!0});var a=cc._decorator.requireComponent,s=cc.Button,c=cc.Sprite,l=cc.SpriteFrame,u=cc._decorator,p=u.ccclass,f=u.property,d=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.button=null,e.sprite=null,e.pictures=[null,null],e}return n(e,t),e.prototype.start=function(){this.button=this.getComponent(s),this.sprite=this.getComponent(c)},e.prototype.update=function(){this.sprite.spriteFrame=this.pictures[this.button.interactable?0:1]},i([f([l])],e.prototype,"pictures",void 0),i([p,a(s),a(c)],e)}(cc.Component);o.default=d,cc._RF.pop()},{}],DynamicData:[function(t,e,o){"use strict";cc._RF.push(e,"9052b0lO+VAB5AGj/KJhgSe","DynamicData");var r,n=this&&this.__extends||(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)});Object.defineProperty(o,"__esModule",{value:!0}),o.DynamicData=void 0;var i=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),Object.defineProperty(e.prototype,"syncAble",{get:function(){return!0},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"removeAble",{get:function(){return!1},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"dataId",{get:function(){return this[DataLoader.getDataPK(this.constructor)]},enumerable:!1,configurable:!0}),e}(t("./BaseData").GameData);o.DynamicData=i,cc._RF.pop()},{"./BaseData":"BaseData"}],EconomicCommon:[function(t,e,o){"use strict";cc._RF.push(e,"fc3b5Fu4c5NA7OFBA7wOhqI","EconomicCommon");var r=this&&this.__decorate||function(t,e,o,r){var n,i=arguments.length,a=i<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,o):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,o,r);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(a=(i<3?n(a):i>3?n(e,o,a):n(e,o))||a);return i>3&&a&&Object.defineProperty(e,o,a),a};Object.defineProperty(o,"__esModule",{value:!0}),o.EconomicInterface=o.EconomicThrow=void 0;var n=t("../../CoreModule/Common/CoreCommon"),i=function(){function t(){}return t.NotEnoughMoney=function(){},t.NotEnoughFragment=function(){},t.NotEnoughReturn=function(){},t.CanNotUnlockJob=function(){},t.JobAlreadyUnlocked=function(){},t.JobNotUnlocked=function(){},t.ReachJobMaxLevel=function(){},t.NotJobProfitTime=function(){},t.UnlockJobError=function(){},t.UpgradeJobError=function(){},t.ProfitJobError=function(){},r([n.error(400001,"\u6301\u6709\u8d27\u5e01\u4e0d\u8db3")],t,"NotEnoughMoney",null),r([n.error(400002,"\u6301\u6709\u788e\u7247\u4e0d\u8db3")],t,"NotEnoughFragment",null),r([n.error(400003,"\u56de\u57ce\u6b21\u6570\u4e0d\u8db3")],t,"NotEnoughReturn",null),r([n.error(400011,"\u65e0\u6cd5\u89e3\u9501\u6253\u5de5\u70b9")],t,"CanNotUnlockJob",null),r([n.error(400012,"\u6253\u5de5\u70b9\u5df2\u89e3\u9501")],t,"JobAlreadyUnlocked",null),r([n.error(400013,"\u6253\u5de5\u70b9\u672a\u89e3\u9501")],t,"JobNotUnlocked",null),r([n.error(400014,"\u5230\u8fbe\u6253\u5de5\u7b49\u7ea7\u4e0a\u9650")],t,"ReachJobMaxLevel",null),r([n.error(400015,"\u9886\u53d6\u65f6\u95f4\u672a\u5230")],t,"NotJobProfitTime",null),r([n.error(400016,"\u89e3\u9501\u6253\u5de5\u70b9\u5931\u8d25")],t,"UnlockJobError",null),r([n.error(400017,"\u5347\u7ea7\u6253\u5de5\u70b9\u5931\u8d25")],t,"UpgradeJobError",null),r([n.error(400018,"\u9886\u53d6\u6253\u5de5\u91d1\u5e01\u5931\u8d25")],t,"ProfitJobError",null),t}();o.EconomicThrow=i;var a=function(){function t(){}return t.UnlockJob=function(){},t.UpgradeJob=function(){},t.ProfitJob=function(){},r([n.post("/job/job/unlock")],t,"UnlockJob",null),r([n.post("/job/job/upgrade")],t,"UpgradeJob",null),r([n.post("/job/job/profit")],t,"ProfitJob",null),t}();o.EconomicInterface=a,cc._RF.pop()},{"../../CoreModule/Common/CoreCommon":"CoreCommon"}],EconomicManager:[function(t,e,o){"use strict";cc._RF.push(e,"22497zQ7u9C9baTTGHjHid+","EconomicManager");var r,n=this&&this.__extends||(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),i=this&&this.__decorate||function(t,e,o,r){var n,i=arguments.length,a=i<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,o):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,o,r);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(a=(i<3?n(a):i>3?n(e,o,a):n(e,o))||a);return i>3&&a&&Object.defineProperty(e,o,a),a},a=this&&this.__awaiter||function(t,e,o,r){return new(o||(o=Promise))(function(n,i){function a(t){try{c(r.next(t))}catch(e){i(e)}}function s(t){try{c(r.throw(t))}catch(e){i(e)}}function c(t){var e;t.done?n(t.value):(e=t.value,e instanceof o?e:new o(function(t){t(e)})).then(a,s)}c((r=r.apply(t,e||[])).next())})},s=this&&this.__generator||function(t,e){var o,r,n,i,a={label:0,sent:function(){if(1&n[0])throw n[1];return n[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(t){return function(e){return c([t,e])}}function c(i){if(o)throw new TypeError("Generator is already executing.");for(;a;)try{if(o=1,r&&(n=2&i[0]?r.return:i[0]?r.throw||((n=r.return)&&n.call(r),0):r.next)&&!(n=n.call(r,i[1])).done)return n;switch(r=0,n&&(i=[2&i[0],n.value]),i[0]){case 0:case 1:n=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,r=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(n=(n=a.trys).length>0&&n[n.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!n||i[1]>n[0]&&i[1]<n[3])){a.label=i[1];break}if(6===i[0]&&a.label<n[1]){a.label=n[1],n=i;break}if(n&&a.label<n[2]){a.label=n[2],a.ops.push(i);break}n[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(s){i=[6,s],r=0}finally{o=n=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}};Object.defineProperty(o,"__esModule",{value:!0}),o.economicMgr=void 0;var c=t("../../CoreModule/Managers/BaseManager"),l=t("../Common/EconomicCommon"),u=t("../../CoreModule/Managers/AlertManager"),p=cc._decorator;p.ccclass,p.property,o.economicMgr=function(){return c.getManager(f)};var f=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.playerJob=null,e.jobItems=[],e}return n(e,t),e.prototype.update=function(e){var o;t.prototype.update.call(this,e),(null===(o=this.playerJob)||void 0===o?void 0:o.isAutoProfit)&&this.profitAutoCheck()},e.prototype.profit=function(t){return a(this,void 0,void 0,function(){var e;return s(this,function(o){switch(o.label){case 0:return e=this.jobItems.find(function(e){return e.jobId==t}),[4,l.EconomicInterface.ProfitJob({id:e.jobId})];case 1:return o.sent(),e.profitConditions().process(),e.profitRewards().invoke(),e.profit(),[2]}})})},e.prototype.upgrade=function(t){return a(this,void 0,void 0,function(){var e;return s(this,function(o){switch(o.label){case 0:return(e=this.jobItems.find(function(e){return e.jobId==t})).curLevel<=0?[4,l.EconomicInterface.UnlockJob({id:e.jobId})]:[3,2];case 1:return o.sent(),e.unlockConditions().process(),[3,4];case 2:return[4,l.EconomicInterface.UpgradeJob({id:e.jobId})];case 3:o.sent(),e.upgradeConditions().process(),o.label=4;case 4:return e.upgrade(),[2]}})})},e.prototype.profitAutoCheck=function(){this.jobItems.forEach(function(t){t.profitConditions().judge()&&(t.profitRewards().invoke(),t.profit())})},i([u.handleError],e.prototype,"profit",null),i([u.handleError],e.prototype,"upgrade",null),i([c.manager],e)}(c.BaseManager);o.default=f,cc._RF.pop()},{"../../CoreModule/Managers/AlertManager":"AlertManager","../../CoreModule/Managers/BaseManager":"BaseManager","../Common/EconomicCommon":"EconomicCommon"}],EditorCommon:[function(t,e,o){"use strict";cc._RF.push(e,"f18f9eDpKZE6b/jGDN6+QWy","EditorCommon");var r=this&&this.__decorate||function(t,e,o,r){var n,i=arguments.length,a=i<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,o):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,o,r);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(a=(i<3?n(a):i>3?n(e,o,a):n(e,o))||a);return i>3&&a&&Object.defineProperty(e,o,a),a};Object.defineProperty(o,"__esModule",{value:!0}),o.EditorInterface=void 0;var n=t("../../CoreModule/Common/CoreCommon"),i=function(){function t(){}return t.PushConfig=function(){},t.PullConfig=function(){},t.SaveConfig=function(){},t.RecalcConfig=function(){},t.ImportParts=function(){},r([n.post("/editor/config/push",!0,!1)],t,"PushConfig",null),r([n.get("/editor/config/pull",!0,!1)],t,"PullConfig",null),r([n.post("/editor/config/save",!0,!1)],t,"SaveConfig",null),r([n.post("/editor/config/recalc",!0,!1)],t,"RecalcConfig",null),r([n.post("/editor/part/import",!0,!1)],t,"ImportParts",null),t}();o.EditorInterface=i,cc._RF.pop()},{"../../CoreModule/Common/CoreCommon":"CoreCommon"}],EditorManager:[function(t,e,o){"use strict";cc._RF.push(e,"c69b9sWE6FCabgOixgbVDxt","EditorManager");var r,n=this&&this.__extends||(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),i=this&&this.__decorate||function(t,e,o,r){var n,i=arguments.length,a=i<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,o):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,o,r);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(a=(i<3?n(a):i>3?n(e,o,a):n(e,o))||a);return i>3&&a&&Object.defineProperty(e,o,a),a},a=this&&this.__awaiter||function(t,e,o,r){return new(o||(o=Promise))(function(n,i){function a(t){try{c(r.next(t))}catch(e){i(e)}}function s(t){try{c(r.throw(t))}catch(e){i(e)}}function c(t){var e;t.done?n(t.value):(e=t.value,e instanceof o?e:new o(function(t){t(e)})).then(a,s)}c((r=r.apply(t,e||[])).next())})},s=this&&this.__generator||function(t,e){var o,r,n,i,a={label:0,sent:function(){if(1&n[0])throw n[1];return n[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(t){return function(e){return c([t,e])}}function c(i){if(o)throw new TypeError("Generator is already executing.");for(;a;)try{if(o=1,r&&(n=2&i[0]?r.return:i[0]?r.throw||((n=r.return)&&n.call(r),0):r.next)&&!(n=n.call(r,i[1])).done)return n;switch(r=0,n&&(i=[2&i[0],n.value]),i[0]){case 0:case 1:n=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,r=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(n=(n=a.trys).length>0&&n[n.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!n||i[1]>n[0]&&i[1]<n[3])){a.label=i[1];break}if(6===i[0]&&a.label<n[1]){a.label=n[1],n=i;break}if(n&&a.label<n[2]){a.label=n[2],a.ops.push(i);break}n[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(s){i=[6,s],r=0}finally{o=n=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}},c=this&&this.__spreadArrays||function(){for(var t=0,e=0,o=arguments.length;e<o;e++)t+=arguments[e].length;var r=Array(t),n=0;for(e=0;e<o;e++)for(var i=arguments[e],a=0,s=i.length;a<s;a++,n++)r[n]=i[a];return r};Object.defineProperty(o,"__esModule",{value:!0}),o.FileType=o.editorMgr=void 0;var l,u=t("../../CoreModule/Managers/BaseManager"),p=t("../../CoreModule/Managers/ConfigManager"),f=t("../Configs/PartConfig"),d=t("../Common/EditorCommon"),h=t("../../CoreModule/Managers/AlertManager"),y=t("../../CoreModule/Managers/LoadingManager"),g=t("../../../Utils/DateUtils");o.editorMgr=function(){return u.getManager(v)},function(t){t[t.DataUrl=0]="DataUrl",t[t.Text=1]="Text",t[t.Binary=2]="Binary",t[t.ArrayBuffer=3]="ArrayBuffer"}(l=o.FileType||(o.FileType={}));var v=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.changes={},e}return n(e,t),Object.defineProperty(e.prototype,"config",{get:function(){return this._config||(this._config=p.configMgr().config(f.default))},enumerable:!1,configurable:!0}),e.prototype.getMapValue=function(t,e,o,r,n){void 0===n&&(n=!1);var i=e+"-"+o,a=this.config[t][i];return null==a&&(a=r,n&&(this.config[t][i]=r)),a instanceof Array&&(a=a.slice()),a},e.prototype.setMapValue=function(t,e,o,r){var n=e+"-"+o;return this.config[t][n]=r},e.prototype.getPHtScale=function(t,e,o){var r=this.config.pHtScale[t][e][o];return void 0===r?1:r},e.prototype.getPtBptScale=function(t,e,o,r){return void 0===o&&(o=1),void 0===r&&(r=!1),this.getMapValue("ptBptScale",t,e,o,r)},e.prototype.getPtBptOffset=function(t,e,o,r){return void 0===o&&(o=[0,0]),void 0===r&&(r=!1),this.getMapValue("ptBptOffset",t,e,o,r)},e.prototype.getPtBptHidden=function(t,e,o,r){return void 0===o&&(o=[]),void 0===r&&(r=!1),this.getMapValue("ptBptHidden",t,e,o,r)},e.prototype.getClothes6Problem=function(t,e,o,r){return void 0===o&&(o=!1),void 0===r&&(r=!1),this.getMapValue("clothes6Problem",t,e,o,r)},e.prototype.setPHtScale=function(t,e,o,r){return this.config.pHtScale[t][e][o]=r},e.prototype.setPtBptScale=function(t,e,o){return this.setMapValue("ptBptScale",t,e,o)},e.prototype.setPtBptOffset=function(t,e,o){return this.setMapValue("ptBptOffset",t,e,o)},e.prototype.setPtBptHidden=function(t,e,o){return this.setMapValue("ptBptHidden",t,e,o)},e.prototype.setClothes6Problem=function(t,e,o){return this.setMapValue("clothes6Problem",t,e,o)},e.prototype.getConfig=function(t,e){switch(t){case"pHtScale":return this.getPHtScale.apply(this,e);case"ptBptScale":return this.getPtBptScale.apply(this,e);case"ptBptOffset":return this.getPtBptOffset.apply(this,e);case"ptBptHidden":return this.getPtBptHidden.apply(this,e);case"clothes6Problem":return this.getClothes6Problem.apply(this,e)}},e.prototype.setConfig=function(t,e,o){switch(t){case"pHtScale":return this.setPHtScale.apply(this,c(e,[o]));case"ptBptScale":return this.setPtBptScale.apply(this,c(e,[o]));case"ptBptOffset":return this.setPtBptOffset.apply(this,c(e,[o]));case"ptBptHidden":return this.setPtBptHidden.apply(this,c(e,[o]));case"clothes6Problem":return this.setClothes6Problem.apply(this,c(e,[o]))}},e.prototype.changePtBptScale=function(t,e,o){this.addChange("ptBptScale",[t,e],o)},e.prototype.changePtBptOffset=function(t,e,o){this.addChange("ptBptOffset",[t,e],o)},e.prototype.changePHtScale=function(t,e,o,r){this.addChange("pHtScale",[t,e,o],r)},e.prototype.changePtBptHidden=function(t,e,o){this.addChange("ptBptHidden",[t,e],o)},e.prototype.changeClothes6Problem=function(t,e,o){this.addChange("clothes6Problem",[t,e],o)},e.prototype.getKey=function(t,e){return t+"."+e.join(",")},e.prototype.getChange=function(t,e){return this.changes[this.getKey(t,e)]},e.prototype.addChange=function(t,e,o){var r;if("string"==typeof t){var n=t,i=this.getKey(n,e),a=(r=this.changes)[i]||(r[i]={key:n,path:e,val:o,ori:this.getConfig(n,e)});return this.setConfig(n,e,a.val=o),a}var s=t,c=this.getKey(s.key,s.path),l=this.changes[c];l?this.addChange(s.key,s.path,this.getMergeVal(s.key,l.val,s.val)):this.addChange(s.key,s.path,s.val)},e.prototype.getMergeVal=function(t,e,o){return o},e.prototype.resetChange=function(t,e){var o=this.getKey(t,e),r=this.changes[o];r&&this.setConfig(t,e,r.ori)},e.prototype.export=function(){console.log(this.changes);var t=JSON.stringify(this.changes);this.saveForBrowser(t,"export-"+g.DateUtils.time2StrInFile(Date.now())+".json"),this.copyToClipboard(t)},e.prototype.copyToClipboard=function(t){var e=document.createElement("input");document.body.appendChild(e),e.setAttribute("value",t),e.select(),document.execCommand("copy")&&(document.execCommand("copy"),h.alertMgr().alert("\u914d\u7f6e\u53d8\u66f4\u5df2\u4e0b\u8f7d\u5e76\u590d\u5236\u5230\u7c98\u8d34\u677f\uff01","",h.AlertDialogType.OK).then()),document.body.removeChild(e)},e.prototype.import=function(){return a(this,void 0,void 0,function(){var t,e,o,r=this;return s(this,function(n){switch(n.label){case 0:return[4,this.openLocalFile("*.json")];case 1:return t=n.sent(),[4,this.readLocalFile(t,l.Text)];case 2:return e=n.sent(),console.log("str:",e),o=JSON.parse(e),console.log("data:",o),Object.values(o).forEach(function(t){return r.addChange(t)}),[2]}})})},e.prototype.push=function(){return a(this,void 0,void 0,function(){return s(this,function(t){switch(t.label){case 0:return[4,d.EditorInterface.PushConfig({changes:this.changes})];case 1:return t.sent(),h.alertMgr().alert("\u6210\u529f\u63d0\u4ea4\u5f53\u524d\u66f4\u6539\uff01","",h.AlertDialogType.OK).then(),[2]}})})},e.prototype.pull=function(){return a(this,void 0,void 0,function(){var t,e=this;return s(this,function(o){switch(o.label){case 0:return[4,d.EditorInterface.PullConfig()];case 1:return t=o.sent(),console.log(t),Object.values(t.changes).forEach(function(t){return e.addChange(t)}),Object.assign(this.config,t.config),h.alertMgr().alert("\u6210\u529f\u62c9\u53d6\u6700\u65b0\u914d\u7f6e\uff01","",h.AlertDialogType.OK).then(),[2]}})})},e.prototype.saveForBrowser=function(t,e){if(cc.sys.isBrowser){console.log("\u6d4f\u89c8\u5668");var o=new Blob([t],{type:"application/json"}),r=document.createElement("a");r.download=e,r.innerHTML="Download File",null!=window.webkitURL?r.href=window.webkitURL.createObjectURL(o):(r.href=window.URL.createObjectURL(o),r.style.display="none",document.body.appendChild(r)),r.click()}},e.prototype.openLocalFile=function(t){var e=document.getElementById("file_input");return e||((e=document.createElement("input")).id="file_input",e.setAttribute("id","file_input"),e.setAttribute("type","file"),e.setAttribute("class","fileToUpload"),e.style.opacity="0",e.style.position="absolute",e.setAttribute("left","-999px"),document.body.appendChild(e)),t=t||".*",e.setAttribute("accept",t),new Promise(function(t){e.onchange=function(o){var r=e.files;console.log("event",o,"files",r),t(r[0])},e.click()})},e.prototype.readLocalFile=function(t,e){var o=new FileReader;return new Promise(function(r){switch(o.onload=function(){o.readyState==FileReader.DONE?r(o.result):r(null)},e){case l.DataUrl:o.readAsDataURL(t);break;case l.Text:o.readAsText(t);break;case l.Binary:o.readAsBinaryString(t);break;case l.ArrayBuffer:o.readAsArrayBuffer(t)}})},e.prototype.base64ToTexture2D=function(t,e){if(t){var o=new Image;o.onload=function(){var t=new cc.Texture2D;t.initWithElement(o),t.handleLoadedTexture(),e&&e(t)},o.onerror=function(){},void 0!==t.startsWith&&t.startsWith("data:image")?o.src=t:o.src="data:image/png;base64,"+t}else e&&e(null)},e.prototype.base64ToSpriteFrame=function(t,e){this.base64ToTexture2D(t,function(t){if(t){var o=new cc.SpriteFrame(t);e&&e(o)}else e&&e(null)})},i([y.showLoading],e.prototype,"import",null),i([u.manager],e)}(u.BaseManager);cc._RF.pop()},{"../../../Utils/DateUtils":"DateUtils","../../CoreModule/Managers/AlertManager":"AlertManager","../../CoreModule/Managers/BaseManager":"BaseManager","../../CoreModule/Managers/ConfigManager":"ConfigManager","../../CoreModule/Managers/LoadingManager":"LoadingManager","../Common/EditorCommon":"EditorCommon","../Configs/PartConfig":"PartConfig"}],Effect:[function(t,e,o){"use strict";cc._RF.push(e,"b6302mJolNKV5IRxvW8LgMb","Effect");var r,n=this&&this.__extends||(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),i=this&&this.__decorate||function(t,e,o,r){var n,i=arguments.length,a=i<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,o):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,o,r);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(a=(i<3?n(a):i>3?n(e,o,a):n(e,o))||a);return i>3&&a&&Object.defineProperty(e,o,a),a};Object.defineProperty(o,"__esModule",{value:!0}),o.Effect=o.EffectType=void 0;var a,s=t("../../CoreModule/Data/BaseData");(function(t){t.None="none",t.Apply="apply",t.AddParam="addParam"})(a=o.EffectType||(o.EffectType={}));var c=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.idx=0,e.value=0,e.method="add",e}return n(e,t),i([s.field(Number)],e.prototype,"idx",void 0),i([s.field(Number)],e.prototype,"value",void 0),i([s.field(String)],e.prototype,"method",void 0),e}(s.BaseData),l=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.percent=1,e.type=a.None,e.params=[],e.levelSettings=[],e}return n(e,t),e.create=function(t,o){var r=new e;return r.type=t,r.params=o,r},e.prototype.applyLevel=function(t){var o=this.params.slice();return this.levelSettings.forEach(function(e){switch(e.method){case"add":o[e.idx]+=e.value*t;break;case"mult":o[e.idx]*=e.value*t}}),e.create(this.type,o)},i([s.field],e.prototype,"percent",void 0),i([s.field(String)],e.prototype,"type",void 0),i([s.field([Object])],e.prototype,"params",void 0),i([s.field([c])],e.prototype,"levelSettings",void 0),e}(s.BaseData);o.Effect=l,cc._RF.pop()},{"../../CoreModule/Data/BaseData":"BaseData"}],Enemy:[function(t,e,o){"use strict";cc._RF.push(e,"6df91SBO3dHC4RN6swqHqf0","Enemy");var r,n=this&&this.__extends||(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),i=this&&this.__decorate||function(t,e,o,r){var n,i=arguments.length,a=i<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,o):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,o,r);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(a=(i<3?n(a):i>3?n(e,o,a):n(e,o))||a);return i>3&&a&&Object.defineProperty(e,o,a),a};Object.defineProperty(o,"__esModule",{value:!0}),o.EnemyRepo=o.enemyRepo=o.Enemy=o.EnemyType=void 0;var a,s=t("../../CoreModule/Data/BaseData"),c=t("../../CoreModule/Managers/AssetBundleManager"),l=sp.SkeletonData,u=t("../../CoreModule/Data/BaseRepository"),p=t("../../CoreModule/Data/StaticData"),f=t("../../BattleModule/Data/MotionGroup"),d=t("../../HeroModule/Data/Param"),h=t("../../../Utils/MathUtils"),y=t("../../HeroModule/Data/Hero");(function(t){t[t.Normal=0]="Normal",t[t.Boss=1]="Boss"})(a=o.EnemyType||(o.EnemyType={}));var g=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.type=a.Normal,e.level=1,e.name="",e.restraint=y.RestraintType.Red,e.skeletonName="",e.params={},e.score=1,e.attackMotionId=f.AttackMotionGroupId,e}return n(e,t),Object.defineProperty(e.prototype,"battleLevel",{get:function(){return this.level},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"battleParams",{get:function(){var t=this;if(!this._battleParams){var e=d.paramRepo().find();this._battleParams=[],e.forEach(function(e){var o=e.id,r=t.params[o]||e.default_;t._battleParams[o]=h.MathUtils.clamp(r,e.min,e.max)})}return this._battleParams},enumerable:!1,configurable:!0}),i([s.field],e.prototype,"type",void 0),i([s.field],e.prototype,"level",void 0),i([s.field],e.prototype,"name",void 0),i([s.field],e.prototype,"restraint",void 0),i([s.field],e.prototype,"skeletonName",void 0),i([s.field],e.prototype,"params",void 0),i([s.field],e.prototype,"score",void 0),i([s.field(Number)],e.prototype,"attackMotionId",void 0),i([s.assetField(l,c.BundleName.Sprites,"parts/${skeletonName}")],e.prototype,"skeleton",void 0),i([p.data("Enemy")],e)}(p.StaticData);o.Enemy=g,o.enemyRepo=function(){return u.getRepository(v)};var v=function(t){function e(){return t.call(this)||this}return n(e,t),Object.defineProperty(e.prototype,"clazz",{get:function(){return g},enumerable:!1,configurable:!0}),i([u.repository],e)}(u.BaseRepository);o.EnemyRepo=v,cc._RF.pop()},{"../../../Utils/MathUtils":"MathUtils","../../BattleModule/Data/MotionGroup":"MotionGroup","../../CoreModule/Data/BaseData":"BaseData","../../CoreModule/Data/BaseRepository":"BaseRepository","../../CoreModule/Data/StaticData":"StaticData","../../CoreModule/Managers/AssetBundleManager":"AssetBundleManager","../../HeroModule/Data/Hero":"Hero","../../HeroModule/Data/Param":"Param"}],EventBus:[function(t,e,o){"use strict";cc._RF.push(e,"5e3aeDdjZFEfZryPWYDpc9O","EventBus"),Object.defineProperty(o,"__esModule",{value:!0}),cc._RF.pop()},{}],GIFUtils:[function(t,e,o){"use strict";cc._RF.push(e,"f191e5GTIBPSoiTQdACzjBU","GIFUtils");var r=this&&this.__awaiter||function(t,e,o,r){return new(o||(o=Promise))(function(n,i){function a(t){try{c(r.next(t))}catch(e){i(e)}}function s(t){try{c(r.throw(t))}catch(e){i(e)}}function c(t){var e;t.done?n(t.value):(e=t.value,e instanceof o?e:new o(function(t){t(e)})).then(a,s)}c((r=r.apply(t,e||[])).next())})},n=this&&this.__generator||function(t,e){var o,r,n,i,a={label:0,sent:function(){if(1&n[0])throw n[1];return n[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(t){return function(e){return c([t,e])}}function c(i){if(o)throw new TypeError("Generator is already executing.");for(;a;)try{if(o=1,r&&(n=2&i[0]?r.return:i[0]?r.throw||((n=r.return)&&n.call(r),0):r.next)&&!(n=n.call(r,i[1])).done)return n;switch(r=0,n&&(i=[2&i[0],n.value]),i[0]){case 0:case 1:n=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,r=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(n=(n=a.trys).length>0&&n[n.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!n||i[1]>n[0]&&i[1]<n[3])){a.label=i[1];break}if(6===i[0]&&a.label<n[1]){a.label=n[1],n=i;break}if(n&&a.label<n[2]){a.label=n[2],a.ops.push(i);break}n[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(s){i=[6,s],r=0}finally{o=n=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}};Object.defineProperty(o,"__esModule",{value:!0});var i=t("./gifshot"),a=t("./PromiseUtils"),s=function(){function t(){}return t.makeGIF=function(t){return r(this,void 0,void 0,function(){var e,o,r,s;return n(this,function(n){switch(n.label){case 0:return e=this.getSelectedOptions(),o=[],t.forEach(function(t){var e=new Image;e.src=t,o.push(e)}),e.images=o,r=null,s=!1,i.createGIF(e,function(t){t.error||(r=t.image),s=!0}),[4,a.PromiseUtils.waitFor(function(){return s})];case 1:return n.sent(),[2,r]}})})},t.getSelectedOptions=function(){return{gifWidth:Number(400),gifHeight:Number(400),images:[],interval:Number(.02),frameDuration:Number(1),sampleInterval:Number(10),numWorkers:Number(2)}},t}();o.default=s,cc._RF.pop()},{"./PromiseUtils":"PromiseUtils","./gifshot":"gifshot"}],GameManager:[function(t,e,o){"use strict";cc._RF.push(e,"cfe15hgDt1FhIUg8knvl49F","GameManager");var r,n=this&&this.__extends||(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),i=this&&this.__decorate||function(t,e,o,r){var n,i=arguments.length,a=i<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,o):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,o,r);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(a=(i<3?n(a):i>3?n(e,o,a):n(e,o))||a);return i>3&&a&&Object.defineProperty(e,o,a),a},a=this&&this.__awaiter||function(t,e,o,r){return new(o||(o=Promise))(function(n,i){function a(t){try{c(r.next(t))}catch(e){i(e)}}function s(t){try{c(r.throw(t))}catch(e){i(e)}}function c(t){var e;t.done?n(t.value):(e=t.value,e instanceof o?e:new o(function(t){t(e)})).then(a,s)}c((r=r.apply(t,e||[])).next())})},s=this&&this.__generator||function(t,e){var o,r,n,i,a={label:0,sent:function(){if(1&n[0])throw n[1];return n[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(t){return function(e){return c([t,e])}}function c(i){if(o)throw new TypeError("Generator is already executing.");for(;a;)try{if(o=1,r&&(n=2&i[0]?r.return:i[0]?r.throw||((n=r.return)&&n.call(r),0):r.next)&&!(n=n.call(r,i[1])).done)return n;switch(r=0,n&&(i=[2&i[0],n.value]),i[0]){case 0:case 1:n=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,r=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(n=(n=a.trys).length>0&&n[n.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!n||i[1]>n[0]&&i[1]<n[3])){a.label=i[1];break}if(6===i[0]&&a.label<n[1]){a.label=n[1],n=i;break}if(n&&a.label<n[2]){a.label=n[2],a.ops.push(i);break}n[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(s){i=[6,s],r=0}finally{o=n=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}};Object.defineProperty(o,"__esModule",{value:!0}),o.gameMgr=void 0;var c=t("./BaseManager"),l=t("../Common/CoreCommon"),u=function(){function t(){}return t.prototype.isOutOfDate=function(){return Date.now()>this.time+t.Duration},t.prototype.isNeedUpdate=function(){return Date.now()>this.time+t.UpdateDuration},t.create=function(e){var o=new t;return o.value=e,o.time=Date.now(),o},t.invalid=function(){var e=new t;return e.time=-1e3,e.value="",e},t.Duration=18e5,t.UpdateDuration=9e5,t}();o.gameMgr=function(){return c.getManager(p)};var p=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.token=null,e.lastCheckUpdToken=0,e.needUpdateToken=!0,e}return n(e,t),e.prototype.update=function(e){t.prototype.update.call(this,e),this.checkUpdateToken()},e.prototype.getToken=function(){return this.token.value},e.prototype.setToken=function(t){this.token=u.create(t)},e.prototype.updateToken=function(){return a(this,void 0,void 0,function(){var t;return s(this,function(e){switch(e.label){case 0:return[4,l.CoreInterface.UpdateToken()];case 1:return t=e.sent(),this.setToken(t.token),[2]}})})},e.prototype.checkUpdateToken=function(){var t,e=this;this.needUpdateToken&&(null===(t=this.token)||void 0===t?void 0:t.isNeedUpdate())&&Date.now()-this.lastCheckUpdToken>5e3&&(this.lastCheckUpdToken=1e300,console.log("UpdateToken!!"),this.updateToken().finally(function(){e.lastCheckUpdToken=Date.now()}))},i([c.manager],e)}(c.BaseManager);cc._RF.pop()},{"../Common/CoreCommon":"CoreCommon","./BaseManager":"BaseManager"}],GlobalEditorCell:[function(t,e,o){"use strict";cc._RF.push(e,"15c26LK5chI/pNai3GRrdxb","GlobalEditorCell");var r,n=this&&this.__extends||(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),i=this&&this.__decorate||function(t,e,o,r){var n,i=arguments.length,a=i<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,o):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,o,r);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(a=(i<3?n(a):i>3?n(e,o,a):n(e,o))||a);return i>3&&a&&Object.defineProperty(e,o,a),a};Object.defineProperty(o,"__esModule",{value:!0});var a=t("../../../../Modules/CoreModule/Components/ItemDisplay"),s=cc.Label,c=cc.Color,l=t("../../SelectorScene"),u=t("../../../../Modules/CoreModule/Managers/ConfigManager"),p=t("../../../../Modules/HeroModule/Configs/PartConfig"),f=cc.Slider,d=cc.EditBox,h=t("../../../../Modules/HeroModule/Managers/EditorManager"),y=cc._decorator,g=y.ccclass,v=y.property,b=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.isTitle=!1,e.title=null,e.slider=null,e.value=null,e.edit=null,e.line=null,e}return n(e,t),Object.defineProperty(e.prototype,"globalEditor",{get:function(){return this.line.globalEditor},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"singleEditor",{get:function(){return l.selectorScene().singleEditor},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"partType",{get:function(){return this.globalEditor.item},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"firstHeroType",{get:function(){return this.line.item},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"scale",{get:function(){var t=this.partType.id,e=this.firstHeroType.id,o=this.item.id;return h.editorMgr().getPHtScale(t,e,o)},set:function(t){var e=this.partType.id,o=this.firstHeroType.id,r=this.item.id;h.editorMgr().changePHtScale(e,o,r,t)},enumerable:!1,configurable:!0}),e.prototype.refresh=function(){this.isTitle?this.drawTitle():this.drawValue()},e.prototype.drawTitle=function(){this.title.string=this.item.id+" "+this.item.getDisplayName()},e.prototype.drawValue=function(){var t,e,o,r=u.configMgr().config(p.default),n=this.partType.id,i=this.firstHeroType.id,a=this.item.id,s=r.pHtScale[n][i][a];this.slider.progress=(s-0)/4,this.value.string=s.toFixed(3),this.edit.string=s.toFixed(3);var l=i!=a&&!this.partType.isBody;this.slider.node.active=l,this.edit.node.active=l,this.value.node.active=!l;var f=null===(t=this.singleEditor)||void 0===t?void 0:t.part,d=null===(e=this.singleEditor)||void 0===e?void 0:e.basePart,h=null==f?void 0:f.partTypeId,y=null==f?void 0:f.heroTypeId,g=d?d.heroTypeId:null===(o=this.globalEditor.preview.item)||void 0===o?void 0:o.heroTypeId,v=n==h&&i==g&&a==y?c.GREEN:c.WHITE;this.value.node.color=this.edit.textLabel.node.color=v},e.prototype.setScale=function(t){this.scale=t,this.refresh(),this.globalEditor.preview.refresh(),this.globalEditor.partsContainer.refresh()},e.prototype.reset=function(){this.setScale(1)},e.prototype.onScaleSlide=function(){var t=this.slider.progress;this.setScale(4*t+0)},e.prototype.onEdit=function(){var t=Number(this.edit.string);isNaN(t)?this.setScale(this.scale):this.setScale(t)},i([v(Boolean)],e.prototype,"isTitle",void 0),i([v(s)],e.prototype,"title",void 0),i([v(f)],e.prototype,"slider",void 0),i([v(s)],e.prototype,"value",void 0),i([v(d)],e.prototype,"edit",void 0),i([g],e)}(a.ItemDisplay);o.default=b,cc._RF.pop()},{"../../../../Modules/CoreModule/Components/ItemDisplay":"ItemDisplay","../../../../Modules/CoreModule/Managers/ConfigManager":"ConfigManager","../../../../Modules/HeroModule/Configs/PartConfig":"PartConfig","../../../../Modules/HeroModule/Managers/EditorManager":"EditorManager","../../SelectorScene":"SelectorScene"}],GlobalEditorLine:[function(t,e,o){"use strict";cc._RF.push(e,"8c222YajsBB84+fJgy16IEn","GlobalEditorLine");var r,n=this&&this.__extends||(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),i=this&&this.__decorate||function(t,e,o,r){var n,i=arguments.length,a=i<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,o):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,o,r);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(a=(i<3?n(a):i>3?n(e,o,a):n(e,o))||a);return i>3&&a&&Object.defineProperty(e,o,a),a};Object.defineProperty(o,"__esModule",{value:!0});var a=t("../../../../Modules/CoreModule/Components/ItemDisplay"),s=cc.Label,c=cc.Node,l=cc.Boolean,u=t("./GlobalEditorCell"),p=cc.Prefab,f=t("../../../../Modules/HeroModule/Data/HeroType"),d=cc._decorator,h=d.ccclass,y=d.property,g=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.isTitle=!1,e.title=null,e.cellContainer=null,e.cells=[],e.editPrefab=null,e.titlePrefab=null,e.globalEditor=null,e.cellCreated=!1,e}return n(e,t),Object.defineProperty(e.prototype,"prefab",{get:function(){return this.isTitle?this.titlePrefab:this.editPrefab},enumerable:!1,configurable:!0}),e.prototype.onLoad=function(){},e.prototype.refresh=function(){t.prototype.refresh.call(this),this.drawTitle(),this.cellCreated?this.refreshCells():this.createCells()},e.prototype.drawTitle=function(){this.title&&this.item&&(this.title.string=this.item.id+" "+this.item.getDisplayName())},e.prototype.createCells=function(){var t=this;f.heroTypeRepo().list.forEach(function(e){return t.createCell(e)}),this.cellCreated=!0},e.prototype.refreshCells=function(){this.cells.forEach(function(t){return t.refresh()})},e.prototype.createCell=function(t){var e=cc.instantiate(this.prefab),o=e.getComponent(u.default);e.parent=this.cellContainer,o.line=this,o.isTitle=this.isTitle,o.setItem(t),this.cells.push(o)},i([y(l)],e.prototype,"isTitle",void 0),i([y(s)],e.prototype,"title",void 0),i([y(c)],e.prototype,"cellContainer",void 0),i([y([u.default])],e.prototype,"cells",void 0),i([y(p)],e.prototype,"editPrefab",void 0),i([y(p)],e.prototype,"titlePrefab",void 0),i([h],e)}(a.ItemDisplay);o.default=g,cc._RF.pop()},{"../../../../Modules/CoreModule/Components/ItemDisplay":"ItemDisplay","../../../../Modules/HeroModule/Data/HeroType":"HeroType","./GlobalEditorCell":"GlobalEditorCell"}],GlobalEditor:[function(t,e,o){"use strict";cc._RF.push(e,"c9e1fJRYYhIladXpdOD+nFZ","GlobalEditor");var r,n=this&&this.__extends||(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),i=this&&this.__decorate||function(t,e,o,r){var n,i=arguments.length,a=i<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,o):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,o,r);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(a=(i<3?n(a):i>3?n(e,o,a):n(e,o))||a);return i>3&&a&&Object.defineProperty(e,o,a),a};Object.defineProperty(o,"__esModule",{value:!0});var a=t("../../../../Modules/CoreModule/Components/ItemDisplay"),s=cc.Node,c=t("../ItemPrefabs/PreviewPictureDisplay"),l=t("../ItemContainers/PartsContainer"),u=t("../ItemContainers/PartTypeContainer"),p=t("../../../../Modules/HeroModule/Data/PartType"),f=cc.Prefab,d=t("./GlobalEditorLine"),h=t("../../../../Modules/HeroModule/Data/HeroType"),y=cc._decorator,g=y.ccclass,v=y.property,b=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.partTypeContainer=null,e.lineContainer=null,e.lines=[],e.partsContainer=null,e.preview=null,e.prefab=null,e}return n(e,t),e.prototype.onLoad=function(){this.partTypeContainer.globalEditor=this,this.partTypeContainer.setItems(p.partTypeRepo().list),this.createLines()},e.prototype.createLines=function(){var t=this;this.createLine(),h.heroTypeRepo().list.forEach(function(e){return t.createLine(e)})},e.prototype.createLine=function(t){var e=cc.instantiate(this.prefab),o=e.getComponent(d.default);e.parent=this.lineContainer,o.globalEditor=this,o.isTitle=!t,o.setItem(t),this.lines.push(o)},e.prototype.refresh=function(){t.prototype.refresh.call(this),this.lines.forEach(function(t){return t.refresh()})},i([v(u.default)],e.prototype,"partTypeContainer",void 0),i([v(s)],e.prototype,"lineContainer",void 0),i([v([d.default])],e.prototype,"lines",void 0),i([v(l.default)],e.prototype,"partsContainer",void 0),i([v(c.default)],e.prototype,"preview",void 0),i([v(f)],e.prototype,"prefab",void 0),i([g],e)}(a.ItemDisplay);o.default=b,cc._RF.pop()},{"../../../../Modules/CoreModule/Components/ItemDisplay":"ItemDisplay","../../../../Modules/HeroModule/Data/HeroType":"HeroType","../../../../Modules/HeroModule/Data/PartType":"PartType","../ItemContainers/PartTypeContainer":"PartTypeContainer","../ItemContainers/PartsContainer":"PartsContainer","../ItemPrefabs/PreviewPictureDisplay":"PreviewPictureDisplay","./GlobalEditorLine":"GlobalEditorLine"}],HeroCommon:[function(t,e,o){"use strict";cc._RF.push(e,"0a476rWpZxGkLEeCBmG6R90","HeroCommon");var r=this&&this.__decorate||function(t,e,o,r){var n,i=arguments.length,a=i<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,o):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,o,r);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(a=(i<3?n(a):i>3?n(e,o,a):n(e,o))||a);return i>3&&a&&Object.defineProperty(e,o,a),a};Object.defineProperty(o,"__esModule",{value:!0}),o.HeroInterface=void 0;var n=t("../../CoreModule/Common/CoreCommon"),i=function(){function t(){}return t.SyncHero=function(){},t.CreateHero=function(){},t.GetHero=function(){},t.GetHeroCount=function(){},t.GetHeroes=function(){},t.UpgradeLevel=function(){},t.BreakLevel=function(){},t.UpgradeStar=function(){},t.UpgradeStrengthen=function(){},t.RefreshAllRank=function(){},t.EmptyCache=function(){},r([n.post("/hero/hero/sync")],t,"SyncHero",null),r([n.post("/hero/hero/create")],t,"CreateHero",null),r([n.get("/hero/hero/get_one")],t,"GetHero",null),r([n.get("/hero/hero/count")],t,"GetHeroCount",null),r([n.get("/hero/hero/get_list")],t,"GetHeroes",null),r([n.post("/hero/level/upgrade")],t,"UpgradeLevel",null),r([n.post("/hero/level/break")],t,"BreakLevel",null),r([n.post("/hero/star/upgrade")],t,"UpgradeStar",null),r([n.post("/hero/strengthen/upgrade")],t,"UpgradeStrengthen",null),r([n.get("/hero/rank/refresh")],t,"RefreshAllRank",null),r([n.post("/core/data/clear_cache")],t,"EmptyCache",null),t}();o.HeroInterface=i,cc._RF.pop()},{"../../CoreModule/Common/CoreCommon":"CoreCommon"}],HeroCompositingContainer:[function(t,e,o){"use strict";cc._RF.push(e,"639e8l8ndZI8rzeGoeO6Co9","HeroCompositingContainer");var r,n=this&&this.__extends||(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),i=this&&this.__decorate||function(t,e,o,r){var n,i=arguments.length,a=i<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,o):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,o,r);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(a=(i<3?n(a):i>3?n(e,o,a):n(e,o))||a);return i>3&&a&&Object.defineProperty(e,o,a),a},a=this&&this.__awaiter||function(t,e,o,r){return new(o||(o=Promise))(function(n,i){function a(t){try{c(r.next(t))}catch(e){i(e)}}function s(t){try{c(r.throw(t))}catch(e){i(e)}}function c(t){var e;t.done?n(t.value):(e=t.value,e instanceof o?e:new o(function(t){t(e)})).then(a,s)}c((r=r.apply(t,e||[])).next())})},s=this&&this.__generator||function(t,e){var o,r,n,i,a={label:0,sent:function(){if(1&n[0])throw n[1];return n[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(t){return function(e){return c([t,e])}}function c(i){if(o)throw new TypeError("Generator is already executing.");for(;a;)try{if(o=1,r&&(n=2&i[0]?r.return:i[0]?r.throw||((n=r.return)&&n.call(r),0):r.next)&&!(n=n.call(r,i[1])).done)return n;switch(r=0,n&&(i=[2&i[0],n.value]),i[0]){case 0:case 1:n=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,r=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(n=(n=a.trys).length>0&&n[n.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!n||i[1]>n[0]&&i[1]<n[3])){a.label=i[1];break}if(6===i[0]&&a.label<n[1]){a.label=n[1],n=i;break}if(n&&a.label<n[2]){a.label=n[2],a.ops.push(i);break}n[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(s){i=[6,s],r=0}finally{o=n=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}};Object.defineProperty(o,"__esModule",{value:!0});var c=t("../../../../CoreModule/Components/ItemContainer"),l=t("../../../../CoreModule/Managers/DataManager"),u=t("../../../../PlayerModule/Managers/PlayerManager"),p=t("../../../../HeroModule/Managers/HeroManager"),f=t("../../../../CoreModule/Utils/ScrollviewFilter"),d=t("./HeroQualitySiftSelectionGroup"),h=t("./HeroQualitySiftSelection"),y=t("./CompositingWindowDisplay"),g=cc.Button,v=cc.Component.EventHandler,b=cc._decorator,m=b.ccclass,_=b.property,P=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.qualitySelections=[],e.compositing=null,e.selectionGroup=null,e.totalHeroes=[],e}return n(e,t),e.prototype.start=function(){var t=this;this.selectionGroup=new d.default(!1),this.qualitySelections.forEach(function(e){t.selectionGroup.addElement(e),e.container=t,e.selectableGroup=t.selectionGroup}),this.setup().then()},e.prototype.setup=function(){return a(this,void 0,void 0,function(){var t,e;return s(this,function(o){switch(o.label){case 0:return t=u.playerMgr().player.account,e=this,[4,p.heroMgr().getListFromServer()];case 1:return e.totalHeroes=o.sent().filter(function(e){return e.ownerAccount==t}),this.onSelectionChange(),[2]}})})},e.prototype.update=function(){var t=this;this.itemsComponents.forEach(function(e){return e.isSelected=e.item==t.compositing.mainHero.item||e.item==t.compositing.secondHero.item})},e.prototype.onItemsChanged=function(){var e=this;t.prototype.onItemsChanged.call(this);var o=[];this.itemsComponents.forEach(function(t,r){1==t.node.active&&o.push(t.node);var n=new v;n.target=e.node,n.component="HeroCompositingContainer",n.handler="onItemClicked",n.customEventData=""+r,t.getComponent(g).clickEvents=[],t.getComponent(g).clickEvents.push(n)}),f.ScrollviewFilter.filter("vertical",this.container,o,60,this.container.height,60,4)},e.prototype.onSelectionChange=function(){var t=this.selectionGroup.currentSelection().quality;-1==t?this.setItems(this.totalHeroes):this.setItems(this.totalHeroes.filter(function(e){return e.quality==t}))},e.prototype.onItemClicked=function(t,e){this.items[e]!=this.compositing.mainHero.item?this.items[e]!=this.compositing.secondHero.item?this.compositing.selectHero(this.items[e]):this.compositing.deselectSecondHero():this.compositing.deselectMainHero()},i([_([h.default])],e.prototype,"qualitySelections",void 0),i([_(y.default)],e.prototype,"compositing",void 0),i([l.waitForDataLoad,u.waitForLogin],e.prototype,"setup",null),i([m],e)}(c.ItemContainer);o.default=P,cc._RF.pop()},{"../../../../CoreModule/Components/ItemContainer":"ItemContainer","../../../../CoreModule/Managers/DataManager":"DataManager","../../../../CoreModule/Utils/ScrollviewFilter":"ScrollviewFilter","../../../../HeroModule/Managers/HeroManager":"HeroManager","../../../../PlayerModule/Managers/PlayerManager":"PlayerManager","./CompositingWindowDisplay":"CompositingWindowDisplay","./HeroQualitySiftSelection":"HeroQualitySiftSelection","./HeroQualitySiftSelectionGroup":"HeroQualitySiftSelectionGroup"}],HeroCompositingDisplay:[function(t,e,o){"use strict";cc._RF.push(e,"7d804pv+tBBMraYGASHjHqh","HeroCompositingDisplay");var r,n=this&&this.__extends||(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),i=this&&this.__decorate||function(t,e,o,r){var n,i=arguments.length,a=i<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,o):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,o,r);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(a=(i<3?n(a):i>3?n(e,o,a):n(e,o))||a);return i>3&&a&&Object.defineProperty(e,o,a),a};Object.defineProperty(o,"__esModule",{value:!0});var a=cc.Label,s=cc.Node,c=cc.Sprite,l=cc.SpriteFrame,u=t("../../../../../Scenes/BattleScene"),p=t("../../HeroWithAvatar"),f=cc._decorator,d=f.ccclass,h=f.property,y=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.nameLabel=null,e.qualitySprite=null,e.qualityPictures=[],e.moreInfoNode=null,e.levelLabel=null,e.starNodes=[],e.selectedNode=null,e.fightingNode=null,e.isSelected=!1,e}return n(e,t),e.prototype.start=function(){},e.prototype.onItemChanged=function(){this.item&&(t.prototype.onItemChanged.call(this),this.nameLabel.string=this.item.name,this.qualitySprite.spriteFrame=this.qualityPictures[this.item.quality])},e.prototype.update=function(){this.updateMoreInfo()},e.prototype.updateMoreInfo=function(){var t=this;this.moreInfoNode&&(this.levelLabel.string=this.item.level.level.toString(),this.starNodes.forEach(function(e,o){return e.active=o<t.item.star.level}),this.selectedNode.active=this.isSelected,this.fightingNode.active=null!=u.battleScene().heroesInTeam.find(function(e){return e==t.item}))},i([h(a)],e.prototype,"nameLabel",void 0),i([h(c)],e.prototype,"qualitySprite",void 0),i([h(l)],e.prototype,"qualityPictures",void 0),i([h(s)],e.prototype,"moreInfoNode",void 0),i([h(a)],e.prototype,"levelLabel",void 0),i([h([s])],e.prototype,"starNodes",void 0),i([h(s)],e.prototype,"selectedNode",void 0),i([h(s)],e.prototype,"fightingNode",void 0),i([d],e)}(p.default);o.default=y,cc._RF.pop()},{"../../../../../Scenes/BattleScene":"BattleScene","../../HeroWithAvatar":"HeroWithAvatar"}],HeroGroupContainer:[function(t,e,o){"use strict";cc._RF.push(e,"cdd54bIN3xNQavjf/ZX7xeL","HeroGroupContainer");var r,n=this&&this.__extends||(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),i=this&&this.__decorate||function(t,e,o,r){var n,i=arguments.length,a=i<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,o):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,o,r);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(a=(i<3?n(a):i>3?n(e,o,a):n(e,o))||a);return i>3&&a&&Object.defineProperty(e,o,a),a},a=this&&this.__awaiter||function(t,e,o,r){return new(o||(o=Promise))(function(n,i){function a(t){try{c(r.next(t))}catch(e){i(e)}}function s(t){try{c(r.throw(t))}catch(e){i(e)}}function c(t){var e;t.done?n(t.value):(e=t.value,e instanceof o?e:new o(function(t){t(e)})).then(a,s)}c((r=r.apply(t,e||[])).next())})},s=this&&this.__generator||function(t,e){var o,r,n,i,a={label:0,sent:function(){if(1&n[0])throw n[1];return n[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(t){return function(e){return c([t,e])}}function c(i){if(o)throw new TypeError("Generator is already executing.");for(;a;)try{if(o=1,r&&(n=2&i[0]?r.return:i[0]?r.throw||((n=r.return)&&n.call(r),0):r.next)&&!(n=n.call(r,i[1])).done)return n;switch(r=0,n&&(i=[2&i[0],n.value]),i[0]){case 0:case 1:n=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,r=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(n=(n=a.trys).length>0&&n[n.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!n||i[1]>n[0]&&i[1]<n[3])){a.label=i[1];break}if(6===i[0]&&a.label<n[1]){a.label=n[1],n=i;break}if(n&&a.label<n[2]){a.label=n[2],a.ops.push(i);break}n[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(s){i=[6,s],r=0}finally{o=n=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}};Object.defineProperty(o,"__esModule",{value:!0});var c=t("../../../CoreModule/Components/ItemContainer"),l=t("../../../CoreModule/Utils/ScrollviewFilter"),u=t("../../../PlayerModule/Managers/PlayerManager"),p=t("../../../CoreModule/Managers/DataManager"),f=t("../../Data/HeroGroup"),d=t("../../../HeroModule/Managers/HeroManager"),h=cc._decorator,y=h.ccclass,g=(h.property,function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.currentGroupType=f.HeroGroupType.RESTRAINT,e.totalHeroes=[],e}return n(e,t),e.prototype.start=function(){this.setup().then()},e.prototype.setup=function(){return a(this,void 0,void 0,function(){var t,e;return s(this,function(o){switch(o.label){case 0:return t=u.playerMgr().player.account,e=this,[4,d.heroMgr().getListFromServer()];case 1:return e.totalHeroes=o.sent().filter(function(e){return e.ownerAccount==t}),this.setItems(this.groupHeroes(this.totalHeroes)),[2]}})})},e.prototype.update=function(){},e.prototype.onItemsChanged=function(){t.prototype.onItemsChanged.call(this);var e=[];this.itemsComponents.forEach(function(t){1==t.node.active&&e.push(t.node)}),l.ScrollviewFilter.filter("vertical",this.container,e,5,this.container.height,180,5)},e.prototype.groupHeroes=function(t,e){void 0===e&&(e=this.currentGroupType),this.currentGroupType=e;var o=[],r=0;t.forEach(function(t){var n,i;switch(e){case f.HeroGroupType.STAR:n=6-t.star.level,i=t.star.level;break;case f.HeroGroupType.QUALITY:i=t.quality,n=6-t.quality;break;case f.HeroGroupType.RESTRAINT:i=n=t.restraint}o[n]||(o[n]=new f.HeroGroup(e,i)),o[n].heroes.push(t),r=Math.max(r,n)});for(var n=r;n>=0;n--)null==o[n]&&o.splice(n,1);return o},e.prototype.setHeroGroupType=function(t,e){var o=parseInt(e);this.setItems(this.groupHeroes(this.totalHeroes,o))},i([p.waitForDataLoad,u.waitForLogin],e.prototype,"setup",null),i([y],e)}(c.ItemContainer));o.default=g,cc._RF.pop()},{"../../../CoreModule/Components/ItemContainer":"ItemContainer","../../../CoreModule/Managers/DataManager":"DataManager","../../../CoreModule/Utils/ScrollviewFilter":"ScrollviewFilter","../../../HeroModule/Managers/HeroManager":"HeroManager","../../../PlayerModule/Managers/PlayerManager":"PlayerManager","../../Data/HeroGroup":"HeroGroup"}],HeroGroupDisplay:[function(t,e,o){"use strict";cc._RF.push(e,"dd5b9lgHOFGEadjgkwZHbjL","HeroGroupDisplay");var r,n=this&&this.__extends||(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),i=this&&this.__decorate||function(t,e,o,r){var n,i=arguments.length,a=i<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,o):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,o,r);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(a=(i<3?n(a):i>3?n(e,o,a):n(e,o))||a);return i>3&&a&&Object.defineProperty(e,o,a),a};Object.defineProperty(o,"__esModule",{value:!0});var a=t("../../../CoreModule/Components/ItemDisplay"),s=t("../../Data/HeroGroup"),c=t("../../../HeroModule/Data/Quality"),l=cc.Label,u=cc.Node,p=cc.Sprite,f=t("../../../HeroModule/Data/Hero"),d=cc.SpriteFrame,h=t("./HeroGroupHeroContainer"),y=cc._decorator,g=y.ccclass,v=y.property,b=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.stars=[],e.restraintIcons=[],e}return n(e,t),e.prototype.start=function(){},e.prototype.onItemChanged=function(){t.prototype.onItemChanged.call(this),this.setTag(),this.heroContainer.setItems(this.item.heroes)},e.prototype.setTag=function(){switch(this.starsNode.active=!1,this.labelNode.active=!1,this.iconNode.active=!1,this.item.groupBy){case s.HeroGroupType.STAR:for(var t=0;t<5;t++)this.stars[t].active=t<this.item.value;this.starsNode.active=!0;break;case s.HeroGroupType.QUALITY:this.tagLabel.string=c.QualityType[this.item.value],this.labelNode.x=0,this.labelNode.active=!0;break;case s.HeroGroupType.RESTRAINT:this.tagLabel.string=f.RestraintType[this.item.value],this.labelNode.x=7,this.icon.spriteFrame=this.restraintIcons[this.item.value],this.labelNode.active=!0,this.iconNode.active=!0}},i([v(h.default)],e.prototype,"heroContainer",void 0),i([v([u])],e.prototype,"stars",void 0),i([v([d])],e.prototype,"restraintIcons",void 0),i([v(l)],e.prototype,"tagLabel",void 0),i([v(p)],e.prototype,"icon",void 0),i([v(u)],e.prototype,"starsNode",void 0),i([v(u)],e.prototype,"labelNode",void 0),i([v(u)],e.prototype,"iconNode",void 0),i([g],e)}(a.ItemDisplay);o.default=b,cc._RF.pop()},{"../../../CoreModule/Components/ItemDisplay":"ItemDisplay","../../../HeroModule/Data/Hero":"Hero","../../../HeroModule/Data/Quality":"Quality","../../Data/HeroGroup":"HeroGroup","./HeroGroupHeroContainer":"HeroGroupHeroContainer"}],HeroGroupHeroContainer:[function(t,e,o){"use strict";cc._RF.push(e,"75958OHasZFl7K3XsYKSaex","HeroGroupHeroContainer");var r,n=this&&this.__extends||(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),i=this&&this.__decorate||function(t,e,o,r){var n,i=arguments.length,a=i<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,o):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,o,r);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(a=(i<3?n(a):i>3?n(e,o,a):n(e,o))||a);return i>3&&a&&Object.defineProperty(e,o,a),a},a=this&&this.__awaiter||function(t,e,o,r){return new(o||(o=Promise))(function(n,i){function a(t){try{c(r.next(t))}catch(e){i(e)}}function s(t){try{c(r.throw(t))}catch(e){i(e)}}function c(t){var e;t.done?n(t.value):(e=t.value,e instanceof o?e:new o(function(t){t(e)})).then(a,s)}c((r=r.apply(t,e||[])).next())})},s=this&&this.__generator||function(t,e){var o,r,n,i,a={label:0,sent:function(){if(1&n[0])throw n[1];return n[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(t){return function(e){return c([t,e])}}function c(i){if(o)throw new TypeError("Generator is already executing.");for(;a;)try{if(o=1,r&&(n=2&i[0]?r.return:i[0]?r.throw||((n=r.return)&&n.call(r),0):r.next)&&!(n=n.call(r,i[1])).done)return n;switch(r=0,n&&(i=[2&i[0],n.value]),i[0]){case 0:case 1:n=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,r=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(n=(n=a.trys).length>0&&n[n.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!n||i[1]>n[0]&&i[1]<n[3])){a.label=i[1];break}if(6===i[0]&&a.label<n[1]){a.label=n[1],n=i;break}if(n&&a.label<n[2]){a.label=n[2],a.ops.push(i);break}n[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(s){i=[6,s],r=0}finally{o=n=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}};Object.defineProperty(o,"__esModule",{value:!0});var c=t("../../../CoreModule/Components/ItemContainer"),l=t("../../../CoreModule/Utils/ScrollviewFilter"),u=cc._decorator,p=u.ccclass,f=(u.property,function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.start=function(){},e.prototype.setup=function(){return a(this,void 0,void 0,function(){return s(this,function(){return[2]})})},e.prototype.onItemsChanged=function(){t.prototype.onItemsChanged.call(this);var e=[];this.itemsComponents.forEach(function(t){1==t.node.active&&e.push(t.node)}),l.ScrollviewFilter.filter("vertical",this.container,e,5,this.container.height,40,5),this.modifyOnClickEvents()},e.prototype.modifyOnClickEvents=function(){var t=this;this.itemsComponents.forEach(function(e){var o=e.node.getComponentInChildren(d);o.clickEvents=[];var r=new cc.Component.EventHandler;r.target=t.node,r.component="HeroGroupHeroContainer",r.handler="onHeroClicked",r.customEventData=e.item.nftId,o.clickEvents.push(r)})},e.prototype.onHeroClicked=function(t,e){return a(this,void 0,void 0,function(){return s(this,function(){return h.battleScene().myTeamFrame.addTeamMember(e),[2]})})},i([p],e)}(c.ItemContainer));o.default=f;var d=cc.Button,h=t("../../../../Scenes/BattleScene");cc._RF.pop()},{"../../../../Scenes/BattleScene":"BattleScene","../../../CoreModule/Components/ItemContainer":"ItemContainer","../../../CoreModule/Utils/ScrollviewFilter":"ScrollviewFilter"}],HeroGroup:[function(t,e,o){"use strict";cc._RF.push(e,"a9f360ODFZAA7E9VdN2gc1T","HeroGroup");var r,n=this&&this.__extends||(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)});Object.defineProperty(o,"__esModule",{value:!0}),o.HeroGroup=o.HeroGroupType=void 0;var i=t("../../CoreModule/Data/BaseData");(function(t){t[t.RESTRAINT=0]="RESTRAINT",t[t.QUALITY=1]="QUALITY",t[t.STAR=2]="STAR"})(o.HeroGroupType||(o.HeroGroupType={}));var a=function(t){function e(e,o){var r=t.call(this)||this;return r.groupBy=e,r.value=o,r.heroes=[],r}return n(e,t),e}(i.BaseData);o.HeroGroup=a,cc._RF.pop()},{"../../CoreModule/Data/BaseData":"BaseData"}],HeroInBagContainer:[function(t,e,o){"use strict";cc._RF.push(e,"e0eb9/6l4dDrL0Lw6XNUpbG","HeroInBagContainer");var r,n=this&&this.__extends||(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),i=this&&this.__decorate||function(t,e,o,r){var n,i=arguments.length,a=i<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,o):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,o,r);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(a=(i<3?n(a):i>3?n(e,o,a):n(e,o))||a);return i>3&&a&&Object.defineProperty(e,o,a),a},a=this&&this.__awaiter||function(t,e,o,r){return new(o||(o=Promise))(function(n,i){function a(t){try{c(r.next(t))}catch(e){i(e)}}function s(t){try{c(r.throw(t))}catch(e){i(e)}}function c(t){var e;t.done?n(t.value):(e=t.value,e instanceof o?e:new o(function(t){t(e)})).then(a,s)}c((r=r.apply(t,e||[])).next())})},s=this&&this.__generator||function(t,e){var o,r,n,i,a={label:0,sent:function(){if(1&n[0])throw n[1];return n[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(t){return function(e){return c([t,e])}}function c(i){if(o)throw new TypeError("Generator is already executing.");for(;a;)try{if(o=1,r&&(n=2&i[0]?r.return:i[0]?r.throw||((n=r.return)&&n.call(r),0):r.next)&&!(n=n.call(r,i[1])).done)return n;switch(r=0,n&&(i=[2&i[0],n.value]),i[0]){case 0:case 1:n=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,r=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(n=(n=a.trys).length>0&&n[n.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!n||i[1]>n[0]&&i[1]<n[3])){a.label=i[1];break}if(6===i[0]&&a.label<n[1]){a.label=n[1],n=i;break}if(n&&a.label<n[2]){a.label=n[2],a.ops.push(i);break}n[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(s){i=[6,s],r=0}finally{o=n=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}};Object.defineProperty(o,"__esModule",{value:!0});var c=t("../../../CoreModule/Components/ItemContainer"),l=t("../../../CoreModule/Utils/ScrollviewFilter"),u=t("../../../PlayerModule/Managers/PlayerManager"),p=t("../../../CoreModule/Managers/DataManager"),f=t("../../../HeroModule/Managers/HeroManager"),d=cc._decorator,h=d.ccclass,y=(d.property,function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.totalHeroes=[],e}return n(e,t),e.prototype.start=function(){this.setup().then()},e.prototype.setup=function(){return a(this,void 0,void 0,function(){var t,e;return s(this,function(o){switch(o.label){case 0:return t=u.playerMgr().player.account,e=this,[4,f.heroMgr().getListFromServer()];case 1:return e.totalHeroes=o.sent().filter(function(e){return e.ownerAccount==t}),this.currentRace=void 0,this.onHeroRaceChange(),[2]}})})},e.prototype.onItemsChanged=function(){t.prototype.onItemsChanged.call(this);var e=[];this.itemsComponents.forEach(function(t){1==t.node.active&&e.push(t.node)}),l.ScrollviewFilter.filter("vertical",this.container,e,5,this.container.height,170,5)},e.prototype.setHeroBagFilter=function(t,e){this.currentRace="undefined"==e?void 0:parseInt(e),this.onHeroRaceChange()},e.prototype.onHeroRaceChange=function(){var t=this,e=this.currentRace?this.totalHeroes.filter(function(e){return e.race==t.currentRace}):this.totalHeroes;this.setItems(e)},i([p.waitForDataLoad,u.waitForLogin],e.prototype,"setup",null),i([h],e)}(c.ItemContainer));o.default=y,cc._RF.pop()},{"../../../CoreModule/Components/ItemContainer":"ItemContainer","../../../CoreModule/Managers/DataManager":"DataManager","../../../CoreModule/Utils/ScrollviewFilter":"ScrollviewFilter","../../../HeroModule/Managers/HeroManager":"HeroManager","../../../PlayerModule/Managers/PlayerManager":"PlayerManager"}],HeroInBagDisplay:[function(t,e,o){"use strict";cc._RF.push(e,"174db6Uu2dCEb+cEC3t5z0f","HeroInBagDisplay");var r,n=this&&this.__extends||(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),i=this&&this.__decorate||function(t,e,o,r){var n,i=arguments.length,a=i<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,o):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,o,r);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(a=(i<3?n(a):i>3?n(e,o,a):n(e,o))||a);return i>3&&a&&Object.defineProperty(e,o,a),a};Object.defineProperty(o,"__esModule",{value:!0});var a=cc.Label,s=cc.Node,c=cc.SpriteFrame,l=cc.Sprite,u=t("../../../../Scenes/BattleScene"),p=t("../HeroWithAvatar"),f=cc._decorator,d=f.ccclass,h=f.property,y=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.nameLabel=null,e.fragmentLabel=null,e.qualityBackground=null,e.fightingTips=null,e.stars=[],e.qualityPictures=[],e}return n(e,t),e.prototype.start=function(){},e.prototype.onItemChanged=function(){t.prototype.onItemChanged.call(this),this.nameLabel.string=this.item.name,this.qualityBackground.spriteFrame=this.qualityPictures[this.item.quality]},e.prototype.update=function(){this.item&&(this.updateLabels(),this.updatePictures(),this.updateNodes())},e.prototype.updateLabels=function(){this.fragmentLabel.string="0/60"},e.prototype.updatePictures=function(){},e.prototype.updateNodes=function(){var t=this;this.fightingTips.active=null!=u.battleScene().heroesInTeam.find(function(e){return e==t.item}),this.stars.forEach(function(e,o){e.active=o<t.item.star.level})},e.prototype.onAvatarClick=function(){u.battleScene().cultivateWindow.open(this.item)},i([h(a)],e.prototype,"nameLabel",void 0),i([h(a)],e.prototype,"fragmentLabel",void 0),i([h(l)],e.prototype,"qualityBackground",void 0),i([h(s)],e.prototype,"fightingTips",void 0),i([h([s])],e.prototype,"stars",void 0),i([h([c])],e.prototype,"qualityPictures",void 0),i([d],e)}(p.default);o.default=y,cc._RF.pop()},{"../../../../Scenes/BattleScene":"BattleScene","../HeroWithAvatar":"HeroWithAvatar"}],HeroInTeamContainer:[function(t,e,o){"use strict";cc._RF.push(e,"3c3d6nLMQdJupIhnkbjOVzp","HeroInTeamContainer");var r,n=this&&this.__extends||(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),i=this&&this.__decorate||function(t,e,o,r){var n,i=arguments.length,a=i<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,o):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,o,r);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(a=(i<3?n(a):i>3?n(e,o,a):n(e,o))||a);return i>3&&a&&Object.defineProperty(e,o,a),a},a=this&&this.__awaiter||function(t,e,o,r){return new(o||(o=Promise))(function(n,i){function a(t){try{c(r.next(t))}catch(e){i(e)}}function s(t){try{c(r.throw(t))}catch(e){i(e)}}function c(t){var e;t.done?n(t.value):(e=t.value,e instanceof o?e:new o(function(t){t(e)})).then(a,s)}c((r=r.apply(t,e||[])).next())})},s=this&&this.__generator||function(t,e){var o,r,n,i,a={label:0,sent:function(){if(1&n[0])throw n[1];return n[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(t){return function(e){return c([t,e])}}function c(i){if(o)throw new TypeError("Generator is already executing.");for(;a;)try{if(o=1,r&&(n=2&i[0]?r.return:i[0]?r.throw||((n=r.return)&&n.call(r),0):r.next)&&!(n=n.call(r,i[1])).done)return n;switch(r=0,n&&(i=[2&i[0],n.value]),i[0]){case 0:case 1:n=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,r=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(n=(n=a.trys).length>0&&n[n.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!n||i[1]>n[0]&&i[1]<n[3])){a.label=i[1];break}if(6===i[0]&&a.label<n[1]){a.label=n[1],n=i;break}if(n&&a.label<n[2]){a.label=n[2],a.ops.push(i);break}n[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(s){i=[6,s],r=0}finally{o=n=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}};Object.defineProperty(o,"__esModule",{value:!0});var c=t("../../../CoreModule/Components/ItemContainer"),l=cc._decorator,u=l.ccclass,p=(l.property,function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.start=function(){},e.prototype.setup=function(){return a(this,void 0,void 0,function(){return s(this,function(){return[2]})})},e.prototype.onItemsChanged=function(){t.prototype.onItemsChanged.call(this),this.modifyOnClickEvents()},e.prototype.modifyOnClickEvents=function(){var t=this;this.itemsComponents.forEach(function(e){var o=e.node.getComponentInChildren(f);o.clickEvents=[];var r=new cc.Component.EventHandler;r.target=t.node,r.component="HeroInTeamContainer",r.handler="onTeamHeroClicked",r.customEventData=e.item.nftId,o.clickEvents.push(r)})},e.prototype.onTeamHeroClicked=function(t,e){d.battleScene().myTeamFrame.removeTeamMember(e)},i([u],e)}(c.ItemContainer));o.default=p;var f=cc.Button,d=t("../../../../Scenes/BattleScene");cc._RF.pop()},{"../../../../Scenes/BattleScene":"BattleScene","../../../CoreModule/Components/ItemContainer":"ItemContainer"}],HeroInTeamDisplay:[function(t,e,o){"use strict";cc._RF.push(e,"1dc64wl2/xNvKwXYRESKqyP","HeroInTeamDisplay");var r,n=this&&this.__extends||(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),i=this&&this.__decorate||function(t,e,o,r){var n,i=arguments.length,a=i<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,o):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,o,r);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(a=(i<3?n(a):i>3?n(e,o,a):n(e,o))||a);return i>3&&a&&Object.defineProperty(e,o,a),a};Object.defineProperty(o,"__esModule",{value:!0});var a=cc.Label,s=cc.Sprite,c=cc.SpriteFrame,l=t("../HeroWithAvatar"),u=cc._decorator,p=u.ccclass,f=u.property,d=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.nameLabel=null,e.levelLabel=null,e.qualityLabel=null,e.qualityBackground=null,e.qualityPictures=[],e}return n(e,t),e.prototype.start=function(){this.setup()},e.prototype.setup=function(){},e.prototype.onItemChanged=function(){t.prototype.onItemChanged.call(this),this.nameLabel.string=this.item.name,this.levelLabel.string="Lv."+this.item.level.level,this.qualityLabel.string=this.item.qualityData.shortName,this.qualityBackground.spriteFrame=this.qualityPictures[this.item.quality]},i([f(a)],e.prototype,"nameLabel",void 0),i([f(a)],e.prototype,"levelLabel",void 0),i([f(a)],e.prototype,"qualityLabel",void 0),i([f(s)],e.prototype,"qualityBackground",void 0),i([f([c])],e.prototype,"qualityPictures",void 0),i([p],e)}(l.default);o.default=d,cc._RF.pop()},{"../HeroWithAvatar":"HeroWithAvatar"}],HeroInfoDisplay:[function(t,e,o){"use strict";cc._RF.push(e,"2db0ewspVRHkJOxEDIxaOAI","HeroInfoDisplay");var r,n=this&&this.__extends||(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),i=this&&this.__decorate||function(t,e,o,r){var n,i=arguments.length,a=i<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,o):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,o,r);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(a=(i<3?n(a):i>3?n(e,o,a):n(e,o))||a);return i>3&&a&&Object.defineProperty(e,o,a),a};Object.defineProperty(o,"__esModule",{value:!0});var a=cc.Sprite,s=cc.Label,c=sp.Skeleton,l=cc.SpriteFrame,u=t("../../../../Utils/NumberUtils"),p=t("../../../../Utils/SpineUtils"),f=t("../../../HeroModule/Managers/HeroManager"),d=t("../../../../Scenes/SelectorScene/Components/ItemPrefabs/PreviewPictureDisplay"),h=cc.Node,y=t("../../../../Scenes/BattleScene"),g=cc.Animation,v=cc._decorator,b=v.ccclass,m=v.property,_=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.nameLabel=null,e.qualitySprite=null,e.qualityLabel=null,e.qualityStrings=["N","R","SR","SSR","UR"],e.starSprites=[],e.restraintSprite=null,e.heroSkeleton=null,e.qualityPictures=[],e.starPictures=[],e.restraintPictures=[],e.animation=null,e.cultivateController=null,e.size=240,e}return n(e,t),e.prototype.start=function(){this.cultivateController=y.battleScene().cultivateWindow},e.prototype.update=function(){},e.prototype.refresh=function(){this.cultivateController||(this.cultivateController=y.battleScene().cultivateWindow),this.updateLabels(),this.updatePictures(),this.drawSkeleton()},e.prototype.updateLabels=function(){var t=this.cultivateController.currentHero;t&&(this.nameLabel.string=t.name,this.qualityLabel.string=this.qualityStrings[t.quality])},e.prototype.updatePictures=function(){var t=this,e=this.cultivateController.currentHero;e&&(this.qualitySprite.spriteFrame=this.qualityPictures[e.quality],this.starSprites.forEach(function(o,r){o.spriteFrame=t.starPictures[r<e.star.level?1:0]}),this.restraintSprite.spriteFrame=this.restraintPictures[e.restraint])},e.prototype.drawSkeleton=function(){var t=this,e=this.cultivateController.currentHero;if(e){var o=new h("node"),r=o.addComponent(c),n=new p.HeroSkeleton(this.heroSkeleton,r,f.heroMgr().getCacheOneFromServer(e.nftId).heroTypeId);e.parts.forEach(function(t){n.addPart(t)}),n.refresh().then(function(){o.destroy(),t.heroSkeleton.clearTracks(),t.heroSkeleton.setAnimation(0,d.DefaultStand,!0),t.sizeFilter()})}},e.prototype.sizeFilter=function(){var t=Math.max(this.heroSkeleton.node.width*this.heroSkeleton.node.scaleX/this.size,this.heroSkeleton.node.height*this.heroSkeleton.node.scaleY/this.size);t>1&&(this.heroSkeleton.node.scaleX/=t,this.heroSkeleton.node.scaleY/=t),this.heroSkeleton.node.y=-50-this.size/3},e.prototype.playAnimation=function(t){this.animation.play(t)},i([m(s)],e.prototype,"nameLabel",void 0),i([m(a)],e.prototype,"qualitySprite",void 0),i([m(s)],e.prototype,"qualityLabel",void 0),i([m([a])],e.prototype,"starSprites",void 0),i([m(a)],e.prototype,"restraintSprite",void 0),i([m(c)],e.prototype,"heroSkeleton",void 0),i([m([l])],e.prototype,"qualityPictures",void 0),i([m([l])],e.prototype,"starPictures",void 0),i([m([l])],e.prototype,"restraintPictures",void 0),i([m(g)],e.prototype,"animation",void 0),i([u.autoUnitConvert],e.prototype,"updateLabels",null),i([b],e)}(cc.Component);o.default=_,cc._RF.pop()},{"../../../../Scenes/BattleScene":"BattleScene","../../../../Scenes/SelectorScene/Components/ItemPrefabs/PreviewPictureDisplay":"PreviewPictureDisplay","../../../../Utils/NumberUtils":"NumberUtils","../../../../Utils/SpineUtils":"SpineUtils","../../../HeroModule/Managers/HeroManager":"HeroManager"}],HeroItemContainer:[function(t,e,o){"use strict";cc._RF.push(e,"9c06enSxeJLxKjUr41VSNnD","HeroItemContainer");var r,n=this&&this.__extends||(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),i=this&&this.__decorate||function(t,e,o,r){var n,i=arguments.length,a=i<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,o):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,o,r);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(a=(i<3?n(a):i>3?n(e,o,a):n(e,o))||a);return i>3&&a&&Object.defineProperty(e,o,a),a},a=this&&this.__awaiter||function(t,e,o,r){return new(o||(o=Promise))(function(n,i){function a(t){try{c(r.next(t))}catch(e){i(e)}}function s(t){try{c(r.throw(t))}catch(e){i(e)}}function c(t){var e;t.done?n(t.value):(e=t.value,e instanceof o?e:new o(function(t){t(e)})).then(a,s)}c((r=r.apply(t,e||[])).next())})},s=this&&this.__generator||function(t,e){var o,r,n,i,a={label:0,sent:function(){if(1&n[0])throw n[1];return n[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(t){return function(e){return c([t,e])}}function c(i){if(o)throw new TypeError("Generator is already executing.");for(;a;)try{if(o=1,r&&(n=2&i[0]?r.return:i[0]?r.throw||((n=r.return)&&n.call(r),0):r.next)&&!(n=n.call(r,i[1])).done)return n;switch(r=0,n&&(i=[2&i[0],n.value]),i[0]){case 0:case 1:n=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,r=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(n=(n=a.trys).length>0&&n[n.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!n||i[1]>n[0]&&i[1]<n[3])){a.label=i[1];break}if(6===i[0]&&a.label<n[1]){a.label=n[1],n=i;break}if(n&&a.label<n[2]){a.label=n[2],a.ops.push(i);break}n[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(s){i=[6,s],r=0}finally{o=n=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}};Object.defineProperty(o,"__esModule",{value:!0});var c=t("../../../CoreModule/Components/ItemContainer"),l=t("../../../CoreModule/Utils/ScrollviewFilter"),u=t("../../../PlayerModule/Managers/PlayerManager"),p=t("../../../CoreModule/Managers/DataManager"),f=cc._decorator,d=f.ccclass,h=(f.property,function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.start=function(){this.setup().then()},e.prototype.setup=function(){return a(this,void 0,void 0,function(){var t,e;return s(this,function(o){switch(o.label){case 0:return t=u.playerMgr().player.account,e=this.setItems,[4,y.heroMgr().getListFromServer()];case 1:return e.apply(this,[o.sent().filter(function(e){return e.ownerAccount==t})]),[2]}})})},e.prototype.update=function(){},e.prototype.onItemsChanged=function(){t.prototype.onItemsChanged.call(this);var e=[];this.itemsComponents.forEach(function(t){1==t.node.active&&e.push(t.node)}),l.ScrollviewFilter.filter("vertical",this.container,e,5,this.node.height,170)},i([p.waitForDataLoad,u.waitForLogin],e.prototype,"setup",null),i([d],e)}(c.ItemContainer));o.default=h;var y=t("../../../HeroModule/Managers/HeroManager");cc._RF.pop()},{"../../../CoreModule/Components/ItemContainer":"ItemContainer","../../../CoreModule/Managers/DataManager":"DataManager","../../../CoreModule/Utils/ScrollviewFilter":"ScrollviewFilter","../../../HeroModule/Managers/HeroManager":"HeroManager","../../../PlayerModule/Managers/PlayerManager":"PlayerManager"}],HeroItemDisplay:[function(t,e,o){"use strict";cc._RF.push(e,"54634SOi9hLXbLU3cyL3t27","HeroItemDisplay");var r,n=this&&this.__extends||(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),i=this&&this.__decorate||function(t,e,o,r){var n,i=arguments.length,a=i<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,o):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,o,r);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(a=(i<3?n(a):i>3?n(e,o,a):n(e,o))||a);return i>3&&a&&Object.defineProperty(e,o,a),a};Object.defineProperty(o,"__esModule",{value:!0});var a=cc.Label,s=cc.Sprite,c=cc.SpriteFrame,l=cc.Node,u=cc.Layout,p=cc.Button,f=t("../../../../Utils/NumberUtils"),d=t("../../../HeroModule/Managers/HeroManager"),h=t("../../../../Scenes/BattleScene"),y=t("../HeroWithAvatar"),g=cc._decorator,v=g.ccclass,b=g.property,m=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.nameLabel=null,e.levelLabel=null,e.qualityLabel=null,e.attackLabel=null,e.defenseLabel=null,e.healthLabel=null,e.upgradeValueLabel=null,e.upgradeTipsLabel=null,e.qualityBackground=null,e.scissorsIcon=null,e.upgradeIcon=null,e.upgradeNode=null,e.upgradePicture=null,e.upgradeButton=null,e.starNodes=[],e.starLayout=null,e.qualityPictures=[],e.scissorsPictures=[],e.buttonPictures=[],e.upgradeIcons=[],e}var o;return n(e,t),o=e,e.prototype.start=function(){this.setup()},e.prototype.setup=function(){this.upgradePicture=this.upgradeNode.getComponent(s),this.upgradeButton=this.upgradeNode.getComponent(p)},e.prototype.onItemChanged=function(){t.prototype.onItemChanged.call(this),this.nameLabel.string=this.item.name,this.qualityLabel.string=this.item.qualityData.shortName,this.qualityBackground.spriteFrame=this.qualityPictures[this.item.quality],this.scissorsIcon.spriteFrame=this.scissorsPictures[this.item.restraint]},e.prototype.update=function(){this.item&&(this.updateLabels(),this.updatePictures(),this.updateNodes())},e.prototype.updateLabels=function(){if(this.levelLabel.string="Lv."+this.item.level.level,this.attackLabel.string=this.item.atk.toString(),this.defenseLabel.string=this.item.def.toString(),this.healthLabel.string=this.item.mhp.toString(),this.item.level.isMax())return this.upgradeValueLabel.string="0",void(this.upgradeTipsLabel.string="\\L[SJob10]");this.item.level.breakEnable()?(this.upgradeValueLabel.string=this.item.break.costs().diamond.value.toString(),this.upgradeTipsLabel.string="\\L[SHero3]"):(this.upgradeValueLabel.string=this.item.level.costs().gold.value.toString(),this.upgradeTipsLabel.string="\\L[SJob3]")},e.prototype.updatePictures=function(){this.upgradeIcon.spriteFrame=this.item.level.breakEnable()?this.upgradeIcons[0]:this.upgradeIcons[1]},e.prototype.updateNodes=function(){var t=this.item.level.breakEnable()&&this.item.break.conditions().judge()||this.item.level.conditions().judge();this.upgradePicture.spriteFrame=this.buttonPictures[t?0:1],this.upgradeButton.interactable=t;var e=this.item.star.level;this.starNodes.forEach(function(t,o){t.active=o<e}),this.starLayout.paddingLeft=o.leftPending[e-1],this.starLayout.spacingX=o.spacingX[e-1]},e.prototype.upgradeBtn=function(){this.item.level.breakEnable()?d.heroMgr().break(this.item).then():d.heroMgr().upgrade(this.item).then()},e.prototype.onAvatarClick=function(){h.battleScene().cultivateWindow.open(this.item)},e.spacingX=[0,0,-8,-18,-23],e.leftPending=[29,12,0,0,0],i([b(a)],e.prototype,"nameLabel",void 0),i([b(a)],e.prototype,"levelLabel",void 0),i([b(a)],e.prototype,"qualityLabel",void 0),i([b(a)],e.prototype,"attackLabel",void 0),i([b(a)],e.prototype,"defenseLabel",void 0),i([b(a)],e.prototype,"healthLabel",void 0),i([b(a)],e.prototype,"upgradeValueLabel",void 0),i([b(a)],e.prototype,"upgradeTipsLabel",void 0),i([b(s)],e.prototype,"qualityBackground",void 0),i([b(s)],e.prototype,"scissorsIcon",void 0),i([b(s)],e.prototype,"upgradeIcon",void 0),i([b(l)],e.prototype,"upgradeNode",void 0),i([b([l])],e.prototype,"starNodes",void 0),i([b(u)],e.prototype,"starLayout",void 0),i([f.autoUnitConvert],e.prototype,"updateLabels",null),i([b([c])],e.prototype,"qualityPictures",void 0),i([b([c])],e.prototype,"scissorsPictures",void 0),i([b([c])],e.prototype,"buttonPictures",void 0),i([b([c])],e.prototype,"upgradeIcons",void 0),o=i([v],e)}(y.default);o.default=m,cc._RF.pop()},{"../../../../Scenes/BattleScene":"BattleScene","../../../../Utils/NumberUtils":"NumberUtils","../../../HeroModule/Managers/HeroManager":"HeroManager","../HeroWithAvatar":"HeroWithAvatar"}],HeroManager:[function(t,e,o){"use strict";cc._RF.push(e,"5abb77sLztEuJc8FeS/Khyh","HeroManager");var r,n=this&&this.__extends||(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),i=this&&this.__decorate||function(t,e,o,r){var n,i=arguments.length,a=i<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,o):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,o,r);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(a=(i<3?n(a):i>3?n(e,o,a):n(e,o))||a);return i>3&&a&&Object.defineProperty(e,o,a),a},a=this&&this.__awaiter||function(t,e,o,r){return new(o||(o=Promise))(function(n,i){function a(t){try{c(r.next(t))}catch(e){i(e)}}function s(t){try{c(r.throw(t))}catch(e){i(e)}}function c(t){var e;t.done?n(t.value):(e=t.value,e instanceof o?e:new o(function(t){t(e)})).then(a,s)}c((r=r.apply(t,e||[])).next())})},s=this&&this.__generator||function(t,e){var o,r,n,i,a={label:0,sent:function(){if(1&n[0])throw n[1];return n[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(t){return function(e){return c([t,e])}}function c(i){if(o)throw new TypeError("Generator is already executing.");for(;a;)try{if(o=1,r&&(n=2&i[0]?r.return:i[0]?r.throw||((n=r.return)&&n.call(r),0):r.next)&&!(n=n.call(r,i[1])).done)return n;switch(r=0,n&&(i=[2&i[0],n.value]),i[0]){case 0:case 1:n=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,r=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(n=(n=a.trys).length>0&&n[n.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!n||i[1]>n[0]&&i[1]<n[3])){a.label=i[1];break}if(6===i[0]&&a.label<n[1]){a.label=n[1],n=i;break}if(n&&a.label<n[2]){a.label=n[2],a.ops.push(i);break}n[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(s){i=[6,s],r=0}finally{o=n=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}};Object.defineProperty(o,"__esModule",{value:!0}),o.heroMgr=o.PageSize=void 0;var c=t("../../CoreModule/Managers/BaseManager"),l=t("../../NFTModule/Managers/NFTManager"),u=t("../Common/HeroCommon"),p=t("../Data/Hero"),f=t("../../CoreModule/Utils/DataLoader"),d=t("../../CoreModule/Managers/AlertManager"),h=t("../Data/HeroType"),y=t("../Data/Quality");o.PageSize=100,o.heroMgr=function(){return c.getManager(g)};var g=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.data={},e.serverKey="server",e}return n(e,t),e.prototype.getOne=function(t,e,o,r){return a(this,void 0,void 0,function(){var n,i,a;return s(this,function(s){switch(s.label){case 0:return(n=this.getCacheOne(t,e,o))&&!r?[3,2]:(i=this.add,a=[t,e],[4,l.nftMgr().getNFTDetail(o)]);case 1:n=i.apply(this,a.concat([s.sent()])),s.label=2;case 2:return[2,n]}})})},e.prototype.getList=function(t,e,r){return a(this,void 0,void 0,function(){var n,i,a,c;return s(this,function(s){switch(s.label){case 0:return(n=this.getCacheList(t,e))&&!r?[3,6]:[4,this.getCount(t,e)];case 1:i=s.sent(),a=Math.ceil(i.createCount/o.PageSize),c=1,s.label=2;case 2:return c<=a?[4,this.getListWithPage(t,e,c,r)]:[3,5];case 3:s.sent(),s.label=4;case 4:return c++,[3,2];case 5:n=this.getCacheList(t,e),s.label=6;case 6:return[2,n]}})})},e.prototype.getListWithPage=function(t,e,r,n){return a(this,void 0,void 0,function(){var i,a=this;return s(this,function(s){switch(s.label){case 0:return!(i=this.getCacheListWithPage(t,e,r))||i.length<=0||n?[4,l.nftMgr().getMyNFTList(r,t,e,o.PageSize)]:[3,2];case 1:s.sent().forEach(function(o){return a.add(t,e,o)}),i=this.getCacheList(t,e),s.label=2;case 2:return[2,i]}})})},e.prototype.getCount=function(t,e){return a(this,void 0,void 0,function(){return s(this,function(o){switch(o.label){case 0:return[4,l.nftMgr().getNFTCount(t,e)];case 1:return[2,o.sent()]}})})},e.prototype.getCacheOne=function(t,e,o){var r=this.getCacheList(t,e);return null==r?void 0:r.find(function(t){return t.nftId==o})},e.prototype.getCacheList=function(t,e){return this.data[this.getKey(t,e)]},e.prototype.getCacheListWithPage=function(t,e,r){var n=this.getCacheList(t,e);return null==n?void 0:n.splice(r*o.PageSize,(r+1)*o.PageSize)},e.prototype.getOrCreateCacheList=function(t,e){var o,r;return(o=this.data)[r=this.getKey(t,e)]||(o[r]=[])},e.prototype.add=function(t,e,o){var r=o.tokenId,n=this.getOrCreateCacheList(t,e),i=this.getCacheOne(t,e,r);return i||n.push(i=new p.Hero),this.convert(o,i)},e.prototype.getKey=function(t,e){return t+"_"+e},e.prototype.convert=function(t,e){return e||(e=new p.Hero),e.bt1=Number(t.seriesId)||l.DefaultBt1,e.bt2=Number(t.gameId)||l.DefaultBt2,e.chainId=Number(t.chainId)||l.chainId(),e.nftId=t.tokenId.toString(),e.name=t.tokenName,e.avatarUrl=t.tokenUrl,e.quality=y.QualityType.UR-Number(t.quality)+1,e.price=l.nftMgr().convertPrice(t.currentPrice),e.creatorAccount=t.createAddress.toLowerCase(),e.ownerAccount=t.ownerAddress.toLowerCase(),e.addedParams=this.convertParams(t),e.partIds=this.convertComponentIds(t.componentIds),e.heroTypeId=e.bodyPart.heroTypeId,e.rawData=t,e},e.prototype.convertParams=function(t){for(var e=[],o=1;o<=6;o++)e[Number(t["et"+o])]=Number(t["ef"+o])/100;return e},e.prototype.convertComponentIds=function(t){return t.split("-").map(function(t){return Number(t)-l.PartIdOffset})},e.prototype.getLastNFT=function(t){return a(this,void 0,void 0,function(){var e;return s(this,function(o){switch(o.label){case 0:return[4,l.nftMgr().getLastestNFT(t)];case 1:return e=o.sent(),[2,this.convert(e)]}})})},e.prototype.synchronizeAllHeroes=function(){return a(this,void 0,void 0,function(){var t=this;return s(this,function(){return h.heroTypeRepo().list.forEach(function(){l.nftMgr().getMyNFTList(1,l.DefaultBt1,l.DefaultBt2,9999).then(function(e){e.forEach(function(e){var o=t.convert(e);u.HeroInterface.SyncHero({hero:o}).then()})})}),[2]})})},e.prototype.getOneFromServer=function(t,e){return a(this,void 0,void 0,function(){var o,r;return s(this,function(n){switch(n.label){case 0:return(o=this.getCacheOneFromServer(t))&&!e?[3,2]:(r=this.addFromServer,[4,this._getOneFromServer(t)]);case 1:o=r.apply(this,[n.sent()]),n.label=2;case 2:return[2,o]}})})},e.prototype._getOneFromServer=function(t){return a(this,void 0,Promise,function(){var e;return s(this,function(o){switch(o.label){case 0:return[4,u.HeroInterface.GetHero({nftId:t})];case 1:return e=o.sent(),[2,f.DataLoader.load(p.Hero,e.hero)]}})})},e.prototype.getListFromServer=function(t){return void 0===t&&(t=!0),a(this,void 0,void 0,function(){var e,r,n,i;return s(this,function(a){switch(a.label){case 0:return(e=this.getCacheListFromServer())&&!t?[3,6]:[4,this.getCountFromServer()];case 1:r=a.sent(),n=Math.ceil(r/o.PageSize),i=0,a.label=2;case 2:return i<n?[4,this.getListWithPageFromServer(i,t)]:[3,5];case 3:a.sent(),a.label=4;case 4:return++i,[3,2];case 5:e=this.getCacheListFromServer(),a.label=6;case 6:return[2,e]}})})},e.prototype._getListFromServer=function(t,e){return void 0===t&&(t=0),void 0===e&&(e=1e3),a(this,void 0,Promise,function(){var o,r;return s(this,function(n){switch(n.label){case 0:return[4,u.HeroInterface.GetHeroes({offset:t,count:e})];case 1:return o=n.sent(),r=[],o.heroes.forEach(function(t){r.push(f.DataLoader.load(p.Hero,t))}),[2,r]}})})},e.prototype.getListWithPageFromServer=function(t,e){return a(this,void 0,void 0,function(){var r,n=this;return s(this,function(i){switch(i.label){case 0:return!(r=this.getCacheListWithPageFromServer(t))||r.length<=0||e?[4,this._getListFromServer(t*o.PageSize,o.PageSize)]:[3,2];case 1:i.sent().forEach(function(t){return n.addFromServer(t)}),r=this.getCacheListFromServer(),i.label=2;case 2:return[2,r]}})})},e.prototype.getCountFromServer=function(){return a(this,void 0,void 0,function(){return s(this,function(){return[2,this._getCountFromServer()]})})},e.prototype._getCountFromServer=function(){return a(this,void 0,Promise,function(){return s(this,function(t){switch(t.label){case 0:return[4,u.HeroInterface.GetHeroCount()];case 1:return[2,t.sent().count]}})})},e.prototype.getCacheOneFromServer=function(t){var e=this.getCacheListFromServer();return null==e?void 0:e.find(function(e){return e.nftId==t})},e.prototype.getCacheListFromServer=function(){return this.data[this.serverKey]},e.prototype.getCacheListWithPageFromServer=function(t){var e=this.getCacheListFromServer();return null==e?void 0:e.slice(t*o.PageSize,(t+1)*o.PageSize)},e.prototype.getOrCreateCacheListFromServer=function(){var t,e;return(t=this.data)[e=this.serverKey]||(t[e]=[])},e.prototype.addFromServer=function(t){var e=this.getOrCreateCacheListFromServer(),o=this.getCacheOneFromServer(t.nftId);return o||e.push(o=t),o},e.prototype.upgrade=function(t){return a(this,void 0,void 0,function(){return s(this,function(e){switch(e.label){case 0:return[4,u.HeroInterface.UpgradeLevel({nftId:t.nftId})];case 1:return e.sent(),t.level.conditions().process(),t.level.upgrade(),[2]}})})},e.prototype.break=function(t){return a(this,void 0,void 0,function(){return s(this,function(e){switch(e.label){case 0:return[4,u.HeroInterface.BreakLevel({nftId:t.nftId})];case 1:return e.sent(),t.break.conditions().process(),t.break.upgrade(),[2]}})})},e.prototype.strengthen=function(t){return a(this,void 0,void 0,function(){return s(this,function(e){switch(e.label){case 0:return[4,u.HeroInterface.UpgradeStrengthen({nftId:t.nftId})];case 1:return e.sent(),t.strengthen.conditions().process(),t.strengthen.upgrade(),[2]}})})},e.prototype.starUp=function(t){return a(this,void 0,void 0,function(){return s(this,function(e){switch(e.label){case 0:return[4,u.HeroInterface.UpgradeStar({nftId:t.nftId})];case 1:return e.sent(),t.star.conditions().process(),t.star.upgrade(),[2]}})})},i([d.handleError],e.prototype,"upgrade",null),i([d.handleError],e.prototype,"break",null),i([d.handleError],e.prototype,"strengthen",null),i([d.handleError],e.prototype,"starUp",null),i([c.manager],e)}(c.BaseManager);cc._RF.pop()},{"../../CoreModule/Managers/AlertManager":"AlertManager","../../CoreModule/Managers/BaseManager":"BaseManager","../../CoreModule/Utils/DataLoader":"DataLoader","../../NFTModule/Managers/NFTManager":"NFTManager","../Common/HeroCommon":"HeroCommon","../Data/Hero":"Hero","../Data/HeroType":"HeroType","../Data/Quality":"Quality"}],HeroPageController:[function(t,e,o){"use strict";cc._RF.push(e,"0def0uqVmZEiYK1UoeiJXLy","HeroPageController");var r,n=this&&this.__extends||(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),i=this&&this.__decorate||function(t,e,o,r){var n,i=arguments.length,a=i<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,o):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,o,r);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(a=(i<3?n(a):i>3?n(e,o,a):n(e,o))||a);return i>3&&a&&Object.defineProperty(e,o,a),a};Object.defineProperty(o,"__esModule",{value:!0});var a=cc.Node,s=cc._decorator,c=s.ccclass,l=s.property,u=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.pages=[],e.titles=[],e.state=0,e}return n(e,t),e.prototype.onEnable=function(){this.onStateChange()},e.prototype.backBtn=function(){this.state=0,this.onStateChange()},e.prototype.teamBtn=function(){this.state=1,this.onStateChange()},e.prototype.bagBtn=function(){this.state=2,this.onStateChange()},e.prototype.onStateChange=function(){var t=this;this.pages.forEach(function(e,o){e.active=o==t.state}),this.titles.forEach(function(e,o){e.active=o==t.state})},i([l([a])],e.prototype,"pages",void 0),i([l([a])],e.prototype,"titles",void 0),i([c],e)}(cc.Component);o.default=u,cc._RF.pop()},{}],HeroQualitySiftSelectionGroup:[function(t,e,o){"use strict";cc._RF.push(e,"777825WTodOmrViwoXlmCYE","HeroQualitySiftSelectionGroup");var r,n=this&&this.__extends||(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),i=this&&this.__decorate||function(t,e,o,r){var n,i=arguments.length,a=i<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,o):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,o,r);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(a=(i<3?n(a):i>3?n(e,o,a):n(e,o))||a);return i>3&&a&&Object.defineProperty(e,o,a),a};Object.defineProperty(o,"__esModule",{value:!0});var a=t("../../../../CoreModule/Components/SelectableGroup"),s=cc._decorator,c=s.ccclass,l=(s.property,function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),i([c],e)}(a.SelectableGroup));o.default=l,cc._RF.pop()},{"../../../../CoreModule/Components/SelectableGroup":"SelectableGroup"}],HeroQualitySiftSelection:[function(t,e,o){"use strict";cc._RF.push(e,"fd959gx0z9Bm4auzKdeqOgB","HeroQualitySiftSelection");var r,n=this&&this.__extends||(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),i=this&&this.__decorate||function(t,e,o,r){var n,i=arguments.length,a=i<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,o):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,o,r);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(a=(i<3?n(a):i>3?n(e,o,a):n(e,o))||a);return i>3&&a&&Object.defineProperty(e,o,a),a};Object.defineProperty(o,"__esModule",{value:!0});var a=t("../../../../CoreModule/Components/SelectableObject"),s=cc.Sprite,c=cc.SpriteFrame,l=cc.LabelOutline,u=cc.Color,p=cc._decorator,f=p.ccclass,d=p.property,h=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.quality=-1,e.picture=null,e.outline=null,e.pictures=[],e.container=null,e}return n(e,t),e.prototype.start=function(){},e.prototype.onDeselected=function(){this.picture.spriteFrame=this.pictures[1],this.outline.color=new u(104,104,104)},e.prototype.onSelected=function(){var t;this.picture.spriteFrame=this.pictures[0],this.outline.color=new u(134,118,79),null===(t=this.container)||void 0===t||t.onSelectionChange()},i([d(Number)],e.prototype,"quality",void 0),i([d(s)],e.prototype,"picture",void 0),i([d(l)],e.prototype,"outline",void 0),i([d([c])],e.prototype,"pictures",void 0),i([f],e)}(a.SelectableObject);o.default=h,cc._RF.pop()},{"../../../../CoreModule/Components/SelectableObject":"SelectableObject"}],HeroSelectContainer:[function(t,e,o){"use strict";cc._RF.push(e,"dea29uZUWxIW7fmkJuBhxnm","HeroSelectContainer");var r,n=this&&this.__extends||(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),i=this&&this.__decorate||function(t,e,o,r){var n,i=arguments.length,a=i<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,o):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,o,r);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(a=(i<3?n(a):i>3?n(e,o,a):n(e,o))||a);return i>3&&a&&Object.defineProperty(e,o,a),a},a=this&&this.__awaiter||function(t,e,o,r){return new(o||(o=Promise))(function(n,i){function a(t){try{c(r.next(t))}catch(e){i(e)}}function s(t){try{c(r.throw(t))}catch(e){i(e)}}function c(t){var e;t.done?n(t.value):(e=t.value,e instanceof o?e:new o(function(t){t(e)})).then(a,s)}c((r=r.apply(t,e||[])).next())})},s=this&&this.__generator||function(t,e){var o,r,n,i,a={label:0,sent:function(){if(1&n[0])throw n[1];return n[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(t){return function(e){return c([t,e])}}function c(i){if(o)throw new TypeError("Generator is already executing.");for(;a;)try{if(o=1,r&&(n=2&i[0]?r.return:i[0]?r.throw||((n=r.return)&&n.call(r),0):r.next)&&!(n=n.call(r,i[1])).done)return n;switch(r=0,n&&(i=[2&i[0],n.value]),i[0]){case 0:case 1:n=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,r=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(n=(n=a.trys).length>0&&n[n.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!n||i[1]>n[0]&&i[1]<n[3])){a.label=i[1];break}if(6===i[0]&&a.label<n[1]){a.label=n[1],n=i;break}if(n&&a.label<n[2]){a.label=n[2],a.ops.push(i);break}n[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(s){i=[6,s],r=0}finally{o=n=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}};Object.defineProperty(o,"__esModule",{value:!0});var c=t("../../../CoreModule/Managers/DataManager"),l=t("../../../PlayerModule/Managers/PlayerManager"),u=t("../../../CoreModule/Utils/ScrollviewFilter"),p=t("../../../CoreModule/Components/ItemContainer"),f=cc._decorator,d=f.ccclass,h=(f.property,function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.start=function(){this.setup().then()},e.prototype.setup=function(){return a(this,void 0,void 0,function(){var t,e;return s(this,function(o){switch(o.label){case 0:return t=l.playerMgr().player.account,[4,y.heroMgr().getListFromServer()];case 1:return e=o.sent().filter(function(e){return e.ownerAccount==t}),this.setItems(e),[2]}})})},e.prototype.update=function(){},e.prototype.onItemsChanged=function(){t.prototype.onItemsChanged.call(this);var e=[];this.itemsComponents.forEach(function(t){1==t.node.active&&e.push(t.node)}),u.ScrollviewFilter.filter("vertical",this.container,e,5,this.node.height,170),g.battleScene().currentPVPSelect=this.items[0],g.battleScene().heroSelected=!0},i([c.waitForDataLoad,l.waitForLogin],e.prototype,"setup",null),i([d],e)}(p.ItemContainer));o.default=h;var y=t("../../../HeroModule/Managers/HeroManager"),g=t("../../../../Scenes/BattleScene");cc._RF.pop()},{"../../../../Scenes/BattleScene":"BattleScene","../../../CoreModule/Components/ItemContainer":"ItemContainer","../../../CoreModule/Managers/DataManager":"DataManager","../../../CoreModule/Utils/ScrollviewFilter":"ScrollviewFilter","../../../HeroModule/Managers/HeroManager":"HeroManager","../../../PlayerModule/Managers/PlayerManager":"PlayerManager"}],HeroSelectDisplay:[function(t,e,o){"use strict";cc._RF.push(e,"f692a9U6PpGt5BUVaT8Vj5/","HeroSelectDisplay");var r,n=this&&this.__extends||(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),i=this&&this.__decorate||function(t,e,o,r){var n,i=arguments.length,a=i<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,o):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,o,r);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(a=(i<3?n(a):i>3?n(e,o,a):n(e,o))||a);return i>3&&a&&Object.defineProperty(e,o,a),a};Object.defineProperty(o,"__esModule",{value:!0});var a=cc.Label,s=cc.Sprite,c=cc.Button,l=cc.Node,u=cc.Layout,p=t("../../../../Utils/NumberUtils"),f=cc.SpriteFrame,d=t("../../../../Scenes/BattleScene"),h=t("../HeroWithAvatar"),y=cc._decorator,g=y.ccclass,v=y.property,b=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.nameLabel=null,e.levelLabel=null,e.qualityLabel=null,e.attackLabel=null,e.defenseLabel=null,e.healthLabel=null,e.qualityBackground=null,e.scissorsIcon=null,e.selectNode=null,e.selectPicture=null,e.selectButton=null,e.starNodes=[],e.starLayout=null,e.selectFrame=null,e.qualityPictures=[],e.scissorsPictures=[],e.buttonPictures=[],e}var o;return n(e,t),o=e,e.prototype.start=function(){this.setup()},e.prototype.setup=function(){this.selectPicture=this.selectNode.getComponent(s),this.selectButton=this.selectNode.getComponent(c)},e.prototype.onItemChanged=function(){t.prototype.onItemChanged.call(this),this.nameLabel.string=this.item.name,this.qualityLabel.string=this.item.qualityData.shortName,this.qualityBackground.spriteFrame=this.qualityPictures[this.item.quality],this.scissorsIcon.spriteFrame=this.scissorsPictures[this.item.restraint]},e.prototype.update=function(){this.item&&(this.updateLabels(),this.updatePictures(),this.updateNodes())},e.prototype.updateLabels=function(){this.levelLabel.string="Lv."+this.item.level.level,this.attackLabel.string=this.item.atk.toString(),this.defenseLabel.string=this.item.def.toString(),this.healthLabel.string=this.item.mhp.toString()},e.prototype.updatePictures=function(){},e.prototype.updateNodes=function(){var t=this;this.item.level.level>20*d.battleScene().currentPVPRoomIndex?(this.selectPicture.spriteFrame=this.buttonPictures[0],this.selectButton.interactable=!0):(this.selectPicture.spriteFrame=this.buttonPictures[1],this.selectButton.interactable=!1),this.starNodes.forEach(function(e,o){e.active=o<t.item.star.level}),this.starLayout.paddingLeft=o.leftPending[this.item.star.level-1],this.starLayout.spacingX=o.spacingX[this.item.star.level-1],this.selectFrame.active=d.battleScene().currentPVPSelect==this.item},e.prototype.selectBtn=function(){d.battleScene().currentPVPSelect=this.item,d.battleScene().heroSelected=!0},e.prototype.onAvatarClick=function(){d.battleScene().cultivateWindow.open(this.item)},e.spacingX=[0,0,-8,-18,-23],e.leftPending=[29,12,0,0,0],i([v(a)],e.prototype,"nameLabel",void 0),i([v(a)],e.prototype,"levelLabel",void 0),i([v(a)],e.prototype,"qualityLabel",void 0),i([v(a)],e.prototype,"attackLabel",void 0),i([v(a)],e.prototype,"defenseLabel",void 0),i([v(a)],e.prototype,"healthLabel",void 0),i([v(s)],e.prototype,"qualityBackground",void 0),i([v(s)],e.prototype,"scissorsIcon",void 0),i([v(l)],e.prototype,"selectNode",void 0),i([v([l])],e.prototype,"starNodes",void 0),i([v(u)],e.prototype,"starLayout",void 0),i([v(l)],e.prototype,"selectFrame",void 0),i([p.autoUnitConvert],e.prototype,"updateLabels",null),i([v([f])],e.prototype,"qualityPictures",void 0),i([v([f])],e.prototype,"scissorsPictures",void 0),i([v([f])],e.prototype,"buttonPictures",void 0),o=i([g],e)}(h.default);o.default=b,cc._RF.pop()},{"../../../../Scenes/BattleScene":"BattleScene","../../../../Utils/NumberUtils":"NumberUtils","../HeroWithAvatar":"HeroWithAvatar"}],HeroSystemConfig:[function(t,e,o){"use strict";cc._RF.push(e,"3101fZp/XBBsIc6m5qaUU36","HeroSystemConfig");var r,n=this&&this.__extends||(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),i=this&&this.__decorate||function(t,e,o,r){var n,i=arguments.length,a=i<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,o):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,o,r);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(a=(i<3?n(a):i>3?n(e,o,a):n(e,o))||a);return i>3&&a&&Object.defineProperty(e,o,a),a};Object.defineProperty(o,"__esModule",{value:!0}),o.HeroSystemConfig=void 0;var a=t("../../CoreModule/Data/BaseConfig"),s=t("../../CoreModule/Data/BaseData"),c=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.paramCalc={},e.level={},e.break={},e.strengthen={},e.star={},e}return n(e,t),i([s.field],e.prototype,"paramCalc",void 0),i([s.field],e.prototype,"level",void 0),i([s.field],e.prototype,"break",void 0),i([s.field],e.prototype,"strengthen",void 0),i([s.field],e.prototype,"star",void 0),i([a.config("HeroSystemConfig")],e)}(a.BaseConfig);o.HeroSystemConfig=c,cc._RF.pop()},{"../../CoreModule/Data/BaseConfig":"BaseConfig","../../CoreModule/Data/BaseData":"BaseData"}],HeroSystem:[function(require,module,exports){"use strict";cc._RF.push(module,"0e6afEXbmdDpL0VnzjLsy5h","HeroSystem");var __extends=this&&this.__extends||(extendStatics=function(t,e){return(extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}extendStatics(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),extendStatics,__decorate=this&&this.__decorate||function(t,e,o,r){var n,i=arguments.length,a=i<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,o):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,o,r);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(a=(i<3?n(a):i>3?n(e,o,a):n(e,o))||a);return i>3&&a&&Object.defineProperty(e,o,a),a};Object.defineProperty(exports,"__esModule",{value:!0}),exports.StarData=exports.StrengthenData=exports.BreakData=exports.LevelData=exports.ConfigurableHeroSystem=exports.HeroSystem=void 0;var BaseData_1=require("../../CoreModule/Data/BaseData"),Condition_1=require("../../PlayerModule/Data/Condition"),HeroSystemConfig_1=require("../Configs/HeroSystemConfig"),MathUtils_1=require("../../../Utils/MathUtils"),ConfigManager_1=require("../../CoreModule/Managers/ConfigManager"),HeroSystem=function(t){function e(e,o){var r=t.call(this,e)||this;return r.level=0,r.hero=o,r}return __extends(e,t),e.prototype.onCreated=function(){t.prototype.onCreated.call(this),this.level=MathUtils_1.MathUtils.clamp(this.level,this.minLevel,this.maxLevel)},Object.defineProperty(e.prototype,"minLevel",{get:function(){return 0},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"affectParams",{get:function(){return[]},enumerable:!1,configurable:!0}),e.prototype.isMax=function(){return this.level>=this.maxLevel},e.prototype.isMin=function(){return this.level<=this.minLevel},e.prototype.conditions=function(){var t=this;return Condition_1.ConditionGroup.create(Condition_1.cFun(function(){return t.level<t.maxLevel}),this.costs())},e.prototype.upgrade=function(){this.level=Math.min(this.level+1,this.maxLevel)},e.prototype.calc=function(t,e){return 0==this.affectParams.length||this.affectParams.includes(e)?this.doCalc(t,e):t},__decorate([BaseData_1.field],e.prototype,"level",void 0),e}(BaseData_1.BaseData);exports.HeroSystem=HeroSystem;var ConfigurableHeroSystem=function(_super){function ConfigurableHeroSystem(){return null!==_super&&_super.apply(this,arguments)||this}return __extends(ConfigurableHeroSystem,_super),Object.defineProperty(ConfigurableHeroSystem.prototype,"config",{get:function(){return ConfigManager_1.configMgr().config(HeroSystemConfig_1.HeroSystemConfig)[this.systemName]},enumerable:!1,configurable:!0}),Object.defineProperty(ConfigurableHeroSystem.prototype,"minLevel",{get:function(){return this.config.min},enumerable:!1,configurable:!0}),Object.defineProperty(ConfigurableHeroSystem.prototype,"maxLevel",{get:function(){return this.config.max},enumerable:!1,configurable:!0}),Object.defineProperty(ConfigurableHeroSystem.prototype,"affectParams",{get:function(){return Object.keys(this.config.params).map(function(t){return Number.parseInt(t)})},enumerable:!1,configurable:!0}),ConfigurableHeroSystem.prototype.costs=function(){var t=new Condition_1.ConditionGroup;for(var e in this.config.cost){var o=this.config.cost[e],r=this.eval(o);r&&t.add(Condition_1.cGte(e,r))}return t},ConfigurableHeroSystem.prototype.doCalc=function(t,e){var o=this.config.params[e],r=this.eval(o,t);return void 0===r?t:r},ConfigurableHeroSystem.prototype.eval=function(formula,val){var i=this.level,c=this.config;try{return eval(formula)}catch(e){console.error("\u5c5e\u6027\u8ba1\u7b97\u9519\u8bef\uff01",this,val,formula,e)}},ConfigurableHeroSystem}(HeroSystem);exports.ConfigurableHeroSystem=ConfigurableHeroSystem;var LevelData=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.curMaxLevel=ConfigManager_1.configMgr().config(HeroSystemConfig_1.HeroSystemConfig).level.defaultMax,e}return __extends(e,t),Object.defineProperty(e.prototype,"systemName",{get:function(){return"level"},enumerable:!1,configurable:!0}),e.prototype.conditions=function(){var e=this;return Condition_1.ConditionGroup.create(Condition_1.cFun(function(){return e.level<e.curMaxLevel}),t.prototype.conditions.call(this))},e.prototype.upgrade=function(){this.level>=this.curMaxLevel||t.prototype.upgrade.call(this)},e.prototype.breakEnable=function(){return this.level>=this.curMaxLevel&&this.curMaxLevel<=this.maxLevel},e.prototype.break=function(){this.curMaxLevel=Math.min(this.maxLevel,this.curMaxLevel+ConfigManager_1.configMgr().config(HeroSystemConfig_1.HeroSystemConfig).break.breakLevel)},__decorate([BaseData_1.field],e.prototype,"curMaxLevel",void 0),e}(ConfigurableHeroSystem);exports.LevelData=LevelData;var BreakData=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),Object.defineProperty(e.prototype,"systemName",{get:function(){return"break"},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"heroLevel",{get:function(){return this.hero.level},enumerable:!1,configurable:!0}),e.prototype.conditions=function(){var e=this;return Condition_1.ConditionGroup.create(Condition_1.cFun(function(){return e.heroLevel.breakEnable()}),t.prototype.conditions.call(this))},e.prototype.upgrade=function(){t.prototype.upgrade.call(this),this.hero.level.break()},e}(ConfigurableHeroSystem);exports.BreakData=BreakData;var StrengthenData=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),Object.defineProperty(e.prototype,"systemName",{get:function(){return"strengthen"},enumerable:!1,configurable:!0}),e}(ConfigurableHeroSystem);exports.StrengthenData=StrengthenData;var StarData=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),Object.defineProperty(e.prototype,"systemName",{get:function(){return"star"},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"costConfig",{get:function(){return this.config.costTable[this.hero.quality][this.level-1]},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"paramConfig",{get:function(){return this.config.paramTable[this.hero.quality][this.level-1]},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"affectParams",{get:function(){return this.paramConfig?Object.keys(this.paramConfig).map(function(t){return Number.parseInt(t)}):[]},enumerable:!1,configurable:!0}),e.prototype.doCalc=function(t,e){var o;return t+((null===(o=this.paramConfig)||void 0===o?void 0:o[e])||0)},e.prototype.costs=function(){var t=new Condition_1.ConditionGroup;if(!this.costConfig)return t;for(var e in this.costConfig)t.add(Condition_1.cGte(e,this.costConfig[e]));return t},e}(ConfigurableHeroSystem);exports.StarData=StarData,cc._RF.pop()},{"../../../Utils/MathUtils":"MathUtils","../../CoreModule/Data/BaseData":"BaseData","../../CoreModule/Managers/ConfigManager":"ConfigManager","../../PlayerModule/Data/Condition":"Condition","../Configs/HeroSystemConfig":"HeroSystemConfig"}],HeroTypeContainer:[function(t,e,o){"use strict";cc._RF.push(e,"26120u4zEJMvY7+nHBYd8YB","HeroTypeContainer");var r,n=this&&this.__extends||(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),i=this&&this.__decorate||function(t,e,o,r){var n,i=arguments.length,a=i<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,o):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,o,r);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(a=(i<3?n(a):i>3?n(e,o,a):n(e,o))||a);return i>3&&a&&Object.defineProperty(e,o,a),a},a=this&&this.__awaiter||function(t,e,o,r){return new(o||(o=Promise))(function(n,i){function a(t){try{c(r.next(t))}catch(e){i(e)}}function s(t){try{c(r.throw(t))}catch(e){i(e)}}function c(t){var e;t.done?n(t.value):(e=t.value,e instanceof o?e:new o(function(t){t(e)})).then(a,s)}c((r=r.apply(t,e||[])).next())})},s=this&&this.__generator||function(t,e){var o,r,n,i,a={label:0,sent:function(){if(1&n[0])throw n[1];return n[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(t){return function(e){return c([t,e])}}function c(i){if(o)throw new TypeError("Generator is already executing.");for(;a;)try{if(o=1,r&&(n=2&i[0]?r.return:i[0]?r.throw||((n=r.return)&&n.call(r),0):r.next)&&!(n=n.call(r,i[1])).done)return n;switch(r=0,n&&(i=[2&i[0],n.value]),i[0]){case 0:case 1:n=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,r=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(n=(n=a.trys).length>0&&n[n.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!n||i[1]>n[0]&&i[1]<n[3])){a.label=i[1];break}if(6===i[0]&&a.label<n[1]){a.label=n[1],n=i;break}if(n&&a.label<n[2]){a.label=n[2],a.ops.push(i);break}n[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(s){i=[6,s],r=0}finally{o=n=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}};Object.defineProperty(o,"__esModule",{value:!0});var c=t("../../../../Modules/CoreModule/Components/ItemContainer"),l=t("../../../../Modules/HeroModule/Data/HeroType"),u=t("../ItemPrefabs/HeroTypeDisplay"),p=t("../ItemPrefabs/HeroTypeSelection"),f=t("./HeroTypeSelectionGroup"),d=t("./PartsContainer"),h=t("../../../../Modules/CoreModule/Managers/DataManager"),y=cc._decorator,g=y.ccclass,v=y.property,b=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.partsContainer=null,e.selectionGroup=null,e}return n(e,t),e.prototype.start=function(){this.setItems(l.heroTypeRepo().list)},e.prototype.update=function(){var t=this;this.itemsComponents.forEach(function(e){return e.node.active?e.size=t.container.width/t.items.length:null})},e.prototype.updateSelectionGroup=function(){var t=this;this.selectionGroup=new f.default(!1),this.itemsComponents.forEach(function(e){var o=e.node.getComponent(p.default);o.display=o.getComponent(u.default),o.container=t,t.selectionGroup.addElement(o)})},e.prototype.onItemsChanged=function(){t.prototype.onItemsChanged.call(this),this.updateSelectionGroup()},e.prototype.onSelectChanged=function(t){return a(this,void 0,void 0,function(){return s(this,function(e){switch(e.label){case 0:return this.partsContainer.currentHeroType=t.item,[4,this.partsContainer.onHeroTypeChange()];case 1:return e.sent(),[4,this.partsContainer.onTypeChange()];case 2:return e.sent(),[2]}})})},i([v(d.default)],e.prototype,"partsContainer",void 0),i([h.waitForDataLoad],e.prototype,"start",null),i([g],e)}(c.ItemContainer);o.default=b,cc._RF.pop()},{"../../../../Modules/CoreModule/Components/ItemContainer":"ItemContainer","../../../../Modules/CoreModule/Managers/DataManager":"DataManager","../../../../Modules/HeroModule/Data/HeroType":"HeroType","../ItemPrefabs/HeroTypeDisplay":"HeroTypeDisplay","../ItemPrefabs/HeroTypeSelection":"HeroTypeSelection","./HeroTypeSelectionGroup":"HeroTypeSelectionGroup","./PartsContainer":"PartsContainer"}],HeroTypeDisplay:[function(t,e,o){"use strict";cc._RF.push(e,"51ea3Vclv1JFLeprV6UQQS+","HeroTypeDisplay");var r,n=this&&this.__extends||(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),i=this&&this.__decorate||function(t,e,o,r){var n,i=arguments.length,a=i<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,o):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,o,r);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(a=(i<3?n(a):i>3?n(e,o,a):n(e,o))||a);return i>3&&a&&Object.defineProperty(e,o,a),a};Object.defineProperty(o,"__esModule",{value:!0});var a=t("../../../../Modules/CoreModule/Components/ItemDisplay"),s=cc.Label,c=cc.Node,l=cc.Color,u=t("../../SelectorScene"),p=cc._decorator,f=p.ccclass,d=p.property,h=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.label=null,e.background=null,e.size=0,e.isSelected=!1,e}return n(e,t),e.prototype.start=function(){},e.prototype.refresh=function(){t.prototype.refresh.call(this),null!=this.item&&(this.isSelected=!1,this.label.string=this.item.getDisplayName(),u.selectorScene().editorMode&&(this.label.string=this.item.id+" "+this.label.string))},e.prototype.update=function(){this.node.width=Math.max(this.size,50),this.label.node.color=this.isSelected?new l(255,255,255):new l(159,157,180),this.background.opacity=this.isSelected?255:0},e.prototype.onSelectChanged=function(t){this.isSelected=t},i([d(s)],e.prototype,"label",void 0),i([d(c)],e.prototype,"background",void 0),i([f],e)}(a.ItemDisplay);o.default=h,cc._RF.pop()},{"../../../../Modules/CoreModule/Components/ItemDisplay":"ItemDisplay","../../SelectorScene":"SelectorScene"}],HeroTypeSelectionGroup:[function(t,e,o){"use strict";cc._RF.push(e,"e4437lzHBtK97IaCQosha4f","HeroTypeSelectionGroup");var r,n=this&&this.__extends||(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),i=this&&this.__decorate||function(t,e,o,r){var n,i=arguments.length,a=i<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,o):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,o,r);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(a=(i<3?n(a):i>3?n(e,o,a):n(e,o))||a);return i>3&&a&&Object.defineProperty(e,o,a),a};Object.defineProperty(o,"__esModule",{value:!0});var a=t("../../../../Modules/CoreModule/Components/SelectableGroup"),s=cc._decorator,c=s.ccclass,l=(s.property,function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),i([c],e)}(a.SelectableGroup));o.default=l,cc._RF.pop()},{"../../../../Modules/CoreModule/Components/SelectableGroup":"SelectableGroup"}],HeroTypeSelection:[function(t,e,o){"use strict";cc._RF.push(e,"a52ffoyg7tHnYRmSIjyzUWH","HeroTypeSelection");var r,n=this&&this.__extends||(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),i=this&&this.__decorate||function(t,e,o,r){var n,i=arguments.length,a=i<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,o):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,o,r);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(a=(i<3?n(a):i>3?n(e,o,a):n(e,o))||a);return i>3&&a&&Object.defineProperty(e,o,a),a};Object.defineProperty(o,"__esModule",{value:!0});var a=t("../../../../Modules/CoreModule/Components/SelectableObject"),s=cc._decorator,c=s.ccclass,l=(s.property,function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.display=null,e.container=null,e}return n(e,t),e.prototype.onDeselected=function(){this.display.onSelectChanged(!1)},e.prototype.onSelected=function(){this.display.onSelectChanged(!0),this.container.onSelectChanged(this.display).then()},i([c],e)}(a.SelectableObject));o.default=l,cc._RF.pop()},{"../../../../Modules/CoreModule/Components/SelectableObject":"SelectableObject"}],HeroType:[function(t,e,o){"use strict";cc._RF.push(e,"01480OCqktJl79puUlYvqaE","HeroType");var r,n=this&&this.__extends||(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),i=this&&this.__decorate||function(t,e,o,r){var n,i=arguments.length,a=i<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,o):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,o,r);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(a=(i<3?n(a):i>3?n(e,o,a):n(e,o))||a);return i>3&&a&&Object.defineProperty(e,o,a),a};Object.defineProperty(o,"__esModule",{value:!0}),o.HeroTypeRepo=o.heroTypeRepo=o.HeroType=o.HeroRace=void 0;var a,s=t("../../CoreModule/Managers/AssetBundleManager"),c=t("../../CoreModule/Data/BaseData"),l=t("../../NFTModule/Managers/NFTManager"),u=t("../../CoreModule/Data/BaseRepository"),p=t("./Part"),f=t("../../CoreModule/Data/StaticData"),d=sp.SkeletonData;(function(t){t[t.Race0=0]="Race0",t[t.Race1=1]="Race1",t[t.Race2=2]="Race2",t[t.Race3=3]="Race3",t[t.None=4]="None"})(a=o.HeroRace||(o.HeroRace={}));var h=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.bt1=l.DefaultBt1,e.bt2=l.DefaultBt2,e.race=a.Race0,e.scale=1,e.defaultParts=[],e.defaultSkeletonName=null,e.createEnable=!0,e}return n(e,t),e.prototype.getDefaultParts=function(){var t=this;return p.partRepo().list.filter(function(e){return t.defaultParts.indexOf(e.id)>=0})},i([c.field],e.prototype,"bt1",void 0),i([c.field],e.prototype,"bt2",void 0),i([c.field],e.prototype,"race",void 0),i([c.field],e.prototype,"scale",void 0),i([c.field([Number])],e.prototype,"defaultParts",void 0),i([c.field(String)],e.prototype,"defaultSkeletonName",void 0),i([c.field],e.prototype,"createEnable",void 0),i([c.assetField(d,s.BundleName.Sprites,"parts/${defaultSkeletonName}")],e.prototype,"defaultSkeleton",void 0),i([f.data("HeroType")],e)}(f.StaticData);o.HeroType=h,o.heroTypeRepo=function(){return u.getRepository(y)};var y=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),Object.defineProperty(e.prototype,"clazz",{get:function(){return h},enumerable:!1,configurable:!0}),i([u.repository],e)}(u.BaseRepository);o.HeroTypeRepo=y,cc._RF.pop()},{"../../CoreModule/Data/BaseData":"BaseData","../../CoreModule/Data/BaseRepository":"BaseRepository","../../CoreModule/Data/StaticData":"StaticData","../../CoreModule/Managers/AssetBundleManager":"AssetBundleManager","../../NFTModule/Managers/NFTManager":"NFTManager","./Part":"Part"}],HeroWithAvatar:[function(t,e,o){"use strict";cc._RF.push(e,"f52farU0D9MZKW8YA7NMQr1","HeroWithAvatar");var r,n=this&&this.__extends||(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),i=this&&this.__decorate||function(t,e,o,r){var n,i=arguments.length,a=i<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,o):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,o,r);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(a=(i<3?n(a):i>3?n(e,o,a):n(e,o))||a);return i>3&&a&&Object.defineProperty(e,o,a),a};Object.defineProperty(o,"__esModule",{value:!0});var a=t("../../CoreModule/Components/ItemDisplay"),s=t("../../../Utils/SpineUtils"),c=cc._decorator.ccclass,l=cc._decorator.property,u=sp.Skeleton,p=cc.Node,f=cc.instantiate,d=t("../../../Scenes/BattleScene"),h=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.avatar=null,e.size=100,e.avatarHeight=0,e.avatarWidth=0,e.avatarOffsetX=0,e.avatarOffsetY=0,e}return n(e,t),e.prototype.start=function(){},e.prototype.onItemChanged=function(){t.prototype.onItemChanged.call(this),this.drawAvatar()},e.prototype.drawAvatar=function(){var t=this;this.avatar.node.scale=0;var e=f(d.battleScene().loading);e.parent=this.avatar.node.parent,e.scale=this.size/e.width*.7;var o=new p("node"),r=o.addComponent(u),n=new s.HeroSkeleton(this.avatar,r,this.item.heroTypeId);this.item.parts.forEach(function(t){n.addPart(t)}),n.refresh().then(function(){o.destroy();var r=n.findBone("head_1");n.skeleton.updateWorldTransform();for(var i=r.worldX,a=r.worldY;r.parent;)r=r.parent;r.x-=i,r.y-=a;var s=n.findSlot("head_1");s.getAttachment()&&(t.avatarHeight=s.getAttachment().height,t.avatarWidth=s.getAttachment().width,t.avatarOffsetY=s.getAttachment().x,t.avatarOffsetX=s.getAttachment().y,t.sizeFilter(),e.destroy())})},e.prototype.sizeFilter=function(){var t=Math.min(this.avatarWidth/this.size,this.avatarHeight/this.size);t*=1.2,this.avatar.node.y=-this.avatarOffsetY/t,this.avatar.node.scale=t>1?1/t:1},i([l(u)],e.prototype,"avatar",void 0),i([l(Number)],e.prototype,"size",void 0),i([c],e)}(a.ItemDisplay);o.default=h,cc._RF.pop()},{"../../../Scenes/BattleScene":"BattleScene","../../../Utils/SpineUtils":"SpineUtils","../../CoreModule/Components/ItemDisplay":"ItemDisplay"}],Hero:[function(require,module,exports){"use strict";cc._RF.push(module,"08ef232IV5NaYObM0DQqDRT","Hero");var __extends=this&&this.__extends||(extendStatics=function(t,e){return(extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}extendStatics(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),extendStatics,__decorate=this&&this.__decorate||function(t,e,o,r){var n,i=arguments.length,a=i<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,o):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,o,r);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(a=(i<3?n(a):i>3?n(e,o,a):n(e,o))||a);return i>3&&a&&Object.defineProperty(e,o,a),a};Object.defineProperty(exports,"__esModule",{value:!0}),exports.Hero=exports.SuitPattern=exports.RestraintType=exports.HeroState=void 0;var DynamicData_1=require("../../CoreModule/Data/DynamicData"),NFTManager_1=require("../../NFTModule/Managers/NFTManager"),Quality_1=require("./Quality"),Part_1=require("./Part"),HeroType_1=require("./HeroType"),HeroSystem_1=require("./HeroSystem"),BaseData_1=require("../../CoreModule/Data/BaseData"),Param_1=require("./Param"),MathUtils_1=require("../../../Utils/MathUtils"),ConfigManager_1=require("../../CoreModule/Managers/ConfigManager"),HeroSystemConfig_1=require("../Configs/HeroSystemConfig"),PartType_1=require("./PartType"),HeroState,RestraintType;(function(t){t[t.NotCreated=0]="NotCreated",t[t.Created=1]="Created",t[t.Destroyed=2]="Destroyed"})(HeroState=exports.HeroState||(exports.HeroState={})),function(t){t[t.Red=0]="Red",t[t.Green=1]="Green",t[t.Blue=2]="Blue"}(RestraintType=exports.RestraintType||(exports.RestraintType={})),exports.SuitPattern=[[[1,1,1,1,1]],[[2,1,1,1]],[[2,2,1],[3,1,1]],[[4,1],[3,2]],[[5]]];var Hero=function(_super){function Hero(){var t=null!==_super&&_super.apply(this,arguments)||this;return t.nftId="",t.bt1=NFTManager_1.DefaultBt1,t.bt2=NFTManager_1.DefaultBt2,t.chainId=NFTManager_1.DefaultChainId,t.restraint=RestraintType.Red,t.variation=!1,t.params=[],t.addedParams=[],t.skillIds=[],t.suitPattern=[],t.partIds=[],t.price=0,t.state=HeroState.NotCreated,t}return __extends(Hero,_super),Hero.prototype.onCreated=function(){_super.prototype.onCreated.call(this),this.initHeroSystems()},Object.defineProperty(Hero.prototype,"heroType",{get:function(){return HeroType_1.heroTypeRepo().getById(this.heroTypeId)},enumerable:!1,configurable:!0}),Object.defineProperty(Hero.prototype,"skeleton",{get:function(){var t;return null===(t=this.heroType)||void 0===t?void 0:t.defaultSkeleton},enumerable:!1,configurable:!0}),Object.defineProperty(Hero.prototype,"parts",{get:function(){return this._parts||(this._parts=this.partIds.map(function(t){return Part_1.partRepo().getById(t)}))},enumerable:!1,configurable:!0}),Object.defineProperty(Hero.prototype,"bodyPart",{get:function(){return this.parts.find(function(t){return t.partType.special===PartType_1.SpecialPartType.Body})},enumerable:!1,configurable:!0}),Object.defineProperty(Hero.prototype,"weaponPart",{get:function(){return this.parts.find(function(t){return t.partType.special===PartType_1.SpecialPartType.Weapon})},enumerable:!1,configurable:!0}),Object.defineProperty(Hero.prototype,"race",{get:function(){return this.heroType.race},enumerable:!1,configurable:!0}),Object.defineProperty(Hero.prototype,"qualityData",{get:function(){return Quality_1.qualityRepo().getById(this.quality)},enumerable:!1,configurable:!0}),Hero.prototype.initHeroSystems=function(){this.level||(this.level=new HeroSystem_1.LevelData(null,this)),this.break||(this.break=new HeroSystem_1.BreakData(null,this)),this.strengthen||(this.strengthen=new HeroSystem_1.StrengthenData(null,this)),this.star||(this.star=new HeroSystem_1.StarData(null,this))},Object.defineProperty(Hero.prototype,"battlePoint",{get:function(){var t=this;return Param_1.paramRepo().find().reduce(function(e,o){return e+t.param(o.id)*o.battlePoint},0)},enumerable:!1,configurable:!0}),Object.defineProperty(Hero.prototype,"heroSystems",{get:function(){return this._heroSystems||(this._heroSystems=[this.break,this.strengthen,this.star])},enumerable:!1,configurable:!0}),Hero.prototype.param=function(t){var e=this,o=Param_1.paramRepo().find(),r=Param_1.paramRepo().getById(t),n=o.filter(function(e){return e.bonus.includes(t)}),i=this.heroSystems.reduce(function(e,o){return o.calc(e,t)},this.baseParam(t))*n.reduce(function(t,o){return t*e.param(o.id)},1);return r.isPercent||(i=Math.round(i)),MathUtils_1.MathUtils.clamp(i,r.min,r.max)},Object.defineProperty(Hero.prototype,"battleLevel",{get:function(){return this.level.level},enumerable:!1,configurable:!0}),Object.defineProperty(Hero.prototype,"battleParams",{get:function(){var t=this;return Param_1.paramRepo().find().map(function(e){return t.param(e.id)})},enumerable:!1,configurable:!0}),Hero.prototype.baseParam=function(index){var param=Param_1.paramRepo().getById(index),base=this.params[index]||param.default_,config=ConfigManager_1.configMgr().config(HeroSystemConfig_1.HeroSystemConfig).paramCalc;if(index in config){var level=this.level.calc(0,index),pow=this.pow,agi=this.agi,int=this.int;try{base+=eval(config[index])}catch(e){console.error("\u8ba1\u7b97\u516c\u5f0f\u6709\u8bef\uff01",index,config,{level:level,pow:pow,agi:agi,int:int})}}return base},Object.defineProperty(Hero.prototype,"cp",{get:function(){return this.param(Param_1.ParamType.CP)},enumerable:!1,configurable:!0}),Object.defineProperty(Hero.prototype,"cpb",{get:function(){return this.param(Param_1.ParamType.CPB)},enumerable:!1,configurable:!0}),Object.defineProperty(Hero.prototype,"hid",{get:function(){return this.param(Param_1.ParamType.HID)},enumerable:!1,configurable:!0}),Object.defineProperty(Hero.prototype,"pow",{get:function(){return this.param(Param_1.ParamType.POW)},enumerable:!1,configurable:!0}),Object.defineProperty(Hero.prototype,"agi",{get:function(){return this.param(Param_1.ParamType.AGI)},enumerable:!1,configurable:!0}),Object.defineProperty(Hero.prototype,"int",{get:function(){return this.param(Param_1.ParamType.INT)},enumerable:!1,configurable:!0}),Object.defineProperty(Hero.prototype,"powb",{get:function(){return this.param(Param_1.ParamType.POWB)},enumerable:!1,configurable:!0}),Object.defineProperty(Hero.prototype,"agib",{get:function(){return this.param(Param_1.ParamType.AGIB)},enumerable:!1,configurable:!0}),Object.defineProperty(Hero.prototype,"intb",{get:function(){return this.param(Param_1.ParamType.INTB)},enumerable:!1,configurable:!0}),Object.defineProperty(Hero.prototype,"atk",{get:function(){return this.param(Param_1.ParamType.ATK)},enumerable:!1,configurable:!0}),Object.defineProperty(Hero.prototype,"cri",{get:function(){return this.param(Param_1.ParamType.CRI)},enumerable:!1,configurable:!0}),Object.defineProperty(Hero.prototype,"dmg",{get:function(){return this.param(Param_1.ParamType.DMG)},enumerable:!1,configurable:!0}),Object.defineProperty(Hero.prototype,"atkb",{get:function(){return this.param(Param_1.ParamType.ATKB)},enumerable:!1,configurable:!0}),Object.defineProperty(Hero.prototype,"crib",{get:function(){return this.param(Param_1.ParamType.CRIB)},enumerable:!1,configurable:!0}),Object.defineProperty(Hero.prototype,"dmgb",{get:function(){return this.param(Param_1.ParamType.DMGB)},enumerable:!1,configurable:!0}),Object.defineProperty(Hero.prototype,"def",{get:function(){return this.param(Param_1.ParamType.DEF)},enumerable:!1,configurable:!0}),Object.defineProperty(Hero.prototype,"avo",{get:function(){return this.param(Param_1.ParamType.AVO)},enumerable:!1,configurable:!0}),Object.defineProperty(Hero.prototype,"eva",{get:function(){return this.param(Param_1.ParamType.EVA)},enumerable:!1,configurable:!0}),Object.defineProperty(Hero.prototype,"defb",{get:function(){return this.param(Param_1.ParamType.DEFB)},enumerable:!1,configurable:!0}),Object.defineProperty(Hero.prototype,"avob",{get:function(){return this.param(Param_1.ParamType.AVOB)},enumerable:!1,configurable:!0}),Object.defineProperty(Hero.prototype,"evab",{get:function(){return this.param(Param_1.ParamType.EVAB)},enumerable:!1,configurable:!0}),Object.defineProperty(Hero.prototype,"mhp",{get:function(){return this.param(Param_1.ParamType.MHP)},enumerable:!1,configurable:!0}),Object.defineProperty(Hero.prototype,"spd",{get:function(){return this.param(Param_1.ParamType.SPD)},enumerable:!1,configurable:!0}),Object.defineProperty(Hero.prototype,"hit",{get:function(){return this.param(Param_1.ParamType.HIT)},enumerable:!1,configurable:!0}),Object.defineProperty(Hero.prototype,"mhpb",{get:function(){return this.param(Param_1.ParamType.MHPB)},enumerable:!1,configurable:!0}),Object.defineProperty(Hero.prototype,"spdb",{get:function(){return this.param(Param_1.ParamType.SPDB)},enumerable:!1,configurable:!0}),Object.defineProperty(Hero.prototype,"hitb",{get:function(){return this.param(Param_1.ParamType.HITB)},enumerable:!1,configurable:!0}),Object.defineProperty(Hero.prototype,"ab1",{get:function(){return this.param(Param_1.ParamType.AB1)},enumerable:!1,configurable:!0}),Object.defineProperty(Hero.prototype,"ab2",{get:function(){return this.param(Param_1.ParamType.AB2)},enumerable:!1,configurable:!0}),Object.defineProperty(Hero.prototype,"ab3",{get:function(){return this.param(Param_1.ParamType.AB3)},enumerable:!1,configurable:!0}),Object.defineProperty(Hero.prototype,"ab4",{get:function(){return this.param(Param_1.ParamType.AB4)},enumerable:!1,configurable:!0}),Object.defineProperty(Hero.prototype,"bp",{get:function(){return this.param(Param_1.ParamType.BP)},enumerable:!1,configurable:!0}),Object.defineProperty(Hero.prototype,"bpb",{get:function(){return this.param(Param_1.ParamType.BPB)},enumerable:!1,configurable:!0}),Hero.create=function(t,e,o,r){var n=new Hero;return n.nftId="LOC_"+MathUtils_1.MathUtils.randomString(),n.creatorAccount=n.ownerAccount=t,n.heroTypeId=e,n.partIds=o,n.name=r,n},Hero.createRandomQuality=function(){},__decorate([BaseData_1.field,BaseData_1.dataPK],Hero.prototype,"nftId",void 0),__decorate([BaseData_1.field],Hero.prototype,"bt1",void 0),__decorate([BaseData_1.field],Hero.prototype,"bt2",void 0),__decorate([BaseData_1.field],Hero.prototype,"chainId",void 0),__decorate([BaseData_1.field(Number)],Hero.prototype,"heroTypeId",void 0),__decorate([BaseData_1.field(String)],Hero.prototype,"creatorAccount",void 0),__decorate([BaseData_1.field(String)],Hero.prototype,"ownerAccount",void 0),__decorate([BaseData_1.field(String)],Hero.prototype,"name",void 0),__decorate([BaseData_1.field(String)],Hero.prototype,"avatarUrl",void 0),__decorate([BaseData_1.field(String)],Hero.prototype,"description",void 0),__decorate([BaseData_1.field(HeroSystem_1.LevelData)],Hero.prototype,"level",void 0),__decorate([BaseData_1.field(HeroSystem_1.BreakData)],Hero.prototype,"break",void 0),__decorate([BaseData_1.field(HeroSystem_1.StrengthenData)],Hero.prototype,"strengthen",void 0),__decorate([BaseData_1.field(HeroSystem_1.StarData)],Hero.prototype,"star",void 0),__decorate([BaseData_1.field(Number)],Hero.prototype,"quality",void 0),__decorate([BaseData_1.field],Hero.prototype,"restraint",void 0),__decorate([BaseData_1.field],Hero.prototype,"variation",void 0),__decorate([BaseData_1.field(Number)],Hero.prototype,"rank",void 0),__decorate([BaseData_1.field([Number])],Hero.prototype,"params",void 0),__decorate([BaseData_1.field([Number])],Hero.prototype,"addedParams",void 0),__decorate([BaseData_1.field([Number])],Hero.prototype,"skillIds",void 0),__decorate([BaseData_1.field([Number])],Hero.prototype,"suitPattern",void 0),__decorate([BaseData_1.field([Number])],Hero.prototype,"partIds",void 0),__decorate([BaseData_1.field(Number)],Hero.prototype,"createdAt",void 0),__decorate([BaseData_1.field],Hero.prototype,"price",void 0),__decorate([BaseData_1.field],Hero.prototype,"state",void 0),__decorate([BaseData_1.field(Object)],Hero.prototype,"rawData",void 0),Hero}(DynamicData_1.DynamicData);exports.Hero=Hero,cc._RF.pop()},{"../../../Utils/MathUtils":"MathUtils","../../CoreModule/Data/BaseData":"BaseData","../../CoreModule/Data/DynamicData":"DynamicData","../../CoreModule/Managers/ConfigManager":"ConfigManager","../../NFTModule/Managers/NFTManager":"NFTManager","../Configs/HeroSystemConfig":"HeroSystemConfig","./HeroSystem":"HeroSystem","./HeroType":"HeroType","./Param":"Param","./Part":"Part","./PartType":"PartType","./Quality":"Quality"}],HitDamage:[function(t,e,o){"use strict";cc._RF.push(e,"e4d9a8BKwhN67vz4Njxs0ro","HitDamage");var r,n=this&&this.__extends||(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),i=this&&this.__decorate||function(t,e,o,r){var n,i=arguments.length,a=i<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,o):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,o,r);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(a=(i<3?n(a):i>3?n(e,o,a):n(e,o))||a);return i>3&&a&&Object.defineProperty(e,o,a),a};Object.defineProperty(o,"__esModule",{value:!0}),o.HitType=void 0;var a,s=cc.Node,c=cc.Label,l=cc.Font,u=cc._decorator,p=u.ccclass,f=u.property,d=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.speedX=0,e.speedY=0,e.accelerationY=200,e.timer=.5,e.scaleSpeed=2,e.disappearSpeed=1e3,e.maxScale=1,e.atlas=[],e.miss=null,e}return n(e,t),e.prototype.start=function(){this.node.scaleX=0,this.node.scaleY=0},e.prototype.update=function(t){this.timer<=0&&(this.node.opacity-=this.disappearSpeed*t,this.node.opacity<=0&&this.node.destroy()),this.updateScale(t),this.updatePosition(t),this.timer-=t},e.prototype.updateScale=function(t){this.node.scaleX=Math.min(this.maxScale,this.node.scaleX+3*t*this.maxScale),this.node.scaleY=Math.min(this.maxScale,this.node.scaleY+3*t*this.maxScale)},e.prototype.updatePosition=function(t){this.node.x+=this.speedX*t,this.node.y+=this.speedY*t,this.speedY+=this.accelerationY*t},e.prototype.setValue=function(t){this.getComponent(c).string=""+t},e.prototype.setPosition=function(t,e){this.node.x=t,this.node.y=e},e.prototype.setRange=function(t,e){var o=Math.random()*t-t/2,r=Math.random()*e-e/2;this.node.x+=o,this.node.y+=r,this.speedX=Math.min(150,Math.max(-150,o))},e.prototype.setType=function(t){if(t==a.Miss)return this.miss.active=!0,void(this.getComponent(c).string="");this.miss.active=!1,this.getComponent(c).font=this.atlas[t]},i([f(Number)],e.prototype,"speedX",void 0),i([f(Number)],e.prototype,"speedY",void 0),i([f(Number)],e.prototype,"accelerationY",void 0),i([f(Number)],e.prototype,"timer",void 0),i([f(Number)],e.prototype,"scaleSpeed",void 0),i([f(Number)],e.prototype,"disappearSpeed",void 0),i([f(Number)],e.prototype,"maxScale",void 0),i([f([l])],e.prototype,"atlas",void 0),i([f(s)],e.prototype,"miss",void 0),i([p],e)}(cc.Component);o.default=d,function(t){t[t.Normal=0]="Normal",t[t.Critical=1]="Critical",t[t.Recover=2]="Recover",t[t.Miss=3]="Miss"}(a=o.HitType||(o.HitType={})),cc._RF.pop()},{}],I18nManager:[function(t,e,o){"use strict";cc._RF.push(e,"b0f0epEmqhLHKkVWMtnUGs5","I18nManager");var r,n=this&&this.__extends||(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),i=this&&this.__decorate||function(t,e,o,r){var n,i=arguments.length,a=i<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,o):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,o,r);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(a=(i<3?n(a):i>3?n(e,o,a):n(e,o))||a);return i>3&&a&&Object.defineProperty(e,o,a),a},a=this&&this.__awaiter||function(t,e,o,r){return new(o||(o=Promise))(function(n,i){function a(t){try{c(r.next(t))}catch(e){i(e)}}function s(t){try{c(r.throw(t))}catch(e){i(e)}}function c(t){var e;t.done?n(t.value):(e=t.value,e instanceof o?e:new o(function(t){t(e)})).then(a,s)}c((r=r.apply(t,e||[])).next())})},s=this&&this.__generator||function(t,e){var o,r,n,i,a={label:0,sent:function(){if(1&n[0])throw n[1];return n[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(t){return function(e){return c([t,e])}}function c(i){if(o)throw new TypeError("Generator is already executing.");for(;a;)try{if(o=1,r&&(n=2&i[0]?r.return:i[0]?r.throw||((n=r.return)&&n.call(r),0):r.next)&&!(n=n.call(r,i[1])).done)return n;switch(r=0,n&&(i=[2&i[0],n.value]),i[0]){case 0:case 1:n=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,r=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(n=(n=a.trys).length>0&&n[n.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!n||i[1]>n[0]&&i[1]<n[3])){a.label=i[1];break}if(6===i[0]&&a.label<n[1]){a.label=n[1],n=i;break}if(n&&a.label<n[2]){a.label=n[2],a.ops.push(i);break}n[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(s){i=[6,s],r=0}finally{o=n=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}};Object.defineProperty(o,"__esModule",{value:!0}),o.getLanguage=o.Languages=o.i18nMgr=void 0;var c=t("./BaseManager"),l=cc.SpriteFrame,u=cc.JsonAsset,p=t("../../../Utils/PromiseUtils"),f=t("./AssetBundleManager");function d(t){return o.Languages.indexOf(t)}o.i18nMgr=function(){return c.getManager(h)},o.Languages=["zh","ko","ja","en"],o.getLanguage=d;var h=function(t){function e(){var e=t.call(this)||this;return e.curLanguage="zh",e.registeredLabels=[],e.registeredSprites=[],e.loadTranslation().then(),e}return n(e,t),e.prototype.loadTranslation=function(){var t;return a(this,void 0,void 0,function(){var e;return s(this,function(o){switch(o.label){case 0:return[4,p.PromiseUtils.waitFor(function(){return f.assetMgr&&!!f.assetMgr()})];case 1:return o.sent(),this.translation?[3,3]:(e=this,[4,f.assetMgr().loadAsset(u,f.BundleName.Data,"translation")]);case 2:e.translation=null===(t=o.sent())||void 0===t?void 0:t.json,o.label=3;case 3:return[2]}})})},e.prototype.getKey=function(t){return this.translation&&this.translation[t]},e.prototype.makeStr=function(t,e){return void 0===e&&(e=""),this.getKey(t)?"\\L["+t+"]":e},e.prototype.t=function(t){for(var e=d(this.curLanguage),o="",r=0;r<t.length;r++)if(t.startsWith("\\L[",r)){r+=3;for(var n="";"]"!=t.charAt(r);)n+=t.charAt(r),r++;if(null==this.translation){o+="{!"+n+"!}";continue}var i=this.translation[n];null==i||null==i[e]?o+="{!"+n+"!}":o+=i[e]}else o+=t.charAt(r);return o},e.prototype.ts=function(t){return a(this,void 0,void 0,function(){var e,o;return s(this,function(r){switch(r.label){case 0:return e=d(this.curLanguage),[4,this.loadSpriteFrame(f.BundleName.Sprites,t+"$"+e)];case 1:return(o=r.sent())?[3,3]:[4,this.loadSpriteFrame(f.BundleName.Sprites,t)];case 2:o=r.sent(),r.label=3;case 3:return[2,o]}})})},e.prototype.loadSpriteFrame=function(t,e){return f.assetMgr().loadAsset(l,t,e)},e.prototype.registerLabel=function(t){this.unregisterLabel(t),this.registeredLabels.push(t)},e.prototype.unregisterLabel=function(t){var e=this.registeredLabels.indexOf(t);-1!=e&&this.registeredLabels.splice(e,1)},e.prototype.registerSprite=function(t){this.unregisterSprite(t),this.registeredSprites.push(t)},e.prototype.unregisterSprite=function(t){var e=this.registeredSprites.indexOf(t);-1!=e&&this.registeredSprites.splice(e,1)},e.prototype.setLanguage=function(t){this.curLanguage!=t&&(this.curLanguage=t,this.updateUIs())},e.prototype.getCurrentLanguage=function(){return this.curLanguage},e.prototype.updateUIs=function(){this.registeredLabels.forEach(function(t){return t.updateText()}),this.registeredSprites.forEach(function(t){return t.updateSprite()})},i([c.manager],e)}(c.BaseManager);cc._RF.pop()},{"../../../Utils/PromiseUtils":"PromiseUtils","./AssetBundleManager":"AssetBundleManager","./BaseManager":"BaseManager"}],ISelectableObject:[function(t,e,o){"use strict";cc._RF.push(e,"cecfeEInv1BVKUrU9/B4JLz","ISelectableObject"),Object.defineProperty(o,"__esModule",{value:!0}),cc._RF.pop()},{}],ImportWindow:[function(t,e,o){"use strict";cc._RF.push(e,"79f81VoND9GBKuQ+CgeDS4+","ImportWindow");var r,n=this&&this.__extends||(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),i=this&&this.__decorate||function(t,e,o,r){var n,i=arguments.length,a=i<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,o):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,o,r);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(a=(i<3?n(a):i>3?n(e,o,a):n(e,o))||a);return i>3&&a&&Object.defineProperty(e,o,a),a};Object.defineProperty(o,"__esModule",{value:!0});var a=t("../../SelectorScene"),s=t("../../../../Modules/CoreModule/Managers/ConfigManager"),c=t("../../../../Modules/HeroModule/Configs/PartConfig"),l=cc.EditBox,u=cc.Component,p=t("../../../../Modules/CoreModule/Managers/AlertManager"),f=cc._decorator,d=f.ccclass,h=f.property,y=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.importInput=null,e}return n(e,t),e.prototype.show=function(){this.node.active=!0},e.prototype.close=function(){this.node.active=!1},e.prototype.import=function(){var t=this.importInput.string;try{var e=JSON.parse(t),o=s.configMgr().config(c.default);Object.assign(o,e),console.log(e," -> ",o),p.alertMgr().alert("\u5bfc\u5165\u6210\u529f\uff01","",p.AlertDialogType.OK).then(),a.selectorScene().globalEditor.refresh(),a.selectorScene().singleEditor.refresh(),this.close()}catch(r){p.alertMgr().alert("\u5bfc\u5165\u6570\u636e\u683c\u5f0f\u4e0d\u6b63\u786e\uff01","",p.AlertDialogType.OK).then()}},i([h(l)],e.prototype,"importInput",void 0),i([d],e)}(u);o.default=y,cc._RF.pop()},{"../../../../Modules/CoreModule/Managers/AlertManager":"AlertManager","../../../../Modules/CoreModule/Managers/ConfigManager":"ConfigManager","../../../../Modules/HeroModule/Configs/PartConfig":"PartConfig","../../SelectorScene":"SelectorScene"}],ItemContainer:[function(t,e,o){"use strict";cc._RF.push(e,"1a1b4wExd9Gmpt4emoPlkU1","ItemContainer");var r,n=this&&this.__extends||(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),i=this&&this.__decorate||function(t,e,o,r){var n,i=arguments.length,a=i<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,o):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,o,r);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(a=(i<3?n(a):i>3?n(e,o,a):n(e,o))||a);return i>3&&a&&Object.defineProperty(e,o,a),a};Object.defineProperty(o,"__esModule",{value:!0}),o.ItemContainer=void 0;var a=t("./ItemDisplay"),s=cc._decorator,c=s.ccclass,l=s.property,u=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.container=null,e.prefab=null,e.items=[],e.itemsComponents=[],e.itemCount=0,e}return n(e,t),e.prototype.isInclude=function(){return!0},e.prototype.setItems=function(t){var e=this;this.items=t.filter(function(t){return e.isInclude(t)}),this.onItemsChanged()},e.prototype.onItemsChanged=function(){this.refresh()},e.prototype.refresh=function(){this.refreshComponents()},e.prototype.refreshComponents=function(){for(var t=0;t<this.items.length;t++)t>=this.itemsComponents.length?this.createItemDisplay():this.itemsComponents[t].node.active=!0,this.itemsComponents[t].setItem(this.items[t]);for(t=this.items.length;t<this.itemsComponents.length;t++)this.itemsComponents[t].node.active=!1;this.itemCount=this.items.length},e.prototype.createItemDisplay=function(){var t=cc.instantiate(this.prefab);t.parent=this.container;var e=t.getComponent(a.ItemDisplay);return this.onItemDisplayCreated(e),this.itemsComponents.push(e),e},e.prototype.onItemDisplayCreated=function(){},i([l(cc.Node)],e.prototype,"container",void 0),i([l(cc.Prefab)],e.prototype,"prefab",void 0),i([c],e)}(cc.Component);o.ItemContainer=u,cc._RF.pop()},{"./ItemDisplay":"ItemDisplay"}],ItemDisplay:[function(t,e,o){"use strict";cc._RF.push(e,"c09ccjk9K5PKpp6vCSWt5T8","ItemDisplay");var r,n=this&&this.__extends||(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),i=this&&this.__decorate||function(t,e,o,r){var n,i=arguments.length,a=i<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,o):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,o,r);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(a=(i<3?n(a):i>3?n(e,o,a):n(e,o))||a);return i>3&&a&&Object.defineProperty(e,o,a),a};Object.defineProperty(o,"__esModule",{value:!0}),o.ItemDisplay=void 0;var a=cc._decorator,s=a.ccclass,c=(a.property,function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.item=null,e}return n(e,t),e.prototype.start=function(){},e.prototype.setItem=function(t){this.item=t,this.onItemChanged()},e.prototype.onItemChanged=function(){this.refresh()},e.prototype.refresh=function(){},i([s],e)}(cc.Component));o.ItemDisplay=c,cc._RF.pop()},{}],JobContainer:[function(t,e,o){"use strict";cc._RF.push(e,"09dc6kK0w5MAbjm0f6dzPdr","JobContainer");var r,n=this&&this.__extends||(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),i=this&&this.__decorate||function(t,e,o,r){var n,i=arguments.length,a=i<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,o):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,o,r);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(a=(i<3?n(a):i>3?n(e,o,a):n(e,o))||a);return i>3&&a&&Object.defineProperty(e,o,a),a};Object.defineProperty(o,"__esModule",{value:!0});var a=t("../../../CoreModule/Components/ItemContainer"),s=t("../../../EconomicModule/Data/Job"),c=t("../../../CoreModule/Utils/ScrollviewFilter"),l=t("../../../EconomicModule/Data/PlayerJob"),u=t("../../../PlayerModule/Managers/PlayerManager"),p=t("../../../CoreModule/Managers/DataManager"),f=t("../../../EconomicModule/Manager/EconomicManager"),d=cc._decorator,h=d.ccclass,y=(d.property,function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.start=function(){this.setup()},e.prototype.setup=function(){var t=u.playerMgr().getPlayerData(l.PlayerJob),e=s.jobRepo().list;this.setItems(e.map(function(e){return t.job(e.id)})),f.economicMgr().playerJob=t,f.economicMgr().jobItems=e.map(function(e){return t.job(e.id)})},e.prototype.onItemsChanged=function(){t.prototype.onItemsChanged.call(this);var e=[];this.itemsComponents.forEach(function(t){return t.node.active&&e.push(t.node)}),c.ScrollviewFilter.filter("vertical",this.container,e,5,this.node.height,170)},i([p.waitForDataLoad,u.waitForLogin],e.prototype,"setup",null),i([h],e)}(a.ItemContainer));o.default=y,cc._RF.pop()},{"../../../CoreModule/Components/ItemContainer":"ItemContainer","../../../CoreModule/Managers/DataManager":"DataManager","../../../CoreModule/Utils/ScrollviewFilter":"ScrollviewFilter","../../../EconomicModule/Data/Job":"Job","../../../EconomicModule/Data/PlayerJob":"PlayerJob","../../../EconomicModule/Manager/EconomicManager":"EconomicManager","../../../PlayerModule/Managers/PlayerManager":"PlayerManager"}],JobDisplay:[function(t,e,o){"use strict";cc._RF.push(e,"3f29dV4gDVFz67Oq4aKALds","JobDisplay");var r,n=this&&this.__extends||(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),i=this&&this.__decorate||function(t,e,o,r){var n,i=arguments.length,a=i<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,o):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,o,r);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(a=(i<3?n(a):i>3?n(e,o,a):n(e,o))||a);return i>3&&a&&Object.defineProperty(e,o,a),a};Object.defineProperty(o,"__esModule",{value:!0});var a=t("../../../CoreModule/Components/ItemDisplay"),s=cc.Label,c=cc.Node,l=cc.Button,u=cc.ProgressBar,p=t("../../../../Utils/NumberUtils"),f=t("../../../../Utils/DateUtils"),d=t("../../../EconomicModule/Manager/EconomicManager"),h=cc.Animation,y=cc._decorator,g=y.ccclass,v=y.property,b=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.profitLabel=null,e.profitLabel2=null,e.upgradeLabel=null,e.upgradeTips=null,e.titleLabel=null,e.timerLabel=null,e.levelLabel=null,e.numberLabel=null,e.infoNode=null,e.profitNode=null,e.iconNode=null,e.autoIconNode=null,e.upgradeNode=null,e.upgradeButton=null,e.progressBar=null,e.levelProgress=null,e.levelUpAnimation=null,e}return n(e,t),e.prototype.start=function(){this.setup()},e.prototype.setup=function(){this.upgradeButton=this.upgradeNode.getComponent(l)},Object.defineProperty(e.prototype,"restSecond",{get:function(){var t=0==this.item.curLevel?0:Math.floor((Date.now()-this.item.lastProfitTime)/1e3);return this.item.job.time-t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"restSecondRate",{get:function(){var t=0==this.item.curLevel?0:(Date.now()-this.item.lastProfitTime)/1e3;return 1-Math.min(.98,t/this.item.job.time)},enumerable:!1,configurable:!0}),e.prototype.refresh=function(){t.prototype.refresh.call(this),this.drawTitle(),this.drawNodes(),this.drawLabels(),this.drawPictures()},e.prototype.drawTitle=function(){this.titleLabel.string=this.item.job.getDisplayName(),this.numberLabel.string=this.item.jobId.toString()},e.prototype.drawNodes=function(){var t=this.item.isAutoProfit,e=this.item.profitConditions().judge();this.autoIconNode.active=t&&this.item.curLevel>0,this.profitNode.active=!t&&e,this.infoNode.active=!e,this.iconNode.active=!t||this.item.curLevel<=0},e.prototype.drawLabels=function(){var t=this.item.upgradeCosts(),e=this.item.profitRewards(),o=0==this.item.curLevel,r=this.item.curLevel>=this.item.job.maxLevel;this.levelLabel.string="Lv."+this.item.curLevel,this.profitLabel.string=this.profitLabel2.string=e.gold.value.toString(),this.upgradeLabel.string=(r?0:t.gold.value).toString(),this.upgradeTips.string=o?"\\L[SJob7]":r?"\\L[SJob10]":"\\L[SJob3]",this.timerLabel.string=f.DateUtils.sec2Str(this.restSecond)},e.prototype.drawPictures=function(){var t=this.item.curLevel<=0?this.item.unlockConditions().judge():this.item.upgradeConditions().judge();this.upgradeButton&&(this.upgradeButton.interactable=t),this.progressBar.progress=this.restSecondRate,this.levelProgress.progress=this.item.curLevel/this.item.job.maxLevel},e.prototype.profitBtn=function(){d.economicMgr().profit(this.item.jobId).then()},e.prototype.upgradeBtn=function(){var t=this;d.economicMgr().upgrade(this.item.jobId).then(function(){return t.levelUpAnimation.play()})},e.prototype.update=function(){this.item&&this.updateDraw()},e.prototype.updateDraw=function(){this.drawNodes(),this.drawLabels(),this.drawPictures()},i([v(s)],e.prototype,"profitLabel",void 0),i([v(s)],e.prototype,"profitLabel2",void 0),i([v(s)],e.prototype,"upgradeLabel",void 0),i([v(s)],e.prototype,"upgradeTips",void 0),i([v(s)],e.prototype,"titleLabel",void 0),i([v(s)],e.prototype,"timerLabel",void 0),i([v(s)],e.prototype,"levelLabel",void 0),i([v(s)],e.prototype,"numberLabel",void 0),i([v(c)],e.prototype,"infoNode",void 0),i([v(c)],e.prototype,"profitNode",void 0),i([v(c)],e.prototype,"iconNode",void 0),i([v(c)],e.prototype,"autoIconNode",void 0),i([v(c)],e.prototype,"upgradeNode",void 0),i([v(u)],e.prototype,"progressBar",void 0),i([v(u)],e.prototype,"levelProgress",void 0),i([v(h)],e.prototype,"levelUpAnimation",void 0),i([p.autoUnitConvert],e.prototype,"drawLabels",null),i([g],e)}(a.ItemDisplay);o.default=b,cc._RF.pop()},{"../../../../Utils/DateUtils":"DateUtils","../../../../Utils/NumberUtils":"NumberUtils","../../../CoreModule/Components/ItemDisplay":"ItemDisplay","../../../EconomicModule/Manager/EconomicManager":"EconomicManager"}],Job:[function(t,e,o){"use strict";cc._RF.push(e,"ffaaeXAkJ1AH4hCmmDnMfl5","Job");var r,n=this&&this.__extends||(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),i=this&&this.__decorate||function(t,e,o,r){var n,i=arguments.length,a=i<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,o):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,o,r);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(a=(i<3?n(a):i>3?n(e,o,a):n(e,o))||a);return i>3&&a&&Object.defineProperty(e,o,a),a};Object.defineProperty(o,"__esModule",{value:!0}),o.JobRepo=o.jobRepo=o.Job=void 0;var a=t("../../CoreModule/Data/BaseData"),s=t("../../CoreModule/Data/BaseRepository"),c=t("../../CoreModule/Data/StaticData"),l=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.time=-1,e.maxLevel=100,e.unlockParams=[],e.profitParams=[],e.upgradeParams=[],e}return n(e,t),Object.defineProperty(e.prototype,"unlockGold",{get:function(){return this.unlockParams[1]},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"unlockReturnTime",{get:function(){return this.unlockParams[0]||0},enumerable:!1,configurable:!0}),e.prototype.profit=function(t){return this.profitParams[0]+this.profitParams[1]*t},e.prototype.upgradeGold=function(t){return this.upgradeParams[0]+this.upgradeParams[1]*t},i([a.field(Number)],e.prototype,"time",void 0),i([a.field(Number)],e.prototype,"maxLevel",void 0),i([a.field([Number])],e.prototype,"unlockParams",void 0),i([a.field([Number])],e.prototype,"profitParams",void 0),i([a.field([Number])],e.prototype,"upgradeParams",void 0),i([c.data("Job")],e)}(c.StaticData);o.Job=l,o.jobRepo=function(){return s.getRepository(u)};var u=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),Object.defineProperty(e.prototype,"clazz",{get:function(){return l},enumerable:!1,configurable:!0}),i([s.repository],e)}(s.BaseRepository);o.JobRepo=u,cc._RF.pop()},{"../../CoreModule/Data/BaseData":"BaseData","../../CoreModule/Data/BaseRepository":"BaseRepository","../../CoreModule/Data/StaticData":"StaticData"}],LanguageSwitch:[function(t,e,o){"use strict";cc._RF.push(e,"a2fcdGtkp5Fipu9Dtno5Rxv","LanguageSwitch");var r,n=this&&this.__extends||(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),i=this&&this.__decorate||function(t,e,o,r){var n,i=arguments.length,a=i<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,o):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,o,r);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(a=(i<3?n(a):i>3?n(e,o,a):n(e,o))||a);return i>3&&a&&Object.defineProperty(e,o,a),a};Object.defineProperty(o,"__esModule",{value:!0});var a=cc._decorator.ccclass,s=cc._decorator.property,c=t("../Managers/I18nManager"),l=cc.Toggle,u=cc.Node,p=cc.Label,f=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.toggles=[],e}return n(e,t),e.prototype.onEnable=function(){var t=c.getLanguage(c.i18nMgr().getCurrentLanguage());this.toggles[t].check(),this.onClick(this.toggles[t])},e.prototype.onClick=function(t){if(t.isChecked){var e=this.toggles.indexOf(t);c.i18nMgr().setLanguage(c.Languages[e]),this.languageLabel.string=t.getComponentInChildren(p).string}},e.prototype.setWindowVisible=function(t,e){console.log(e),this.langSwitchWindow.active="true"==e},i([s(u)],e.prototype,"langSwitchWindow",void 0),i([s([l])],e.prototype,"toggles",void 0),i([s(p)],e.prototype,"languageLabel",void 0),i([a],e)}(cc.Component);o.default=f,cc._RF.pop()},{"../Managers/I18nManager":"I18nManager"}],LoadingManager:[function(t,e,o){"use strict";cc._RF.push(e,"55082VyyhdAc5UkSKX337Xz","LoadingManager");var r,n=this&&this.__extends||(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),i=this&&this.__decorate||function(t,e,o,r){var n,i=arguments.length,a=i<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,o):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,o,r);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(a=(i<3?n(a):i>3?n(e,o,a):n(e,o))||a);return i>3&&a&&Object.defineProperty(e,o,a),a},a=this&&this.__awaiter||function(t,e,o,r){return new(o||(o=Promise))(function(n,i){function a(t){try{c(r.next(t))}catch(e){i(e)}}function s(t){try{c(r.throw(t))}catch(e){i(e)}}function c(t){var e;t.done?n(t.value):(e=t.value,e instanceof o?e:new o(function(t){t(e)})).then(a,s)}c((r=r.apply(t,e||[])).next())})},s=this&&this.__generator||function(t,e){var o,r,n,i,a={label:0,sent:function(){if(1&n[0])throw n[1];return n[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(t){return function(e){return c([t,e])}}function c(i){if(o)throw new TypeError("Generator is already executing.");for(;a;)try{if(o=1,r&&(n=2&i[0]?r.return:i[0]?r.throw||((n=r.return)&&n.call(r),0):r.next)&&!(n=n.call(r,i[1])).done)return n;switch(r=0,n&&(i=[2&i[0],n.value]),i[0]){case 0:case 1:n=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,r=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(n=(n=a.trys).length>0&&n[n.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!n||i[1]>n[0]&&i[1]<n[3])){a.label=i[1];break}if(6===i[0]&&a.label<n[1]){a.label=n[1],n=i;break}if(n&&a.label<n[2]){a.label=n[2],a.ops.push(i);break}n[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(s){i=[6,s],r=0}finally{o=n=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}};Object.defineProperty(o,"__esModule",{value:!0}),o.peekLoadingInfo=o.loadingMgr=o.blockLoading=o.showLoading=o.GameLoading=void 0;var c=t("./BaseManager"),l=cc.director;function u(){return c.getManager(f)}o.GameLoading=function(t,e,o,r,n){void 0===r&&(r=1),void 0===n&&(n=!1),this.code=t,this.title=e,this.detail=o,this.maxValue=r,this.showImmediately=n},o.showLoading=function(t,e,o){var r=!e&&!o,n=function(o,n,i){var c=i.value;i.value=function(){for(var o=[],n=0;n<arguments.length;n++)o[n]=arguments[n];return a(this,void 0,void 0,function(){var n,i;return s(this,function(a){switch(a.label){case 0:return n=r?"function"==typeof t?t(e):t:void 0,i=u().startLoading(n),[4,c.apply(this,o).finally(function(){return null==i?void 0:i.finish()})];case 1:return[2,a.sent()]}})})}};if(r)return n;n(0,0,o)},o.blockLoading=function(t,e,o){var r=o.value,n=u();o.value=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];n.isBlocked=!0;try{return r.apply(this,t)}finally{n.isBlocked=!1}}},o.loadingMgr=u,o.peekLoadingInfo=function(){return u().peekLatestLoadingInfo()};var p,f=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.loadingInfo=[],e.isBlocked=!1,e}return n(e,t),e.prototype.startLoading=function(t){if(t||(t=h.CoreLoading.Default),"function"==typeof t&&(t=t()),this.isBlocked||!1===(null==t?void 0:t.enable))return null;var e=t.title,o=t.detail;if(t.code){var r="LOAD"+t.code;if(e=y.i18nMgr().getKey(r)?"\\L["+r+"]":e,!o){var n=r+"_DETAIL";o=y.i18nMgr().getKey(n)?"\\L["+n+"]":""}}return this.pushLoadingInfo(e,o,t.maxValue,t.showImmediately)},e.prototype.pushLoadingInfo=function(t,e,o,r){var n=new d(t,e,o,r);return this.loadingInfo.push(n),n},e.prototype.peekLatestLoadingInfo=function(){return this.loadingInfo[this.loadingInfo.length-1]},e.prototype.popLatestLoadingInfo=function(){this.loadingInfo.pop()},i([c.manager],e)}(c.BaseManager);(function(t){t[t.NOT_STARTED=0]="NOT_STARTED",t[t.LOADING=1]="LOADING",t[t.FINISHED=2]="FINISHED"})(p||(p={}));var d=function(){function t(t,e,o,r){this.title=t,this.detail=e,this.currentValue=0,this.maxValue=o,this.startTime=l.getTotalTime()-(r?1e9:0),this.state=p.NOT_STARTED}return t.prototype.updateProgress=function(t,e){void 0===e&&(e=void 0),this.currentValue=t,null!=e&&(this.maxValue=e),this.currentValue>=this.maxValue&&this.markFinished()},t.prototype.updateLoadingText=function(t){this.title=t},t.prototype.updateReminder=function(t){this.detail=t},Object.defineProperty(t.prototype,"isNotStarted",{get:function(){return this.state==p.NOT_STARTED},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"isLoading",{get:function(){return this.state==p.LOADING},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"isFinished",{get:function(){return this.state==p.FINISHED},enumerable:!1,configurable:!0}),t.prototype.markStarted=function(){this.state=p.LOADING},t.prototype.markFinished=function(){this.state=p.FINISHED},t.prototype.finish=function(){this.updateProgress(this.maxValue)},t}(),h=t("../Common/CoreCommon"),y=t("./I18nManager");cc._RF.pop()},{"../Common/CoreCommon":"CoreCommon","./BaseManager":"BaseManager","./I18nManager":"I18nManager"}],LoadingMask:[function(t,e,o){"use strict";cc._RF.push(e,"63761phe3ZJ3ZGkH1Ax6tDL","LoadingMask");var r,n=this&&this.__extends||(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),i=this&&this.__decorate||function(t,e,o,r){var n,i=arguments.length,a=i<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,o):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,o,r);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(a=(i<3?n(a):i>3?n(e,o,a):n(e,o))||a);return i>3&&a&&Object.defineProperty(e,o,a),a};Object.defineProperty(o,"__esModule",{value:!0});var a=cc.ProgressBar,s=cc.Label,c=t("../Managers/LoadingManager"),l=cc.BlockInputEvents,u=cc._decorator,p=u.ccclass,f=u.property,d=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.progressBar=null,e}return n(e,t),e.prototype.start=function(){this.node.opacity=0},e.prototype.update=function(){var t=c.peekLoadingInfo();if(t)if(t.isNotStarted&&(t.markStarted(),this.loadingLabel.string=t.title,this.node.opacity=0,this.blockInput()),t.isFinished){c.loadingMgr().popLatestLoadingInfo(),this.node.opacity=0,this.unblockInput();var e=c.peekLoadingInfo();null!=e&&(e.startTime-=1e9)}else cc.director.getTotalTime()-t.startTime>100&&!t.isFinished&&(this.node.opacity=255),this.progressBar&&(this.progressBar.progress=t.currentValue/t.maxValue),this.loadingLabel&&(this.loadingLabel.string=t.title),this.detailLabel&&(this.detailLabel.string=t.detail)},e.prototype.blockInput=function(){this.inputBlocker.enabled=!0},e.prototype.unblockInput=function(){this.inputBlocker.enabled=!1},i([f(a)],e.prototype,"progressBar",void 0),i([f(s)],e.prototype,"loadingLabel",void 0),i([f(s)],e.prototype,"detailLabel",void 0),i([f(l)],e.prototype,"inputBlocker",void 0),i([p],e)}(cc.Component);o.default=d,cc._RF.pop()},{"../Managers/LoadingManager":"LoadingManager"}],LocalizedLabel:[function(t,e,o){"use strict";cc._RF.push(e,"0a08ajaF8BCt7avQSiazXPM","LocalizedLabel");var r,n=this&&this.__extends||(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),i=this&&this.__decorate||function(t,e,o,r){var n,i=arguments.length,a=i<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,o):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,o,r);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(a=(i<3?n(a):i>3?n(e,o,a):n(e,o))||a);return i>3&&a&&Object.defineProperty(e,o,a),a};Object.defineProperty(o,"__esModule",{value:!0}),o.LocalizedLabel=void 0;var a=cc.Label,s=t("../Managers/I18nManager"),c=cc._decorator,l=c.ccclass,u=(c.property,function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),Object.defineProperty(e.prototype,"string",{get:function(){return this.prevRawText},set:function(t){this.prevRawText=t,this.prevLocalizedText=this.label.string=s.i18nMgr().t(t)},enumerable:!1,configurable:!0}),e.prototype.start=function(){s.i18nMgr().registerLabel(this)},e.prototype.onEnable=function(){this.label=this.getComponent(a),this.label?this.string=this.label.string:console.log("i18nLabel\u6ca1\u6709\u5bf9\u5e94\u7684Label")},e.prototype.onDisable=function(){},e.prototype.updateText=function(){this.string=this.prevRawText},e.prototype.update=function(){this.label.string!=this.prevLocalizedText&&(this.string=this.label.string)},e.prototype.lateUpdate=function(t){this.update(t)},i([l],e)}(cc.Component));o.LocalizedLabel=u,cc._RF.pop()},{"../Managers/I18nManager":"I18nManager"}],LocalizedSprite:[function(t,e,o){"use strict";cc._RF.push(e,"45126biQNtBSZj4rop5RB1S","LocalizedSprite");var r,n=this&&this.__extends||(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),i=this&&this.__decorate||function(t,e,o,r){var n,i=arguments.length,a=i<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,o):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,o,r);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(a=(i<3?n(a):i>3?n(e,o,a):n(e,o))||a);return i>3&&a&&Object.defineProperty(e,o,a),a};Object.defineProperty(o,"__esModule",{value:!0}),o.LocalizedSprite=void 0;var a=cc.Sprite,s=t("../Managers/I18nManager"),c=cc._decorator,l=c.ccclass,u=c.property,p=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.SpriteName="",e}return n(e,t),Object.defineProperty(e.prototype,"spriteName",{get:function(){return this.SpriteName},set:function(t){var e=this;this.SpriteName=t,s.i18nMgr().ts(t).then(function(t){e.sprite.spriteFrame=t})},enumerable:!1,configurable:!0}),e.prototype.onEnable=function(){this.sprite=this.getComponent(a),null!=this.sprite?(s.i18nMgr().registerSprite(this),this.spriteName=this.SpriteName):console.log("i18nSprite\u6ca1\u6709\u5bf9\u5e94\u7684Sprite")},e.prototype.onDisable=function(){t.prototype.onDisable.call(this),s.i18nMgr().unregisterSprite(this)},e.prototype.updateSprite=function(){this.spriteName=this.spriteName},e.prototype.test33=function(){this.spriteName="loc/test"==this.spriteName?"loc/tt":"loc/test"},i([u],e.prototype,"SpriteName",void 0),i([l],e)}(cc.Component);o.LocalizedSprite=p,cc._RF.pop()},{"../Managers/I18nManager":"I18nManager"}],MainBattleDisplay:[function(t,e,o){"use strict";cc._RF.push(e,"261fa7WGG5IKKZupQqYhFoF","MainBattleDisplay");var r,n=this&&this.__extends||(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),i=this&&this.__decorate||function(t,e,o,r){var n,i=arguments.length,a=i<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,o):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,o,r);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(a=(i<3?n(a):i>3?n(e,o,a):n(e,o))||a);return i>3&&a&&Object.defineProperty(e,o,a),a};Object.defineProperty(o,"__esModule",{value:!0});var a=t("../BattleDisplay"),s=t("../StageProgressController"),c=t("../../../PlayerModule/Managers/PlayerManager"),l=t("../../../CoreModule/Managers/DataManager"),u=t("../../../CopyModule/Managers/CopyManager"),p=t("../../../CopyModule/Data/Copy"),f=cc.Label,d=cc.Prefab,h=cc.Sprite,y=cc.Node,g=cc.instantiate,v=cc._decorator,b=v.ccclass,m=v.property,_=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.mapName=null,e.progressContainer=null,e.progressPrefab=null,e.backgroundSprite=null,e.enemies=[],e.currentLevel=1,e}return n(e,t),e.prototype.start=function(){t.prototype.start.call(this),this.initProgress()},e.prototype.refresh=function(){t.prototype.refresh.call(this);var e=(this.item.level-1)%15+1,o=p.copyRepo().main().level(this.item.level-1);this.mapName.string=o.displayName+(e<10?"0":"")+e,this.setMap()},e.prototype.update=function(e){this.item&&(t.prototype.update.call(this,e),this.updateStageProgress(),this.judgeCopySettlement())},e.prototype.updateStageProgress=function(){var t=this,e=u.copyMgr().getMainPlayerCopy().curLevel;e>this.currentLevel&&this.nextStage(),e<this.currentLevel&&this.lastStage(),this.enemies.forEach(function(o){return o.enemyIndex=o.stageIndex<e?5:o.stageIndex>e?0:t.enemyIndex()})},e.prototype.judgeCopySettlement=function(){0!=this.item.winner||this.isSettled||null==this.item.copyId||null==this.item.level||(this.isSettled=!0)},e.prototype.enemyIndex=function(){var t;return this.item&&this.item.state<5?1+(null===(t=this.item)||void 0===t?void 0:t.battlers.filter(function(t){return 1==t.camp&&t.isDead}).length):0},e.prototype.initProgress=function(){this.currentLevel=Math.max(1,u.copyMgr().getMainPlayerCopy().curLevel-1),this.enemies=[];for(var t=0;t<2;t++){var e=g(this.progressPrefab);e.parent=this.progressContainer;var o=e.getComponent(s.default);o.init(t+this.currentLevel,t),this.enemies.push(o)}},e.prototype.nextStage=function(){var t=this;this.currentLevel++;var e=g(this.progressPrefab);e.parent=this.progressContainer,e.opacity=0;var o=e.getComponent(s.default);o.init(this.currentLevel+1,2),this.enemies.push(o),this.enemies.forEach(function(e,o){e.node?e.nextStage():t.enemies.splice(o,1)})},e.prototype.lastStage=function(){var t=this;if(1!=this.currentLevel){if(this.currentLevel--,this.currentLevel>1){var e=g(this.progressPrefab);e.parent=this.progressContainer,e.opacity=0;var o=e.getComponent(s.default);o.init(this.currentLevel-1,-2),this.enemies.push(o)}this.enemies.forEach(function(e,o){e.node?e.lastStage():t.enemies.splice(o,1)})}},e.prototype.setMap=function(){this.backgroundSprite.spriteFrame=p.copyRepo().main().level(this.item.level-1).mapPicture},i([m(f)],e.prototype,"mapName",void 0),i([m(y)],e.prototype,"progressContainer",void 0),i([m(d)],e.prototype,"progressPrefab",void 0),i([m(h)],e.prototype,"backgroundSprite",void 0),i([c.waitForLogin,l.waitForDataLoad],e.prototype,"initProgress",null),i([b],e)}(a.default);o.default=_,cc._RF.pop()},{"../../../CopyModule/Data/Copy":"Copy","../../../CopyModule/Managers/CopyManager":"CopyManager","../../../CoreModule/Managers/DataManager":"DataManager","../../../PlayerModule/Managers/PlayerManager":"PlayerManager","../BattleDisplay":"BattleDisplay","../StageProgressController":"StageProgressController"}],MainMenuController:[function(t,e,o){"use strict";cc._RF.push(e,"4132eUafIhM1bOBfcuGUzoT","MainMenuController");var r,n=this&&this.__extends||(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),i=this&&this.__decorate||function(t,e,o,r){var n,i=arguments.length,a=i<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,o):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,o,r);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(a=(i<3?n(a):i>3?n(e,o,a):n(e,o))||a);return i>3&&a&&Object.defineProperty(e,o,a),a};Object.defineProperty(o,"__esModule",{value:!0});var a=cc.Component,s=cc.Sprite,c=cc.SpriteFrame,l=t("./MainMenuItemSelectionGroup"),u=t("./MainMenuItemSelection"),p=cc.Node,f=cc.Color,d=cc._decorator,h=d.ccclass,y=d.property,g=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.backgroundSprites=[],e.iconSprites=[],e.textNodes=[],e.playerWindows=[],e.backgroundSelect=null,e.iconSelect=[],e.backgroundUnselect=null,e.iconUnselect=[],e.redPointTips=[],e.isLoad=!1,e.selectionGroup=null,e.selections=[],e}return n(e,t),e.prototype.start=function(){},e.prototype.setup=function(){var t=this;this.selectionGroup=new l.default(!1),this.selections.forEach(function(e){t.selectionGroup.addElement(e),e.menu=t}),this.selectionGroup.select(this.selections[1]),this.selectionGroup.select(this.selections[0]),this.isLoad=!0},e.prototype.update=function(){(this.isLoad||(this.setup(),this.isLoad))&&this.updateTips()},e.prototype.updateTips=function(){this.redPointTips[2].active=Date.now()%1e4>=5e3},e.prototype.onSelectChanged=function(t){var e=this;this.backgroundSprites.forEach(function(o,r){o.spriteFrame=r==t?e.backgroundSelect:e.backgroundUnselect}),this.iconSprites.forEach(function(o,r){o.spriteFrame=r==t?e.iconSelect[r]:e.iconUnselect[r]}),this.textNodes.forEach(function(e,o){e.color=o==t?new f(250,235,204):new f(68,58,46)}),this.playerWindows.forEach(function(e,o){e.active=o==t})},i([y([s])],e.prototype,"backgroundSprites",void 0),i([y([s])],e.prototype,"iconSprites",void 0),i([y([p])],e.prototype,"textNodes",void 0),i([y([p])],e.prototype,"playerWindows",void 0),i([y(c)],e.prototype,"backgroundSelect",void 0),i([y([c])],e.prototype,"iconSelect",void 0),i([y(c)],e.prototype,"backgroundUnselect",void 0),i([y([c])],e.prototype,"iconUnselect",void 0),i([y([p])],e.prototype,"redPointTips",void 0),i([y([u.default])],e.prototype,"selections",void 0),i([h],e)}(a);o.default=g,cc._RF.pop()},{"./MainMenuItemSelection":"MainMenuItemSelection","./MainMenuItemSelectionGroup":"MainMenuItemSelectionGroup"}],MainMenuItemSelectionGroup:[function(t,e,o){"use strict";cc._RF.push(e,"84bd5CHiZdAhp7h2XZqncpY","MainMenuItemSelectionGroup");var r,n=this&&this.__extends||(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),i=this&&this.__decorate||function(t,e,o,r){var n,i=arguments.length,a=i<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,o):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,o,r);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(a=(i<3?n(a):i>3?n(e,o,a):n(e,o))||a);return i>3&&a&&Object.defineProperty(e,o,a),a};Object.defineProperty(o,"__esModule",{value:!0});var a=t("../../../CoreModule/Components/SelectableGroup"),s=cc._decorator,c=s.ccclass,l=(s.property,function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),i([c],e)}(a.SelectableGroup));o.default=l,cc._RF.pop()},{"../../../CoreModule/Components/SelectableGroup":"SelectableGroup"}],MainMenuItemSelection:[function(t,e,o){"use strict";cc._RF.push(e,"4e9bdCl5XhDDKH3h0Fm2Grk","MainMenuItemSelection");var r,n=this&&this.__extends||(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),i=this&&this.__decorate||function(t,e,o,r){var n,i=arguments.length,a=i<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,o):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,o,r);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(a=(i<3?n(a):i>3?n(e,o,a):n(e,o))||a);return i>3&&a&&Object.defineProperty(e,o,a),a};Object.defineProperty(o,"__esModule",{value:!0});var a=t("../../../CoreModule/Components/SelectableObject"),s=cc._decorator,c=s.ccclass,l=(s.property,function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.menu=null,e}return n(e,t),e.prototype.onDeselected=function(){},e.prototype.onSelected=function(){var t;null===(t=this.menu)||void 0===t||t.onSelectChanged(this.selectableGroup.indexOf(this))},i([c],e)}(a.SelectableObject));o.default=l,cc._RF.pop()},{"../../../CoreModule/Components/SelectableObject":"SelectableObject"}],MathUtils:[function(t,e,o){"use strict";cc._RF.push(e,"e9b87Xt64BDnLliqQkxbygv","MathUtils"),Object.defineProperty(o,"__esModule",{value:!0}),o.MathUtils=void 0;var r=function(){function t(){}return t.clamp=function(t,e,o){return Math.max(Math.min(t,o),e)},t.random=function(t,e){return void 0===t&&(t=0),void 0===e&&(e=1),Math.random()*(e-t)+t},t.randomString=function(t){void 0===t&&(t=32);for(var e="ABCDEFGHJKMNPQRSTWXYZabcdefhijkmnprstwxyz2345678",o=e.length,r="",n=0;n<t;n++)r+=e.charAt(Math.floor(Math.random()*o));return r},t.randomPick=function(t){return t[Math.floor(Math.random()*t.length)]},t.randomPickMany=function(t,e,o){void 0===o&&(o=!1);var r=[];if(o)for(var n=0;n<e;n++)r.push(this.randomPick(t));else{var i=t.slice(0);for(n=0;n<e;n++){var a=Math.floor(Math.random()*i.length);r.push(i[a]),i.splice(a,1)}}return r},t.randomByRate=function(t){return Math.random()<=t},t}();o.MathUtils=r,cc._RF.pop()},{}],MessageQueue:[function(t,e,o){"use strict";cc._RF.push(e,"bc913KuK8JJDY1qEawGPMsS","MessageQueue"),Object.defineProperty(o,"__esModule",{value:!0}),o.MessageQueue=void 0;var r=function(){function t(){}return t.registerListener=function(){var t=this;this.queue=window.queue||[],window.addEventListener("message",function(e){console.log("message",e,e.data),t.queue.push(e)},!1)},t.message=function(){return this.queue.shift()},t.queue=[],t}();o.MessageQueue=r,r.registerListener(),cc._RF.pop()},{}],MoneyConditionProcessor:[function(t,e,o){"use strict";cc._RF.push(e,"b8434fv9zBG3ZEZmjm8MROs","MoneyConditionProcessor");var r,n=this&&this.__extends||(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),i=this&&this.__decorate||function(t,e,o,r){var n,i=arguments.length,a=i<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,o):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,o,r);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(a=(i<3?n(a):i>3?n(e,o,a):n(e,o))||a);return i>3&&a&&Object.defineProperty(e,o,a),a},a=this&&this.__awaiter||function(t,e,o,r){return new(o||(o=Promise))(function(n,i){function a(t){try{c(r.next(t))}catch(e){i(e)}}function s(t){try{c(r.throw(t))}catch(e){i(e)}}function c(t){var e;t.done?n(t.value):(e=t.value,e instanceof o?e:new o(function(t){t(e)})).then(a,s)}c((r=r.apply(t,e||[])).next())})},s=this&&this.__generator||function(t,e){var o,r,n,i,a={label:0,sent:function(){if(1&n[0])throw n[1];return n[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(t){return function(e){return c([t,e])}}function c(i){if(o)throw new TypeError("Generator is already executing.");for(;a;)try{if(o=1,r&&(n=2&i[0]?r.return:i[0]?r.throw||((n=r.return)&&n.call(r),0):r.next)&&!(n=n.call(r,i[1])).done)return n;switch(r=0,n&&(i=[2&i[0],n.value]),i[0]){case 0:case 1:n=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,r=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(n=(n=a.trys).length>0&&n[n.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!n||i[1]>n[0]&&i[1]<n[3])){a.label=i[1];break}if(6===i[0]&&a.label<n[1]){a.label=n[1],n=i;break}if(n&&a.label<n[2]){a.label=n[2],a.ops.push(i);break}n[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(s){i=[6,s],r=0}finally{o=n=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}};Object.defineProperty(o,"__esModule",{value:!0}),o.ReturnTimeConditionProcessor=o.FragmentConditionProcessor=o.MedalConditionProcessor=o.DiamondConditionProcessor=o.GoldConditionProcessor=void 0;var c=t("../../PlayerModule/Utils/ConditionProcessor"),l=t("../Data/PlayerMoney"),u=t("../Common/EconomicCommon"),p=t("../../PlayerModule/Managers/PlayerManager"),f=t("../../PlayerModule/Data/Condition"),d=t("../Data/PlayerJob"),h=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),Object.defineProperty(e.prototype,"playerValue",{get:function(){return this.pMoney[this.type]},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"throwFunc",{get:function(){return u.EconomicThrow.NotEnoughMoney},enumerable:!1,configurable:!0}),e.prototype.preprocess=function(){t.prototype.preprocess.call(this),this.pMoney=p.playerMgr().getPlayerData(l.PlayerMoney)},e.prototype.doConsume=function(){return a(this,void 0,void 0,function(){return s(this,function(){return this.pMoney.gain(this.type,-this.value),[2]})})},e}(c.ConditionProcessor),y=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),Object.defineProperty(e.prototype,"type",{get:function(){return"gold"},enumerable:!1,configurable:!0}),i([c.conditionProcessor(f.ConditionType.Gold)],e)}(h);o.GoldConditionProcessor=y;var g=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),Object.defineProperty(e.prototype,"type",{get:function(){return"diamond"},enumerable:!1,configurable:!0}),i([c.conditionProcessor(f.ConditionType.Diamond)],e)}(h);o.DiamondConditionProcessor=g;var v=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),Object.defineProperty(e.prototype,"type",{get:function(){return"medal"},enumerable:!1,configurable:!0}),i([c.conditionProcessor(f.ConditionType.Medal)],e)}(h);o.MedalConditionProcessor=v;var b=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),Object.defineProperty(e.prototype,"type",{get:function(){return"fragment"},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"throwFunc",{get:function(){return u.EconomicThrow.NotEnoughFragment},enumerable:!1,configurable:!0}),i([c.conditionProcessor(f.ConditionType.Fragment)],e)}(h);o.FragmentConditionProcessor=b;var m=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.preprocess=function(){t.prototype.preprocess.call(this),this.pJob=p.playerMgr().getPlayerData(d.PlayerJob)},Object.defineProperty(e.prototype,"consumable",{get:function(){return!1},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"playerValue",{get:function(){return this.pJob.returnTimes},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"throwFunc",{get:function(){return u.EconomicThrow.NotEnoughReturn},enumerable:!1,configurable:!0}),i([c.conditionProcessor(f.ConditionType.ReturnTime)],e)}(c.ConditionProcessor);o.ReturnTimeConditionProcessor=m,cc._RF.pop()},{"../../PlayerModule/Data/Condition":"Condition","../../PlayerModule/Managers/PlayerManager":"PlayerManager","../../PlayerModule/Utils/ConditionProcessor":"ConditionProcessor","../Common/EconomicCommon":"EconomicCommon","../Data/PlayerJob":"PlayerJob","../Data/PlayerMoney":"PlayerMoney"}],MoneyRewardProcessor:[function(t,e,o){"use strict";cc._RF.push(e,"a5df2BAAdpA3Y96JGpe2bgM","MoneyRewardProcessor");var r,n=this&&this.__extends||(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),i=this&&this.__decorate||function(t,e,o,r){var n,i=arguments.length,a=i<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,o):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,o,r);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(a=(i<3?n(a):i>3?n(e,o,a):n(e,o))||a);return i>3&&a&&Object.defineProperty(e,o,a),a};Object.defineProperty(o,"__esModule",{value:!0}),o.FragmentRewardProcessor=o.MedalRewardProcessor=o.DiamondRewardProcessor=o.GoldRewardProcessor=void 0;var a=t("../../PlayerModule/Utils/RewardProcessor"),s=t("../Data/PlayerMoney"),c=t("../../PlayerModule/Data/Reward"),l=t("../../PlayerModule/Managers/PlayerManager"),u=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.invoke=function(t){void 0===t&&(t=1),l.playerMgr().getPlayerData(s.PlayerMoney).gain(this.type,this.value*t)},e}(a.RewardProcessor),p=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),Object.defineProperty(e.prototype,"type",{get:function(){return"gold"},enumerable:!1,configurable:!0}),i([a.rewardProcessor(c.RewardType.Gold)],e)}(u);o.GoldRewardProcessor=p;var f=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),Object.defineProperty(e.prototype,"type",{get:function(){return"diamond"},enumerable:!1,configurable:!0}),i([a.rewardProcessor(c.RewardType.Diamond)],e)}(u);o.DiamondRewardProcessor=f;var d=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),Object.defineProperty(e.prototype,"type",{get:function(){return"medal"},enumerable:!1,configurable:!0}),i([a.rewardProcessor(c.RewardType.Medal)],e)}(u);o.MedalRewardProcessor=d;var h=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),Object.defineProperty(e.prototype,"type",{get:function(){return"fragment"},enumerable:!1,configurable:!0}),i([a.rewardProcessor(c.RewardType.Fragment)],e)}(u);o.FragmentRewardProcessor=h,cc._RF.pop()},{"../../PlayerModule/Data/Reward":"Reward","../../PlayerModule/Managers/PlayerManager":"PlayerManager","../../PlayerModule/Utils/RewardProcessor":"RewardProcessor","../Data/PlayerMoney":"PlayerMoney"}],MotionGroup:[function(t,e,o){"use strict";cc._RF.push(e,"6b962PmcyZOwqfV9N4Dk14H","MotionGroup");var r,n=this&&this.__extends||(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),i=this&&this.__decorate||function(t,e,o,r){var n,i=arguments.length,a=i<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,o):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,o,r);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(a=(i<3?n(a):i>3?n(e,o,a):n(e,o))||a);return i>3&&a&&Object.defineProperty(e,o,a),a};Object.defineProperty(o,"__esModule",{value:!0}),o.MotionGroupRepo=o.motionGroupRepo=o.MotionGroup=o.BossEnterMotionGroupId=o.DieMotionGroupId=o.EnterMotionGroupId=o.HurtMotionGroupId=o.AttackMotionGroupId=void 0;var a=t("../../CoreModule/Data/BaseData"),s=t("./Motion"),c=t("../../CoreModule/Data/BaseRepository"),l=t("../../CoreModule/Data/StaticData");o.AttackMotionGroupId=0,o.HurtMotionGroupId=1,o.EnterMotionGroupId=2,o.DieMotionGroupId=3,o.BossEnterMotionGroupId=5;var u=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.motions=[],e}return n(e,t),i([a.field([s.Motion])],e.prototype,"motions",void 0),i([l.data("MotionGroup")],e)}(l.StaticData);o.MotionGroup=u,o.motionGroupRepo=function(){return c.getRepository(p)};var p=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),Object.defineProperty(e.prototype,"clazz",{get:function(){return u},enumerable:!1,configurable:!0}),e.prototype.attack=function(){return this.getById(o.AttackMotionGroupId)},e.prototype.hurt=function(){return this.getById(o.HurtMotionGroupId)},e.prototype.enter=function(){return this.getById(o.EnterMotionGroupId)},e.prototype.die=function(){return this.getById(o.DieMotionGroupId)},i([c.repository],e)}(c.BaseRepository);o.MotionGroupRepo=p,cc._RF.pop()},{"../../CoreModule/Data/BaseData":"BaseData","../../CoreModule/Data/BaseRepository":"BaseRepository","../../CoreModule/Data/StaticData":"StaticData","./Motion":"Motion"}],MotionProcessor:[function(t,e,o){"use strict";cc._RF.push(e,"6fd82seaFBLsbxKIiJJkTp/","MotionProcessor");var r,n=this&&this.__extends||(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),i=this&&this.__decorate||function(t,e,o,r){var n,i=arguments.length,a=i<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,o):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,o,r);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(a=(i<3?n(a):i>3?n(e,o,a):n(e,o))||a);return i>3&&a&&Object.defineProperty(e,o,a),a};Object.defineProperty(o,"__esModule",{value:!0}),o.MotionProcessor=o.createProcessor=o.motionProcessor=void 0;var a=t("../Data/Motion"),s=t("./Vec1"),c=t("../../../Utils/DecoratorUtils"),l=cc.Vec2,u=cc.v2,p=cc.Color;function f(t){return function(e){d.processorSettings[t]=e}}o.motionProcessor=f,o.createProcessor=function(t,e,o,r){void 0===r&&(r=!1);var n=d.processorSettings[e.type];return n?new n(t,e,o,r):null};var d=function(){function t(t,e,o,r){void 0===r&&(r=!1),this.startTime=-1,this.elapsedTime=-1,this.state="not_started",this.battler=t,this.action=o,this.motion=e,this.isResult=r}return Object.defineProperty(t.prototype,"battle",{get:function(){return this.action.battle},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"subject",{get:function(){return this.action.subject},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"subjectBattler",{get:function(){return this.subject.battler},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"target",{get:function(){return this.action.target},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"targetBattler",{get:function(){return this.target.battler},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"isSubject",{get:function(){return this.battler==this.subjectBattler},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"isTarget",{get:function(){return this.battler==this.targetBattler},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"isStarted",{get:function(){return"not_started"!=this.state},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"isEnded",{get:function(){return"ended"==this.state||this.isFinished},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"isFinished",{get:function(){return"finished"==this.state},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"isElapsedStarted",{get:function(){return this.progress>0},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"isElapsedEnded",{get:function(){return this.progress>=1},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"isElapsedFinished",{get:function(){return this.totalProgress>=1},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"duration",{get:function(){return this.motion.duration},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"endTime",{get:function(){return this.startTime+this.duration},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"totalEndTime",{get:function(){return this.endTime+this.motion.wait},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"totalDuration",{get:function(){return this.totalEndTime-this.startTime},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"progress",{get:function(){return this.elapsedTime/this.duration},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"totalProgress",{get:function(){return this.elapsedTime/this.totalDuration},enumerable:!1,configurable:!0}),t.prototype.motionTarget=function(t){switch(t){case a.TargetType.Self:return this.battler;case a.TargetType.Subject:return this.subjectBattler;case a.TargetType.Target:return this.targetBattler}},t.prototype.update=function(){this.elapsedTime=this.battler.elapsedTime-this.startTime,!this.isStarted&&this.isElapsedStarted&&this.start(),this.isEnded||this.isFinished||!this.isElapsedEnded||this.end(),!this.isFinished&&this.isElapsedFinished&&this.finish(),this.isStarted&&!this.isEnded&&this.onProgress(this.progress)},t.prototype.start=function(){this.state="playing",this.onStart(),this.onProgress(0)},t.prototype.end=function(){this.state="ended",this.onProgress(1),this.onEnd()},t.prototype.finish=function(){this.state="finished",this.onFinish()},t.prototype.onProgress=function(){},t.prototype.onStart=function(){},t.prototype.onEnd=function(){},t.prototype.onFinish=function(){},t.processorSettings={},t}();o.MotionProcessor=d;var h=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),Object.defineProperty(e.prototype,"val",{get:function(){return this.battler[this.propKey].clone()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"tType",{get:function(){return this.motion.params[0]},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"delta",{get:function(){return this.motion.params[1]},enumerable:!1,configurable:!0}),e.prototype.onStart=function(){t.prototype.onStart.call(this),this.setupStartVal(),this.setupTargetVal()},e.prototype.setupStartVal=function(){this.startVal=this.val},e.prototype.setupTargetVal=function(){this.targetVal=new l;var t=u(this.delta[0]||this.delta,this.delta[1]||0);switch(this.tType){case a.TranslateType.Delta:l.add(this.targetVal,this.val,t);break;case a.TranslateType.Value:this.targetVal=t;break;case a.TranslateType.Origin:l.add(this.targetVal,this.oriVal,t);break;default:this.targetVal=this.val}},e.prototype.onProgress=function(e){t.prototype.onProgress.call(this,e);var o=new l;l.lerp(o,this.startVal,this.targetVal,e),this.battler[this.propKey]=o},e}(d);(function(t){function e(){return null!==t&&t.apply(this,arguments)||this}n(e,t),Object.defineProperty(e.prototype,"propKey",{get:function(){return"posRate"},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"sPos",{get:function(){return this.battler.startPos},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"tPos",{get:function(){return this.battler.targetPos},enumerable:!1,configurable:!0}),e.prototype.setupStartVal=function(){this.startVal=s.Vec1.ZERO},e.prototype.setupTargetVal=function(){var t=u(this.delta[0]||0,this.delta[1]||0);switch(this.tType){case a.TranslateType.Delta:this.tPos.origin=this.sPos.origin,l.add(this.tPos.offset,this.sPos.offset,t);break;case a.TranslateType.Value:this.tPos.origin=this.sPos.origin,this.tPos.offset=t;break;case a.TranslateType.Origin:this.tPos.origin="self",this.tPos.offset=t;break;case a.TranslateType.Target:this.tPos.origin="target",this.tPos.offset=t}this.targetVal=s.Vec1.ONE},e.prototype.onFinish=function(){t.prototype.onFinish.call(this),this.sPos.origin=this.tPos.origin,this.sPos.offset=this.tPos.offset.clone()},Object.defineProperty(e.prototype,"oriVal",{get:function(){return null},enumerable:!1,configurable:!0}),e=i([f(a.MotionType.Move)],e)})(h),function(t){function e(){return null!==t&&t.apply(this,arguments)||this}n(e,t),Object.defineProperty(e.prototype,"propKey",{get:function(){return"scale"},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"oriVal",{get:function(){return l.ONE},enumerable:!1,configurable:!0}),e=i([f(a.MotionType.Scale)],e)}(h),function(t){function e(){return null!==t&&t.apply(this,arguments)||this}n(e,t),Object.defineProperty(e.prototype,"propKey",{get:function(){return"angle"},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"oriVal",{get:function(){return s.Vec1.ZERO},enumerable:!1,configurable:!0}),e=i([f(a.MotionType.Rotate)],e)}(h),function(t){function e(){return null!==t&&t.apply(this,arguments)||this}n(e,t),e=i([f(a.MotionType.Jump)],e)}(d),function(t){function e(){return null!==t&&t.apply(this,arguments)||this}n(e,t),e.prototype.onStart=function(){t.prototype.onStart.call(this),this.isResult?console.error("\u7ed3\u679c\u52a8\u4f5c\u4e2d\u65e0\u6cd5\u4f7f\u7528ApplyResult\u52a8\u4f5c\uff01"):this.targetBattler.applyResult(this.action)},e=i([f(a.MotionType.ApplyResult)],e)}(d),function(t){function e(){return null!==t&&t.apply(this,arguments)||this}n(e,t),e.prototype.onStart=function(){t.prototype.onStart.call(this),this.isResult?this.battler.showResult(this.action.result):console.error("\u975e\u7ed3\u679c\u52a8\u4f5c\u4e2d\u65e0\u6cd5\u4f7f\u7528ShowResult\u52a8\u4f5c\uff01")},e=i([f(a.MotionType.ShowResult)],e)}(d),function(t){function e(){return null!==t&&t.apply(this,arguments)||this}n(e,t),Object.defineProperty(e.prototype,"name",{get:function(){return this.motion.params[0]},enumerable:!1,configurable:!0}),e.prototype.onStart=function(){t.prototype.onStart.call(this),this.battler.animation=this.name},Object.defineProperty(e.prototype,"duration",{get:function(){return this.realDuration()},enumerable:!1,configurable:!0}),e.prototype.realDuration=function(){var t,e=this;return(null===(t=this.battler.entity.skeleton.getRuntimeData().animations.find(function(t){return t.name==e.name}))||void 0===t?void 0:t.duration)||this.motion.duration},e.prototype.onEnd=function(){t.prototype.onEnd.call(this)},i([c.cache],e.prototype,"realDuration",null),e=i([f(a.MotionType.PlayCharAni)],e)}(d),function(t){function e(){return null!==t&&t.apply(this,arguments)||this}n(e,t),Object.defineProperty(e.prototype,"tt",{get:function(){return this.motion.params[0]},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"range",{get:function(){return this.motion.params[1]},enumerable:!1,configurable:!0}),e.prototype.onProgress=function(e){t.prototype.onProgress.call(this,e),this.motionTarget(this.tt).shakePos.x=this.range*Math.sin(4*Math.PI*e)},e.prototype.onEnd=function(){t.prototype.onEnd.call(this),this.motionTarget(this.tt).shakePos=l.ZERO},e=i([f(a.MotionType.Shake)],e)}(d),function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.realColor=p.WHITE,e}n(e,t),Object.defineProperty(e.prototype,"tt",{get:function(){return this.motion.params[0]},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"colorCode",{get:function(){return this.motion.params[1]},enumerable:!1,configurable:!0}),e.prototype.onStart=function(){t.prototype.onStart.call(this),this.realColor=(new p).fromHEX(this.colorCode)},e.prototype.onProgress=function(e){t.prototype.onProgress.call(this,e),p.lerp(this.motionTarget(this.tt).color,p.WHITE,this.realColor,Math.sin(Math.PI*e))},e.prototype.onEnd=function(){t.prototype.onEnd.call(this),this.motionTarget(this.tt).color=p.WHITE},e=i([f(a.MotionType.Shine)],e)}(d),function(t){function e(){return null!==t&&t.apply(this,arguments)||this}n(e,t),Object.defineProperty(e.prototype,"tt",{get:function(){return this.motion.params[0]},enumerable:!1,configurable:!0}),e.prototype.onStart=function(){t.prototype.onStart.call(this)},e.prototype.onProgress=function(e){t.prototype.onProgress.call(this,e),this.motionTarget(this.tt).opacity=255*(1-e)},e.prototype.onEnd=function(){t.prototype.onEnd.call(this)},e=i([f(a.MotionType.FadeOut)],e)}(d),function(t){function e(){return null!==t&&t.apply(this,arguments)||this}n(e,t),e.prototype.onStart=function(){var e=this;this.motion.params.forEach(function(t){e.battler.battle.battleAnimations.push(t[0]),e.battler.battle.battleAnimationTimes.push(t[1])}),t.prototype.onStart.call(this)},e.prototype.onProgress=function(e){t.prototype.onProgress.call(this,e)},e.prototype.onEnd=function(){t.prototype.onEnd.call(this)},e=i([f(a.MotionType.PlayBattleAni)],e)}(d),function(t){function e(){return null!==t&&t.apply(this,arguments)||this}n(e,t),e.prototype.onStart=function(){var e=this;this.motion.params.forEach(function(t){e.battler.normalAnimations=t[0],e.battler.normalAnimationTimes=t[1]}),t.prototype.onStart.call(this)},e.prototype.onProgress=function(e){t.prototype.onProgress.call(this,e)},e.prototype.onEnd=function(){t.prototype.onEnd.call(this)},e=i([f(a.MotionType.PlayNormalAni)],e)}(d),cc._RF.pop()},{"../../../Utils/DecoratorUtils":"DecoratorUtils","../Data/Motion":"Motion","./Vec1":"Vec1"}],Motion:[function(t,e,o){"use strict";cc._RF.push(e,"40ab0nzTTtJfL4VOfzSgyZd","Motion");var r,n=this&&this.__extends||(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),i=this&&this.__decorate||function(t,e,o,r){var n,i=arguments.length,a=i<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,o):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,o,r);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(a=(i<3?n(a):i>3?n(e,o,a):n(e,o))||a);return i>3&&a&&Object.defineProperty(e,o,a),a};Object.defineProperty(o,"__esModule",{value:!0}),o.Motion=o.AniOrigin=o.TargetType=o.TranslateType=o.MotionType=void 0;var a,s=t("../../CoreModule/Data/BaseData");(function(t){t.None="none",t.Move="move",t.Rotate="rotate",t.Scale="scale",t.Jump="jump",t.Shake="shake",t.Shine="shine",t.Reset="reset",t.PlayCharAni="playCharAni",t.PlayBattleAni="playBattleAni",t.PlayNormalAni="playNormalAni",t.PlaySE="playSE",t.ApplyResult="applyResult",t.ShowResult="showResult",t.Wait="ended",t.FadeOut="fadeOut"})(a=o.MotionType||(o.MotionType={})),function(t){t.Delta="delta",t.Value="value",t.Origin="origin",t.Target="target"}(o.TranslateType||(o.TranslateType={})),function(t){t.Self="self",t.Subject="subject",t.Target="target",t.Background="background",t.Screen="screen"}(o.TargetType||(o.TargetType={})),function(t){t.Subject="subject",t.Screen="screen",t.Target="target"}(o.AniOrigin||(o.AniOrigin={}));var c=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.duration=0,e.offset=0,e.wait=0,e.playType="after",e.type=a.None,e.params=[],e}return n(e,t),i([s.field],e.prototype,"duration",void 0),i([s.field],e.prototype,"offset",void 0),i([s.field],e.prototype,"wait",void 0),i([s.field],e.prototype,"playType",void 0),i([s.field(String)],e.prototype,"type",void 0),i([s.field([Object])],e.prototype,"params",void 0),e}(s.BaseData);o.Motion=c,cc._RF.pop()},{"../../CoreModule/Data/BaseData":"BaseData"}],MyTeamFrame:[function(t,e,o){"use strict";cc._RF.push(e,"d7196II0a1IrZTR97z9Pc/F","MyTeamFrame");var r,n=this&&this.__extends||(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),i=this&&this.__decorate||function(t,e,o,r){var n,i=arguments.length,a=i<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,o):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,o,r);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(a=(i<3?n(a):i>3?n(e,o,a):n(e,o))||a);return i>3&&a&&Object.defineProperty(e,o,a),a},a=this&&this.__awaiter||function(t,e,o,r){return new(o||(o=Promise))(function(n,i){function a(t){try{c(r.next(t))}catch(e){i(e)}}function s(t){try{c(r.throw(t))}catch(e){i(e)}}function c(t){var e;t.done?n(t.value):(e=t.value,e instanceof o?e:new o(function(t){t(e)})).then(a,s)}c((r=r.apply(t,e||[])).next())})},s=this&&this.__generator||function(t,e){var o,r,n,i,a={label:0,sent:function(){if(1&n[0])throw n[1];return n[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(t){return function(e){return c([t,e])}}function c(i){if(o)throw new TypeError("Generator is already executing.");for(;a;)try{if(o=1,r&&(n=2&i[0]?r.return:i[0]?r.throw||((n=r.return)&&n.call(r),0):r.next)&&!(n=n.call(r,i[1])).done)return n;switch(r=0,n&&(i=[2&i[0],n.value]),i[0]){case 0:case 1:n=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,r=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(n=(n=a.trys).length>0&&n[n.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!n||i[1]>n[0]&&i[1]<n[3])){a.label=i[1];break}if(6===i[0]&&a.label<n[1]){a.label=n[1],n=i;break}if(n&&a.label<n[2]){a.label=n[2],a.ops.push(i);break}n[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(s){i=[6,s],r=0}finally{o=n=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}};Object.defineProperty(o,"__esModule",{value:!0});var c=t("../../../Modules/BattleModule/Components/Hero/HeroInTeamContainer"),l=t("../../../Modules/BattleModule/Components/Hero/HeroGroupContainer"),u=t("../../../Modules/CopyModule/Data/Copy"),p=t("../../../Modules/CopyModule/CopyCommon"),f=t("../../../Modules/PlayerModule/Managers/PlayerManager"),d=t("../../../Modules/CoreModule/Managers/DataManager"),h=t("../../../Modules/HeroModule/Managers/HeroManager"),y=t("../../../Modules/CopyModule/Managers/CopyManager"),g=t("../../BattleScene"),v=cc._decorator,b=v.ccclass,m=v.property,_=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.totalHeroes=[],e.heroesInTeamContainer=null,e.heroGroupContainer=null,e}return n(e,t),e.prototype.start=function(){var t=this;this.setup().then(function(){t.refreshTeam()})},e.prototype.setup=function(){return a(this,void 0,void 0,function(){var t,e;return s(this,function(o){switch(o.label){case 0:return t=f.playerMgr().player.account,e=this,[4,h.heroMgr().getListFromServer()];case 1:return e.totalHeroes=o.sent().filter(function(e){return e.ownerAccount==t}),[2]}})})},e.prototype.refreshTeam=function(){var t;g.battleScene().heroesInTeam=this.getHeroesInTeam(),null===(t=this.heroesInTeamContainer)||void 0===t||t.setItems(g.battleScene().heroesInTeam)},e.prototype.getHeroesInTeam=function(){var t=y.copyMgr().getMainPlayerCopySettings();return this.totalHeroes.filter(function(e){return t.nftIds.find(function(t){return t==e.nftId})})},e.prototype.addTeamMember=function(t){var e=y.copyMgr().getPlayerCopy().mainSetting().nftIds;if(e.indexOf(t)>=0)return this.removeTeamMember(t);e.length>=3||(e.push(t),this.refreshTeam())},e.prototype.removeTeamMember=function(t){var e=y.copyMgr().getPlayerCopy().mainSetting().nftIds,o=e.indexOf(t);-1!=o&&e.splice(o,1),this.refreshTeam()},e.prototype.makeNewTeam=function(){var t=y.copyMgr().getPlayerCopy().mainSetting().nftIds;p.CopyInterface.AdjustHeroes({copyType:u.CopyType.Main,nftIds:t})},i([m(c.default)],e.prototype,"heroesInTeamContainer",void 0),i([m(l.default)],e.prototype,"heroGroupContainer",void 0),i([d.waitForDataLoad,f.waitForLogin],e.prototype,"setup",null),i([b],e)}(cc.Component);o.default=_,cc._RF.pop()},{"../../../Modules/BattleModule/Components/Hero/HeroGroupContainer":"HeroGroupContainer","../../../Modules/BattleModule/Components/Hero/HeroInTeamContainer":"HeroInTeamContainer","../../../Modules/CopyModule/CopyCommon":"CopyCommon","../../../Modules/CopyModule/Data/Copy":"Copy","../../../Modules/CopyModule/Managers/CopyManager":"CopyManager","../../../Modules/CoreModule/Managers/DataManager":"DataManager","../../../Modules/HeroModule/Managers/HeroManager":"HeroManager","../../../Modules/PlayerModule/Managers/PlayerManager":"PlayerManager","../../BattleScene":"BattleScene"}],NFTCommon:[function(t,e,o){"use strict";cc._RF.push(e,"fa62dLMNq1LBqet5VaIicv6","NFTCommon");var r=this&&this.__decorate||function(t,e,o,r){var n,i=arguments.length,a=i<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,o):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,o,r);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(a=(i<3?n(a):i>3?n(e,o,a):n(e,o))||a);return i>3&&a&&Object.defineProperty(e,o,a),a};Object.defineProperty(o,"__esModule",{value:!0}),o.NFTInterface=o.NFTLoading=o.NFTThrow=void 0;var n=t("../../CoreModule/Common/CoreCommon"),i=function(){function t(){}return t.Web3InitError=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e]},t.NicknameError=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e]},t.PartStockError=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e]},t.NFTStockError=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e]},t.NFTExistError=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e]},t.TransactionError=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e]},t.NFTCreateError=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e]},r([n.error(5e5,"Web3\u521d\u59cb\u5316\u932f\u8aa4")],t,"Web3InitError",null),r([n.error(500001,"\u66b1\u7a31\u8f38\u5165\u4e0d\u6b63\u78ba")],t,"NicknameError",null),r([n.error(500002,"\u90e8\u4ef6\u5eab\u5b58\u4e0d\u8db3")],t,"PartStockError",null),r([n.error(500003,"NFT\u5df2\u552e\u7f44")],t,"NFTStockError",null),r([n.error(500004,"\u76f8\u540c\u7684NFT\u5df2\u5b58\u5728")],t,"NFTExistError",null),r([n.error(500005,"\u4ea4\u6613\u932f\u8aa4")],t,"TransactionError",null),r([n.error(500010,"NFT\u5275\u5efa\u932f\u8aa4")],t,"NFTCreateError",null),t}();o.NFTThrow=i;var a=function(){function t(){}return t.Web3Init=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e]},t.CreateNFT=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e]},r([n.loading(5e5,"\u9322\u5305\u521d\u59cb\u5316")],t,"Web3Init",null),r([n.loading(500001,"\u5275\u5efaNFT")],t,"CreateNFT",null),t}();o.NFTLoading=a;var s=t("../Managers/NFTManager"),c=function(){function t(){}return t.UploadImgInterface=function(){},r([n.post(s.Testing?"https://test-hkaws-20220318-9927311a69be.nftmake.io/platform":"https://www.nftmake.com/platform","/api/createimg")],t,"UploadImgInterface",null),t}();o.NFTInterface=c,cc._RF.pop()},{"../../CoreModule/Common/CoreCommon":"CoreCommon","../Managers/NFTManager":"NFTManager"}],NFTCreator:[function(t,e,o){"use strict";cc._RF.push(e,"8a587GFtKtK2YZo0U79MELI","NFTCreator");var r=this&&this.__decorate||function(t,e,o,r){var n,i=arguments.length,a=i<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,o):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,o,r);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(a=(i<3?n(a):i>3?n(e,o,a):n(e,o))||a);return i>3&&a&&Object.defineProperty(e,o,a),a},n=this&&this.__awaiter||function(t,e,o,r){return new(o||(o=Promise))(function(n,i){function a(t){try{c(r.next(t))}catch(e){i(e)}}function s(t){try{c(r.throw(t))}catch(e){i(e)}}function c(t){var e;t.done?n(t.value):(e=t.value,e instanceof o?e:new o(function(t){t(e)})).then(a,s)}c((r=r.apply(t,e||[])).next())})},i=this&&this.__generator||function(t,e){var o,r,n,i,a={label:0,sent:function(){if(1&n[0])throw n[1];return n[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(t){return function(e){return c([t,e])}}function c(i){if(o)throw new TypeError("Generator is already executing.");for(;a;)try{if(o=1,r&&(n=2&i[0]?r.return:i[0]?r.throw||((n=r.return)&&n.call(r),0):r.next)&&!(n=n.call(r,i[1])).done)return n;switch(r=0,n&&(i=[2&i[0],n.value]),i[0]){case 0:case 1:n=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,r=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(n=(n=a.trys).length>0&&n[n.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!n||i[1]>n[0]&&i[1]<n[3])){a.label=i[1];break}if(6===i[0]&&a.label<n[1]){a.label=n[1],n=i;break}if(n&&a.label<n[2]){a.label=n[2],a.ops.push(i);break}n[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(s){i=[6,s],r=0}finally{o=n=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}};Object.defineProperty(o,"__esModule",{value:!0}),o.NFTCreator=void 0;var a=t("../Managers/NFTManager"),s=t("../Common/NFTCommon"),c=t("../../CoreModule/Managers/AlertManager"),l=t("../../CoreModule/Managers/LoadingManager"),u=t("../../HeroModule/Managers/HeroManager"),p=function(){function t(){this.bt1=a.DefaultBt1,this.bt2=a.DefaultBt2}return Object.defineProperty(t.prototype,"partIds",{get:function(){return this._partIds},set:function(t){this._partIds=t,this.calcPrice().then()},enumerable:!1,configurable:!0}),t.prototype.getPrice=function(){return n(this,void 0,void 0,function(){var t;return i(this,function(e){switch(e.label){case 0:return(t=this.price)?[3,2]:[4,this.calcPrice()];case 1:t=e.sent(),e.label=2;case 2:return[2,t]}})})},t.prototype.calcPrice=function(){return n(this,void 0,void 0,function(){var t;return i(this,function(e){switch(e.label){case 0:return this.price=null,t=this,[4,a.nftMgr().getNFTPrice(this.bt1,this.bt2,this.partIds)];case 1:return[2,t.price=e.sent()]}})})},t.prototype.checkNFT=function(){return n(this,void 0,void 0,function(){var t,e;return i(this,function(o){switch(o.label){case 0:return t=/[a-zA-Z0-9]+\s?[a-zA-Z0-9]+|[a-zA-Z0-9]+/,(this.name.length>20||t.exec(this.name))&&t.exec(this.name)[0]==this.name||s.NFTThrow.NicknameError(),[4,a.nftMgr().getPartsStock(this.bt1,this.bt2,this.partIds)];case 1:return e=o.sent(),console.log("getPartsStock: ",e),e.length>0&&s.NFTThrow.PartStockError(),-1!==e.indexOf("0")&&s.NFTThrow.PartStockError(),[4,a.nftMgr().notUniqueParts(this.partIds)];case 2:return o.sent()&&s.NFTThrow.NFTExistError(),[2]}})})},t.prototype.payForGameToken=function(){return n(this,void 0,void 0,function(){var t,e;return i(this,function(o){switch(o.label){case 0:return[4,a.nftMgr().getTotalSupply()];case 1:return t=o.sent(),[4,a.nftMgr().payForIt(t)];case 2:return e=o.sent(),[4,a.nftMgr().searchHash(e)];case 3:if(!o.sent())throw"\\L[ERR500010_DETAIL4]";return[2]}})})},t.prototype.checkAccount=function(){return n(this,void 0,void 0,function(){var t,e,o,r,n;return i(this,function(i){switch(i.label){case 0:return a.defaultAccount()||s.NFTThrow.NFTCreateError("\\L[ERR500010_DETAIL1]"),[4,a.nftMgr().getGasPrice()];case 1:return t=i.sent(),[4,a.nftMgr().getBNBBalance()];case 2:return e=i.sent(),t>=e&&s.NFTThrow.TransactionError(),[4,this.getPrice()];case 3:return o=i.sent(),[4,a.nftMgr().getUSTDBalance()];case 4:return r=i.sent(),o>r&&s.NFTThrow.NFTCreateError("\\L[ERR500010_DETAIL2]"),[4,a.nftMgr().getAllowance()];case 5:return n=i.sent(),o>n?[2,this.payForGameToken()]:[2]}})})},t.prototype.check=function(){return n(this,void 0,void 0,function(){return i(this,function(){return[2,Promise.all([this.checkAccount(),this.checkNFT()])]})})},t.prototype.uploadImage=function(){return n(this,void 0,void 0,function(){var t;return i(this,function(e){switch(e.label){case 0:return[4,a.nftMgr().uploadImage(this.picture,this.gif)];case 1:return t=e.sent(),console.log("uploadImage: ",t),[2,t.data.toString()]}})})},t.prototype.create=function(){return n(this,void 0,void 0,function(){var t,e,o;return i(this,function(r){switch(r.label){case 0:return[4,a.nftMgr().connect()];case 1:return r.sent(),[4,this.check()];case 2:return r.sent(),[4,this.uploadImage()];case 3:return t=r.sent(),[4,a.nftMgr().createNFT(this.name,t,this.bt1,this.bt2,this.partIds)];case 4:return e=r.sent(),(o=u.heroMgr().convert(e))?(console.log("NFT Result: ",o),[4,f.HeroInterface.CreateHero({hero:o})]):[3,6];case 5:return r.sent(),[2,o];case 6:s.NFTThrow.NFTCreateError(),r.label=7;case 7:return[2]}})})},r([c.catchAsError(s.NFTThrow.TransactionError)],t.prototype,"payForGameToken",null),r([c.catchAsError(s.NFTThrow.NFTCreateError,"\\L[ERR500010_DETAIL3]")],t.prototype,"uploadImage",null),r([l.showLoading(s.NFTLoading.CreateNFT),c.handleError(!0),c.catchAsError(s.NFTThrow.NFTCreateError),l.blockLoading],t.prototype,"create",null),t}();o.NFTCreator=p;var f=t("../../HeroModule/Common/HeroCommon");cc._RF.pop()},{"../../CoreModule/Managers/AlertManager":"AlertManager","../../CoreModule/Managers/LoadingManager":"LoadingManager","../../HeroModule/Common/HeroCommon":"HeroCommon","../../HeroModule/Managers/HeroManager":"HeroManager","../Common/NFTCommon":"NFTCommon","../Managers/NFTManager":"NFTManager"}],NFTManager:[function(t,e,o){"use strict";cc._RF.push(e,"bef86e3mt5HxZLXPhJeA84F","NFTManager");var r,n=this&&this.__extends||(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),i=this&&this.__decorate||function(t,e,o,r){var n,i=arguments.length,a=i<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,o):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,o,r);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(a=(i<3?n(a):i>3?n(e,o,a):n(e,o))||a);return i>3&&a&&Object.defineProperty(e,o,a),a},a=this&&this.__awaiter||function(t,e,o,r){return new(o||(o=Promise))(function(n,i){function a(t){try{c(r.next(t))}catch(e){i(e)}}function s(t){try{c(r.throw(t))}catch(e){i(e)}}function c(t){var e;t.done?n(t.value):(e=t.value,e instanceof o?e:new o(function(t){t(e)})).then(a,s)}c((r=r.apply(t,e||[])).next())})},s=this&&this.__generator||function(t,e){var o,r,n,i,a={label:0,sent:function(){if(1&n[0])throw n[1];return n[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(t){return function(e){return c([t,e])}}function c(i){if(o)throw new TypeError("Generator is already executing.");for(;a;)try{if(o=1,r&&(n=2&i[0]?r.return:i[0]?r.throw||((n=r.return)&&n.call(r),0):r.next)&&!(n=n.call(r,i[1])).done)return n;switch(r=0,n&&(i=[2&i[0],n.value]),i[0]){case 0:case 1:n=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,r=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(n=(n=a.trys).length>0&&n[n.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!n||i[1]>n[0]&&i[1]<n[3])){a.label=i[1];break}if(6===i[0]&&a.label<n[1]){a.label=n[1],n=i;break}if(n&&a.label<n[2]){a.label=n[2],a.ops.push(i);break}n[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(s){i=[6,s],r=0}finally{o=n=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}};Object.defineProperty(o,"__esModule",{value:!0}),o.defaultAccount=o.walletType=o.chainId=o.data=o.nftMgr=o.PartTypeIdOffset=o.PartIdOffset=o.NFTServerPath=o.NFTTestServerPath=o.DefaultBt2=o.DefaultBt1=o.DefaultTokenType=o.DefaultWalletType=o.DefaultChainType=o.DefaultChainId=o.Testing=o.Web3Enable=void 0;var c=t("../../CoreModule/Utils/MessageQueue");o.Web3Enable=!1,o.Testing=!0;var l=t("../../CoreModule/Managers/BaseManager"),u=t("../../CoreModule/Managers/LoadingManager"),p=t("../../CoreModule/Managers/I18nManager"),f=t("../../../Utils/PromiseUtils"),d=t("../../CoreModule/Managers/AlertManager"),h=t("../Common/NFTCommon"),y=t("../../PlayerModule/Managers/PlayerManager");function g(){return l.getManager(m)}o.DefaultChainId=o.Testing?97:56,o.DefaultChainType="BSC",o.DefaultWalletType="Metamask",o.DefaultTokenType="BSC",o.DefaultBt1=2,o.DefaultBt2=6,o.NFTTestServerPath="http://static.nftmake.io",o.NFTServerPath="https://static.nftmake.com",o.PartIdOffset=6896,o.PartTypeIdOffset=331,o.nftMgr=g,o.data=function(){return g().data},o.chainId=function(){return g().chainId},o.walletType=function(){return g().walletType},o.defaultAccount=function(){return g().defaultAccount};var v=o.Testing?["https://cdn.jsdelivr.net/npm/web3@1.2.7/dist/web3.min.js","https://unpkg.com/@walletconnect/qrcode-modal@1.6.6/dist/umd/index.min.js","https://unpkg.com/@walletconnect/client@1.6.6/dist/umd/index.min.js","https://unpkg.com/axios/dist/axios.min.js","https://static.nftmake.io/static/CREATELIB.js"]:["https://cdn.jsdelivr.net/npm/web3@1.2.7/dist/web3.min.js","https://unpkg.com/@walletconnect/qrcode-modal@1.6.6/dist/umd/index.min.js","https://unpkg.com/@walletconnect/client@1.6.6/dist/umd/index.min.js","https://unpkg.com/axios/dist/axios.min.js","https://static.nftmake.com/static/CREATELIB.js"];function b(t,e,r){var n=null,i=function(t,e,r){var i=r.value;r.value=function(){var t=this,e=arguments;return new Promise(function(r,c){return a(t,void 0,void 0,function(){var t,a,l=this;return s(this,function(s){switch(s.label){case 0:return o.Web3Enable?[3,1]:(r(n),[3,7]);case 1:return s.trys.push([1,6,,7]),[4,f.PromiseUtils.waitFor(function(){return l.initialized})];case 2:return s.sent()?(t=r,[4,i.apply(this,e)]):[3,4];case 3:return t.apply(void 0,[s.sent()]),[3,5];case 4:c("\u521d\u59cb\u5316\u5931\u8d25\uff01"),s.label=5;case 5:return[3,7];case 6:return a=s.sent(),c(a),[3,7];case 7:return[2]}})})})}};if(void 0===e&&void 0===r)return n=t,i;i(0,0,r)}var m=function(t){function e(){var e=t.call(this)||this;return e.data={},e.chainId=o.DefaultChainId,e.chainType=o.DefaultChainType,e.walletType=o.DefaultWalletType,e.tokenType=o.DefaultTokenType,e.initialized=!1,o.Web3Enable&&e.initialize().then(),e}return n(e,t),e.prototype.initialize=function(){return a(this,void 0,void 0,function(){return s(this,function(t){switch(t.label){case 0:return[4,this.loadScripts()];case 1:return t.sent(),this.setupLanguage(),this.createWeb3(),console.log("NFT Managers",this),[2]}})})},e.prototype.loadScripts=function(){return a(this,void 0,void 0,function(){var t,e,o;return s(this,function(r){switch(r.label){case 0:console.log("loadScripts"),t=0,e=v,r.label=1;case 1:return t<e.length?(o=e[t],[4,this.loadScript(o)]):[3,4];case 2:r.sent(),r.label=3;case 3:return t++,[3,1];case 4:return[2]}})})},e.prototype.loadScript=function(t){var e=document.children[0].children[0];return console.log({head:e}),new Promise(function(o){var r=document.createElement("script");r.src=t,e.appendChild(r),r.onload=function(){return o(!0)},r.onerror=function(){return o(!1)}})},e.prototype.setupLanguage=function(){var t=this;f.PromiseUtils.waitFor(function(){return!!t.data.lang},100,100).then(function(e){return e&&p.i18nMgr().setLanguage(t.data.lang)})},e.prototype.createWeb3=function(){this.w3=new getWeb3Lib},e.prototype.update=function(e){t.prototype.update.call(this,e),this.updateMessage()},e.prototype.updateMessage=function(){var t=c.MessageQueue.message();t&&this.processMessage(t)},e.prototype.processMessage=function(t){var e;console.log("processMessage: ",t,t.data),null!==(e=t.data.target)&&void 0!==e&&e.includes("metamask")||"createNFTProgressCallBack"!=t.data.key&&(t.data.nftData&&this.dataRes(t.data.nftData),(t.data.lang||t.data.windowSize||t.data.inviteAddress||t.data.address)&&(this.data=Object.assign(this.data,t.data),window.defaultAccount=this.defaultAccount=this.data.address))},e.prototype.getEnoughStock=function(t,e,o){return a(this,void 0,void 0,function(){var r;return s(this,function(n){switch(n.label){case 0:return r="number"==typeof o?[o]:o,[4,this.w3.getEnoughStock(t,e,r,this.chainId)];case 1:return[2,n.sent()]}})})},e.prototype.getPartsStock=function(t,e,o){return a(this,void 0,void 0,function(){return s(this,function(r){switch(r.label){case 0:return[4,this.w3.getFilterComponentStock(t,e,o,this.chainId)];case 1:return[2,r.sent()]}})})},e.prototype.notUniqueParts=function(t){return a(this,void 0,void 0,function(){return s(this,function(e){switch(e.label){case 0:return[4,this.w3.filterUniqueComponent(t,this.chainId,this.chainType)];case 1:return[2,e.sent()]}})})},e.prototype.getAllNFTList=function(t,e,o,r){return a(this,void 0,void 0,function(){return s(this,function(n){switch(n.label){case 0:return[4,this.w3.getALLNFTList(t,e,o,r,this.chainId,this.chainType)];case 1:return[2,n.sent()]}})})},e.prototype.getMyNFTList=function(t,e,o,r){return a(this,void 0,void 0,function(){return s(this,function(n){switch(n.label){case 0:return[4,this.w3.getMyNFTList(t,e,o,r,this.chainId,this.chainType)];case 1:return[2,n.sent()]}})})},e.prototype.getNFTDetail=function(t){return a(this,void 0,void 0,function(){return s(this,function(e){switch(e.label){case 0:return[4,this.w3.getTokenExtraView(t,this.chainId,this.chainType)];case 1:return[2,e.sent()]}})})},e.prototype.createNFT=function(t,e,o,r,n){var i=this;return new Promise(function(c,l){return a(i,void 0,void 0,function(){var i,a;return s(this,function(s){switch(s.label){case 0:return this.dataRes=c,this.dataRej=l,[4,this.getNFTPrice(o,r,n)];case 1:return i=s.sent(),a=this,[4,this.checkPaySymbol(this.chainType,this.chainId)];case 2:return a.tokenType=s.sent(),this.NFTMAKECreateNFTProgress(this.data.inviteAddress,this.tokenType,t,e,o,r,n,this.chainId,this.chainType,this.walletType,i,null),[2]}})})})},e.prototype.getPartList=function(t,e,r){return a(this,void 0,void 0,function(){var n;return s(this,function(i){switch(i.label){case 0:return n=o.PartTypeIdOffset+r.id,[4,this.w3.getNFTComponent(t,e,n,this.chainId)];case 1:return[2,i.sent()]}})})},e.prototype.getUserNFTCount=function(){return a(this,void 0,void 0,function(){var t;return s(this,function(e){switch(e.label){case 0:return t=Number,[4,this.w3.getNFTBalance(this.chainId)];case 1:return[2,t.apply(void 0,[e.sent()])]}})})},e.prototype.getNFTCount=function(t,e){return a(this,void 0,void 0,function(){var o;return s(this,function(r){switch(r.label){case 0:return[4,this.w3.getNftCount(t,e,this.chainId)];case 1:return o=r.sent(),[2,{createCount:Number(o.createCount),limitCreateCount:Number(o.limitCreateCount),restCount:Number(o.limitCreateCount)-Number(o.createCount)}]}})})},e.prototype.getNFTPrice=function(t,e,o){return a(this,void 0,void 0,function(){var r;return s(this,function(n){switch(n.label){case 0:return r=Number,[4,this.w3.getNFTPrice(t,e,o,this.chainId,this.chainType,this.tokenType)];case 1:return[2,r.apply(void 0,[n.sent()])]}})})},e.prototype.getLastestNFT=function(t){return a(this,void 0,void 0,function(){return s(this,function(e){switch(e.label){case 0:return[4,this.w3.getLastestCreateNFT(this.chainId,this.chainType,t)];case 1:return[2,e.sent()]}})})},e.prototype.uploadImage=function(t,e){return a(this,void 0,void 0,function(){return s(this,function(o){switch(o.label){case 0:return[4,this.NFTMAKECreateimg(this.chainType,this.chainId,this.defaultAccount,t,e)];case 1:return[2,o.sent()]}})})},e.prototype.getGasPrice=function(){return a(this,void 0,void 0,function(){var t;return s(this,function(e){switch(e.label){case 0:return t=Number,[4,this.w3.getGasPrice(this.chainId)];case 1:return[2,t.apply(void 0,[e.sent()])]}})})},e.prototype.getUSTDBalance=function(){return a(this,void 0,void 0,function(){var t,e=this;return s(this,function(o){switch(o.label){case 0:return[4,f.PromiseUtils.waitFor(function(){return e.initialized})];case 1:return o.sent(),t=Number,[4,this.w3.getBalanceOf(this.chainId)];case 2:return[2,t.apply(void 0,[o.sent()])]}})})},e.prototype.getBNBBalance=function(){return a(this,void 0,void 0,function(){var t;return s(this,function(e){switch(e.label){case 0:return t=Number,[4,this.w3.getBalance(this.chainId)];case 1:return[2,t.apply(void 0,[e.sent()])]}})})},e.prototype.getAllowance=function(){return a(this,void 0,void 0,function(){var t;return s(this,function(e){switch(e.label){case 0:return t=Number,[4,this.w3.getAllowance(this.chainId)];case 1:return[2,t.apply(void 0,[e.sent()])]}})})},e.prototype.getTotalSupply=function(){return a(this,void 0,void 0,function(){var t;return s(this,function(e){switch(e.label){case 0:return t=Number,[4,this.w3.searchTotalSupply(this.chainId)];case 1:return[2,t.apply(void 0,[e.sent()])]}})})},e.prototype.payForIt=function(t){return a(this,void 0,void 0,function(){return s(this,function(e){switch(e.label){case 0:return[4,this.w3.payForIt(t,this.chainId,this.walletType)];case 1:return[2,e.sent()]}})})},e.prototype.searchHash=function(t){var e=this;return f.PromiseUtils.waitFor(function(){return e.w3.searchHash(t,e.chainId)},1e3,60,"interval","SearchHash")},e.prototype.convertPrice=function(t){if("number"==typeof t)return t;var e=t.length;return Number(e<18?t:t.substr(0,e-18))},e.prototype.connect=function(){return a(this,void 0,void 0,function(){var t=this;return s(this,function(e){switch(e.label){case 0:return[4,f.PromiseUtils.waitFor(function(){return!!t.defaultAccount})];case 1:return e.sent()?[3,3]:[4,window.NFTMAKEDisconnect()];case 2:return e.sent(),[3,0];case 3:return[4,y.playerMgr().login(this.defaultAccount,this.chainId,this.walletType)];case 4:return e.sent(),[2]}})})},e.prototype.init=function(t){return void 0===t&&(t=!0),a(this,void 0,void 0,function(){var e=this;return s(this,function(o){switch(o.label){case 0:return[4,f.PromiseUtils.waitFor(function(){return!!e.w3})];case 1:return o.sent(),this.initialized=!0,t?[4,this.connect()]:[3,3];case 2:o.sent(),o.label=3;case 3:return[2]}})})},e.prototype.NFTMAKECreateNFTProgress=function(t,e,o,r,n,i,a,s,c,l,u,p){window.NFTMAKECreateNFTProgress(t,e,o,r,n,i,a,s,c,l,u,p)},e.prototype.NFTMAKECreateimg=function(t,e,o,r,n){return a(this,void 0,void 0,function(){return s(this,function(i){switch(i.label){case 0:return[4,window.NFTMAKECreateimg(t,e,o,null,r,n,1)];case 1:return[2,i.sent()]}})})},e.prototype.checkPaySymbol=function(t,e){return a(this,void 0,void 0,function(){return s(this,function(o){switch(o.label){case 0:return[4,window.checkPaySymbol("createNft",t,e)];case 1:return[2,o.sent()]}})})},i([b(!0)],e.prototype,"getEnoughStock",null),i([b([])],e.prototype,"getPartsStock",null),i([b(!1)],e.prototype,"notUniqueParts",null),i([b([])],e.prototype,"getAllNFTList",null),i([b([])],e.prototype,"getMyNFTList",null),i([u.showLoading,b({})],e.prototype,"getNFTDetail",null),i([u.showLoading,b],e.prototype,"createNFT",null),i([b([])],e.prototype,"getPartList",null),i([b(0)],e.prototype,"getUserNFTCount",null),i([b({createCount:0,limitCreateCount:99999,restCount:99999})],e.prototype,"getNFTCount",null),i([b(0)],e.prototype,"getNFTPrice",null),i([b({})],e.prototype,"getLastestNFT",null),i([u.showLoading,b({imgurl:""})],e.prototype,"uploadImage",null),i([b(0)],e.prototype,"getGasPrice",null),i([b(0)],e.prototype,"getUSTDBalance",null),i([b(0)],e.prototype,"getBNBBalance",null),i([b(0)],e.prototype,"getAllowance",null),i([b(0)],e.prototype,"getTotalSupply",null),i([b],e.prototype,"payForIt",null),i([u.showLoading,b],e.prototype,"searchHash",null),i([u.showLoading(h.NFTLoading.Web3Init),d.handleError(!0),d.catchAsError(h.NFTThrow.Web3InitError)],e.prototype,"connect",null),i([u.showLoading(h.NFTLoading.Web3Init),d.handleError,d.catchAsError(h.NFTThrow.Web3InitError)],e.prototype,"init",null),i([l.manager],e)}(l.BaseManager);cc._RF.pop()},{"../../../Utils/PromiseUtils":"PromiseUtils","../../CoreModule/Managers/AlertManager":"AlertManager","../../CoreModule/Managers/BaseManager":"BaseManager","../../CoreModule/Managers/I18nManager":"I18nManager","../../CoreModule/Managers/LoadingManager":"LoadingManager","../../CoreModule/Utils/MessageQueue":"MessageQueue","../../PlayerModule/Managers/PlayerManager":"PlayerManager","../Common/NFTCommon":"NFTCommon"}],NetworkManager:[function(t,e,o){"use strict";cc._RF.push(e,"a9211QGmchJPZ2SW1S4eUIH","NetworkManager");var r,n=this&&this.__extends||(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),i=this&&this.__decorate||function(t,e,o,r){var n,i=arguments.length,a=i<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,o):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,o,r);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(a=(i<3?n(a):i>3?n(e,o,a):n(e,o))||a);return i>3&&a&&Object.defineProperty(e,o,a),a},a=this&&this.__awaiter||function(t,e,o,r){return new(o||(o=Promise))(function(n,i){function a(t){try{c(r.next(t))}catch(e){i(e)}}function s(t){try{c(r.throw(t))}catch(e){i(e)}}function c(t){var e;t.done?n(t.value):(e=t.value,e instanceof o?e:new o(function(t){t(e)})).then(a,s)}c((r=r.apply(t,e||[])).next())})},s=this&&this.__generator||function(t,e){var o,r,n,i,a={label:0,sent:function(){if(1&n[0])throw n[1];return n[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(t){return function(e){return c([t,e])}}function c(i){if(o)throw new TypeError("Generator is already executing.");for(;a;)try{if(o=1,r&&(n=2&i[0]?r.return:i[0]?r.throw||((n=r.return)&&n.call(r),0):r.next)&&!(n=n.call(r,i[1])).done)return n;switch(r=0,n&&(i=[2&i[0],n.value]),i[0]){case 0:case 1:n=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,r=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(n=(n=a.trys).length>0&&n[n.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!n||i[1]>n[0]&&i[1]<n[3])){a.label=i[1];break}if(6===i[0]&&a.label<n[1]){a.label=n[1],n=i;break}if(n&&a.label<n[2]){a.label=n[2],a.ops.push(i);break}n[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(s){i=[6,s],r=0}finally{o=n=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}};Object.defineProperty(o,"__esModule",{value:!0}),o.networkMgr=o.requestErrorHandler=o.Interface=void 0;var c=t("./BaseManager"),l=t("./LoadingManager"),u=t("./AlertManager"),p=t("../Utils/ParamCodec"),f="https://zooworld-server-1836805-1255510304.ap-shanghai.run.tcloudbase.com",d=function(){function t(t){this.host=f,this.useToken=!0,this.useEncrypt=!0,this.loading=!0,this._loadingSetting=null,Object.assign(this,t)}return Object.defineProperty(t.prototype,"isGet",{get:function(){return"get"==this.method},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"isPost",{get:function(){return"post"==this.method},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"loadingSetting",{get:function(){if(!this._loadingSetting){var t={};"function"==typeof this.loading?t=this.loading():null===this.loading||!0===this.loading?t=m.CoreLoading.Request():!1===this.loading?t.enable=!1:t=this.loading,this._loadingSetting=t}return this._loadingSetting},enumerable:!1,configurable:!0}),t}();o.Interface=d,o.requestErrorHandler=function(t,e,o){return void 0===o&&(o=200),function(r,n,i){y().registerErrorHandler(t,e,o,i.value)}};var h=function(){function t(){this.funcDict={}}return t.prototype.getKey=function(t){return t.host+t.route},t.prototype.register=function(t,e,o,r){var n,i;if(e instanceof d){var a=this.getKey(e);(n=this.funcDict)[a]||(n[a]={}),(i=this.funcDict[a])[o]||(i[o]={}),this.funcDict[a][o][r]=t}else this.register(t,e.interface_,e.status,e.code)},t.prototype.getHandler=function(t,e,o){if(t instanceof d){var r=this.getKey(t);return this.funcDict[r]&&this.funcDict[r][e]?this.funcDict[r][e][o]:null}return this.getHandler(t.interface_,t.status,t.code)},t.prototype.handle=function(t){var e=this.getHandler(t);if(!e)return!1;if(!t.handled){var o=e(t);return t.handled=null==o||o}},t}();function y(){return c.getManager(g)}o.networkMgr=y;var g=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.errorHandler=new h,e}return n(e,t),e.prototype.request=function(t,e){return void 0===e&&(e={}),a(this,void 0,Promise,function(){var o,r,n;return s(this,function(i){switch(i.label){case 0:return e=b.DataLoader.convert(e),o=this.makeQueryParam(e,t.useEncrypt),r=t.host+t.route,t.isGet&&(r+="?"+o),(n=cc.loader.getXMLHttpRequest()).open(t.method,r,!0),n.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),t.useToken&&n.setRequestHeader("Token",v.gameMgr().getToken()),[4,this.getRequestPromise(n,t,o)];case 1:return[2,i.sent()]}})})},e.prototype.getRequestPromise=function(t,e,o){var r=this;return new Promise(function(n,i){var a=l.loadingMgr().startLoading(e.loadingSetting);t.onreadystatechange=function(){if(4===t.readyState){var o,s,c,l,u=t.responseText,f=t.status;console.log("Response: ",t,f,u);try{"string"==typeof(o=JSON.parse(u))&&(o=JSON.parse(l=p.ParamCodec.decode(o))),s=o.code||0,c=o.data||o,console.log("Response JSON: ",o,s,c)}catch(g){console.error("Parse JSON failed!",l,g)}if(f>=200&&f<300&&0===s)n(c);else{var d=void 0,h="";o?(d=o.errMsg,h=o.detail):(d="\\L[ERR_SYSTEM]"+f,c=u);var y={interface_:e,status:f,code:s,errMsg:d,detail:h,data:c};r.handleError(y),i(y)}null==a||a.finish()}},e.isGet?t.send():t.send(o)})},e.prototype.makeQueryParam=function(t){var e=this,o=Object.keys(t).reduce(function(o,r){return o+r+"="+e.convertParam(t[r])+"&"},"");return""!==o&&(o=o.substr(0,o.lastIndexOf("&"))),o},e.prototype.convertParam=function(t){var e=t;return"object"==typeof t&&(e=JSON.stringify(e)),encodeURIComponent(e)},e.prototype.handleError=function(t){this.errorHandler.handle(t)||u.alertMgr().handleError(t)},e.prototype.registerErrorHandler=function(t,e,o,r){this.errorHandler.register(r,t,o,e)},i([c.manager],e)}(c.BaseManager),v=t("./GameManager"),b=t("../Utils/DataLoader"),m=t("../Common/CoreCommon");cc._RF.pop()},{"../Common/CoreCommon":"CoreCommon","../Utils/DataLoader":"DataLoader","../Utils/ParamCodec":"ParamCodec","./AlertManager":"AlertManager","./BaseManager":"BaseManager","./GameManager":"GameManager","./LoadingManager":"LoadingManager"}],NumberUtils:[function(t,e,o){"use strict";cc._RF.push(e,"23b75PVYbhAvpDbhsLVczXe","NumberUtils"),Object.defineProperty(o,"__esModule",{value:!0}),o.NumberUtils=o.autoUnitConvert=void 0,o.autoUnitConvert=function(t,e,o){var r=o.value;o.value=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var o=n.autoUnitConvert;try{return n.autoUnitConvert=!0,r.apply(this,t)}finally{n.autoUnitConvert=o}}};var r=Number.prototype.toString;Number.prototype.toString=function(t){return n.autoUnitConvert?n.toString(this):r.call(this,t)};var n=function(){function t(){}return t.toString=function(t){if(t<1e3)return t%1==0?""+t:t.toFixed(2);for(var e=0;e<5;e++){if(!(t>=1e3))return t>100?t.toFixed(1)+this.units[e]:t.toFixed(2)+this.units[e];t/=1e3}return t.toFixed(2)+this.units[5]},t.autoUnitConvert=!1,t.units=["","K","M","B","T","aa"],t}();o.NumberUtils=n,cc._RF.pop()},{}],PVPBattleDisplay:[function(t,e,o){"use strict";cc._RF.push(e,"14de9JwCu1PXbb6ysIklswQ","PVPBattleDisplay");var r,n=this&&this.__extends||(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),i=this&&this.__decorate||function(t,e,o,r){var n,i=arguments.length,a=i<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,o):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,o,r);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(a=(i<3?n(a):i>3?n(e,o,a):n(e,o))||a);return i>3&&a&&Object.defineProperty(e,o,a),a};Object.defineProperty(o,"__esModule",{value:!0});var a=t("../BattleDisplay"),s=cc.Label,c=cc.ProgressBar,l=sp.Skeleton,u=cc.Sprite,p=cc.SpriteFrame,f=t("../../../../Utils/SpineUtils"),d=cc.Node,h=cc._decorator,y=h.ccclass,g=h.property,v=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.heroLevelLabels=[],e.heroAvatarSkeletons=[],e.heroQualitySprites=[],e.heroRestraintSprites=[],e.heroQualityPictures=[],e.heroRestraintPictures=[],e.heroHpProgressBars=[],e.heroHpLabels=[],e.size=93,e.avatarHeight=[0,0],e.avatarWidth=[0,0],e.avatarOffsetX=[0,0],e.avatarOffsetY=[0,0],e}return n(e,t),e.prototype.start=function(){t.prototype.start.call(this)},e.prototype.refresh=function(){t.prototype.refresh.call(this),this.setupHeroes()},e.prototype.setupHeroes=function(){var t=this;console.log("setupHeroes",this.heroLevelLabels,this.battlers,this.battlers.length),this.heroLevelLabels.forEach(function(e,o){return e.string=t.battlers[o].item.hero().level.level.toString()}),this.heroQualitySprites.forEach(function(e,o){return e.spriteFrame=t.heroQualityPictures[t.battlers[o].item.hero().quality]}),this.heroRestraintSprites.forEach(function(e,o){return e.spriteFrame=t.heroRestraintPictures[t.battlers[o].item.hero().restraint]}),this.heroHpProgressBars.forEach(function(e,o){return e.reverse=t.battlers[o].flip}),this.drawAvatar()},e.prototype.update=function(e){this.item&&(t.prototype.update.call(this,e),this.updateHpBars())},e.prototype.updateHpBars=function(){var t=this;this.heroHpLabels.forEach(function(e,o){return e.string=t.battlers[o].item.hp+"/"+t.battlers[o].item.mhp}),this.heroHpProgressBars.forEach(function(e,o){return e.progress=t.battlers[o].item.hp/t.battlers[o].item.mhp})},e.prototype.drawAvatar=function(){for(var t=this,e=function(e){var r=new d("node"),n=r.addComponent(l),i=new f.HeroSkeleton(o.heroAvatarSkeletons[e],n,o.item.battlers[e].hero().heroTypeId);o.item.battlers[e].hero().parts.forEach(function(t){i.addPart(t)}),i.refresh().then(function(){r.destroy();var o=i.findBone("head_1");i.skeleton.updateWorldTransform();for(var n=o.worldX,a=o.worldY;o.parent;)o=o.parent;o.x-=n,o.y-=a;var s=i.findSlot("head_1");s.getAttachment()&&(t.avatarHeight[e]=s.getAttachment().height,t.avatarWidth[e]=s.getAttachment().width,t.avatarOffsetY[e]=s.getAttachment().x,t.avatarOffsetX[e]=s.getAttachment().y,t.sizeFilter(e))})},o=this,r=0;r<2;r++)e(r)},e.prototype.sizeFilter=function(t){var e=Math.min(this.avatarWidth[t]/this.size,this.avatarHeight[t]/this.size);e*=1.2,this.heroAvatarSkeletons[t].node.y=-this.avatarOffsetY[t]/e,this.heroAvatarSkeletons[t].node.scale=e>1?1/e:1,this.heroAvatarSkeletons[t].node.scaleX*=this.battlers[t].flip?1:-1},i([g([s])],e.prototype,"heroLevelLabels",void 0),i([g([l])],e.prototype,"heroAvatarSkeletons",void 0),i([g([u])],e.prototype,"heroQualitySprites",void 0),i([g([u])],e.prototype,"heroRestraintSprites",void 0),i([g([p])],e.prototype,"heroQualityPictures",void 0),i([g([p])],e.prototype,"heroRestraintPictures",void 0),i([g([c])],e.prototype,"heroHpProgressBars",void 0),i([g([s])],e.prototype,"heroHpLabels",void 0),i([y],e)}(a.default);o.default=v,cc._RF.pop()},{"../../../../Utils/SpineUtils":"SpineUtils","../BattleDisplay":"BattleDisplay"}],PVPRoomDisplay:[function(t,e,o){"use strict";cc._RF.push(e,"61ed9zolE1D2JLWzGXTkQfC","PVPRoomDisplay");var r,n=this&&this.__extends||(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),i=this&&this.__decorate||function(t,e,o,r){var n,i=arguments.length,a=i<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,o):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,o,r);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(a=(i<3?n(a):i>3?n(e,o,a):n(e,o))||a);return i>3&&a&&Object.defineProperty(e,o,a),a};Object.defineProperty(o,"__esModule",{value:!0});var a=cc.Sprite,s=cc.Label,c=cc.SpriteFrame,l=cc.Node,u=t("../../../../Scenes/BattleScene"),p=cc._decorator,f=p.ccclass,d=p.property,h=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.index=-1,e.icon=null,e.levelFrame=null,e.levelValue=null,e.tips1=null,e.tips2=null,e.frame=null,e.lock=null,e.iconPictures=[],e.framePictures=[],e}return n(e,t),e.prototype.start=function(){this.index>=0&&this.onIndexChange()},e.prototype.update=function(){-1==this.index&&(this.node.active=!1),this.frame.active=this.index==u.battleScene().currentPVPRoomIndex,this.lock.active=!u.battleScene().currentPVPSelect||u.battleScene().currentPVPSelect.level.level<=20*this.index},e.prototype.setIndex=function(t){this.index=t,this.onIndexChange()},e.prototype.onIndexChange=function(){this.node.active=!0,this.index<0||(this.icon.spriteFrame=this.iconPictures[this.index],this.levelFrame.spriteFrame=this.framePictures[this.index],this.levelValue.string=0==this.index?"01-20":20*this.index+1+"-"+20*(this.index+1))},e.prototype.onClick=function(){if(u.battleScene().currentPVPRoomIndex==this.index)return u.battleScene().currentPVPRoomIndex=-1;this.lock.active||(u.battleScene().currentPVPRoomIndex=this.index)},i([d(Number)],e.prototype,"index",void 0),i([d(a)],e.prototype,"icon",void 0),i([d(a)],e.prototype,"levelFrame",void 0),i([d(s)],e.prototype,"levelValue",void 0),i([d(s)],e.prototype,"tips1",void 0),i([d(s)],e.prototype,"tips2",void 0),i([d(l)],e.prototype,"frame",void 0),i([d(l)],e.prototype,"lock",void 0),i([d([c])],e.prototype,"iconPictures",void 0),i([d([c])],e.prototype,"framePictures",void 0),i([f],e)}(cc.Component);o.default=h,cc._RF.pop()},{"../../../../Scenes/BattleScene":"BattleScene"}],PVPRoom:[function(t,e,o){"use strict";cc._RF.push(e,"ce989kniehGmaKr4EjGoIqy","PVPRoom");var r,n=this&&this.__extends||(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),i=this&&this.__decorate||function(t,e,o,r){var n,i=arguments.length,a=i<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,o):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,o,r);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(a=(i<3?n(a):i>3?n(e,o,a):n(e,o))||a);return i>3&&a&&Object.defineProperty(e,o,a),a};Object.defineProperty(o,"__esModule",{value:!0}),o.PVPRoomRepo=o.pvpRoomRepo=o.PVPRoom=void 0;var a=t("../../CoreModule/Data/StaticData"),s=t("../../CoreModule/Data/BaseRepository"),c=t("../../CoreModule/Data/BaseData"),l=8,u=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.levelRange=[0,20],e.rankRange=[-.01,.05],e.playerCount=l,e}return n(e,t),i([c.field([Number])],e.prototype,"levelRange",void 0),i([c.field([Number])],e.prototype,"rankRange",void 0),i([c.field],e.prototype,"playerCount",void 0),i([a.data("PVPRoom")],e)}(a.StaticData);o.PVPRoom=u,o.pvpRoomRepo=function(){return s.getRepository(p)};var p=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),Object.defineProperty(e.prototype,"clazz",{get:function(){return u},enumerable:!1,configurable:!0}),i([s.repository],e)}(s.BaseRepository);o.PVPRoomRepo=p,cc._RF.pop()},{"../../CoreModule/Data/BaseData":"BaseData","../../CoreModule/Data/BaseRepository":"BaseRepository","../../CoreModule/Data/StaticData":"StaticData"}],PVPWindowController:[function(t,e,o){"use strict";cc._RF.push(e,"c2dafC/taFPJbaE9y/copq/","PVPWindowController");var r,n=this&&this.__extends||(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),i=this&&this.__decorate||function(t,e,o,r){var n,i=arguments.length,a=i<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,o):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,o,r);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(a=(i<3?n(a):i>3?n(e,o,a):n(e,o))||a);return i>3&&a&&Object.defineProperty(e,o,a),a};Object.defineProperty(o,"__esModule",{value:!0});var a=cc.Node,s=t("../../../../Scenes/BattleScene"),c=cc.Label,l=t("../../../PlayerModule/Managers/PlayerManager"),u=t("../../Data/PlayerBattle"),p=cc._decorator,f=p.ccclass,d=p.property,h=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.roomsSelectNode=null,e.playersSelectNode=null,e.heroesSelectNode=null,e.rankNode=null,e.battleChanceNode=null,e.battleChance=null,e.fighting=!1,e}return n(e,t),e.prototype.update=function(){this.roomsSelectNode.active=!this.fighting&&!s.battleScene().roomSelected,this.playersSelectNode.active=!this.fighting&&s.battleScene().roomSelected,this.battleChanceNode.active=!this.fighting},e.prototype.onEnable=function(){this.pvpBtn(),s.battleScene().currentPVPSelect&&(s.battleScene().heroSelected=!0),this.drawBattleChance()},e.prototype.drawBattleChance=function(){var t=l.playerMgr().getPlayerData(u.PlayerBattle);this.battleChance.string=t.battleChance.toString()},e.prototype.onDisable=function(){s.battleScene().roomSelected=!1,s.battleScene().heroSelected=!1,s.battleScene().currentPVPRoomIndex=-1,s.battleScene().currentTargetSelect=null},e.prototype.pvpBtn=function(){this.heroesSelectNode.active=!0,this.rankNode.active=!1},e.prototype.rankBtn=function(){this.heroesSelectNode.active=!1,this.rankNode.active=!0},e.prototype.confirmRoomBtn=function(){-1!=s.battleScene().currentPVPRoomIndex&&(s.battleScene().roomSelected=!0)},e.prototype.backBtn=function(){s.battleScene().roomSelected=!1},e.prototype.confirmBattleBtn=function(){s.battleScene().startPVPBattle().then(),this.fighting=!0},e.prototype.refreshBtn=function(){},i([d(a)],e.prototype,"roomsSelectNode",void 0),i([d(a)],e.prototype,"playersSelectNode",void 0),i([d(a)],e.prototype,"heroesSelectNode",void 0),i([d(a)],e.prototype,"rankNode",void 0),i([d(a)],e.prototype,"battleChanceNode",void 0),i([d(c)],e.prototype,"battleChance",void 0),i([l.waitForLogin],e.prototype,"drawBattleChance",null),i([f],e)}(cc.Component);o.default=h,cc._RF.pop()},{"../../../../Scenes/BattleScene":"BattleScene","../../../PlayerModule/Managers/PlayerManager":"PlayerManager","../../Data/PlayerBattle":"PlayerBattle"}],ParamCodec:[function(t,e,o){"use strict";cc._RF.push(e,"677af1Ea49PG4SlgpSlK4cx","ParamCodec"),Object.defineProperty(o,"__esModule",{value:!0}),o.ParamCodec=void 0;var r=function(){function t(){}return t.encode=function(t){null==this.perms&&this.init();for(var e=(new TextEncoder).encode(t),o=this.hash(e),r="",n=0;n<4;n++)r+=this.charset[o>>4*n&15];for(n=0;n<e.length;n++){var i=e[n];o=this.nextInt(o);var a=(i=this.shuffleByte(i,this.perms[o%40320]))>>4,s=15&i;r+=this.charset[a]+this.charset[s]}return r},t.decode=function(t){null==this.perms&&this.init();var e=(new TextEncoder).encode(t);if(e.length<4)return null;if((e.length-4)%2!=0)return null;for(var o=0,r=[],n=0,i=1;n<4;n++,i*=16){var a=this.charset.indexOf(String.fromCharCode(e[n]));if(a<0)return null;o+=i*a}for(n=0;n<e.length-4;n+=2){var s=this.charset.indexOf(String.fromCharCode(e[n+4])),c=this.charset.indexOf(String.fromCharCode(e[n+5]));if(s<0||c<0)return null;var l=16*s+c;o=this.nextInt(o),l=this.deshuffleByte(l,this.perms[o%40320]),r.push(l)}var u=new Uint8Array(r);return(new TextDecoder).decode(u)},t.init=function(){this.perms=[];for(var t=[0,1,2,3,4,5,6,7],e=0;e<40320;e++)this.perms.push(t.slice()),this.nextPermutation(t)},t.nextInt=function(t){return(5461*t+97)%65520},t.hash=function(t){for(var e=43,o=0;o<t.length;o++)e=(97*e+t[o])%40320;return e},t.shuffleByte=function(t,e){for(var o=[],r=0;r<8;r++)o[e[r]]=t%2,t>>=1;return this.array2byte(o)},t.deshuffleByte=function(t,e){for(var o=[],r=[],n=0;n<8;n++)o[n]=t%2,t>>=1;for(n=0;n<8;n++)r[n]=o[e[n]];return this.array2byte(r)},t.array2byte=function(t){for(var e=1,o=0,r=0;r<8;r++)o+=e*t[r],e*=2;return o},t.nextPermutation=function(t){var e,o,r=t.length;for(e=r-2;e>=0;e--)if(!(t[e+1]<=t[e])){for(o=r-1;o>e&&!(t[o]>t[e]);o--);return this.swap(t,e,o),void this.reverse(t,e+1)}t.reverse()},t.swap=function(t,e,o){var r=t[e];t[e]=t[o],t[o]=r},t.reverse=function(t,e){for(var o=t.length-1;e<o;)this.swap(t,e,o),e++,o--},t.charset="0123456789ABCDEF",t.perms=void 0,t}();o.ParamCodec=r,cc._RF.pop()},{}],Param:[function(t,e,o){"use strict";cc._RF.push(e,"fce55bF89tDtatV6MNTHJR9","Param");var r,n=this&&this.__extends||(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),i=this&&this.__decorate||function(t,e,o,r){var n,i=arguments.length,a=i<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,o):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,o,r);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(a=(i<3?n(a):i>3?n(e,o,a):n(e,o))||a);return i>3&&a&&Object.defineProperty(e,o,a),a};Object.defineProperty(o,"__esModule",{value:!0}),o.ParamRepo=o.paramRepo=o.Param=o.ParamType=void 0;var a,s=t("../../CoreModule/Data/StaticData"),c=t("../../CoreModule/Data/BaseRepository"),l=t("../../CoreModule/Data/BaseData");(function(t){t[t.CP=0]="CP",t[t.CPB=1]="CPB",t[t.HID=2]="HID",t[t.POW=3]="POW",t[t.AGI=4]="AGI",t[t.INT=5]="INT",t[t.POWB=6]="POWB",t[t.AGIB=7]="AGIB",t[t.INTB=8]="INTB",t[t.ATK=9]="ATK",t[t.CRI=10]="CRI",t[t.DMG=11]="DMG",t[t.ATKB=12]="ATKB",t[t.CRIB=13]="CRIB",t[t.DMGB=14]="DMGB",t[t.DEF=15]="DEF",t[t.AVO=16]="AVO",t[t.EVA=17]="EVA",t[t.DEFB=18]="DEFB",t[t.AVOB=19]="AVOB",t[t.EVAB=20]="EVAB",t[t.MHP=21]="MHP",t[t.SPD=22]="SPD",t[t.HIT=23]="HIT",t[t.MHPB=24]="MHPB",t[t.SPDB=25]="SPDB",t[t.HITB=26]="HITB",t[t.AB1=27]="AB1",t[t.AB2=28]="AB2",t[t.AB3=29]="AB3",t[t.AB4=30]="AB4",t[t.BP=31]="BP",t[t.BPB=32]="BPB"})(a=o.ParamType||(o.ParamType={}));var u=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.default_=0,e.min=0,e.max=999999,e.isPercent=!1,e.battlePoint=0,e}return n(e,t),Object.defineProperty(e.prototype,"shortName",{get:function(){return a[this.id]},enumerable:!1,configurable:!0}),i([l.field(Number)],e.prototype,"id",void 0),i([l.field(String)],e.prototype,"attr",void 0),i([l.field],e.prototype,"default_",void 0),i([l.field],e.prototype,"min",void 0),i([l.field],e.prototype,"max",void 0),i([l.field],e.prototype,"isPercent",void 0),i([l.field([Number])],e.prototype,"bonus",void 0),i([l.field],e.prototype,"battlePoint",void 0),i([s.data("Param")],e)}(s.StaticData);o.Param=u,o.paramRepo=function(){return c.getRepository(p)};var p=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),Object.defineProperty(e.prototype,"clazz",{get:function(){return u},enumerable:!1,configurable:!0}),e.prototype.getById=function(e){return t.prototype.getById.call(this,e)},e.prototype.getByAttr=function(){},i([c.repository],e)}(c.BaseRepository);o.ParamRepo=p,cc._RF.pop()},{"../../CoreModule/Data/BaseData":"BaseData","../../CoreModule/Data/BaseRepository":"BaseRepository","../../CoreModule/Data/StaticData":"StaticData"}],PartColorsContainer:[function(t,e,o){"use strict";cc._RF.push(e,"fdb403ccO9EeYJtNamdyOLa","PartColorsContainer");var r,n=this&&this.__extends||(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),i=this&&this.__decorate||function(t,e,o,r){var n,i=arguments.length,a=i<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,o):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,o,r);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(a=(i<3?n(a):i>3?n(e,o,a):n(e,o))||a);return i>3&&a&&Object.defineProperty(e,o,a),a},a=this&&this.__awaiter||function(t,e,o,r){return new(o||(o=Promise))(function(n,i){function a(t){try{c(r.next(t))}catch(e){i(e)}}function s(t){try{c(r.throw(t))}catch(e){i(e)}}function c(t){var e;t.done?n(t.value):(e=t.value,e instanceof o?e:new o(function(t){t(e)})).then(a,s)}c((r=r.apply(t,e||[])).next())})},s=this&&this.__generator||function(t,e){var o,r,n,i,a={label:0,sent:function(){if(1&n[0])throw n[1];return n[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(t){return function(e){return c([t,e])}}function c(i){if(o)throw new TypeError("Generator is already executing.");for(;a;)try{if(o=1,r&&(n=2&i[0]?r.return:i[0]?r.throw||((n=r.return)&&n.call(r),0):r.next)&&!(n=n.call(r,i[1])).done)return n;switch(r=0,n&&(i=[2&i[0],n.value]),i[0]){case 0:case 1:n=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,r=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(n=(n=a.trys).length>0&&n[n.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!n||i[1]>n[0]&&i[1]<n[3])){a.label=i[1];break}if(6===i[0]&&a.label<n[1]){a.label=n[1],n=i;break}if(n&&a.label<n[2]){a.label=n[2],a.ops.push(i);break}n[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(s){i=[6,s],r=0}finally{o=n=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}};Object.defineProperty(o,"__esModule",{value:!0});var c=t("../../../../Modules/CoreModule/Components/ItemContainer"),l=t("../ItemPrefabs/PartsDisplay"),u=t("../ItemPrefabs/PreviewPictureDisplay"),p=t("./PartsSelectionGroup"),f=t("../../../../Modules/CoreModule/Utils/ScrollviewFilter"),d=t("../ItemPrefabs/PartsSelection"),h=t("../../../../Modules/HeroModule/Managers/PartManager"),y=t("../../../../Modules/NFTModule/Managers/NFTManager"),g=cc._decorator,v=g.ccclass,b=g.property,m=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.preview=null,e.selectionGroup=null,e.singleEditor=null,e.currentHeroType=null,e.currentPartType=null,e}return n(e,t),Object.defineProperty(e.prototype,"hero",{get:function(){return this.preview.item},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"partTypeId",{get:function(){var t;return null===(t=this.items[0])||void 0===t?void 0:t.partTypeId},enumerable:!1,configurable:!0}),e.prototype.update=function(){var t=this.itemsComponents.map(function(t){return t.node}).filter(function(t){return t.active});f.ScrollviewFilter.filter("vertical",this.container,t,20,this.node.height,20,Math.floor(this.container.width/120))},e.prototype.makeSelectionGroup=function(){var t=this;this.selectionGroup=new p.default,this.itemsComponents.forEach(function(e){var o=e.node.getComponent(d.default);o.display=o.getComponent(l.default),o.container=t,t.selectionGroup.addElement(o)}),this.selectionGroup.select(this.selectionGroup.getElementAt(0)),this.node.active=!0},e.prototype.onItemDisplayCreated=function(t){t.preview=this.preview},e.prototype.onItemsChanged=function(){t.prototype.onItemsChanged.call(this),this.makeSelectionGroup()},e.prototype.onHeroTypeChange=function(){return a(this,void 0,void 0,function(){return s(this,function(t){switch(t.label){case 0:return[4,this.preview.setHeroType(this.currentHeroType)];case 1:return t.sent(),[2]}})})},e.prototype.onTypeChange=function(){return a(this,void 0,void 0,function(){var t;return s(this,function(e){switch(e.label){case 0:return this.currentHeroType&&this.currentPartType?(t=this.setItems,[4,h.partMgr().getList(y.DefaultBt1,y.DefaultBt2,this.currentPartType)]):[2];case 1:return t.apply(this,[e.sent()]),[2]}})})},e.prototype.onSelectChanged=function(t){var e;this.preview.addPart(t.item.part),null===(e=this.singleEditor)||void 0===e||e.setItem(t.item),this.node.active=!1},e.prototype.onSelectCancel=function(t){this.selectionGroup.select(t.node.getComponent(d.default))},i([b(u.default)],e.prototype,"preview",void 0),i([v],e)}(c.ItemContainer);o.default=m,cc._RF.pop()},{"../../../../Modules/CoreModule/Components/ItemContainer":"ItemContainer","../../../../Modules/CoreModule/Utils/ScrollviewFilter":"ScrollviewFilter","../../../../Modules/HeroModule/Managers/PartManager":"PartManager","../../../../Modules/NFTModule/Managers/NFTManager":"NFTManager","../ItemPrefabs/PartsDisplay":"PartsDisplay","../ItemPrefabs/PartsSelection":"PartsSelection","../ItemPrefabs/PreviewPictureDisplay":"PreviewPictureDisplay","./PartsSelectionGroup":"PartsSelectionGroup"}],PartConfig:[function(t,e,o){"use strict";cc._RF.push(e,"606b0lr0olFTJPctjgyNcQ2","PartConfig");var r,n=this&&this.__extends||(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),i=this&&this.__decorate||function(t,e,o,r){var n,i=arguments.length,a=i<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,o):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,o,r);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(a=(i<3?n(a):i>3?n(e,o,a):n(e,o))||a);return i>3&&a&&Object.defineProperty(e,o,a),a};Object.defineProperty(o,"__esModule",{value:!0});var a=t("../../CoreModule/Data/BaseConfig"),s=t("../../CoreModule/Data/BaseData"),c=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.slotOrders={},e.slotNameMap={},e.pHtScale=[],e.ptBptScale={},e.ptBptOffset={},e.ptBptHidden={},e.clothes6Problem={},e}return n(e,t),i([s.field],e.prototype,"slotOrders",void 0),i([s.field],e.prototype,"slotNameMap",void 0),i([s.field],e.prototype,"pHtScale",void 0),i([s.field],e.prototype,"ptBptScale",void 0),i([s.field],e.prototype,"ptBptOffset",void 0),i([s.field],e.prototype,"ptBptHidden",void 0),i([s.field],e.prototype,"clothes6Problem",void 0),i([a.config("PartConfig")],e)}(a.BaseConfig);o.default=c,cc._RF.pop()},{"../../CoreModule/Data/BaseConfig":"BaseConfig","../../CoreModule/Data/BaseData":"BaseData"}],PartInfo:[function(t,e,o){"use strict";cc._RF.push(e,"dd00d1QhnhIo6nZthUAgf4+","PartInfo");var r,n=this&&this.__extends||(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)});Object.defineProperty(o,"__esModule",{value:!0}),o.PartInfo=void 0;var i=t("../../CoreModule/Data/BaseData"),a=t("./Part"),s=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.name="",e.partTypeId=-1,e.price=0,e.stock=0,e.url="",e}return n(e,t),Object.defineProperty(e.prototype,"part",{get:function(){return this._part||(this._part=a.partRepo().getById(this.partId))},enumerable:!1,configurable:!0}),e}(i.BaseData);o.PartInfo=s,cc._RF.pop()},{"../../CoreModule/Data/BaseData":"BaseData","./Part":"Part"}],PartManager:[function(t,e,o){"use strict";cc._RF.push(e,"7f597fRZI5L964VtexTwbQu","PartManager");var r,n=this&&this.__extends||(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),i=this&&this.__decorate||function(t,e,o,r){var n,i=arguments.length,a=i<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,o):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,o,r);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(a=(i<3?n(a):i>3?n(e,o,a):n(e,o))||a);return i>3&&a&&Object.defineProperty(e,o,a),a},a=this&&this.__awaiter||function(t,e,o,r){return new(o||(o=Promise))(function(n,i){function a(t){try{c(r.next(t))}catch(e){i(e)}}function s(t){try{c(r.throw(t))}catch(e){i(e)}}function c(t){var e;t.done?n(t.value):(e=t.value,e instanceof o?e:new o(function(t){t(e)})).then(a,s)}c((r=r.apply(t,e||[])).next())})},s=this&&this.__generator||function(t,e){var o,r,n,i,a={label:0,sent:function(){if(1&n[0])throw n[1];return n[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(t){return function(e){return c([t,e])}}function c(i){if(o)throw new TypeError("Generator is already executing.");for(;a;)try{if(o=1,r&&(n=2&i[0]?r.return:i[0]?r.throw||((n=r.return)&&n.call(r),0):r.next)&&!(n=n.call(r,i[1])).done)return n;switch(r=0,n&&(i=[2&i[0],n.value]),i[0]){case 0:case 1:n=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,r=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(n=(n=a.trys).length>0&&n[n.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!n||i[1]>n[0]&&i[1]<n[3])){a.label=i[1];break}if(6===i[0]&&a.label<n[1]){a.label=n[1],n=i;break}if(n&&a.label<n[2]){a.label=n[2],a.ops.push(i);break}n[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(s){i=[6,s],r=0}finally{o=n=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}};Object.defineProperty(o,"__esModule",{value:!0}),o.partMgr=void 0;var c=t("../../CoreModule/Managers/BaseManager"),l=t("../../NFTModule/Managers/NFTManager"),u=t("../Data/PartInfo"),p=t("../Data/Part");o.partMgr=function(){return c.getManager(f)};var f=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.data={},e}return n(e,t),e.prototype.getOne=function(t,e,o,r,n){return a(this,void 0,void 0,function(){var i;return s(this,function(a){switch(a.label){case 0:return[4,this.getList(t,e,o,n)];case 1:return[2,null==(i=a.sent())?void 0:i.find(function(t){return t.partId==r})]}})})},e.prototype.getList=function(t,e,o,r){return a(this,void 0,void 0,function(){var n,i,a=this;return s(this,function(s){switch(s.label){case 0:return(n=this.getCacheList(t,e,o))&&!r?[3,3]:(i=p.partRepo().findByPartTypeId(o.id),n=this.data[this.getKey(t,e,o)]=i.map(function(t){return t.toPartInfo()}),[3,3]);case 1:return[4,l.nftMgr().getPartList(t,e,o)];case 2:s.sent().filter(function(t){return a.isValid(t)}).forEach(function(r){return a.add(t,e,o,r)}),n=this.getCacheList(t,e,o),s.label=3;case 3:return[2,n]}})})},e.prototype.getCacheOne=function(t,e,o,r){var n=this.getCacheList(t,e,o);return null==n?void 0:n.find(function(t){return t.partId==r})},e.prototype.getCacheList=function(t,e,o){return this.data[this.getKey(t,e,o)]},e.prototype.getOrCreateCacheList=function(t,e,o){var r,n;return(r=this.data)[n=this.getKey(t,e,o)]||(r[n]=[])},e.prototype.add=function(t,e,o,r){var n=Number(r.componentId)-l.PartIdOffset,i=this.getOrCreateCacheList(t,e,o),a=this.getCacheOne(t,e,o,n);return a||i.push(a=new u.PartInfo),this.convert(r,a)},e.prototype.getKey=function(t,e,o){return t+"_"+e+"_"+o.id},e.prototype.isValid=function(t){var e=Number(t.componentId)-l.PartIdOffset;return!!p.partRepo().getById(e)},e.prototype.convert=function(t,e){return e||(e=new u.PartInfo),e.partId=Number(t.componentId)-l.PartIdOffset,e.name=t.name,e.partTypeId=Number(t.ct)-l.PartTypeIdOffset,e.price=l.nftMgr().convertPrice(t.prices[0].price),e.stock=Number(t.stock),e.rawData=t,e},i([c.manager],e)}(c.BaseManager);cc._RF.pop()},{"../../CoreModule/Managers/BaseManager":"BaseManager","../../NFTModule/Managers/NFTManager":"NFTManager","../Data/Part":"Part","../Data/PartInfo":"PartInfo"}],PartTypeContainer:[function(t,e,o){"use strict";cc._RF.push(e,"b892cJIhqVNn4UDvm7nmALC","PartTypeContainer");var r,n=this&&this.__extends||(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),i=this&&this.__decorate||function(t,e,o,r){var n,i=arguments.length,a=i<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,o):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,o,r);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(a=(i<3?n(a):i>3?n(e,o,a):n(e,o))||a);return i>3&&a&&Object.defineProperty(e,o,a),a};Object.defineProperty(o,"__esModule",{value:!0});var a=t("../../../../Modules/CoreModule/Components/ItemContainer"),s=t("../../../../Modules/HeroModule/Data/PartType"),c=t("./PartsContainer"),l=t("../ItemPrefabs/PartTypeDisplay"),u=t("./PartTypeSelectionGroup"),p=t("../ItemPrefabs/PartTypeSelection"),f=t("../../../../Modules/CoreModule/Managers/DataManager"),d=cc.Boolean,h=cc._decorator,y=h.ccclass,g=h.property,v=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.partsContainer=null,e.includeBackground=!0,e.relative=null,e.selectionGroup=null,e.globalEditor=null,e}var o;return n(e,t),o=e,e.prototype.isInclude=function(e){return t.prototype.isInclude.call(this,e)&&(this.includeBackground||!e.isBackground)},e.prototype.makeSelectionGroup=function(){var t=this;this.selectionGroup=new u.default(!1),this.itemsComponents.forEach(function(e){var o=e.node.getComponent(p.default);o.display=o.getComponent(l.default),o.container=t,t.selectionGroup.addElement(o)})},e.prototype.start=function(){this.setup()},e.prototype.setup=function(){this.setItems(s.partTypeRepo().list)},e.prototype.update=function(){var t=this;this.itemsComponents.forEach(function(e){return e.node.active?e.size=t.container.width/t.items.length:null})},e.prototype.onItemsChanged=function(){t.prototype.onItemsChanged.call(this),this.makeSelectionGroup()},e.prototype.onSelectChanged=function(t){var e,o;if(this.relative){var r=this.selectionGroup.currentSelection(),n=this.selectionGroup.indexOf(r),i=null===(e=this.relative)||void 0===e?void 0:e.selectionGroup;i.select(i.getElementAt(n))}this.partsContainer&&(this.partsContainer.optional=t.item.optional,this.partsContainer.currentPartType=t.item,this.partsContainer.onTypeChange().then()),null===(o=this.globalEditor)||void 0===o||o.setItem(t.item)},i([g(c.default)],e.prototype,"partsContainer",void 0),i([g(d)],e.prototype,"includeBackground",void 0),i([g(o)],e.prototype,"relative",void 0),i([f.waitForDataLoad],e.prototype,"setup",null),i([y],e)}(a.ItemContainer);o.default=v,cc._RF.pop()},{"../../../../Modules/CoreModule/Components/ItemContainer":"ItemContainer","../../../../Modules/CoreModule/Managers/DataManager":"DataManager","../../../../Modules/HeroModule/Data/PartType":"PartType","../ItemPrefabs/PartTypeDisplay":"PartTypeDisplay","../ItemPrefabs/PartTypeSelection":"PartTypeSelection","./PartTypeSelectionGroup":"PartTypeSelectionGroup","./PartsContainer":"PartsContainer"}],PartTypeDisplay:[function(t,e,o){"use strict";cc._RF.push(e,"69bccQ/AsROl5wStxrIHj1P","PartTypeDisplay");var r,n=this&&this.__extends||(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),i=this&&this.__decorate||function(t,e,o,r){var n,i=arguments.length,a=i<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,o):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,o,r);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(a=(i<3?n(a):i>3?n(e,o,a):n(e,o))||a);return i>3&&a&&Object.defineProperty(e,o,a),a};Object.defineProperty(o,"__esModule",{value:!0});var a=t("../../../../Modules/CoreModule/Components/ItemDisplay"),s=cc.Label,c=cc.Node,l=cc.Color,u=t("../../SelectorScene"),p=cc._decorator,f=p.ccclass,d=p.property,h=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.label=null,e.background=null,e.bottomLine=null,e.size=0,e.isSelected=!1,e}return n(e,t),e.prototype.start=function(){},e.prototype.refresh=function(){t.prototype.refresh.call(this),null!=this.item&&(this.isSelected=!1,this.label.string=this.item.getDisplayName(),u.selectorScene().editorMode&&(this.label.string=this.item.id+" "+this.label.string))},e.prototype.update=function(){this.node.width=Math.max(this.size,40),this.bottomLine.width=this.node.width+10,this.label.node.color=this.isSelected?new l(255,255,255):new l(159,157,180),this.bottomLine.opacity=this.isSelected?255:0},e.prototype.onSelectChanged=function(t){this.isSelected=t},i([d(s)],e.prototype,"label",void 0),i([d(c)],e.prototype,"background",void 0),i([d(c)],e.prototype,"bottomLine",void 0),i([f],e)}(a.ItemDisplay);o.default=h,cc._RF.pop()},{"../../../../Modules/CoreModule/Components/ItemDisplay":"ItemDisplay","../../SelectorScene":"SelectorScene"}],PartTypeSelectionGroup:[function(t,e,o){"use strict";cc._RF.push(e,"bfa49sJAZ9Icp2lxk9DurIh","PartTypeSelectionGroup");var r,n=this&&this.__extends||(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),i=this&&this.__decorate||function(t,e,o,r){var n,i=arguments.length,a=i<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,o):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,o,r);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(a=(i<3?n(a):i>3?n(e,o,a):n(e,o))||a);return i>3&&a&&Object.defineProperty(e,o,a),a};Object.defineProperty(o,"__esModule",{value:!0});var a=t("../../../../Modules/CoreModule/Components/SelectableGroup"),s=cc._decorator,c=s.ccclass,l=(s.property,function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),i([c],e)}(a.SelectableGroup));o.default=l,cc._RF.pop()},{"../../../../Modules/CoreModule/Components/SelectableGroup":"SelectableGroup"}],PartTypeSelection:[function(t,e,o){"use strict";cc._RF.push(e,"7edd518XgpD1oCLg41qN7C7","PartTypeSelection");var r,n=this&&this.__extends||(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),i=this&&this.__decorate||function(t,e,o,r){var n,i=arguments.length,a=i<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,o):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,o,r);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(a=(i<3?n(a):i>3?n(e,o,a):n(e,o))||a);return i>3&&a&&Object.defineProperty(e,o,a),a};Object.defineProperty(o,"__esModule",{value:!0});var a=t("../../../../Modules/CoreModule/Components/SelectableObject"),s=cc._decorator,c=s.ccclass,l=(s.property,function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.display=null,e.container=null,e}return n(e,t),e.prototype.onDeselected=function(){this.display.onSelectChanged(!1)},e.prototype.onSelected=function(){this.display.onSelectChanged(!0),this.container.onSelectChanged(this.display)},i([c],e)}(a.SelectableObject));o.default=l,cc._RF.pop()},{"../../../../Modules/CoreModule/Components/SelectableObject":"SelectableObject"}],PartType:[function(t,e,o){"use strict";cc._RF.push(e,"26acd4IVOJFnZOtuVb2AJq/","PartType");var r,n=this&&this.__extends||(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),i=this&&this.__decorate||function(t,e,o,r){var n,i=arguments.length,a=i<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,o):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,o,r);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(a=(i<3?n(a):i>3?n(e,o,a):n(e,o))||a);return i>3&&a&&Object.defineProperty(e,o,a),a};Object.defineProperty(o,"__esModule",{value:!0}),o.PartTypeRepo=o.partTypeRepo=o.PartType=o.SpecialPartType=void 0;var a,s=t("../../CoreModule/Data/BaseRepository"),c=t("../../CoreModule/Data/StaticData"),l=t("../../CoreModule/Data/BaseData");(function(t){t[t.Normal=0]="Normal",t[t.Body=1]="Body",t[t.Head=2]="Head",t[t.Clothes=3]="Clothes",t[t.Weapon=4]="Weapon",t[t.Background=5]="Background"})(a=o.SpecialPartType||(o.SpecialPartType={}));var u=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.name="",e.baseTypeId=-1,e.special=a.Normal,e.optional=!1,e.slotNames=[],e}return n(e,t),Object.defineProperty(e.prototype,"isBody",{get:function(){return this.special==a.Body},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isHead",{get:function(){return this.special==a.Head},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isClothes",{get:function(){return this.special==a.Clothes},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isWeapon",{get:function(){return this.special==a.Weapon},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isBackground",{get:function(){return this.special==a.Background},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"basePartType",{get:function(){return this.baseTypeId<0?null:p().getById(this.baseTypeId)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"subPartTypes",{get:function(){return p().findByBaseTypeId(this.id)},enumerable:!1,configurable:!0}),i([l.field],e.prototype,"name",void 0),i([l.field],e.prototype,"baseTypeId",void 0),i([l.field],e.prototype,"special",void 0),i([l.field],e.prototype,"optional",void 0),i([l.field([String])],e.prototype,"slotNames",void 0),i([c.data("PartType")],e)}(c.StaticData);function p(){return s.getRepository(f)}o.PartType=u,o.partTypeRepo=p;var f=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),Object.defineProperty(e.prototype,"clazz",{get:function(){return u},enumerable:!1,configurable:!0}),e.prototype.findByBaseTypeId=function(){},e.prototype.getBySpecial=function(){},e.prototype.rootPartTypes=function(){return this.findByBaseTypeId(-1)},Object.defineProperty(e.prototype,"body",{get:function(){return this.getBySpecial(a.Body)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"head",{get:function(){return this.getBySpecial(a.Head)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"clothes",{get:function(){return this.getBySpecial(a.Clothes)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"weapon",{get:function(){return this.getBySpecial(a.Weapon)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"background",{get:function(){return this.getBySpecial(a.Background)},enumerable:!1,configurable:!0}),i([s.repository],e)}(s.BaseRepository);o.PartTypeRepo=f,cc._RF.pop()},{"../../CoreModule/Data/BaseData":"BaseData","../../CoreModule/Data/BaseRepository":"BaseRepository","../../CoreModule/Data/StaticData":"StaticData"}],PartsContainer:[function(t,e,o){"use strict";cc._RF.push(e,"0c7f7iHb1ZN8oJXSbc7eaIR","PartsContainer");var r,n=this&&this.__extends||(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),i=this&&this.__decorate||function(t,e,o,r){var n,i=arguments.length,a=i<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,o):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,o,r);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(a=(i<3?n(a):i>3?n(e,o,a):n(e,o))||a);return i>3&&a&&Object.defineProperty(e,o,a),a},a=this&&this.__awaiter||function(t,e,o,r){return new(o||(o=Promise))(function(n,i){function a(t){try{c(r.next(t))}catch(e){i(e)}}function s(t){try{c(r.throw(t))}catch(e){i(e)}}function c(t){var e;t.done?n(t.value):(e=t.value,e instanceof o?e:new o(function(t){t(e)})).then(a,s)}c((r=r.apply(t,e||[])).next())})},s=this&&this.__generator||function(t,e){var o,r,n,i,a={label:0,sent:function(){if(1&n[0])throw n[1];return n[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(t){return function(e){return c([t,e])}}function c(i){if(o)throw new TypeError("Generator is already executing.");for(;a;)try{if(o=1,r&&(n=2&i[0]?r.return:i[0]?r.throw||((n=r.return)&&n.call(r),0):r.next)&&!(n=n.call(r,i[1])).done)return n;switch(r=0,n&&(i=[2&i[0],n.value]),i[0]){case 0:case 1:n=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,r=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(n=(n=a.trys).length>0&&n[n.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!n||i[1]>n[0]&&i[1]<n[3])){a.label=i[1];break}if(6===i[0]&&a.label<n[1]){a.label=n[1],n=i;break}if(n&&a.label<n[2]){a.label=n[2],a.ops.push(i);break}n[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(s){i=[6,s],r=0}finally{o=n=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}};Object.defineProperty(o,"__esModule",{value:!0});var c=t("../../../../Modules/CoreModule/Components/ItemContainer"),l=t("../ItemPrefabs/PartsDisplay"),u=t("../ItemPrefabs/PartsSelection"),p=t("./PartsSelectionGroup"),f=t("../../../../Modules/CoreModule/Utils/ScrollviewFilter"),d=t("../ItemPrefabs/PreviewPictureDisplay"),h=t("../../../../Modules/HeroModule/Data/PartType"),y=t("../../../../Modules/HeroModule/Managers/PartManager"),g=t("../../../../Modules/NFTModule/Managers/NFTManager"),v=t("../../SelectorScene"),b=t("./PartColorsContainer"),m=cc._decorator,_=m.ccclass,P=m.property,M=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.preview=null,e.colors=null,e.optional=!1,e.selectionGroup=null,e.singleEditor=null,e.currentHeroType=null,e.currentPartType=null,e.currentTotalParts=[],e}return n(e,t),Object.defineProperty(e.prototype,"hero",{get:function(){return this.preview.item},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"partTypeId",{get:function(){var t;return null===(t=this.items[0])||void 0===t?void 0:t.partTypeId},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"lastSelection",{get:function(){var t,e=this;return this.items.length<=0?null:null===(t=this.hero)||void 0===t?void 0:t.parts.find(function(t){return t.partTypeId==e.partTypeId})},enumerable:!1,configurable:!0}),e.prototype.isInclude=function(t){return!(!v.selectorScene().editorMode||this.currentPartType.isBody)||!this.preview.item||this.preview.item.calcScale(t.part)>0},e.prototype.update=function(){var t=this.itemsComponents.map(function(t){return t.node}).filter(function(t){return t.active});f.ScrollviewFilter.filter("vertical",this.container,t,20,this.node.height,20,Math.floor(this.container.width/120)),this.preview.partsChanged&&this.onPartsChanged()},e.prototype.reselect=function(){var t=this;if(this.currentPartType.special!=h.SpecialPartType.Background){var e=this.lastSelection;e?this.selectionGroup.select(this.selectionGroup.getElementAt(this.items.findIndex(function(t){return t.partId==e.id}))):this.selectionGroup.deselect(this.selectionGroup.currentSelection())}else{var o=this.items.find(function(e){return e.part==t.preview.backgroundPart});o?this.selectionGroup.select(this.selectionGroup.getElementAt(this.items.findIndex(function(t){return t.partId==o.part.id}))):this.selectionGroup.select(this.selectionGroup.getElementAt(0))}},e.prototype.makeSelectionGroup=function(){var t=this;this.selectionGroup=new p.default(this.optional),this.itemsComponents.forEach(function(e){var o=e.node.getComponent(u.default);o.display=o.getComponent(l.default),o.container=t,t.selectionGroup.addElement(o)})},e.prototype.onItemDisplayCreated=function(t){t.preview=this.preview},e.prototype.onItemsChanged=function(){t.prototype.onItemsChanged.call(this);var e=this.lastSelection;this.makeSelectionGroup(),this.preview.addPart(e),this.reselect(),this.colors&&(this.colors.node.active=!1)},e.prototype.onHeroTypeChange=function(){return a(this,void 0,void 0,function(){return s(this,function(t){switch(t.label){case 0:return[4,this.preview.setHeroType(this.currentHeroType)];case 1:return t.sent(),[2]}})})},e.prototype.onTypeChange=function(){return a(this,void 0,void 0,function(){var t;return s(this,function(e){switch(e.label){case 0:return this.currentHeroType&&this.currentPartType?(t=this,[4,y.partMgr().getList(g.DefaultBt1,g.DefaultBt2,this.currentPartType)]):[2];case 1:return t.currentTotalParts=e.sent(),this.setItems(this.currentTotalParts.filter(function(t){return t.part.id==t.part.oriId})),[2]}})})},e.prototype.onPartsChanged=function(){this.reselect()},e.prototype.onSelectChanged=function(t){var e;this.preview.addPart(t.item.part),null===(e=this.singleEditor)||void 0===e||e.setItem(t.item),this.colors&&(this.colors.node.active=!0,this.colors.setItems(this.currentTotalParts.filter(function(e){return e.part.oriId==t.item.part.oriId&&e.part.stock>0})))},e.prototype.switchColorSelector=function(){this.colors&&(this.colors.node.active=!this.colors.node.active)},e.prototype.onSelectCancel=function(t){var e;this.preview.removePart(t.item.part),null===(e=this.singleEditor)||void 0===e||e.setItem(null),this.colors.node.active=!1},i([P(d.default)],e.prototype,"preview",void 0),i([P(b.default)],e.prototype,"colors",void 0),i([_],e)}(c.ItemContainer);o.default=M,cc._RF.pop()},{"../../../../Modules/CoreModule/Components/ItemContainer":"ItemContainer","../../../../Modules/CoreModule/Utils/ScrollviewFilter":"ScrollviewFilter","../../../../Modules/HeroModule/Data/PartType":"PartType","../../../../Modules/HeroModule/Managers/PartManager":"PartManager","../../../../Modules/NFTModule/Managers/NFTManager":"NFTManager","../../SelectorScene":"SelectorScene","../ItemPrefabs/PartsDisplay":"PartsDisplay","../ItemPrefabs/PartsSelection":"PartsSelection","../ItemPrefabs/PreviewPictureDisplay":"PreviewPictureDisplay","./PartColorsContainer":"PartColorsContainer","./PartsSelectionGroup":"PartsSelectionGroup"}],PartsDisplay:[function(t,e,o){"use strict";cc._RF.push(e,"a502dHIkPZGX5sKD8I2lOGh","PartsDisplay");var r,n=this&&this.__extends||(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),i=this&&this.__decorate||function(t,e,o,r){var n,i=arguments.length,a=i<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,o):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,o,r);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(a=(i<3?n(a):i>3?n(e,o,a):n(e,o))||a);return i>3&&a&&Object.defineProperty(e,o,a),a};Object.defineProperty(o,"__esModule",{value:!0});var a=t("../../../../Modules/CoreModule/Components/ItemDisplay"),s=cc.Label,c=cc.Node,l=cc.Sprite,u=t("./PartsSelection"),p=cc.Color,f=t("../../SelectorScene"),d=t("./PreviewPictureDisplay"),h=cc._decorator,y=h.ccclass,g=h.property,v=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.picture=null,e.background=null,e.frame=null,e.padding=20,e.editor=null,e.id=null,e.htId=null,e.ban=null,e.preview=null,e.isSelected=!1,e}return n(e,t),e.prototype.update=function(){this.frame.active=this.isSelected,this.node.color=this.isSelected?new p(53,48,71):new p(36,32,47)},e.prototype.refresh=function(){t.prototype.refresh.call(this),null!=this.item&&(this.isSelected=!1,this.drawPicture(),f.selectorScene().editorMode&&(this.drawBan(),this.drawEditorInfo()))},e.prototype.drawEditorInfo=function(){if(this.editor){this.editor.active=!0;var t=this.item.partId,e=this.item.part.oriId;this.id.string=t==e?"#"+t:"#"+t+" ("+e+")",this.htId.string=this.item.part.heroTypeId.toString()}},e.prototype.drawPicture=function(){var t=this,e=this.item;this.picture.spriteFrame=null,this.item.part.picture().then(function(o){t.item==e&&(t.picture.spriteFrame=null==o?void 0:o.clone(),t.filterPicture())})},e.prototype.filterPicture=function(){var t=Math.max(this.picture.node.width/(this.node.width-this.padding),this.picture.node.height/(this.node.height-this.padding));t>1&&(this.picture.node.width/=t,this.picture.node.height/=t)},e.prototype.drawBan=function(){var t,e;this.ban.active=(null===(e=null===(t=this.preview)||void 0===t?void 0:t.item)||void 0===e?void 0:e.calcScale(this.item.part))<=0},e.prototype.onSelectChanged=function(t){this.isSelected=t,this.item.stock<=0&&this.node.getComponent(u.default).selectableGroup.deselect(this.node.getComponent(u.default).selectableGroup.currentSelection())},i([g(l)],e.prototype,"picture",void 0),i([g(c)],e.prototype,"background",void 0),i([g(c)],e.prototype,"frame",void 0),i([g(Number)],e.prototype,"padding",void 0),i([g(c)],e.prototype,"editor",void 0),i([g(s)],e.prototype,"id",void 0),i([g(s)],e.prototype,"htId",void 0),i([g(c)],e.prototype,"ban",void 0),i([g(d.default)],e.prototype,"preview",void 0),i([y],e)}(a.ItemDisplay);o.default=v,cc._RF.pop()},{"../../../../Modules/CoreModule/Components/ItemDisplay":"ItemDisplay","../../SelectorScene":"SelectorScene","./PartsSelection":"PartsSelection","./PreviewPictureDisplay":"PreviewPictureDisplay"}],PartsSelectionGroup:[function(t,e,o){"use strict";cc._RF.push(e,"7d777/8/6hAqJwAp/6cqFau","PartsSelectionGroup");var r,n=this&&this.__extends||(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),i=this&&this.__decorate||function(t,e,o,r){var n,i=arguments.length,a=i<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,o):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,o,r);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(a=(i<3?n(a):i>3?n(e,o,a):n(e,o))||a);return i>3&&a&&Object.defineProperty(e,o,a),a};Object.defineProperty(o,"__esModule",{value:!0});var a=t("../../../../Modules/CoreModule/Components/SelectableGroup"),s=cc._decorator,c=s.ccclass,l=(s.property,function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),i([c],e)}(a.SelectableGroup));o.default=l,cc._RF.pop()},{"../../../../Modules/CoreModule/Components/SelectableGroup":"SelectableGroup"}],PartsSelection:[function(t,e,o){"use strict";cc._RF.push(e,"bdcbeJL7+xNFpSO8SzwBAvU","PartsSelection");var r,n=this&&this.__extends||(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),i=this&&this.__decorate||function(t,e,o,r){var n,i=arguments.length,a=i<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,o):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,o,r);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(a=(i<3?n(a):i>3?n(e,o,a):n(e,o))||a);return i>3&&a&&Object.defineProperty(e,o,a),a};Object.defineProperty(o,"__esModule",{value:!0});var a=t("../../../../Modules/CoreModule/Components/SelectableObject"),s=t("../ItemContainers/PartsContainer"),c=cc._decorator,l=c.ccclass,u=(c.property,function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.display=null,e.container=null,e}return n(e,t),e.prototype.onDeselected=function(){this.display.onSelectChanged(!1),-1==this.selectableGroup.selectedIndex&&this.container.onSelectCancel(this.display)},e.prototype.onSelected=function(){this.display.onSelectChanged(!0),this.container.onSelectChanged(this.display)},e.prototype.toggleSelection=function(){this.container instanceof s.default&&this.container.switchColorSelector(),t.prototype.toggleSelection.call(this)},i([l],e)}(a.SelectableObject));o.default=u,cc._RF.pop()},{"../../../../Modules/CoreModule/Components/SelectableObject":"SelectableObject","../ItemContainers/PartsContainer":"PartsContainer"}],Part:[function(t,e,o){"use strict";cc._RF.push(e,"cf9f6pVDVtEkJi/nusyIRBp","Part");var r,n=this&&this.__extends||(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),i=this&&this.__decorate||function(t,e,o,r){var n,i=arguments.length,a=i<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,o):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,o,r);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(a=(i<3?n(a):i>3?n(e,o,a):n(e,o))||a);return i>3&&a&&Object.defineProperty(e,o,a),a},a=this&&this.__awaiter||function(t,e,o,r){return new(o||(o=Promise))(function(n,i){function a(t){try{c(r.next(t))}catch(e){i(e)}}function s(t){try{c(r.throw(t))}catch(e){i(e)}}function c(t){var e;t.done?n(t.value):(e=t.value,e instanceof o?e:new o(function(t){t(e)})).then(a,s)}c((r=r.apply(t,e||[])).next())})},s=this&&this.__generator||function(t,e){var o,r,n,i,a={label:0,sent:function(){if(1&n[0])throw n[1];return n[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(t){return function(e){return c([t,e])}}function c(i){if(o)throw new TypeError("Generator is already executing.");for(;a;)try{if(o=1,r&&(n=2&i[0]?r.return:i[0]?r.throw||((n=r.return)&&n.call(r),0):r.next)&&!(n=n.call(r,i[1])).done)return n;switch(r=0,n&&(i=[2&i[0],n.value]),i[0]){case 0:case 1:n=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,r=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(n=(n=a.trys).length>0&&n[n.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!n||i[1]>n[0]&&i[1]<n[3])){a.label=i[1];break}if(6===i[0]&&a.label<n[1]){a.label=n[1],n=i;break}if(n&&a.label<n[2]){a.label=n[2],a.ops.push(i);break}n[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(s){i=[6,s],r=0}finally{o=n=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}};Object.defineProperty(o,"__esModule",{value:!0}),o.PartRepo=o.partRepo=o.Part=void 0;var c=t("../../CoreModule/Managers/AssetBundleManager"),l=t("../../CoreModule/Data/BaseData"),u=t("./PartType"),p=sp.SkeletonData,f=cc.SpriteFrame,d=t("../../NFTModule/Managers/NFTManager"),h=t("./HeroType"),y=t("../../CoreModule/Data/BaseRepository"),g=t("../../CoreModule/Data/StaticData"),v=t("./PartInfo"),b=t("../../../Utils/SpineUtils"),m=t("../../BattleModule/Data/MotionGroup"),_=t("../../CoreModule/Managers/LoadingManager"),P=t("../../CoreModule/Managers/ConfigManager"),M=t("../Configs/PartConfig"),C=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.bt1=d.DefaultBt1,e.bt2=d.DefaultBt2,e.oriId=-1,e.heroTypeId=-1,e.partTypeId=-1,e.name="",e.price=0,e.stock=999999,e.color=1,e.containCts=[],e.skeletonName="",e.pictureName="",e.attackMotionId=m.AttackMotionGroupId,e._slotNames=null,e._boneNames=null,e}return n(e,t),e.prototype.picture=function(){return a(this,void 0,Promise,function(){var t,e;return s(this,function(o){switch(o.label){case 0:return(t=this._picture)?[3,2]:(e=this,[4,this.loadPicture()]);case 1:t=e._picture=o.sent(),o.label=2;case 2:return[2,t]}})})},e.prototype.loadPicture=function(){return a(this,void 0,Promise,function(){return s(this,function(t){switch(t.label){case 0:return[4,c.assetMgr().loadAsset(f,c.BundleName.Sprites,"partpictures/"+this.pictureName)];case 1:return[2,t.sent()]}})})},e.prototype.allPictures=function(){return a(this,void 0,Promise,function(){var t,e;return s(this,function(o){switch(o.label){case 0:return(t=this._allPicture)?[3,2]:(e=this,[4,this.loadAllPictures()]);case 1:t=e._allPicture=o.sent(),o.label=2;case 2:return[2,t]}})})},e.prototype.loadAllPictures=function(){return a(this,void 0,Promise,function(){var t,e,o,r,n,i,a,l;return s(this,function(s){switch(s.label){case 0:t=this.pictureName.split("_"),e=P.configMgr().config(M.default).slotOrders,o=Object.keys(e).filter(function(e){return e.split("_")[0]==t[2]}),r=new Map,n=0,i=o,s.label=1;case 1:return n<i.length?(a=i[n],[4,c.assetMgr().loadAsset(f,c.BundleName.Sprites,"partpictures/"+t[0]+"_"+t[1]+"_"+a+"_"+t[4])]):[3,4];case 2:(l=s.sent())&&r.set(a,l),s.label=3;case 3:return n++,[3,1];case 4:return[2,r]}})})},e.prototype.skeleton=function(){return a(this,void 0,Promise,function(){var t,e;return s(this,function(o){switch(o.label){case 0:return(t=this._skeleton)?[3,2]:(e=this,[4,this.loadSkeleton()]);case 1:t=e._skeleton=o.sent(),o.label=2;case 2:return[2,t]}})})},e.prototype.loadSkeleton=function(){return a(this,void 0,Promise,function(){return s(this,function(t){switch(t.label){case 0:return[4,c.assetMgr().loadAsset(p,c.BundleName.Sprites,"parts/"+this.skeletonName)];case 1:return[2,t.sent()]}})})},Object.defineProperty(e.prototype,"partType",{get:function(){return u.partTypeRepo().getById(this.partTypeId)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"heroType",{get:function(){return h.heroTypeRepo().getById(this.heroTypeId)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"oriPart",{get:function(){return w().getById(this.oriId)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"slotNames",{get:function(){return this._slotNames||(this._slotNames=this.getSlotNames())},enumerable:!1,configurable:!0}),e.prototype.getSlotNames=function(){var t;return((null===(t=this.containCts)||void 0===t?void 0:t.length)>0?this.containCts:[this.partTypeId]).map(function(t){return u.partTypeRepo().getById(t)}).reduce(function(t,e){return t.concat(b.SpineUtils.getSlotNames(e))},[])},Object.defineProperty(e.prototype,"boneNames",{get:function(){return this._boneNames||(this._boneNames=this.getBoneNames())},enumerable:!1,configurable:!0}),e.prototype.getBoneNames=function(){var t;return((null===(t=this.containCts)||void 0===t?void 0:t.length)>0?this.containCts:[this.partTypeId]).map(function(t){return u.partTypeRepo().getById(t)}).reduce(function(t,e){return t.concat(b.SpineUtils.getBoneNames(e))},[])},e.prototype.toPartInfo=function(){var t=new v.PartInfo;return t.partId=this.id,t.name=this.name,t.partTypeId=this.partTypeId,t.price=this.price,t.stock=this.stock,t},i([l.field],e.prototype,"bt1",void 0),i([l.field],e.prototype,"bt2",void 0),i([l.field],e.prototype,"oriId",void 0),i([l.field],e.prototype,"heroTypeId",void 0),i([l.field],e.prototype,"partTypeId",void 0),i([l.field],e.prototype,"name",void 0),i([l.field],e.prototype,"price",void 0),i([l.field],e.prototype,"stock",void 0),i([l.field],e.prototype,"color",void 0),i([l.field([Number])],e.prototype,"containCts",void 0),i([l.field],e.prototype,"skeletonName",void 0),i([l.field],e.prototype,"pictureName",void 0),i([l.field(Number)],e.prototype,"attackMotionId",void 0),i([_.blockLoading],e.prototype,"loadPicture",null),i([_.blockLoading],e.prototype,"allPictures",null),i([_.blockLoading],e.prototype,"loadSkeleton",null),i([g.data("Part")],e)}(g.StaticData);function w(){return y.getRepository(O)}o.Part=C,o.partRepo=w;var O=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),Object.defineProperty(e.prototype,"clazz",{get:function(){return C},enumerable:!1,configurable:!0}),e.prototype.findByHeroTypeId=function(){},e.prototype.findByPartTypeId=function(){},e.prototype.getByPartTypeId=function(){},e.prototype.findByTypes=function(){},i([y.filterKeys("heroTypeId","partTypeId","color")],e.prototype,"findByTypes",null),i([y.repository],e)}(y.BaseRepository);o.PartRepo=O,cc._RF.pop()},{"../../../Utils/SpineUtils":"SpineUtils","../../BattleModule/Data/MotionGroup":"MotionGroup","../../CoreModule/Data/BaseData":"BaseData","../../CoreModule/Data/BaseRepository":"BaseRepository","../../CoreModule/Data/StaticData":"StaticData","../../CoreModule/Managers/AssetBundleManager":"AssetBundleManager","../../CoreModule/Managers/ConfigManager":"ConfigManager","../../CoreModule/Managers/LoadingManager":"LoadingManager","../../NFTModule/Managers/NFTManager":"NFTManager","../Configs/PartConfig":"PartConfig","./HeroType":"HeroType","./PartInfo":"PartInfo","./PartType":"PartType"}],PlatformManager:[function(t,e,o){"use strict";cc._RF.push(e,"4a7edGmBuFHW7HkHqGZKaQT","PlatformManager");var r,n=this&&this.__extends||(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),i=this&&this.__decorate||function(t,e,o,r){var n,i=arguments.length,a=i<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,o):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,o,r);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(a=(i<3?n(a):i>3?n(e,o,a):n(e,o))||a);return i>3&&a&&Object.defineProperty(e,o,a),a};Object.defineProperty(o,"__esModule",{value:!0}),o.getPlatform=o.platformMgr=o.getPlatformType=void 0;var a=t("./BaseManager");function s(){switch(cc.sys.platform){case cc.sys.DESKTOP_BROWSER:case cc.sys.MOBILE_BROWSER:return"web";case cc.sys.ANDROID:return"android";default:return"test"}}function c(){return a.getManager(l)}o.getPlatformType=s,o.platformMgr=c,o.getPlatform=function(){return c().getPlatform(s())};var l=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.platformClasses={},e.platforms={},e}return n(e,t),e.prototype.registerPlatform=function(t,e){this.platformClasses[t]=e},e.prototype.getPlatform=function(t){var e,o=this.platformClasses[t];return(e=this.platforms)[t]||(e[t]=o?new o(t):null)},i([a.manager],e)}(a.BaseManager);cc._RF.pop()},{"./BaseManager":"BaseManager"}],PlayerBattle:[function(t,e,o){"use strict";cc._RF.push(e,"c3557JB3N1N8aq2jAwlDoig","PlayerBattle");var r,n=this&&this.__extends||(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),i=this&&this.__decorate||function(t,e,o,r){var n,i=arguments.length,a=i<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,o):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,o,r);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(a=(i<3?n(a):i>3?n(e,o,a):n(e,o))||a);return i>3&&a&&Object.defineProperty(e,o,a),a};Object.defineProperty(o,"__esModule",{value:!0}),o.PlayerBattle=o.PlayerBattleItem=o.RoomNFTInfo=void 0;var a=t("../../CoreModule/Data/BaseData"),s=t("../../PlayerModule/Managers/PlayerManager"),c=t("../../PlayerModule/Data/Player"),l=t("../../PlayerModule/Data/Condition"),u=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),i([a.field(String)],e.prototype,"nftId",void 0),i([a.field(String)],e.prototype,"name",void 0),i([a.field(String)],e.prototype,"ownerAccount",void 0),i([a.field(Number)],e.prototype,"heroTypeId",void 0),i([a.field([Number])],e.prototype,"partIds",void 0),i([a.field(Number)],e.prototype,"level",void 0),i([a.field(Number)],e.prototype,"star",void 0),i([a.field(Number)],e.prototype,"quality",void 0),i([a.field(Number)],e.prototype,"restraint",void 0),i([a.field(Number)],e.prototype,"battlePoint",void 0),i([a.field(Number)],e.prototype,"rank",void 0),e}(a.BaseData);o.RoomNFTInfo=u;var p=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.opponents=[],e}return n(e,t),i([a.field(Number)],e.prototype,"roomId",void 0),i([a.field([u])],e.prototype,"opponents",void 0),e}(a.BaseData);o.PlayerBattleItem=p;var f=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.battleData=[],e.refreshCount=0,e.battleChance=0,e}return n(e,t),e.prototype.getRoomData=function(t){var e=this.battleData.find(function(e){return e.roomId==t});return e||((e=new p).roomId=t,this.battleData.push(e)),e},e.prototype.battleBuyCosts=function(t){return l.ConditionGroup.create(l.cGte(l.ConditionType.Gold,1e3*t))},e.prototype.buyBattleChance=function(t){this.battleChance+=t},e.prototype.startPVPBattle=function(){this.battleChance=Math.max(0,this.battleChance-1)},e.prototype.finishPVPBattle=function(t,e,o){if(t){var r=this.getRoomData(o).opponents,n=r.findIndex(function(t){return t.nftId==e});r.splice(n,1)}},e.prototype.refreshBuyCosts=function(t){return l.ConditionGroup.create(l.cGte(l.ConditionType.Gold,500*t))},e.prototype.buyRefreshCount=function(t,e){void 0===e&&(e=!1),this.refreshCount+=t,e&&this.refreshCount>0&&this.refreshPVP()},e.prototype.refreshPVP=function(){this.battleData.forEach(function(t){return t.opponents=[]}),this.refreshCount=Math.max(0,this.refreshCount-1)},i([a.field([p])],e.prototype,"battleData",void 0),i([a.field],e.prototype,"refreshCount",void 0),i([a.field],e.prototype,"battleChance",void 0),i([s.playerData("PlayerBattle")],e)}(c.PlayerData);o.PlayerBattle=f,cc._RF.pop()},{"../../CoreModule/Data/BaseData":"BaseData","../../PlayerModule/Data/Condition":"Condition","../../PlayerModule/Data/Player":"Player","../../PlayerModule/Managers/PlayerManager":"PlayerManager"}],PlayerCardContainer:[function(t,e,o){"use strict";cc._RF.push(e,"b5401rDQllKOI20VMzre8WF","PlayerCardContainer");var r,n=this&&this.__extends||(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),i=this&&this.__decorate||function(t,e,o,r){var n,i=arguments.length,a=i<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,o):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,o,r);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(a=(i<3?n(a):i>3?n(e,o,a):n(e,o))||a);return i>3&&a&&Object.defineProperty(e,o,a),a},a=this&&this.__awaiter||function(t,e,o,r){return new(o||(o=Promise))(function(n,i){function a(t){try{c(r.next(t))}catch(e){i(e)}}function s(t){try{c(r.throw(t))}catch(e){i(e)}}function c(t){var e;t.done?n(t.value):(e=t.value,e instanceof o?e:new o(function(t){t(e)})).then(a,s)}c((r=r.apply(t,e||[])).next())})},s=this&&this.__generator||function(t,e){var o,r,n,i,a={label:0,sent:function(){if(1&n[0])throw n[1];return n[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(t){return function(e){return c([t,e])}}function c(i){if(o)throw new TypeError("Generator is already executing.");for(;a;)try{if(o=1,r&&(n=2&i[0]?r.return:i[0]?r.throw||((n=r.return)&&n.call(r),0):r.next)&&!(n=n.call(r,i[1])).done)return n;switch(r=0,n&&(i=[2&i[0],n.value]),i[0]){case 0:case 1:n=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,r=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(n=(n=a.trys).length>0&&n[n.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!n||i[1]>n[0]&&i[1]<n[3])){a.label=i[1];break}if(6===i[0]&&a.label<n[1]){a.label=n[1],n=i;break}if(n&&a.label<n[2]){a.label=n[2],a.ops.push(i);break}n[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(s){i=[6,s],r=0}finally{o=n=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}};Object.defineProperty(o,"__esModule",{value:!0});var c=t("../../../CoreModule/Components/ItemContainer"),l=t("./PlayerCardDisplay"),u=t("../../../CoreModule/Managers/DataManager"),p=t("../../../PlayerModule/Managers/PlayerManager"),f=cc.ScrollView,d=cc._decorator,h=d.ccclass,y=(d.property,function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.currentDisplayRoomId=-1,e.roomInfos=[],e}return n(e,t),e.prototype.start=function(){this.setup().then()},e.prototype.setup=function(){return a(this,void 0,void 0,function(){var t,e,o;return s(this,function(r){switch(r.label){case 0:o=0,r.label=1;case 1:return o<5?[4,v.BattleInterface.GetPVPPlayers({roomId:o})]:[3,4];case 2:t=r.sent().nfts,e=t.map(function(t){return b.DataLoader.load(l.RoomNFTInfo,t)}),this.roomInfos.push(e.filter(function(t){return!!t})),r.label=3;case 3:return o++,[3,1];case 4:return this.currentDisplayRoomId=g.battleScene().currentPVPRoomIndex,this.setItems(this.roomInfos[this.currentDisplayRoomId]),[2]}})})},e.prototype.update=function(){this.roomInfos.length<5||this.currentDisplayRoomId!=g.battleScene().currentPVPRoomIndex&&(this.currentDisplayRoomId=g.battleScene().currentPVPRoomIndex,this.setItems(this.roomInfos[this.currentDisplayRoomId]))},e.prototype.onItemsChanged=function(){t.prototype.onItemsChanged.call(this),this.getComponent(f).scrollToLeft()},e.prototype.onDisable=function(){g.battleScene().currentTargetSelect=null},i([u.waitForDataLoad,p.waitForLogin],e.prototype,"setup",null),i([h],e)}(c.ItemContainer));o.default=y;var g=t("../../../../Scenes/BattleScene"),v=t("../../BattleCommon"),b=t("../../../CoreModule/Utils/DataLoader");cc._RF.pop()},{"../../../../Scenes/BattleScene":"BattleScene","../../../CoreModule/Components/ItemContainer":"ItemContainer","../../../CoreModule/Managers/DataManager":"DataManager","../../../CoreModule/Utils/DataLoader":"DataLoader","../../../PlayerModule/Managers/PlayerManager":"PlayerManager","../../BattleCommon":"BattleCommon","./PlayerCardDisplay":"PlayerCardDisplay"}],PlayerCardDisplay:[function(t,e,o){"use strict";cc._RF.push(e,"cb163RPrQxNFYTKrmsSNLL0","PlayerCardDisplay");var r,n=this&&this.__extends||(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),i=this&&this.__decorate||function(t,e,o,r){var n,i=arguments.length,a=i<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,o):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,o,r);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(a=(i<3?n(a):i>3?n(e,o,a):n(e,o))||a);return i>3&&a&&Object.defineProperty(e,o,a),a};Object.defineProperty(o,"__esModule",{value:!0}),o.RoomNFTInfo=void 0;var a=t("../../../CoreModule/Components/ItemDisplay"),s=cc.Label,c=cc.Sprite,l=cc.SpriteFrame,u=sp.Skeleton,p=t("../../../../Utils/SpineUtils"),f=cc.Node,d=t("../../../../Scenes/BattleScene"),h=t("../../../CoreModule/Data/BaseData"),y=t("../../../HeroModule/Data/Part"),g=cc._decorator,v=g.ccclass,b=g.property,m=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.nameLabel=null,e.qualityLabel=null,e.levelLabel=null,e.powerLabel=null,e.qualityIcon=null,e.frame=null,e.qualityPictures=[],e.quality=["N","R","SR","SSR","UR"],e.hero=null,e.size=120,e}return n(e,t),e.prototype.start=function(){},e.prototype.update=function(){this.frame.active=d.battleScene().currentTargetSelect==this.item},e.prototype.refresh=function(){t.prototype.refresh.call(this),this.updateLabels(),this.updatePictures(),this.drawHero()},e.prototype.updateLabels=function(){this.nameLabel.string=this.item.name,this.qualityLabel.string=this.quality[this.item.quality],this.levelLabel.string=this.item.level.toString(),this.powerLabel.string=this.item.battlePoint.toString()},e.prototype.updatePictures=function(){this.qualityIcon.spriteFrame=this.qualityPictures[this.item.quality]},e.prototype.drawHero=function(){var t=this;this.hero.node.scale=0;var e=new f("node"),o=e.addComponent(u),r=new p.HeroSkeleton(this.hero,o,this.item.heroTypeId);this.item.parts.forEach(function(t){r.addPart(t)}),r.refresh().then(function(){e.destroy(),t.sizeFilter()})},e.prototype.sizeFilter=function(){var t=Math.max(this.hero.node.width/this.size,this.hero.node.height/this.size);this.hero.node.scale=t>1?1/t:1,this.hero.node.y=-this.size/2},e.prototype.onClick=function(){if(d.battleScene().currentTargetSelect==this.item)return d.battleScene().currentTargetSelect=null;d.battleScene().currentTargetSelect=this.item},i([b(s)],e.prototype,"nameLabel",void 0),i([b(s)],e.prototype,"qualityLabel",void 0),i([b(s)],e.prototype,"levelLabel",void 0),i([b(s)],e.prototype,"powerLabel",void 0),i([b(c)],e.prototype,"qualityIcon",void 0),i([b(f)],e.prototype,"frame",void 0),i([b([l])],e.prototype,"qualityPictures",void 0),i([b(u)],e.prototype,"hero",void 0),i([v],e)}(a.ItemDisplay);o.default=m;var _=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),Object.defineProperty(e.prototype,"parts",{get:function(){return this._parts||(this._parts=this.partIds.map(function(t){return y.partRepo().getById(t)}))},enumerable:!1,configurable:!0}),i([h.field(String)],e.prototype,"nftId",void 0),i([h.field(String)],e.prototype,"name",void 0),i([h.field(Number)],e.prototype,"heroTypeId",void 0),i([h.field([Number])],e.prototype,"partIds",void 0),i([h.field(Number)],e.prototype,"level",void 0),i([h.field(Number)],e.prototype,"quality",void 0),i([h.field(Number)],e.prototype,"battlePoint",void 0),e}(h.BaseData);o.RoomNFTInfo=_,cc._RF.pop()},{"../../../../Scenes/BattleScene":"BattleScene","../../../../Utils/SpineUtils":"SpineUtils","../../../CoreModule/Components/ItemDisplay":"ItemDisplay","../../../CoreModule/Data/BaseData":"BaseData","../../../HeroModule/Data/Part":"Part"}],PlayerCommon:[function(t,e,o){"use strict";cc._RF.push(e,"85634yoxDdKW46vKw8ohOcd","PlayerCommon");var r=this&&this.__decorate||function(t,e,o,r){var n,i=arguments.length,a=i<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,o):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,o,r);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(a=(i<3?n(a):i>3?n(e,o,a):n(e,o))||a);return i>3&&a&&Object.defineProperty(e,o,a),a};Object.defineProperty(o,"__esModule",{value:!0}),o.PlayerInterface=void 0;var n=t("../../CoreModule/Common/CoreCommon"),i=function(){function t(){}return t.Login=function(){},t.Logout=function(){},t.GetInfo=function(){},t.GetData=function(){},t.EditInfo=function(){},r([n.post("/player/player/login",void 0,!1)],t,"Login",null),r([n.post("/player/player/logout")],t,"Logout",null),r([n.get("/player/player_info/get")],t,"GetInfo",null),r([n.post("/player/player_data/get")],t,"GetData",null),r([n.post("/player/player_info/edit")],t,"EditInfo",null),t}();o.PlayerInterface=i,cc._RF.pop()},{"../../CoreModule/Common/CoreCommon":"CoreCommon"}],PlayerCopy:[function(t,e,o){"use strict";cc._RF.push(e,"acc00JxaqZCWK4nuKNOV0BQ","PlayerCopy");var r,n=this&&this.__extends||(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),i=this&&this.__decorate||function(t,e,o,r){var n,i=arguments.length,a=i<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,o):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,o,r);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(a=(i<3?n(a):i>3?n(e,o,a):n(e,o))||a);return i>3&&a&&Object.defineProperty(e,o,a),a};Object.defineProperty(o,"__esModule",{value:!0}),o.PlayerCopy=o.PlayerCopySetting=o.PlayerCopyItem=void 0;var a=t("../../CoreModule/Data/BaseData"),s=t("../../PlayerModule/Data/Player"),c=t("../../PlayerModule/Managers/PlayerManager"),l=t("./Copy"),u=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.curLevel=0,e.maxLevel=0,e}return n(e,t),Object.defineProperty(e.prototype,"copy",{get:function(){return l.copyRepo().getById(this.copyId)},enumerable:!1,configurable:!0}),e.prototype.next=function(){this.maxLevel=Math.max(this.curLevel,this.maxLevel),this.curLevel++},e.prototype.prev=function(){this.curLevel--},i([a.field(Number)],e.prototype,"copyId",void 0),i([a.field],e.prototype,"curLevel",void 0),i([a.field],e.prototype,"maxLevel",void 0),e}(a.BaseData);o.PlayerCopyItem=u;var p=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.copyType=l.CopyType.Main,e.nftIds=[],e.speedUpTime=0,e}return n(e,t),Object.defineProperty(e.prototype,"battleSpeed",{get:function(){return Date.now()>this.speedUpTime?1:2},enumerable:!1,configurable:!0}),e.prototype.boost=function(t,e){void 0===e&&(e=!1),this.speedUpTime=e?Date.now()+t:Math.max(this.speedUpTime,Date.now())+t},i([a.field],e.prototype,"copyType",void 0),i([a.field([String])],e.prototype,"nftIds",void 0),i([a.field],e.prototype,"speedUpTime",void 0),e}(a.BaseData);o.PlayerCopySetting=p;var f=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.copies=[],e.settings=[],e}return n(e,t),e.prototype.copy=function(t){return this.copies.find(function(e){return e.copyId==t})},e.prototype.setting=function(t){return this.settings.find(function(e){return e.copyType==t})},e.prototype.mainCopy=function(){return this.copy(l.copyRepo().main().id)},e.prototype.mainSetting=function(){return this.setting(l.CopyType.Main)},i([a.field([u])],e.prototype,"copies",void 0),i([a.field([p])],e.prototype,"settings",void 0),i([c.playerData("PlayerCopy")],e)}(s.PlayerData);o.PlayerCopy=f,cc._RF.pop()},{"../../CoreModule/Data/BaseData":"BaseData","../../PlayerModule/Data/Player":"Player","../../PlayerModule/Managers/PlayerManager":"PlayerManager","./Copy":"Copy"}],PlayerInfoDisplay:[function(t,e,o){"use strict";cc._RF.push(e,"b92f9EYItROapSg18oLJ/Vf","PlayerInfoDisplay");var r,n=this&&this.__extends||(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),i=this&&this.__decorate||function(t,e,o,r){var n,i=arguments.length,a=i<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,o):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,o,r);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(a=(i<3?n(a):i>3?n(e,o,a):n(e,o))||a);return i>3&&a&&Object.defineProperty(e,o,a),a};Object.defineProperty(o,"__esModule",{value:!0});var a=cc.Label,s=t("../../../CoreModule/Components/ItemDisplay"),c=cc.Sprite,l=t("../../../EconomicModule/Data/PlayerMoney"),u=t("../../../PlayerModule/Managers/PlayerManager"),p=t("../../../../Utils/NumberUtils"),f=cc.Node,d=t("../../../CoreModule/Managers/DataManager"),h=t("../../../../Scenes/BattleScene"),y=cc._decorator,g=y.ccclass,v=y.property,b=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.playerName=null,e.force=null,e.avatar=null,e.gold=null,e.diamond=null,e.stableCoin=null,e.heroInfoNode=null,e.money=null,e}return n(e,t),e.prototype.start=function(){this.setup()},e.prototype.setup=function(){var t=u.playerMgr().player;this.setItem(t)},e.prototype.onItemChanged=function(){t.prototype.onItemChanged.call(this),this.money=u.playerMgr().getPlayerData(l.PlayerMoney)},e.prototype.update=function(){if(h.battleScene().heroSelected)return this.heroInfoNode.active=!0,void(this.node.active=!1);this.item&&this.updateLabels()},e.prototype.updateLabels=function(){this.playerName.string=this.item.name,this.gold.string=this.money.gold.toString(),this.diamond.string=this.money.diamond.toString(),this.stableCoin.string=this.money.token.toString()},i([v(a)],e.prototype,"playerName",void 0),i([v(a)],e.prototype,"force",void 0),i([v(c)],e.prototype,"avatar",void 0),i([v(a)],e.prototype,"gold",void 0),i([v(a)],e.prototype,"diamond",void 0),i([v(a)],e.prototype,"stableCoin",void 0),i([v(f)],e.prototype,"heroInfoNode",void 0),i([u.waitForLogin,d.waitForDataLoad],e.prototype,"setup",null),i([p.autoUnitConvert],e.prototype,"updateLabels",null),i([g],e)}(s.ItemDisplay);o.default=b,cc._RF.pop()},{"../../../../Scenes/BattleScene":"BattleScene","../../../../Utils/NumberUtils":"NumberUtils","../../../CoreModule/Components/ItemDisplay":"ItemDisplay","../../../CoreModule/Managers/DataManager":"DataManager","../../../EconomicModule/Data/PlayerMoney":"PlayerMoney","../../../PlayerModule/Managers/PlayerManager":"PlayerManager"}],PlayerJob:[function(t,e,o){"use strict";cc._RF.push(e,"1e608ACwUZDPrVSR7WAo5tg","PlayerJob");var r,n=this&&this.__extends||(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),i=this&&this.__decorate||function(t,e,o,r){var n,i=arguments.length,a=i<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,o):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,o,r);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(a=(i<3?n(a):i>3?n(e,o,a):n(e,o))||a);return i>3&&a&&Object.defineProperty(e,o,a),a};Object.defineProperty(o,"__esModule",{value:!0}),o.PlayerJob=o.PlayerJobItem=void 0;var a=t("../../CoreModule/Data/BaseData"),s=t("../../PlayerModule/Data/Player"),c=t("../../PlayerModule/Managers/PlayerManager"),l=function(t){function e(e,o){var r=t.call(this,e)||this;return r.curLevel=0,r.maxLevel=0,r.lastProfitTime=0,r.profitCount=0,r.pJob=o,r}return n(e,t),Object.defineProperty(e.prototype,"job",{get:function(){return p.jobRepo().getById(this.jobId)},enumerable:!1,configurable:!0}),e.prototype.upgradeCosts=function(){var t=this.job.upgradeGold(this.curLevel);return f.ConditionGroup.create(f.cGte(f.ConditionType.Gold,t))},e.prototype.upgradeConditions=function(){var t=this;return f.ConditionGroup.create(f.cFun(function(){return t.curLevel>0},h.EconomicThrow.JobNotUnlocked),f.cFun(function(){return t.curLevel<t.job.maxLevel},h.EconomicThrow.ReachJobMaxLevel),this.upgradeCosts())},e.prototype.unlockCosts=function(){return f.ConditionGroup.create(f.cGte(f.ConditionType.Gold,this.job.unlockGold))},e.prototype.unlockConditions=function(){var t=this;return f.ConditionGroup.create(f.cFun(function(){return t.curLevel<=0},h.EconomicThrow.JobAlreadyUnlocked),f.cGte(f.ConditionType.ReturnTime,this.job.unlockReturnTime),this.unlockCosts())},Object.defineProperty(e.prototype,"isAutoProfit",{get:function(){return this.pJob.isAutoProfit},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isValidProfitTime",{get:function(){return Date.now()>=this.lastProfitTime+1e3*this.job.time},enumerable:!1,configurable:!0}),e.prototype.profitConditions=function(){var t=this;return f.ConditionGroup.create(f.cFun(function(){return t.curLevel>0},h.EconomicThrow.JobNotUnlocked),f.cFun(function(){return t.isValidProfitTime},h.EconomicThrow.NotJobProfitTime))},e.prototype.profitRewards=function(){var t=this.job.profit(this.curLevel);return d.RewardGroup.create(d.r(d.RewardType.Gold,t))},e.prototype.upgrade=function(){var t=this.job.maxLevel;this.curLevel>=t||(this.maxLevel=Math.max(this.maxLevel,++this.curLevel),0==this.lastProfitTime&&(this.lastProfitTime=Date.now()))},e.prototype.profit=function(){this.lastProfitTime=Date.now(),this.profitCount++},i([a.field(Number)],e.prototype,"jobId",void 0),i([a.field],e.prototype,"curLevel",void 0),i([a.field],e.prototype,"maxLevel",void 0),i([a.field],e.prototype,"lastProfitTime",void 0),i([a.field],e.prototype,"profitCount",void 0),e}(a.BaseData);o.PlayerJobItem=l;var u=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.id=-1,e.returnTimes=0,e.jobs=[],e.autoProfitTime=0,e}return n(e,t),e.prototype.job=function(t){var e=this.jobs.find(function(e){return e.jobId==t});return e||((e=new l(this.jobs.length,this)).jobId=t,this.jobs.push(e)),e},Object.defineProperty(e.prototype,"isAutoProfit",{get:function(){return Date.now()<=this.autoProfitTime},enumerable:!1,configurable:!0}),i([a.field],e.prototype,"id",void 0),i([a.field(Number)],e.prototype,"returnTimes",void 0),i([a.field([l])],e.prototype,"jobs",void 0),i([a.field],e.prototype,"autoProfitTime",void 0),i([c.playerData("PlayerJob")],e)}(s.PlayerData);o.PlayerJob=u;var p=t("./Job"),f=t("../../PlayerModule/Data/Condition"),d=t("../../PlayerModule/Data/Reward"),h=t("../Common/EconomicCommon");cc._RF.pop()},{"../../CoreModule/Data/BaseData":"BaseData","../../PlayerModule/Data/Condition":"Condition","../../PlayerModule/Data/Player":"Player","../../PlayerModule/Data/Reward":"Reward","../../PlayerModule/Managers/PlayerManager":"PlayerManager","../Common/EconomicCommon":"EconomicCommon","./Job":"Job"}],PlayerManager:[function(t,e,o){"use strict";cc._RF.push(e,"b932dX7w5NFDK0R/cYYgPj/","PlayerManager");var r,n=this&&this.__extends||(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),i=this&&this.__decorate||function(t,e,o,r){var n,i=arguments.length,a=i<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,o):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,o,r);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(a=(i<3?n(a):i>3?n(e,o,a):n(e,o))||a);return i>3&&a&&Object.defineProperty(e,o,a),a},a=this&&this.__awaiter||function(t,e,o,r){return new(o||(o=Promise))(function(n,i){function a(t){try{c(r.next(t))}catch(e){i(e)}}function s(t){try{c(r.throw(t))}catch(e){i(e)}}function c(t){var e;t.done?n(t.value):(e=t.value,e instanceof o?e:new o(function(t){t(e)})).then(a,s)}c((r=r.apply(t,e||[])).next())})},s=this&&this.__generator||function(t,e){var o,r,n,i,a={label:0,sent:function(){if(1&n[0])throw n[1];return n[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(t){return function(e){return c([t,e])}}function c(i){if(o)throw new TypeError("Generator is already executing.");for(;a;)try{if(o=1,r&&(n=2&i[0]?r.return:i[0]?r.throw||((n=r.return)&&n.call(r),0):r.next)&&!(n=n.call(r,i[1])).done)return n;switch(r=0,n&&(i=[2&i[0],n.value]),i[0]){case 0:case 1:n=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,r=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(n=(n=a.trys).length>0&&n[n.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!n||i[1]>n[0]&&i[1]<n[3])){a.label=i[1];break}if(6===i[0]&&a.label<n[1]){a.label=n[1],n=i;break}if(n&&a.label<n[2]){a.label=n[2],a.ops.push(i);break}n[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(s){i=[6,s],r=0}finally{o=n=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}};Object.defineProperty(o,"__esModule",{value:!0}),o.playerMgr=o.waitForLogin=o.playerData=void 0;var c=t("../../CoreModule/Managers/BaseManager"),l=t("../Data/Player"),u=t("../../NFTModule/Managers/NFTManager"),p=t("../../CoreModule/Utils/DataLoader"),f=t("../../CoreModule/Managers/GameManager");function d(){return c.getManager(h)}o.playerData=function(t){return function(e){return d().registerPlayerData(e,t)}},o.waitForLogin=function(t,e,o){var r=o.value;o.value=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return a(this,void 0,void 0,function(){return s(this,function(e){switch(e.label){case 0:return[4,g.PromiseUtils.waitFor(function(){return!!d().player})];case 1:return e.sent(),[2,r.apply(this,t)]}})})}},o.playerMgr=d;var h=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.player=null,e.playerData={},e.playerDataClasses={},e.needLogin=!0,e}return n(e,t),e.prototype.login=function(t,e,o){return void 0===e&&(e=u.DefaultChainId),void 0===o&&(o=u.DefaultWalletType),a(this,void 0,void 0,function(){var r;return s(this,function(n){switch(n.label){case 0:return[4,y.PlayerInterface.Login({chainId:e,account:t,wallet:o})];case 1:return r=n.sent(),this.player=p.DataLoader.load(l.Player,r.player),this.setAllPlayerData(r.data),f.gameMgr().setToken(r.token),[2]}})})},e.prototype.autoLogin=function(){return a(this,void 0,void 0,function(){var t;return s(this,function(e){switch(e.label){case 0:return this.player?[2]:((t=cc.sys.localStorage.getItem("autoAccount"))||cc.sys.localStorage.setItem("autoAccount",t=v.MathUtils.randomString()),console.log("AutoLogin: ",t),[4,this.login(t)]);case 1:return e.sent(),[2]}})})},e.prototype.registerPlayerData=function(t,e){this.playerDataClasses[e]=t},e.prototype.getPlayerDataName=function(t){for(var e in this.playerDataClasses)if(t==this.playerDataClasses[e])return e},e.prototype.getPlayerDataClass=function(t){return this.playerDataClasses[t]},e.prototype.getPlayerData=function(t){return this.playerData[this.getPlayerDataName(t)]},e.prototype.refreshPlayerData=function(t){return a(this,void 0,void 0,function(){var e,o;return s(this,function(r){switch(r.label){case 0:return t?(e=this.getPlayerDataName(t),[4,y.PlayerInterface.GetData({name:e})]):[3,2];case 1:return o=r.sent(),this.setPlayerData(t,o.data),[3,4];case 2:return[4,y.PlayerInterface.GetData()];case 3:o=r.sent(),this.setAllPlayerData(o.data),r.label=4;case 4:return[2]}})})},e.prototype.setPlayerData=function(t,e){var o=this.getPlayerDataName(t);o&&(this.playerData[o]=p.DataLoader.load(t,e))},e.prototype.setAllPlayerData=function(t){for(var e in t){var o=this.getPlayerDataClass(e);o&&this.setPlayerData(o,t[e])}},i([c.manager],e)}(c.BaseManager),y=t("../Common/PlayerCommon"),g=t("../../../Utils/PromiseUtils"),v=t("../../../Utils/MathUtils");cc._RF.pop()},{"../../../Utils/MathUtils":"MathUtils","../../../Utils/PromiseUtils":"PromiseUtils","../../CoreModule/Managers/BaseManager":"BaseManager","../../CoreModule/Managers/GameManager":"GameManager","../../CoreModule/Utils/DataLoader":"DataLoader","../../NFTModule/Managers/NFTManager":"NFTManager","../Common/PlayerCommon":"PlayerCommon","../Data/Player":"Player"}],PlayerMoney:[function(t,e,o){"use strict";cc._RF.push(e,"865a0zUpNtHhL6upIeWRl0x","PlayerMoney");var r,n=this&&this.__extends||(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),i=this&&this.__decorate||function(t,e,o,r){var n,i=arguments.length,a=i<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,o):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,o,r);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(a=(i<3?n(a):i>3?n(e,o,a):n(e,o))||a);return i>3&&a&&Object.defineProperty(e,o,a),a};Object.defineProperty(o,"__esModule",{value:!0}),o.PlayerMoney=void 0;var a=t("../../PlayerModule/Data/Player"),s=t("../../PlayerModule/Managers/PlayerManager"),c=t("../../CoreModule/Data/BaseData"),l=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.gold=0,e.diamond=0,e.fragment=0,e.medal=0,e.token=0,e}return n(e,t),e.prototype.gainGold=function(t){return this.gain("gold",t)},e.prototype.gainDiamond=function(t){return this.gain("diamond",t)},e.prototype.gainFragment=function(t){return this.gain("fragment",t)},e.prototype.gainMedal=function(t){return this.gain("medal",t)},e.prototype.gain=function(t,e){return this[t]=Math.max(this[t]+e,0)},i([c.field],e.prototype,"gold",void 0),i([c.field],e.prototype,"diamond",void 0),i([c.field],e.prototype,"fragment",void 0),i([c.field],e.prototype,"medal",void 0),i([c.field],e.prototype,"token",void 0),i([s.playerData("PlayerMoney")],e)}(a.PlayerData);o.PlayerMoney=l,cc._RF.pop()},{"../../CoreModule/Data/BaseData":"BaseData","../../PlayerModule/Data/Player":"Player","../../PlayerModule/Managers/PlayerManager":"PlayerManager"}],PlayerRank:[function(t,e,o){"use strict";cc._RF.push(e,"311f8u0tShMOYzc4Fx0A9Ne","PlayerRank");var r,n=this&&this.__extends||(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),i=this&&this.__decorate||function(t,e,o,r){var n,i=arguments.length,a=i<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,o):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,o,r);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(a=(i<3?n(a):i>3?n(e,o,a):n(e,o))||a);return i>3&&a&&Object.defineProperty(e,o,a),a};Object.defineProperty(o,"__esModule",{value:!0}),o.PlayerRank=void 0;var a=t("../../PlayerModule/Data/Player"),s=t("../../CoreModule/Data/BaseData"),c=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.data={},e}return n(e,t),i([s.field(Object)],e.prototype,"data",void 0),e}(a.PlayerData);o.PlayerRank=c,cc._RF.pop()},{"../../CoreModule/Data/BaseData":"BaseData","../../PlayerModule/Data/Player":"Player"}],Player:[function(t,e,o){"use strict";cc._RF.push(e,"3c17133beRCRI2mwfQPufVB","Player");var r,n=this&&this.__extends||(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),i=this&&this.__decorate||function(t,e,o,r){var n,i=arguments.length,a=i<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,o):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,o,r);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(a=(i<3?n(a):i>3?n(e,o,a):n(e,o))||a);return i>3&&a&&Object.defineProperty(e,o,a),a};Object.defineProperty(o,"__esModule",{value:!0}),o.Player=o.PlayerData=o.PlayerState=void 0;var a,s=t("../../CoreModule/Data/BaseData"),c=t("../../NFTModule/Managers/NFTManager"),l=t("../../CoreModule/Data/DynamicData");(function(t){t[t.Normal=0]="Normal",t[t.Banned=1]="Banned"})(a=o.PlayerState||(o.PlayerState={}));var u=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),i([s.field(String),s.dataPK],e.prototype,"uuid",void 0),e}(l.DynamicData);o.PlayerData=u;var p=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.uuid="",e.chainId=c.DefaultChainId,e.account="",e.wallet="Metamask",e.name="",e.avatarUrl="",e.state=a.Normal,e}return n(e,t),e.prototype.login=function(){},e.prototype.logout=function(){},i([s.field],e.prototype,"uuid",void 0),i([s.field],e.prototype,"chainId",void 0),i([s.field],e.prototype,"account",void 0),i([s.field],e.prototype,"wallet",void 0),i([s.field],e.prototype,"name",void 0),i([s.field],e.prototype,"avatarUrl",void 0),i([s.field(Number)],e.prototype,"createdAt",void 0),i([s.field],e.prototype,"state",void 0),i([s.field(Number)],e.prototype,"stateTime",void 0),i([s.field(String)],e.prototype,"stateDesc",void 0),e}(s.GameData);o.Player=p,cc._RF.pop()},{"../../CoreModule/Data/BaseData":"BaseData","../../CoreModule/Data/DynamicData":"DynamicData","../../NFTModule/Managers/NFTManager":"NFTManager"}],PreviewPictureDisplay:[function(t,e,o){"use strict";cc._RF.push(e,"02076jsDH1HT4ais7UmfSwJ","PreviewPictureDisplay");var r,n=this&&this.__extends||(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),i=this&&this.__decorate||function(t,e,o,r){var n,i=arguments.length,a=i<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,o):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,o,r);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(a=(i<3?n(a):i>3?n(e,o,a):n(e,o))||a);return i>3&&a&&Object.defineProperty(e,o,a),a},a=this&&this.__awaiter||function(t,e,o,r){return new(o||(o=Promise))(function(n,i){function a(t){try{c(r.next(t))}catch(e){i(e)}}function s(t){try{c(r.throw(t))}catch(e){i(e)}}function c(t){var e;t.done?n(t.value):(e=t.value,e instanceof o?e:new o(function(t){t(e)})).then(a,s)}c((r=r.apply(t,e||[])).next())})},s=this&&this.__generator||function(t,e){var o,r,n,i,a={label:0,sent:function(){if(1&n[0])throw n[1];return n[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(t){return function(e){return c([t,e])}}function c(i){if(o)throw new TypeError("Generator is already executing.");for(;a;)try{if(o=1,r&&(n=2&i[0]?r.return:i[0]?r.throw||((n=r.return)&&n.call(r),0):r.next)&&!(n=n.call(r,i[1])).done)return n;switch(r=0,n&&(i=[2&i[0],n.value]),i[0]){case 0:case 1:n=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,r=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(n=(n=a.trys).length>0&&n[n.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!n||i[1]>n[0]&&i[1]<n[3])){a.label=i[1];break}if(6===i[0]&&a.label<n[1]){a.label=n[1],n=i;break}if(n&&a.label<n[2]){a.label=n[2],a.ops.push(i);break}n[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(s){i=[6,s],r=0}finally{o=n=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}};Object.defineProperty(o,"__esModule",{value:!0}),o.DefaultAttack=o.DefaultStand=void 0;var c=t("../../../../Modules/CoreModule/Components/ItemDisplay"),l=t("../../../../Modules/HeroModule/Data/Part"),u=t("../../../../Modules/NFTModule/Utils/NFTCreator"),p=t("../../../../Modules/NFTModule/Managers/NFTManager"),f=t("../CreatedWindow"),d=t("../../../../Modules/CoreModule/Managers/LoadingManager"),h=t("../../../../Utils/SpineUtils"),y=t("../../../../Modules/HeroModule/Data/PartType"),g=t("../../../../Modules/CoreModule/Managers/DataManager"),v=t("../../../../Modules/HeroModule/Data/Hero"),b=t("../../../../Modules/HeroModule/Common/HeroCommon"),m=t("../../../../Modules/HeroModule/Data/Quality"),_=t("../../../../Modules/PlayerModule/Managers/PlayerManager"),P=t("../../../../Utils/MathUtils"),M=sp.Skeleton,C=cc.Label,w=cc.EditBox,O=cc.Camera,S=cc.RenderTexture,j=cc.Sprite,D=t("../../../../Utils/PromiseUtils"),R=t("../../../../Utils/GIFUtils"),T=t("../../SelectorScene"),B=cc._decorator,I=B.ccclass,F=B.property;o.DefaultStand="stand",o.DefaultAttack="attack_1";var k=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.skeleton=null,e.temp=null,e.price=null,e.heroName=null,e.lastCount=null,e.createdWindow=null,e.heroBackground=null,e.backgroundPart=null,e._partsChanged=!1,e.skeletonSize=300,e.nickname=null,e.camera=null,e.texture=null,e.windowSize=Math.max(cc.winSize.width,cc.winSize.height),e.targetSize=600,e.recording=!1,e.images=[],e}return n(e,t),e.prototype.onLoad=function(){this.initScreenShot()},e.prototype.start=function(){this.setItem(new h.HeroSkeleton(this.skeleton,this.temp))},e.prototype.setHeroType=function(t){return a(this,void 0,void 0,function(){var e,o,r,n;return s(this,function(){for(e=t.getDefaultParts(),o=0,r=e;o<r.length;o++)n=r[o],this.addPart(n);return this.refresh(),[2]})})},e.prototype.refresh=function(){t.prototype.refresh.call(this),null!=this.item&&(this.refreshHeroType(),this.refreshAnimation(),this.refreshHeroBackground(),this.refreshPrice().then(),this.item.refresh(T.selectorScene().editorMode).then())},e.prototype.refreshHeroType=function(){var t=this;this.heroName.string=this.item.heroType.getDisplayName(),this.lastCount&&p.nftMgr().getNFTCount(p.DefaultBt1,p.DefaultBt2).then(function(e){return t.lastCount.string=e.restCount+"/"+e.limitCreateCount})},e.prototype.refreshAnimation=function(){this.skeleton.clearTrack(0),this.skeleton.setAnimation(0,o.DefaultStand,!0)},e.prototype.refreshPrice=function(){return a(this,void 0,void 0,function(){return s(this,function(){return[2]})})},e.prototype.refreshHeroBackground=function(){var t=this;if(this.backgroundPart){var e=this.item;this.backgroundPart.picture().then(function(o){return e==t.item?t.heroBackground.spriteFrame=o:null})}},e.prototype.addPart=function(t){var e,o;t&&(t.partType.isBody&&(null===(e=this.item)||void 0===e||e.setHeroTypeId(t.heroTypeId)),null===(o=this.item)||void 0===o||o.addPart(t),t.partType.special==y.SpecialPartType.Background&&(this.backgroundPart=t),this.refresh())},e.prototype.removePart=function(t){var e;t&&(null===(e=this.item)||void 0===e||e.removePart(t),this.refresh())},Object.defineProperty(e.prototype,"partsChanged",{get:function(){var t=this._partsChanged;return this._partsChanged=!1,t},enumerable:!1,configurable:!0}),e.prototype.random=function(){return a(this,void 0,void 0,function(){return s(this,function(t){switch(t.label){case 0:return[4,this.randomParts()];case 1:return t.sent(),this._partsChanged=!0,[2]}})})},e.prototype.randomParts=function(t){return a(this,void 0,void 0,function(){var e,o,r,n,i,a,c,u,p,f,d=this;return s(this,function(s){switch(s.label){case 0:if(void 0!==t)return[3,6];e=y.partTypeRepo().rootPartTypes(),o=0,r=e,s.label=1;case 1:return o<r.length?(n=r[o])?[4,this.randomParts(n)]:[3,3]:[3,5];case 2:s.sent(),s.label=3;case 3:s.label=4;case 4:return o++,[3,1];case 5:return[3,10];case 6:if(t.special==y.SpecialPartType.Background)return[2];i=l.partRepo().findByPartTypeId(t.id).filter(function(t){return d.item.calcScale(t)>0&&t.stock>0}),t.optional&&i.push(null),(a=P.MathUtils.randomPick(i))?this.addPart(a):(this.addPart(i[0]),this.removePart(i[0])),c=t.subPartTypes,u=0,p=c,s.label=7;case 7:return u<p.length?(f=p[u],[4,this.randomParts(f)]):[3,10];case 8:s.sent(),s.label=9;case 9:return u++,[3,7];case 10:return[2]}})})},e.prototype.update=function(){this.updateScale(),this.recording&&(this.skeleton.setAnimation(0,o.DefaultStand,!0),this.skeleton.update(this.images.length/60),this.images.push(this.shot()))},e.prototype.updateScale=function(){var t=this.skeleton.node.scaleX/this.skeletonSize,e=this.skeleton.node.scaleY/this.skeletonSize,o=Math.max(this.skeleton.node.width*t,this.skeleton.node.height*e);o>1&&(this.skeleton.node.scaleX/=o,this.skeleton.node.scaleY/=o)},e.prototype.createNFT=function(){return a(this,void 0,void 0,function(){var t,e,r,n,i,a=this;return s(this,function(s){switch(s.label){case 0:return t=this.shot(),this.startRecording(),e=Math.floor(60*this.skeleton.findAnimation(o.DefaultStand).duration),[4,D.PromiseUtils.waitFor(function(){return a.images.length>=e})];case 1:return s.sent(),this.recording=!1,[4,R.default.makeGIF(this.images.filter(function(t,o){return o<e}))];case 2:return r=s.sent(),p.Web3Enable?((n=new u.NFTCreator).name=this.nickname.string,n.picture=t,n.gif=r,n.partIds=this.item.nftPartIds,n.create().then(function(t){a.createdWindow.setPicture(n.picture),a.createdWindow.setQuality(Number(t.rawData.quality)),a.createdWindow.show()})):(console.log("\u672c\u5730\u521b\u5efa"),i=v.Hero.create(_.playerMgr().player.account,this.item.heroTypeId,this.item.partIds,this.nickname.string),b.HeroInterface.CreateHero({hero:i}).then(function(e){var o=e.hero;a.createdWindow.setPicture(t),a.createdWindow.setQuality(m.QualityType.UR-o.quality+1),a.createdWindow.show()})),[2]}})})},e.prototype.initScreenShot=function(){this.camera.enabled=!1,this.texture=new S,this.texture.initWithSize(this.windowSize,this.windowSize,cc.RenderTexture.DepthStencilFormat.RB_FMT_S8),this.camera.targetTexture=this.texture},e.prototype.shot=function(){this.camera.render(void 0);var t=this.texture,e=t.readPixels(),o=t.width,r=t.height,n=document.createElement("canvas"),i=n.getContext("2d");n.width=o,n.height=r;for(var a=4*o,s=0;s<r;s++){for(var c=r-1-s,l=i.createImageData(o,1),u=c*o*4,p=0;p<a;p++)l.data[p]=e[u+p];i.putImageData(l,0,s)}var f=document.createElement("canvas"),d=f.getContext("2d");return f.width=this.targetSize,f.height=this.targetSize,d.drawImage(n,(this.windowSize-this.targetSize)/2,(this.windowSize-this.targetSize)/2,this.targetSize,this.targetSize,0,0,this.targetSize,this.targetSize),f.toDataURL("image/png")},e.prototype.downloadScreenShot=function(t){document.location.href=t.replace(/^data:image[^;]*/,"data:image/octet-stream")},e.prototype.startRecording=function(){this.images=[],this.recording=!0},i([F(M)],e.prototype,"skeleton",void 0),i([F(M)],e.prototype,"temp",void 0),i([F(C)],e.prototype,"price",void 0),i([F(C)],e.prototype,"heroName",void 0),i([F(C)],e.prototype,"lastCount",void 0),i([F(f.default)],e.prototype,"createdWindow",void 0),i([F(j)],e.prototype,"heroBackground",void 0),i([g.waitForDataLoad],e.prototype,"start",null),i([d.blockLoading],e.prototype,"refreshPrice",null),i([d.showLoading,d.blockLoading],e.prototype,"random",null),i([F(w)],e.prototype,"nickname",void 0),i([d.showLoading],e.prototype,"createNFT",null),i([F(O)],e.prototype,"camera",void 0),i([I],e)}(c.ItemDisplay);o.default=k,cc._RF.pop()},{"../../../../Modules/CoreModule/Components/ItemDisplay":"ItemDisplay","../../../../Modules/CoreModule/Managers/DataManager":"DataManager","../../../../Modules/CoreModule/Managers/LoadingManager":"LoadingManager","../../../../Modules/HeroModule/Common/HeroCommon":"HeroCommon","../../../../Modules/HeroModule/Data/Hero":"Hero","../../../../Modules/HeroModule/Data/Part":"Part","../../../../Modules/HeroModule/Data/PartType":"PartType","../../../../Modules/HeroModule/Data/Quality":"Quality","../../../../Modules/NFTModule/Managers/NFTManager":"NFTManager","../../../../Modules/NFTModule/Utils/NFTCreator":"NFTCreator","../../../../Modules/PlayerModule/Managers/PlayerManager":"PlayerManager","../../../../Utils/GIFUtils":"GIFUtils","../../../../Utils/MathUtils":"MathUtils","../../../../Utils/PromiseUtils":"PromiseUtils","../../../../Utils/SpineUtils":"SpineUtils","../../SelectorScene":"SelectorScene","../CreatedWindow":"CreatedWindow"}],PromiseUtils:[function(t,e,o){"use strict";cc._RF.push(e,"c1577/YbAxP5ZYT3zU5UwFW","PromiseUtils");var r=this&&this.__awaiter||function(t,e,o,r){return new(o||(o=Promise))(function(n,i){function a(t){try{c(r.next(t))}catch(e){i(e)}}function s(t){try{c(r.throw(t))}catch(e){i(e)}}function c(t){var e;t.done?n(t.value):(e=t.value,e instanceof o?e:new o(function(t){t(e)})).then(a,s)}c((r=r.apply(t,e||[])).next())})},n=this&&this.__generator||function(t,e){var o,r,n,i,a={label:0,sent:function(){if(1&n[0])throw n[1];return n[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(t){return function(e){return c([t,e])}}function c(i){if(o)throw new TypeError("Generator is already executing.");for(;a;)try{if(o=1,r&&(n=2&i[0]?r.return:i[0]?r.throw||((n=r.return)&&n.call(r),0):r.next)&&!(n=n.call(r,i[1])).done)return n;switch(r=0,n&&(i=[2&i[0],n.value]),i[0]){case 0:case 1:n=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,r=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(n=(n=a.trys).length>0&&n[n.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!n||i[1]>n[0]&&i[1]<n[3])){a.label=i[1];break}if(6===i[0]&&a.label<n[1]){a.label=n[1],n=i;break}if(n&&a.label<n[2]){a.label=n[2],a.ops.push(i);break}n[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(s){i=[6,s],r=0}finally{o=n=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}};Object.defineProperty(o,"__esModule",{value:!0}),o.PromiseUtils=void 0;var i=function(){function t(){}return t.wait=function(t){return new Promise(function(e){return setTimeout(function(){return e(!0)},t)})},t.waitFor=function(t,e,o,i,a){var s=this;return void 0===e&&(e=100),void 0===o&&(o=1e4),void 0===i&&(i="timeout"),new Promise(function(c){var l,u=function(e,i){return r(s,void 0,void 0,function(){var r;return n(this,function(n){switch(n.label){case 0:return a&&console.log("Waiting for:",a,t),[4,t()];case 1:return r=n.sent(),a&&console.log("Current result:",a,r),r||--o<=0?(e&&e(),c(r)):i&&i(),[2]}})})};switch(i){case"timeout":(l=function(){return u(null,function(){return setTimeout(l,e)})})().then();break;case"interval":l=function(){return u(function(){return clearInterval(p)})};var p=setInterval(l,e)}})},t.waitForResult=function(t,e,o,r){return void 0===e&&(e=3e4),void 0===r&&(r=!1),new Promise(function(n,i){setTimeout(function(){return r?i(o):n(o)},e),t.then(n).catch(i)})},t.waitForRetry=function(t,e,o,r){var n=this;return void 0===e&&(e=20),void 0===r&&(r=!1),new Promise(function(o,r){var i=0,a=function(){++i>e?r():t().then(function(t){return o(t)}).catch(function(){setTimeout(a,n.retryColdDownTime)})};a()})},t.funcWrapper=function(t,e,o){e();try{return t()}finally{o()}},t.retryColdDownTime=3e3,t}();o.PromiseUtils=i,cc._RF.pop()},{}],Quality:[function(t,e,o){"use strict";cc._RF.push(e,"0b6ffn9rNBH9rbFZuFJSnWq","Quality");var r,n=this&&this.__extends||(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),i=this&&this.__decorate||function(t,e,o,r){var n,i=arguments.length,a=i<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,o):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,o,r);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(a=(i<3?n(a):i>3?n(e,o,a):n(e,o))||a);return i>3&&a&&Object.defineProperty(e,o,a),a};Object.defineProperty(o,"__esModule",{value:!0}),o.QualityRepo=o.qualityRepo=o.Quality=o.QualityType=void 0;var a,s=t("../../CoreModule/Data/BaseData"),c=t("../../CoreModule/Data/BaseRepository"),l=t("../../CoreModule/Data/StaticData");(function(t){t[t.N=0]="N",t[t.R=1]="R",t[t.SR=2]="SR",t[t.SSR=3]="SSR",t[t.UR=4]="UR"})(a=o.QualityType||(o.QualityType={}));var u=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.id=a.N,e.color="FFFFFF",e.rate=1,e}return n(e,t),Object.defineProperty(e.prototype,"shortName",{get:function(){return a[this.id]},enumerable:!1,configurable:!0}),i([s.field],e.prototype,"id",void 0),i([s.field],e.prototype,"color",void 0),i([s.field],e.prototype,"rate",void 0),i([l.data("Quality")],e)}(l.StaticData);o.Quality=u,o.qualityRepo=function(){return c.getRepository(p)};var p=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),Object.defineProperty(e.prototype,"clazz",{get:function(){return u},enumerable:!1,configurable:!0}),e.prototype.getById=function(){},e.prototype.n=function(){return this.getById(a.N)},e.prototype.r=function(){return this.getById(a.R)},e.prototype.sr=function(){return this.getById(a.SR)},e.prototype.ssr=function(){return this.getById(a.SSR)},e.prototype.ur=function(){return this.getById(a.UR)},i([c.repository],e)}(c.BaseRepository);o.QualityRepo=p,cc._RF.pop()},{"../../CoreModule/Data/BaseData":"BaseData","../../CoreModule/Data/BaseRepository":"BaseRepository","../../CoreModule/Data/StaticData":"StaticData"}],RadiusMask:[function(t,e,o){"use strict";cc._RF.push(e,"0fd21zq5MpI/5v584qy9lYx","RadiusMask");var r,n=this&&this.__extends||(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),i=this&&this.__decorate||function(t,e,o,r){var n,i=arguments.length,a=i<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,o):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,o,r);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(a=(i<3?n(a):i>3?n(e,o,a):n(e,o))||a);return i>3&&a&&Object.defineProperty(e,o,a),a};Object.defineProperty(o,"__esModule",{value:!0}),o.RadiusMask=void 0;var a=cc._decorator.property,s=cc._decorator.ccclass,c=cc._decorator.executeInEditMode,l=cc._decorator.disallowMultiple,u=cc._decorator.requireComponent,p=cc._decorator.menu;cc.macro.ENABLE_WEBGL_ANTIALIAS=!0;var f=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e._radius=50,e.mask=null,e}return n(e,t),Object.defineProperty(e.prototype,"radius",{get:function(){return this._radius},set:function(t){this._radius=t,this.updateMask(t)},enumerable:!1,configurable:!0}),e.prototype.onEnable=function(){this.mask=this.getComponent(cc.Mask),this.updateMask(this.radius)},e.prototype.updateMask=function(t){var e=t>=0?t:0;e<1&&(e=Math.min(this.node.width,this.node.height)*e),this.mask.radius=e,this.mask.onDraw=this.onDraw.bind(this.mask),this.mask._updateGraphics=this._updateGraphics.bind(this.mask),this.mask.type=cc.Mask.Type.RECT},e.prototype._updateGraphics=function(){var t=this._graphics;t&&this.onDraw(t)},e.prototype.onDraw=function(t){t.clear(!1);var e=this.node,o=e.width,r=e.height,n=-o*e.anchorX,i=-r*e.anchorY;t.roundRect(n,i,o,r,this.radius||0),cc.game.renderType===cc.game.RENDER_TYPE_CANVAS?t.stroke():t.fill()},i([a()],e.prototype,"_radius",void 0),i([a({tooltip:"\u5706\u89d2\u534a\u5f84:\n0-1\u4e4b\u95f4\u4e3a\u6700\u5c0f\u8fb9\u957f\u6bd4\u4f8b\u503c, \n>1\u4e3a\u5177\u4f53\u50cf\u7d20\u503c"})],e.prototype,"radius",null),i([s(),c(!0),l(!0),u(cc.Mask),p("\u6e32\u67d3\u7ec4\u4ef6/\u5706\u89d2\u906e\u7f69")],e)}(cc.Component);o.RadiusMask=f,cc._RF.pop()},{}],RandomAnimation:[function(t,e,o){"use strict";cc._RF.push(e,"79a36si/01OS5IxNPhhhS9P","RandomAnimation");var r,n=this&&this.__extends||(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),i=this&&this.__decorate||function(t,e,o,r){var n,i=arguments.length,a=i<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,o):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,o,r);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(a=(i<3?n(a):i>3?n(e,o,a):n(e,o))||a);return i>3&&a&&Object.defineProperty(e,o,a),a};Object.defineProperty(o,"__esModule",{value:!0});var a=cc.Animation,s=cc._decorator.requireComponent,c=cc._decorator.menu,l=cc._decorator,u=l.ccclass,p=l.property,f=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.animation=null,e.timeOffset=0,e.timeOffsetAdd=0,e.xOffset=0,e.yOffset=0,e.speedUp=0,e.resetPositionEveryLoop=!0,e.centerX=0,e.centerY=0,e.timer=0,e.isPlaying=!1,e}return n(e,t),e.prototype.start=function(){this.reset(),this.resetPositionEveryLoop&&this.animation.on("lastframe",this.resetPosition,this)},e.prototype.onEnable=function(){this.centerX=this.node.x,this.centerY=this.node.y,this.reset()},e.prototype.reset=function(){this.animation||(this.animation=this.getComponent(a)),this.animation.play(),this.animation.sample(this.animation.defaultClip.name),this.animation.stop(),this.resetPosition(),this.timer=Math.random()*this.timeOffset,this.animation.defaultClip.speed=1+Math.random()*this.speedUp,this.isPlaying=!1},e.prototype.update=function(t){this.isPlaying||(this.timer<=0&&(this.animation.play(),this.isPlaying=!0),this.timer-=t)},e.prototype.resetPosition=function(){this.node.x=this.centerX+Math.random()*this.xOffset*2-this.xOffset,this.node.y=this.centerY+Math.random()*this.yOffset*2-this.yOffset},i([p(a)],e.prototype,"animation",void 0),i([p(Number)],e.prototype,"timeOffset",void 0),i([p(Number)],e.prototype,"timeOffsetAdd",void 0),i([p(Number)],e.prototype,"xOffset",void 0),i([p(Number)],e.prototype,"yOffset",void 0),i([p(Number)],e.prototype,"speedUp",void 0),i([p(Boolean)],e.prototype,"resetPositionEveryLoop",void 0),i([u,s(a),c("\u5176\u4ed6\u7ec4\u4ef6/\u968f\u673a\u52a8\u753b\u8f85\u52a9")],e)}(cc.Component);o.default=f,cc._RF.pop()},{}],RankCommon:[function(t,e,o){"use strict";cc._RF.push(e,"f3fd9t6uCpDZaj9RZX3C4Ji","RankCommon");var r=this&&this.__decorate||function(t,e,o,r){var n,i=arguments.length,a=i<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,o):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,o,r);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(a=(i<3?n(a):i>3?n(e,o,a):n(e,o))||a);return i>3&&a&&Object.defineProperty(e,o,a),a};Object.defineProperty(o,"__esModule",{value:!0}),o.RankInterface=void 0;var n=t("../../CoreModule/Common/CoreCommon"),i=function(){function t(){}return t.GetPVPRank=function(){},r([n.get("/rank/pvp/get")],t,"GetPVPRank",null),t}();o.RankInterface=i,cc._RF.pop()},{"../../CoreModule/Common/CoreCommon":"CoreCommon"}],RankItemContainer:[function(t,e,o){"use strict";cc._RF.push(e,"84261bRIfZHo48kIRb7Pmtn","RankItemContainer");var r,n=this&&this.__extends||(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),i=this&&this.__decorate||function(t,e,o,r){var n,i=arguments.length,a=i<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,o):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,o,r);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(a=(i<3?n(a):i>3?n(e,o,a):n(e,o))||a);return i>3&&a&&Object.defineProperty(e,o,a),a},a=this&&this.__awaiter||function(t,e,o,r){return new(o||(o=Promise))(function(n,i){function a(t){try{c(r.next(t))}catch(e){i(e)}}function s(t){try{c(r.throw(t))}catch(e){i(e)}}function c(t){var e;t.done?n(t.value):(e=t.value,e instanceof o?e:new o(function(t){t(e)})).then(a,s)}c((r=r.apply(t,e||[])).next())})},s=this&&this.__generator||function(t,e){var o,r,n,i,a={label:0,sent:function(){if(1&n[0])throw n[1];return n[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(t){return function(e){return c([t,e])}}function c(i){if(o)throw new TypeError("Generator is already executing.");for(;a;)try{if(o=1,r&&(n=2&i[0]?r.return:i[0]?r.throw||((n=r.return)&&n.call(r),0):r.next)&&!(n=n.call(r,i[1])).done)return n;switch(r=0,n&&(i=[2&i[0],n.value]),i[0]){case 0:case 1:n=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,r=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(n=(n=a.trys).length>0&&n[n.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!n||i[1]>n[0]&&i[1]<n[3])){a.label=i[1];break}if(6===i[0]&&a.label<n[1]){a.label=n[1],n=i;break}if(n&&a.label<n[2]){a.label=n[2],a.ops.push(i);break}n[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(s){i=[6,s],r=0}finally{o=n=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}};Object.defineProperty(o,"__esModule",{value:!0});var c=t("../../../CoreModule/Components/ItemContainer"),l=t("../../../HeroModule/Data/Hero"),u=t("../../../CoreModule/Managers/DataManager"),p=t("../../../PlayerModule/Managers/PlayerManager"),f=t("../../../RankModule/Common/RankCommon"),d=t("../../../CoreModule/Utils/ScrollviewFilter"),h=t("../../../CoreModule/Utils/DataLoader"),y=cc._decorator,g=y.ccclass,v=(y.property,function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.start=function(){this.setup().then()},e.prototype.setup=function(){return a(this,void 0,void 0,function(){var t,e;return s(this,function(o){switch(o.label){case 0:return[4,f.RankInterface.GetPVPRank()];case 1:return t=o.sent().nfts,e=t.map(function(t){return h.DataLoader.load(l.Hero,t)}).sort(function(t,e){return t.rank-e.rank}),this.setItems(e),[2]}})})},e.prototype.update=function(){},e.prototype.onItemsChanged=function(){t.prototype.onItemsChanged.call(this);var e=[];this.itemsComponents.forEach(function(t){1==t.node.active&&e.push(t.node)}),d.ScrollviewFilter.filter("vertical",this.container,e,5,this.node.height,170)},i([u.waitForDataLoad,p.waitForLogin],e.prototype,"setup",null),i([g],e)}(c.ItemContainer));o.default=v,cc._RF.pop()},{"../../../CoreModule/Components/ItemContainer":"ItemContainer","../../../CoreModule/Managers/DataManager":"DataManager","../../../CoreModule/Utils/DataLoader":"DataLoader","../../../CoreModule/Utils/ScrollviewFilter":"ScrollviewFilter","../../../HeroModule/Data/Hero":"Hero","../../../PlayerModule/Managers/PlayerManager":"PlayerManager","../../../RankModule/Common/RankCommon":"RankCommon"}],RankItemDisplay:[function(t,e,o){"use strict";cc._RF.push(e,"dfcfcgRdEdMBYBDsasKdDN7","RankItemDisplay");var r,n=this&&this.__extends||(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),i=this&&this.__decorate||function(t,e,o,r){var n,i=arguments.length,a=i<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,o):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,o,r);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(a=(i<3?n(a):i>3?n(e,o,a):n(e,o))||a);return i>3&&a&&Object.defineProperty(e,o,a),a};Object.defineProperty(o,"__esModule",{value:!0});var a=cc.Label,s=cc.Sprite,c=cc.SpriteFrame,l=t("../../../../Scenes/BattleScene"),u=t("../HeroWithAvatar"),p=cc._decorator,f=p.ccclass,d=p.property,h=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.nameLabel=null,e.powerLabel=null,e.rankLabel=null,e.qualityLabel=null,e.levelLabel=null,e.rankSprite=null,e.restraintSprite=null,e.qualitySprite=null,e.rankPictures=[],e.restraintPictures=[],e.qualityPictures=[],e.quality=["N","R","SR","SSR","UR"],e}return n(e,t),e.prototype.start=function(){},e.prototype.refresh=function(){t.prototype.refresh.call(this),this.nameLabel.string=this.item.name,this.powerLabel.string=this.item.battlePoint.toString(),this.rankLabel.string=this.item.rank>3?this.item.rank.toString():"",this.qualityLabel.string=this.quality[this.item.quality],this.levelLabel.string="Lv."+this.item.level.level.toString(),this.rankSprite.spriteFrame=this.item.rank<4?this.rankPictures[this.item.rank-1]:null,this.restraintSprite.spriteFrame=this.restraintPictures[this.item.restraint],this.qualitySprite.spriteFrame=this.qualityPictures[this.item.quality]},e.prototype.fightBtn=function(){l.battleScene().startPVPBattle(this.item.nftId).then()},i([d(a)],e.prototype,"nameLabel",void 0),i([d(a)],e.prototype,"powerLabel",void 0),i([d(a)],e.prototype,"rankLabel",void 0),i([d(a)],e.prototype,"qualityLabel",void 0),i([d(a)],e.prototype,"levelLabel",void 0),i([d(s)],e.prototype,"rankSprite",void 0),i([d(s)],e.prototype,"restraintSprite",void 0),i([d(s)],e.prototype,"qualitySprite",void 0),i([d([c])],e.prototype,"rankPictures",void 0),i([d([c])],e.prototype,"restraintPictures",void 0),i([d([c])],e.prototype,"qualityPictures",void 0),i([f],e)}(u.default);o.default=h,cc._RF.pop()},{"../../../../Scenes/BattleScene":"BattleScene","../HeroWithAvatar":"HeroWithAvatar"}],RankRecord:[function(t,e,o){"use strict";cc._RF.push(e,"d61d8CNSKpJ0Y4T5vAh+Nmo","RankRecord");var r,n=this&&this.__extends||(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),i=this&&this.__decorate||function(t,e,o,r){var n,i=arguments.length,a=i<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,o):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,o,r);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(a=(i<3?n(a):i>3?n(e,o,a):n(e,o))||a);return i>3&&a&&Object.defineProperty(e,o,a),a};Object.defineProperty(o,"__esModule",{value:!0}),o.RankRecord=o.RankItem=o.RankTypes=void 0;var a=t("../../CoreModule/Data/BaseData"),s=t("../../NFTModule/Managers/NFTManager");o.RankTypes=["battle","gold","diamond","pvp"];var c=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.chainId=s.DefaultChainId,e.account="",e.wallet="Metamask",e.name="",e.avatarUrl="",e}return n(e,t),i([a.field(String)],e.prototype,"uuid",void 0),i([a.field(Number)],e.prototype,"value",void 0),i([a.field],e.prototype,"chainId",void 0),i([a.field],e.prototype,"account",void 0),i([a.field],e.prototype,"wallet",void 0),i([a.field],e.prototype,"name",void 0),i([a.field],e.prototype,"avatarUrl",void 0),e}(a.BaseData);o.RankItem=c;var l=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.list=[],e}return n(e,t),e.create=function(t,o){var r=new e;return r.type=t,r.createdAt=Date.now(),r.list=o,r},i([a.field(String)],e.prototype,"type",void 0),i([a.field(Number)],e.prototype,"createdAt",void 0),i([a.field([c])],e.prototype,"list",void 0),e}(a.GameData);o.RankRecord=l,cc._RF.pop()},{"../../CoreModule/Data/BaseData":"BaseData","../../NFTModule/Managers/NFTManager":"NFTManager"}],ResultProcessor:[function(t,e,o){"use strict";cc._RF.push(e,"0eaf4C3L/1E5qLa6xaFqjFY","ResultProcessor"),Object.defineProperty(o,"__esModule",{value:!0}),o.ResultProcessor=void 0;var r=function(){function t(){}return t.create=function(e,o){var r=new t;return r.result=o,r.battler=e,r},t.prototype.process=function(){this.doProcess()},t.prototype.doProcess=function(){},t}();o.ResultProcessor=r,cc._RF.pop()},{}],Result:[function(t,e,o){"use strict";cc._RF.push(e,"bb6b8J0/dtJMKoOOFaX9mqx","Result");var r,n=this&&this.__extends||(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),i=this&&this.__decorate||function(t,e,o,r){var n,i=arguments.length,a=i<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,o):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,o,r);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(a=(i<3?n(a):i>3?n(e,o,a):n(e,o))||a);return i>3&&a&&Object.defineProperty(e,o,a),a};Object.defineProperty(o,"__esModule",{value:!0}),o.Result=void 0;var a=t("../../CoreModule/Data/BaseData"),s=function(t){function e(e,o){var r=t.call(this,e)||this;return r.hpDamage=0,r.hpRecover=0,r.hpDrain=0,r.isMiss=!1,r.isCritical=!1,r.action=o,r}return n(e,t),e.create=function(t,o,r,n){void 0===r&&(r=0),void 0===n&&(n=!1);var i=new e(void 0,t);switch(o){case"damage":i.hpDamage=r;break;case"recover":i.hpRecover=r;break;case"drain":i.hpDrain=r;break;case"miss":i.isMiss=!0}return i.isCritical=n,i},e.testData=function(){var t=new e;return t.hpDamage=Math.floor(128*Math.random()),t},i([a.field],e.prototype,"hpDamage",void 0),i([a.field],e.prototype,"hpRecover",void 0),i([a.field],e.prototype,"hpDrain",void 0),i([a.field],e.prototype,"isMiss",void 0),i([a.field],e.prototype,"isCritical",void 0),e}(a.BaseData);o.Result=s,cc._RF.pop()},{"../../CoreModule/Data/BaseData":"BaseData"}],RewardProcessor:[function(t,e,o){"use strict";cc._RF.push(e,"14a4aSyw7xKjrA6Z7VfZrLK","RewardProcessor"),Object.defineProperty(o,"__esModule",{value:!0}),o.RewardProcessor=o.createProcessor=o.rewardProcessor=void 0,o.rewardProcessor=function(t){return function(e){r.processorSettings[t]=e}},o.createProcessor=function(t){return new(0,r.processorSettings[t.type])(t)};var r=function(){function t(t){this.reward=t}return Object.defineProperty(t.prototype,"value",{get:function(){return this.reward.value},enumerable:!1,configurable:!0}),t.processorSettings={},t}();o.RewardProcessor=r,cc._RF.pop()},{}],Reward:[function(t,e,o){"use strict";cc._RF.push(e,"d3742aBxVdLG41gbYO56u+Q","Reward");var r,n=this&&this.__extends||(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),i=this&&this.__decorate||function(t,e,o,r){var n,i=arguments.length,a=i<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,o):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,o,r);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(a=(i<3?n(a):i>3?n(e,o,a):n(e,o))||a);return i>3&&a&&Object.defineProperty(e,o,a),a};Object.defineProperty(o,"__esModule",{value:!0}),o.RewardGroup=o.Reward=o.r=o.RewardType=void 0;var a,s=t("../../CoreModule/Data/BaseData");(function(t){t.Gold="gold",t.Diamond="diamond",t.Fragment="fragment",t.Medal="medal",t.Token="token"})(a=o.RewardType||(o.RewardType={})),o.r=function(t,e,o){return void 0===o&&(o={}),c.create(t,e,o)};var c=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.type=a.Gold,e.value=0,e.params={},e}return n(e,t),e.create=function(t,o,r){void 0===r&&(r={});var n=new e;return n.type=t,n.value=o,n.params=r,n},i([s.field],e.prototype,"type",void 0),i([s.field],e.prototype,"value",void 0),i([s.field(Object)],e.prototype,"params",void 0),e}(s.BaseData);o.Reward=c;var l=t("../Utils/RewardProcessor"),u=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.rewards=[],e}return n(e,t),e.create=function(){for(var t=[],o=0;o<arguments.length;o++)t[o]=arguments[o];var r=new e;return t.forEach(function(t){return r.add(t)}),r},e.prototype.add=function(t){var e=this;if(t instanceof c){var o=this.find(t.type);o?o.value+=t.value:this.rewards.push(t.clone())}else t.rewards.forEach(function(t){return e.add(t)})},e.prototype.push=function(t){this.rewards.push(t)},e.prototype.invoke=function(t){void 0===t&&(t=1);for(var e=0,o=this.rewards.map(function(t){return l.createProcessor(t)});e<o.length;e++)o[e].invoke(t)},e.prototype.find=function(t){return this.rewards.find(function(e){return e.type==t})},Object.defineProperty(e.prototype,"gold",{get:function(){return this.find(a.Gold)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"diamond",{get:function(){return this.find(a.Diamond)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"medal",{get:function(){return this.find(a.Medal)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"token",{get:function(){return this.find(a.Token)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"fragment",{get:function(){return this.find(a.Fragment)},enumerable:!1,configurable:!0}),i([s.field([c])],e.prototype,"rewards",void 0),e}(s.BaseData);o.RewardGroup=u,cc._RF.pop()},{"../../CoreModule/Data/BaseData":"BaseData","../Utils/RewardProcessor":"RewardProcessor"}],SceneManager:[function(t,e,o){"use strict";cc._RF.push(e,"330696NdkdBCazsHWvcDzdi","SceneManager");var r,n=this&&this.__extends||(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),i=this&&this.__decorate||function(t,e,o,r){var n,i=arguments.length,a=i<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,o):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,o,r);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(a=(i<3?n(a):i>3?n(e,o,a):n(e,o))||a);return i>3&&a&&Object.defineProperty(e,o,a),a};Object.defineProperty(o,"__esModule",{value:!0}),o.getOrCreateCache=o.singletonTarget=o.singletonComponent=o.curScene=o.sceneMgr=void 0;var a=t("./BaseManager"),s="__exermonCache__";function c(){return a.getManager(f)}function l(){return c().curScene}function u(t){return t?"function"!=typeof t?u(t.constructor):t[s]||(t[s]={targets:{}}):{}}function p(t,e){var o=u(t);for(var r in o.targets)if(o.targets[r]==e)return r;return null}o.sceneMgr=c,o.curScene=l,o.singletonComponent=function(t){var e=t.prototype.start,o=t.prototype.onDestroy;t.prototype.start=function(){var o=l(),r=p(o,t);r&&(o[r]=this),null==e||e.call(this)},t.prototype.onDestroy=function(){var e=l(),r=p(e,t);r&&(e[r]=null),null==o||o.call(this)}},o.singletonTarget=function(t){return function(e,o){u(e.constructor).targets[o]=t}},o.getOrCreateCache=u;var f=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.curScene=null,e}return n(e,t),i([a.manager],e)}(a.BaseManager);cc._RF.pop()},{"./BaseManager":"BaseManager"}],ScrollviewFilter:[function(t,e,o){"use strict";cc._RF.push(e,"22352Zx50pL/5ZKvEJoCCTB","ScrollviewFilter"),Object.defineProperty(o,"__esModule",{value:!0}),o.ScrollviewFilter=void 0;var r=cc.ScrollView,n=function(){function t(){}return t.filter=function(t,e,o,n,i,a,s){void 0===a&&(a=0),void 0===s&&(s=1);for(var c=-n+a,l=null,u=e;u.parent;u=u.parent){var p=u.getComponent(r);if(p&&p.content==e){l=p;break}}switch(t){case"horizontal":for(u=0;u<o.length;u++)u%s==0&&(c+=o[u].width+n);c>i?(c!=e.width&&(l?l.scrollToLeft():e.x=(c-i)/2),e.width=c):(l?l.scrollToLeft():e.x=0,e.width=i);break;case"vertical":for(u=0;u<o.length;u++)u%s==0&&(c+=o[u].height+n);c>i?(c!=e.height&&(l?l.scrollToTop():e.y=(i-c+e.height)/2),e.height=c):(l?l.scrollToTop():e.y=i/2,e.height=i)}},t}();o.ScrollviewFilter=n,cc._RF.pop()},{}],SelectableGroup:[function(t,e,o){"use strict";cc._RF.push(e,"c4151ha3yBC8Y1BUubjVVt1","SelectableGroup"),Object.defineProperty(o,"__esModule",{value:!0}),o.SelectableGroup=void 0;var r=function(){function t(t){void 0===t&&(t=!0),this.elements=[],this.selectedIndex=-1,this.allowNoSelection=t}return t.prototype.addElement=function(t){-1==this.indexOf(t)&&(t.selectableGroup=this,this.elements.push(t),1!=this.size()||this.allowNoSelection||this.select(t))},t.prototype.removeElement=function(t){var e=this.indexOf(t);-1!=e&&(this.isSelected(t)?(this.selectedIndex=-1,this.elements.splice(e,1),t.onDeselected(),!this.allowNoSelection&&this.size()>0&&this.select(this.getElementAt(0))):(this.elements.splice(e,1),e<this.selectedIndex&&this.selectedIndex--),t.selectableGroup=null)},t.prototype.indexOf=function(t){return this.elements.indexOf(t)},t.prototype.size=function(){return this.elements.length},t.prototype.getElementAt=function(t){return this.elements[t]},t.prototype.isSelected=function(t){return this.currentSelection()==t},t.prototype.select=function(t){var e=this.indexOf(t);if(-1!=e&&this.selectedIndex!=e){var o=this.currentSelection();this.selectedIndex=e,null==o||o.onDeselected(),t.onSelected()}},t.prototype.deselect=function(t){t&&-1!=this.indexOf(t)&&this.allowNoSelection&&(this.selectedIndex=-1,t.onDeselected())},t.prototype.currentSelection=function(){return-1==this.selectedIndex?null:this.getElementAt(this.selectedIndex)},t}();o.SelectableGroup=r,cc._RF.pop()},{}],SelectableObject:[function(t,e,o){"use strict";cc._RF.push(e,"70657laVSVHwqRBDcRZZEiN","SelectableObject");var r,n=this&&this.__extends||(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)});Object.defineProperty(o,"__esModule",{value:!0}),o.SelectableObject=void 0;var i=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.selectSelf=function(){var t;null===(t=this.selectableGroup)||void 0===t||t.select(this)},e.prototype.deselectSelf=function(){var t;null===(t=this.selectableGroup)||void 0===t||t.deselect(this)},e.prototype.toggleSelection=function(){null!=this.selectableGroup&&(this.selectableGroup.isSelected(this)?this.selectableGroup.deselect(this):this.selectableGroup.select(this))},e.prototype.removeSelf=function(){var t;null===(t=this.selectableGroup)||void 0===t||t.removeElement(this)},e}(cc.Component);o.SelectableObject=i,cc._RF.pop()},{}],SelectedHeroDisplay:[function(t,e,o){"use strict";cc._RF.push(e,"df276H/bFREPY287oaHHhEM","SelectedHeroDisplay");var r,n=this&&this.__extends||(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),i=this&&this.__decorate||function(t,e,o,r){var n,i=arguments.length,a=i<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,o):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,o,r);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(a=(i<3?n(a):i>3?n(e,o,a):n(e,o))||a);return i>3&&a&&Object.defineProperty(e,o,a),a};Object.defineProperty(o,"__esModule",{value:!0});var a=cc.Label,s=t("../../../../Scenes/BattleScene"),c=t("../../../PlayerModule/Managers/PlayerManager"),l=t("../../../EconomicModule/Data/PlayerMoney"),u=cc.Sprite,p=cc.SpriteFrame,f=t("../../../../Utils/SpineUtils"),d=t("../../../HeroModule/Managers/HeroManager"),h=sp.Skeleton,y=cc.Node,g=t("../../../../Utils/NumberUtils"),v=cc._decorator,b=v.ccclass,m=v.property,_=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.nameLabel=null,e.levelLabel=null,e.qualityLabel=null,e.powerLabel=null,e.coinLabel=null,e.qualitySprite=null,e.restraintSprite=null,e.playerInfoNode=null,e.hero=null,e.quality=["N","R","SR","SSR","UR"],e.qualityPictures=[],e.restraintPictures=[],e.avatar=null,e.size=120,e.avatarHeight=0,e.avatarWidth=0,e.avatarOffsetX=0,e.avatarOffsetY=0,e}return n(e,t),e.prototype.start=function(){},e.prototype.update=function(){if(!s.battleScene().heroSelected)return this.playerInfoNode.active=!0,void(this.node.active=!1);var t=s.battleScene().currentPVPSelect;t!=this.hero&&(this.hero=t,this.onHeroChanged(this.hero)),this.updateLabels(this.hero)},e.prototype.updateLabels=function(t){this.levelLabel.string="Lv."+t.level.level,this.powerLabel.string="99999999",this.coinLabel.string=c.playerMgr().getPlayerData(l.PlayerMoney).gold.toString()},e.prototype.onHeroChanged=function(t){this.nameLabel.string=t.name,this.qualityLabel.string=this.quality[t.quality],this.qualitySprite.spriteFrame=this.qualityPictures[t.quality],this.restraintSprite.spriteFrame=this.restraintPictures[t.restraint],this.drawAvatar(t)},e.prototype.drawAvatar=function(t){var e=this;this.avatar.node.scale=0;var o=new y("node"),r=o.addComponent(h),n=new f.HeroSkeleton(this.avatar,r,d.heroMgr().getCacheOneFromServer(t.nftId).heroTypeId);t.parts.forEach(function(t){n.addPart(t)}),n.refresh().then(function(){o.destroy();var t=n.findBone("head_1");n.skeleton.updateWorldTransform();for(var r=t.worldX,i=t.worldY;t.parent;)t=t.parent;t.x-=r,t.y-=i;var a=n.findSlot("head_1");a.getAttachment()&&(e.avatarHeight=a.getAttachment().height,e.avatarWidth=a.getAttachment().width,e.avatarOffsetY=a.getAttachment().x,e.avatarOffsetX=a.getAttachment().y,e.sizeFilter())})},e.prototype.sizeFilter=function(){var t=Math.min(this.avatarWidth/this.size,this.avatarHeight/this.size);t*=1.2,this.avatar.node.y=-this.avatarOffsetY/t,this.avatar.node.scale=t>1?1/t:1},i([m(a)],e.prototype,"nameLabel",void 0),i([m(a)],e.prototype,"levelLabel",void 0),i([m(a)],e.prototype,"qualityLabel",void 0),i([m(a)],e.prototype,"powerLabel",void 0),i([m(a)],e.prototype,"coinLabel",void 0),i([m(u)],e.prototype,"qualitySprite",void 0),i([m(u)],e.prototype,"restraintSprite",void 0),i([m(y)],e.prototype,"playerInfoNode",void 0),i([g.autoUnitConvert],e.prototype,"updateLabels",null),i([m([p])],e.prototype,"qualityPictures",void 0),i([m([p])],e.prototype,"restraintPictures",void 0),i([m(h)],e.prototype,"avatar",void 0),i([b],e)}(cc.Component);o.default=_,cc._RF.pop()},{"../../../../Scenes/BattleScene":"BattleScene","../../../../Utils/NumberUtils":"NumberUtils","../../../../Utils/SpineUtils":"SpineUtils","../../../EconomicModule/Data/PlayerMoney":"PlayerMoney","../../../HeroModule/Managers/HeroManager":"HeroManager","../../../PlayerModule/Managers/PlayerManager":"PlayerManager"}],SelectorScene:[function(t,e,o){"use strict";cc._RF.push(e,"3c3d27vRexCp4rY0aeoyGjk","SelectorScene");var r,n=this&&this.__extends||(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),i=this&&this.__decorate||function(t,e,o,r){var n,i=arguments.length,a=i<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,o):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,o,r);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(a=(i<3?n(a):i>3?n(e,o,a):n(e,o))||a);return i>3&&a&&Object.defineProperty(e,o,a),a},a=this&&this.__awaiter||function(t,e,o,r){return new(o||(o=Promise))(function(n,i){function a(t){try{c(r.next(t))}catch(e){i(e)}}function s(t){try{c(r.throw(t))}catch(e){i(e)}}function c(t){var e;t.done?n(t.value):(e=t.value,e instanceof o?e:new o(function(t){t(e)})).then(a,s)}c((r=r.apply(t,e||[])).next())})},s=this&&this.__generator||function(t,e){var o,r,n,i,a={label:0,sent:function(){if(1&n[0])throw n[1];return n[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(t){return function(e){return c([t,e])}}function c(i){if(o)throw new TypeError("Generator is already executing.");for(;a;)try{if(o=1,r&&(n=2&i[0]?r.return:i[0]?r.throw||((n=r.return)&&n.call(r),0):r.next)&&!(n=n.call(r,i[1])).done)return n;switch(r=0,n&&(i=[2&i[0],n.value]),i[0]){case 0:case 1:n=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,r=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(n=(n=a.trys).length>0&&n[n.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!n||i[1]>n[0]&&i[1]<n[3])){a.label=i[1];break}if(6===i[0]&&a.label<n[1]){a.label=n[1],n=i;break}if(n&&a.label<n[2]){a.label=n[2],a.ops.push(i);break}n[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(s){i=[6,s],r=0}finally{o=n=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}};Object.defineProperty(o,"__esModule",{value:!0}),o.selectorScene=void 0;var c=t("../../Modules/CoreModule/Utils/SingletonUtils"),l=t("../BaseScene"),u=t("./Components/Editor/GlobalEditor"),p=t("./Components/Editor/SingleEditor"),f=cc.director,d=t("../../Modules/CoreModule/Managers/GameManager"),h=t("../../Modules/HeroModule/Managers/EditorManager"),y=t("../../Modules/CoreModule/Managers/LoadingManager"),g=cc._decorator,v=g.ccclass,b=g.property;o.selectorScene=function(){return c.getSingleton(m)};var m=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.editorMode=!1,e.globalEditor=null,e.singleEditor=null,e}return n(e,t),Object.defineProperty(e.prototype,"autoConnect",{get:function(){return!1},enumerable:!1,configurable:!0}),e.prototype.onLoad=function(){t.prototype.onLoad.call(this),d.gameMgr().needUpdateToken=!this.editorMode},e.prototype.update=function(e){t.prototype.update.call(this,e)},e.prototype.enterGame=function(){f.loadScene("BattleScene")},e.prototype.importConfigs=function(){h.editorMgr().import()},e.prototype.exportConfigs=function(){h.editorMgr().export()},e.prototype.pushConfigs=function(){return a(this,void 0,void 0,function(){return s(this,function(t){switch(t.label){case 0:return[4,h.editorMgr().push()];case 1:return t.sent(),[2]}})})},e.prototype.pullConfigs=function(){return a(this,void 0,void 0,function(){return s(this,function(t){switch(t.label){case 0:return[4,h.editorMgr().pull()];case 1:return t.sent(),this.globalEditor.refresh(),this.singleEditor.refresh(),[2]}})})},e.prototype.toggleGlobalEditor=function(){this.globalEditor.node.active=!this.globalEditor.node.active},i([b],e.prototype,"editorMode",void 0),i([b(u.default)],e.prototype,"globalEditor",void 0),i([b(p.default)],e.prototype,"singleEditor",void 0),i([y.showLoading],e.prototype,"pushConfigs",null),i([y.showLoading],e.prototype,"pullConfigs",null),i([v,c.singleton],e)}(l.BaseScene);o.default=m,cc._RF.pop()},{"../../Modules/CoreModule/Managers/GameManager":"GameManager","../../Modules/CoreModule/Managers/LoadingManager":"LoadingManager","../../Modules/CoreModule/Utils/SingletonUtils":"SingletonUtils","../../Modules/HeroModule/Managers/EditorManager":"EditorManager","../BaseScene":"BaseScene","./Components/Editor/GlobalEditor":"GlobalEditor","./Components/Editor/SingleEditor":"SingleEditor"}],SettlementWindowController:[function(t,e,o){"use strict";cc._RF.push(e,"a5349Ve0P9PII/PYdLz29jn","SettlementWindowController");var r,n=this&&this.__extends||(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),i=this&&this.__decorate||function(t,e,o,r){var n,i=arguments.length,a=i<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,o):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,o,r);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(a=(i<3?n(a):i>3?n(e,o,a):n(e,o))||a);return i>3&&a&&Object.defineProperty(e,o,a),a};Object.defineProperty(o,"__esModule",{value:!0});var a=t("./Main/BattleRewardContainer"),s=cc._decorator,c=s.ccclass,l=s.property,u=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.container=null,e}return n(e,t),e.prototype.start=function(){},e.prototype.open=function(t){this.node.active||(this.node.active=!0,this.container.setItems(t))},e.prototype.quit=function(){this.container.setItems([]),this.node.active=!1},i([l(a.default)],e.prototype,"container",void 0),i([c],e)}(cc.Component);o.default=u,cc._RF.pop()},{"./Main/BattleRewardContainer":"BattleRewardContainer"}],SingleEditor:[function(t,e,o){"use strict";cc._RF.push(e,"034d6jF6UJNkKXuUHkUOrSp","SingleEditor");var r,n=this&&this.__extends||(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),i=this&&this.__decorate||function(t,e,o,r){var n,i=arguments.length,a=i<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,o):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,o,r);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(a=(i<3?n(a):i>3?n(e,o,a):n(e,o))||a);return i>3&&a&&Object.defineProperty(e,o,a),a};Object.defineProperty(o,"__esModule",{value:!0});var a=t("../../../../Modules/CoreModule/Components/ItemDisplay"),s=cc.Node,c=t("../../SelectorScene"),l=t("../ItemPrefabs/PartsDisplay"),u=t("../ItemPrefabs/PreviewPictureDisplay"),p=cc.Slider,f=t("../ItemContainers/PartsContainer"),d=cc.EditBox,h=t("../../../../Modules/HeroModule/Managers/EditorManager"),y=t("../../../../Utils/TransformUtils"),g=t("../../../../Modules/HeroModule/Data/PartType"),v=cc.Button,b=t("../../../../Modules/HeroModule/Data/Part"),m=cc._decorator,_=m.ccclass,P=m.property,M=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.partsContainer=null,e.curPartDisplay=null,e.basePartDisplay=null,e.scaleNode=null,e.scaleBar=null,e.scaleValue=null,e.xNode=null,e.xBar=null,e.xValue=null,e.yNode=null,e.yBar=null,e.yValue=null,e.applyButton=null,e.clothes6Button=null,e.preview=null,e.keyTimes={},e}return n(e,t),Object.defineProperty(e.prototype,"globalEditor",{get:function(){return c.selectorScene().globalEditor},enumerable:!1,configurable:!0}),e.prototype.onLoad=function(){this.partsContainer.singleEditor=this,this.curPartDisplay.preview=this.preview,this.basePartDisplay.preview=this.preview,this.addKeyListeners()},e.prototype.addKeyListeners=function(){cc.systemEvent.on(cc.SystemEvent.EventType.KEY_DOWN,this.onKeyDown,this),cc.systemEvent.on(cc.SystemEvent.EventType.KEY_UP,this.onKeyUp,this),this.touchNode.on("touchstart",this.onTouchStart,this)},Object.defineProperty(e.prototype,"part",{get:function(){var t;return null===(t=this.item)||void 0===t?void 0:t.part},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"partType",{get:function(){var t;return null===(t=this.part)||void 0===t?void 0:t.partType},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"basePartType",{get:function(){var t;return null===(t=this.partType)||void 0===t?void 0:t.basePartType},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"basePart",{get:function(){var t;return this.basePartType?null===(t=this.preview.item)||void 0===t?void 0:t.findPart(this.basePartType):null},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"headPart",{get:function(){var t;return null===(t=this.preview.item)||void 0===t?void 0:t.findPart(g.partTypeRepo().head)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"scale",{get:function(){return h.editorMgr().getPtBptScale(this.part.oriId,this.basePart.oriId)},set:function(t){h.editorMgr().changePtBptScale(this.part.oriId,this.basePart.oriId,t)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"offset",{get:function(){return h.editorMgr().getPtBptOffset(this.part.oriId,this.basePart.oriId)},set:function(t){h.editorMgr().changePtBptOffset(this.part.oriId,this.basePart.oriId,t)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"hidden",{get:function(){return h.editorMgr().getPtBptHidden(this.part.oriId,this.basePart.oriId)},set:function(t){h.editorMgr().changePtBptHidden(this.part.oriId,this.basePart.oriId,t)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"clothes6",{get:function(){return h.editorMgr().getClothes6Problem(this.part.oriId,this.headPart.oriId)},set:function(t){h.editorMgr().changeClothes6Problem(this.part.oriId,this.headPart.oriId,t)},enumerable:!1,configurable:!0}),e.prototype.refresh=function(){var e;t.prototype.refresh.call(this),this.preview.refresh(),this.partsContainer.refresh(),null!=this.item&&(null===(e=this.globalEditor)||void 0===e||e.refresh(),this.drawParts(),this.drawScaleOffset(),this.drawOthers())},e.prototype.drawParts=function(){this.curPartDisplay.setItem(this.item),this.basePart?(this.basePartDisplay.node.active=!0,this.basePartDisplay.setItem(this.basePart.toPartInfo())):this.basePartDisplay.node.active=!1},e.prototype.drawScaleOffset=function(){if(this.xNode.active=this.yNode.active=this.scaleNode.active=!!this.basePart,this.basePart){var t=this.scale;this.scaleBar.progress=(t-0)/4,this.scaleValue.string=t.toFixed(3);var e=this.offset;this.xBar.progress=(e[0]- -256)/512,this.xValue.string=e[0].toFixed(1),this.yBar.progress=(e[1]- -256)/512,this.yValue.string=e[1].toFixed(1)}},e.prototype.drawOthers=function(){this.applyButton.interactable=!!this.basePart,this.clothes6Button.interactable=this.item.part.partType.isClothes},e.prototype.setScale=function(t){this.scale=t,this.refresh()},e.prototype.setOffset=function(t,e){var o=this.offset;null!=t&&(o[0]=t),null!=e&&(o[1]=e),this.offset=o,this.refresh()},e.prototype.setX=function(t){return this.setOffset(t)},e.prototype.setY=function(t){return this.setOffset(void 0,t)},e.prototype.reset=function(){this.setScale(1),this.setOffset()},e.prototype.toggleSlot=function(t){var e=this.hidden,o=e.indexOf(t);o>=0?e.splice(o,1):e.push(t),this.hidden=e,this.refresh()},e.prototype.toggleClothes6=function(){this.clothes6=!this.clothes6,this.refresh()},e.prototype.processDir=function(t,e){void 0===e&&(e=1);var o=5*e;switch(t){case cc.macro.KEY.down:this.setY(this.offset[1]-o);break;case cc.macro.KEY.left:this.setX(this.offset[0]-o);break;case cc.macro.KEY.right:this.setX(this.offset[0]+o);break;case cc.macro.KEY.up:this.setY(this.offset[1]+o)}},e.prototype.applySameHeroType=function(){var t=this,e=this.basePart;if(e){var o=this.part.oriId,r=e.heroTypeId,n=e.partTypeId,i=b.partRepo().findByTypes(r,n,1);console.log("applySameHeroType",i),i.forEach(function(r){r!=e&&(h.editorMgr().changePtBptScale(o,r.oriId,t.scale),h.editorMgr().changePtBptOffset(o,r.oriId,t.offset),h.editorMgr().changePtBptHidden(o,r.oriId,t.hidden))}),this.refresh()}},e.prototype.onScaleSlide=function(){var t=this.scaleBar.progress;this.setScale(4*t+0)},e.prototype.onScaleEdit=function(){var t=Number(this.scaleValue.string);isNaN(t)?this.setScale(this.scale):this.setScale(t)},e.prototype.onXSlide=function(){var t=this.xBar.progress;this.setX(512*t-256)},e.prototype.onXEdit=function(){var t=Number(this.xValue.string);isNaN(t)?this.setX(this.offset[0]):this.setX(t)},e.prototype.onYSlide=function(){var t=this.yBar.progress;this.setY(512*t-256)},e.prototype.onYEdit=function(){var t=Number(this.yValue.string);isNaN(t)?this.setY(this.offset[1]):this.setY(t)},e.prototype.onKeyDown=function(t){var e=this.convertKeyCode(t.keyCode);this.keyTimes[e]={time:Date.now(),dt:0},this.processDir(e)},e.prototype.onKeyUp=function(t){var e=this.convertKeyCode(t.keyCode);delete this.keyTimes[e]},e.prototype.convertKeyCode=function(t){switch(t){case cc.macro.KEY.s:return cc.macro.KEY.down;case cc.macro.KEY.a:return cc.macro.KEY.left;case cc.macro.KEY.d:return cc.macro.KEY.right;case cc.macro.KEY.w:return cc.macro.KEY.up;default:return t}},e.prototype.onTouchStart=function(t){var e=this.preview.skeleton.node,o=y.default.getWorldPosition2(e),r=t.currentTouch.getLocation().clone(),n=r.sub(o).multiply(new cc.Vec2(1/e.scaleX,1/e.scaleY));console.log("Delta",r.x,r.y,n.x,n.y,e,this.preview.skeleton);for(var i=0,a=this.item.part.slotNames;i<a.length;i++){var s=a[i],c=this.preview.item.slotTouchTest(s,n);if(console.log("Slot: ",s,c),c)return void this.toggleSlot(c.data.name)}},e.prototype.update=function(t){var e=this,o=Date.now();Object.keys(this.keyTimes).forEach(function(r){var n=e.keyTimes[r];!n||o-n.time<500||(n.dt+=t)>50&&(n.dt=0,e.processDir(Number(r)))})},i([P(f.default)],e.prototype,"partsContainer",void 0),i([P(l.default)],e.prototype,"curPartDisplay",void 0),i([P(l.default)],e.prototype,"basePartDisplay",void 0),i([P(s)],e.prototype,"scaleNode",void 0),i([P(p)],e.prototype,"scaleBar",void 0),i([P(d)],e.prototype,"scaleValue",void 0),i([P(s)],e.prototype,"xNode",void 0),i([P(p)],e.prototype,"xBar",void 0),i([P(d)],e.prototype,"xValue",void 0),i([P(s)],e.prototype,"yNode",void 0),i([P(p)],e.prototype,"yBar",void 0),i([P(d)],e.prototype,"yValue",void 0),i([P(v)],e.prototype,"applyButton",void 0),i([P(v)],e.prototype,"clothes6Button",void 0),i([P(u.default)],e.prototype,"preview",void 0),i([P(s)],e.prototype,"touchNode",void 0),i([_],e)}(a.ItemDisplay);o.default=M,cc._RF.pop()},{"../../../../Modules/CoreModule/Components/ItemDisplay":"ItemDisplay","../../../../Modules/HeroModule/Data/Part":"Part","../../../../Modules/HeroModule/Data/PartType":"PartType","../../../../Modules/HeroModule/Managers/EditorManager":"EditorManager","../../../../Utils/TransformUtils":"TransformUtils","../../SelectorScene":"SelectorScene","../ItemContainers/PartsContainer":"PartsContainer","../ItemPrefabs/PartsDisplay":"PartsDisplay","../ItemPrefabs/PreviewPictureDisplay":"PreviewPictureDisplay"}],SingletonUtils:[function(t,e,o){"use strict";cc._RF.push(e,"144d2U1bV1O4q1d3bTE1X0A","SingletonUtils");var r,n=this&&this.__extends||(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)});Object.defineProperty(o,"__esModule",{value:!0}),o.getSingleton=o.singletonGetter=o.singletonValue=o.singleton=void 0;var i=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),Object.defineProperty(e.prototype,"contentName",{get:function(){return"Singleton"},enumerable:!1,configurable:!0}),e}(t("../../../Utils/BaseContext").BaseContext),a=function(){function t(){}return t.context=new i,t}();function s(t){return a.context.instance(t)}o.singleton=function(t){if(cc.js.isChildClassOf(t,cc.Component)){var e=t.prototype.onLoad,o=t.prototype.onDestroy;t.prototype.onLoad=function(){null==a.context.instance(t)&&a.context.create(t,this),null==e||e.call(this)},t.prototype.onDestroy=function(){a.context.instance(t)===this&&a.context.remove(t),null==o||o.call(this)}}else a.context.create(t,new t)},o.singletonValue=function(t){return function(e,o){console.log("[USE] ",{clazz:t,target:e,key:o}),e[o]=s(t)}},o.singletonGetter=function(t){return function(e,o,r){r.value=function(){var r;return e[r=o+"_CACHE"]||(e[r]=s(t))}}},o.getSingleton=s,cc._RF.pop()},{"../../../Utils/BaseContext":"BaseContext"}],SkillContainer:[function(t,e,o){"use strict";cc._RF.push(e,"de23ciFjZpPXpRm3TAfgESv","SkillContainer");var r,n=this&&this.__extends||(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),i=this&&this.__decorate||function(t,e,o,r){var n,i=arguments.length,a=i<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,o):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,o,r);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(a=(i<3?n(a):i>3?n(e,o,a):n(e,o))||a);return i>3&&a&&Object.defineProperty(e,o,a),a},a=this&&this.__awaiter||function(t,e,o,r){return new(o||(o=Promise))(function(n,i){function a(t){try{c(r.next(t))}catch(e){i(e)}}function s(t){try{c(r.throw(t))}catch(e){i(e)}}function c(t){var e;t.done?n(t.value):(e=t.value,e instanceof o?e:new o(function(t){t(e)})).then(a,s)}c((r=r.apply(t,e||[])).next())})},s=this&&this.__generator||function(t,e){var o,r,n,i,a={label:0,sent:function(){if(1&n[0])throw n[1];return n[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(t){return function(e){return c([t,e])}}function c(i){if(o)throw new TypeError("Generator is already executing.");for(;a;)try{if(o=1,r&&(n=2&i[0]?r.return:i[0]?r.throw||((n=r.return)&&n.call(r),0):r.next)&&!(n=n.call(r,i[1])).done)return n;switch(r=0,n&&(i=[2&i[0],n.value]),i[0]){case 0:case 1:n=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,r=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(n=(n=a.trys).length>0&&n[n.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!n||i[1]>n[0]&&i[1]<n[3])){a.label=i[1];break}if(6===i[0]&&a.label<n[1]){a.label=n[1],n=i;break}if(n&&a.label<n[2]){a.label=n[2],a.ops.push(i);break}n[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(s){i=[6,s],r=0}finally{o=n=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}};Object.defineProperty(o,"__esModule",{value:!0});var c=t("../../../CoreModule/Components/ItemContainer"),l=t("../../../CoreModule/Utils/ScrollviewFilter"),u=t("../../../PlayerModule/Managers/PlayerManager"),p=t("../../../CoreModule/Managers/DataManager"),f=t("../../../HeroModule/Data/Skill"),d=t("../../../../Scenes/BattleScene"),h=t("../../../../Utils/PromiseUtils"),y=cc._decorator,g=y.ccclass,v=(y.property,function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.start=function(){this.setup()},e.prototype.setup=function(){return a(this,void 0,void 0,function(){return s(this,function(t){switch(t.label){case 0:return[4,h.PromiseUtils.waitFor(function(){return null!=d.battleScene().currentPVPSelect})];case 1:return t.sent(),this.updateSkills(),[2]}})})},e.prototype.onItemsChanged=function(){t.prototype.onItemsChanged.call(this);var e=[];this.itemsComponents.forEach(function(t){return t.node.active&&e.push(t.node)}),l.ScrollviewFilter.filter("vertical",this.container,e,5,this.node.height,10)},e.prototype.updateSkills=function(){var t=d.battleScene().currentPVPSelect.skillIds.map(function(t){return f.skillRepo().getById(t)});this.setItems(t)},i([p.waitForDataLoad,u.waitForLogin],e.prototype,"setup",null),i([g],e)}(c.ItemContainer));o.default=v,cc._RF.pop()},{"../../../../Scenes/BattleScene":"BattleScene","../../../../Utils/PromiseUtils":"PromiseUtils","../../../CoreModule/Components/ItemContainer":"ItemContainer","../../../CoreModule/Managers/DataManager":"DataManager","../../../CoreModule/Utils/ScrollviewFilter":"ScrollviewFilter","../../../HeroModule/Data/Skill":"Skill","../../../PlayerModule/Managers/PlayerManager":"PlayerManager"}],SkillDisplay:[function(t,e,o){"use strict";cc._RF.push(e,"08b09NiNEdEYoQyJdJheI8g","SkillDisplay");var r,n=this&&this.__extends||(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),i=this&&this.__decorate||function(t,e,o,r){var n,i=arguments.length,a=i<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,o):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,o,r);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(a=(i<3?n(a):i>3?n(e,o,a):n(e,o))||a);return i>3&&a&&Object.defineProperty(e,o,a),a},a=this&&this.__awaiter||function(t,e,o,r){return new(o||(o=Promise))(function(n,i){function a(t){try{c(r.next(t))}catch(e){i(e)}}function s(t){try{c(r.throw(t))}catch(e){i(e)}}function c(t){var e;t.done?n(t.value):(e=t.value,e instanceof o?e:new o(function(t){t(e)})).then(a,s)}c((r=r.apply(t,e||[])).next())})},s=this&&this.__generator||function(t,e){var o,r,n,i,a={label:0,sent:function(){if(1&n[0])throw n[1];return n[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(t){return function(e){return c([t,e])}}function c(i){if(o)throw new TypeError("Generator is already executing.");for(;a;)try{if(o=1,r&&(n=2&i[0]?r.return:i[0]?r.throw||((n=r.return)&&n.call(r),0):r.next)&&!(n=n.call(r,i[1])).done)return n;switch(r=0,n&&(i=[2&i[0],n.value]),i[0]){case 0:case 1:n=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,r=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(n=(n=a.trys).length>0&&n[n.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!n||i[1]>n[0]&&i[1]<n[3])){a.label=i[1];break}if(6===i[0]&&a.label<n[1]){a.label=n[1],n=i;break}if(n&&a.label<n[2]){a.label=n[2],a.ops.push(i);break}n[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(s){i=[6,s],r=0}finally{o=n=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}};Object.defineProperty(o,"__esModule",{value:!0});var c=t("../../../CoreModule/Components/ItemDisplay"),l=cc.Label,u=cc.Node,p=cc.Button,f=cc.Sprite,d=cc.ProgressBar,h=cc.SpriteFrame,y=t("../../../../Utils/NumberUtils"),g=t("../../../../Utils/DateUtils"),v=t("../../BattleCommon"),b=cc._decorator,m=b.ccclass,_=b.property,P=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.upgradeLabel=null,e.upgradeTips=null,e.titleLabel=null,e.timerLabel=null,e.levelLabel=null,e.numberLabel=null,e.infoNode=null,e.iconNode=null,e.upgradeNode=null,e.upgradePicture=null,e.upgradeButton=null,e.progressBar=null,e.canUpgrade=null,e.cannotUpgrade=null,e}return n(e,t),e.prototype.start=function(){this.setup()},e.prototype.setup=function(){this.upgradePicture=this.upgradeNode.getComponent(f),this.upgradeButton=this.upgradeNode.getComponent(p)},Object.defineProperty(e.prototype,"restSecond",{get:function(){return 1},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"restSecondRate",{get:function(){return 1},enumerable:!1,configurable:!0}),e.prototype.refresh=function(){t.prototype.refresh.call(this),this.drawTitle(),this.drawNodes(),this.drawLabels(),this.drawPictures()},e.prototype.drawTitle=function(){this.titleLabel.string="\\L[SKILL_"+this.item.id+"]"},e.prototype.drawNodes=function(){},e.prototype.drawLabels=function(){var t=this.item.boostCost;this.item.freezeTime,this.levelLabel.string="",this.upgradeLabel.string=t.toString(),this.upgradeTips.string="\u7acb\u5373\u4f7f\u7528",this.timerLabel.string=g.DateUtils.sec2Str(this.restSecond)},e.prototype.drawPictures=function(){this.upgradePicture&&(this.upgradePicture.spriteFrame=this.canBoost?this.canUpgrade:this.cannotUpgrade),this.upgradeButton&&(this.upgradeButton.interactable=this.canBoost),this.progressBar.progress=this.restSecondRate},Object.defineProperty(e.prototype,"canBoost",{get:function(){return!0},enumerable:!1,configurable:!0}),e.prototype.upgradeBtn=function(){return a(this,void 0,void 0,function(){return s(this,function(t){switch(t.label){case 0:return[4,v.BattleInterface.StartTest()];case 1:return t.sent(),[4,v.BattleInterface.BoostPVP({battleId:"5",skillId:this.item.id})];case 2:return t.sent(),[2]}})})},e.prototype.update=function(){this.item&&this.updateDraw()},e.prototype.updateDraw=function(){this.drawNodes(),this.drawLabels(),this.drawPictures()},i([_(l)],e.prototype,"upgradeLabel",void 0),i([_(l)],e.prototype,"upgradeTips",void 0),i([_(l)],e.prototype,"titleLabel",void 0),i([_(l)],e.prototype,"timerLabel",void 0),i([_(l)],e.prototype,"levelLabel",void 0),i([_(l)],e.prototype,"numberLabel",void 0),i([_(u)],e.prototype,"infoNode",void 0),i([_(u)],e.prototype,"iconNode",void 0),i([_(u)],e.prototype,"upgradeNode",void 0),i([_(d)],e.prototype,"progressBar",void 0),i([_(h)],e.prototype,"canUpgrade",void 0),i([_(h)],e.prototype,"cannotUpgrade",void 0),i([y.autoUnitConvert],e.prototype,"drawLabels",null),i([m],e)}(c.ItemDisplay);o.default=P,cc._RF.pop()},{"../../../../Utils/DateUtils":"DateUtils","../../../../Utils/NumberUtils":"NumberUtils","../../../CoreModule/Components/ItemDisplay":"ItemDisplay","../../BattleCommon":"BattleCommon"}],Skill:[function(t,e,o){"use strict";cc._RF.push(e,"da800WdTKlABL4AmCAr3RtF","Skill");var r,n=this&&this.__extends||(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),i=this&&this.__decorate||function(t,e,o,r){var n,i=arguments.length,a=i<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,o):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,o,r);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(a=(i<3?n(a):i>3?n(e,o,a):n(e,o))||a);return i>3&&a&&Object.defineProperty(e,o,a),a};Object.defineProperty(o,"__esModule",{value:!0}),o.SkillRepo=o.skillRepo=o.Skill=o.PartAttackId=o.NormalAttackId=o.TargetType=void 0;var a,s=t("../../CoreModule/Data/BaseData"),c=t("../../BattleModule/Data/Effect"),l=t("../../CoreModule/Data/BaseRepository"),u=t("../../BattleModule/Data/MotionGroup"),p=t("../../../Utils/DecoratorUtils"),f=t("../../CoreModule/Data/StaticData"),d=t("./HeroType"),h=t("../../BattleModule/Data/Trait");(function(t){t[t.Self=0]="Self",t[t.FriendsNotSelf=1]="FriendsNotSelf",t[t.Friends=2]="Friends",t[t.Enemies=3]="Enemies",t[t.AllNotSelf=4]="AllNotSelf",t[t.All=5]="All"})(a=o.TargetType||(o.TargetType={})),o.NormalAttackId=0,o.PartAttackId=-1;var y=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.freezeTime=-1,e.boostCost=0,e.subjectMotionId=o.PartAttackId,e.targetMotionId=u.HurtMotionGroupId,e.race=d.HeroRace.None,e.mainParam=3,e.targetType=a.Enemies,e.targetCount=1,e.effects=[],e.traits=[],e.isPassive=!1,e.mustHit=!1,e}return n(e,t),e.prototype.subjectMotion=function(){return u.motionGroupRepo().getById(this.subjectMotionId)},e.prototype.targetMotion=function(){return u.motionGroupRepo().getById(this.targetMotionId)},i([s.field],e.prototype,"freezeTime",void 0),i([s.field],e.prototype,"boostCost",void 0),i([s.field(Number)],e.prototype,"subjectMotionId",void 0),i([s.field(Number)],e.prototype,"targetMotionId",void 0),i([s.field],e.prototype,"race",void 0),i([s.field],e.prototype,"mainParam",void 0),i([s.field],e.prototype,"targetType",void 0),i([s.field(Number)],e.prototype,"targetCount",void 0),i([s.field([c.Effect])],e.prototype,"effects",void 0),i([s.field([h.Trait])],e.prototype,"traits",void 0),i([s.field],e.prototype,"isPassive",void 0),i([s.field],e.prototype,"mustHit",void 0),i([p.cache],e.prototype,"subjectMotion",null),i([p.cache],e.prototype,"targetMotion",null),i([f.data("Skill")],e)}(f.StaticData);o.Skill=y,o.skillRepo=function(){return l.getRepository(g)};var g=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),Object.defineProperty(e.prototype,"clazz",{get:function(){return y},enumerable:!1,configurable:!0}),e.prototype.normalAttack=function(){return this.getById(o.NormalAttackId)},i([l.repository],e)}(l.BaseRepository);o.SkillRepo=g,cc._RF.pop()},{"../../../Utils/DecoratorUtils":"DecoratorUtils","../../BattleModule/Data/Effect":"Effect","../../BattleModule/Data/MotionGroup":"MotionGroup","../../BattleModule/Data/Trait":"Trait","../../CoreModule/Data/BaseData":"BaseData","../../CoreModule/Data/BaseRepository":"BaseRepository","../../CoreModule/Data/StaticData":"StaticData","./HeroType":"HeroType"}],SpeedButtonController:[function(t,e,o){"use strict";cc._RF.push(e,"184363b2rBGbJvCtJkxLrhb","SpeedButtonController");var r,n=this&&this.__extends||(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),i=this&&this.__decorate||function(t,e,o,r){var n,i=arguments.length,a=i<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,o):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,o,r);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(a=(i<3?n(a):i>3?n(e,o,a):n(e,o))||a);return i>3&&a&&Object.defineProperty(e,o,a),a};Object.defineProperty(o,"__esModule",{value:!0});var a=cc.Label,s=cc.ProgressBar,c=t("../../BattleCommon"),l=t("../../../CopyModule/Managers/CopyManager"),u=cc._decorator,p=u.ccclass,f=u.property,d=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.speedUpProgress=null,e.tipsLabel=null,e}return n(e,t),e.prototype.start=function(){},e.prototype.update=function(){if(l.copyMgr().getMainPlayerCopySettings()){var t=(l.copyMgr().getMainPlayerCopySettings().speedUpTime-Date.now())/1e3;if(t<0)return this.tipsLabel.string="\\L[SMain1]",void(this.speedUpProgress.progress=1);this.tipsLabel.string=this.toTime(t),this.speedUpProgress.progress=Math.max(t/120,.08)}},e.prototype.speedUp=function(){Date.now()>l.copyMgr().getMainPlayerCopySettings().speedUpTime&&c.BattleInterface.BoostMainBattle().then(function(){return l.copyMgr().getMainPlayerCopySettings().speedUpTime=Date.now()+12e4})},e.prototype.toTime=function(t){var e=Math.floor(t/60),o=Math.floor(t%60);return(e<10?"0"+e:e)+":"+(o<10?"0"+o:o)},i([f(s)],e.prototype,"speedUpProgress",void 0),i([f(a)],e.prototype,"tipsLabel",void 0),i([p],e)}(cc.Component);o.default=d,cc._RF.pop()},{"../../../CopyModule/Managers/CopyManager":"CopyManager","../../BattleCommon":"BattleCommon"}],SpineUtils:[function(t,e,o){"use strict";cc._RF.push(e,"510dauMhU1HWrVI5b6u+niD","SpineUtils");var r,n=this&&this.__extends||(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),i=this&&this.__awaiter||function(t,e,o,r){return new(o||(o=Promise))(function(n,i){function a(t){try{c(r.next(t))}catch(e){i(e)}}function s(t){try{c(r.throw(t))}catch(e){i(e)}}function c(t){var e;t.done?n(t.value):(e=t.value,e instanceof o?e:new o(function(t){t(e)})).then(a,s)}c((r=r.apply(t,e||[])).next())})},a=this&&this.__generator||function(t,e){var o,r,n,i,a={label:0,sent:function(){if(1&n[0])throw n[1];return n[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(t){return function(e){return c([t,e])}}function c(i){if(o)throw new TypeError("Generator is already executing.");for(;a;)try{if(o=1,r&&(n=2&i[0]?r.return:i[0]?r.throw||((n=r.return)&&n.call(r),0):r.next)&&!(n=n.call(r,i[1])).done)return n;switch(r=0,n&&(i=[2&i[0],n.value]),i[0]){case 0:case 1:n=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,r=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(n=(n=a.trys).length>0&&n[n.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!n||i[1]>n[0]&&i[1]<n[3])){a.label=i[1];break}if(6===i[0]&&a.label<n[1]){a.label=n[1],n=i;break}if(n&&a.label<n[2]){a.label=n[2],a.ops.push(i);break}n[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(s){i=[6,s],r=0}finally{o=n=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}},s=this&&this.__spreadArrays||function(){for(var t=0,e=0,o=arguments.length;e<o;e++)t+=arguments[e].length;var r=Array(t),n=0;for(e=0;e<o;e++)for(var i=arguments[e],a=0,s=i.length;a<s;a++,n++)r[n]=i[a];return r};Object.defineProperty(o,"__esModule",{value:!0}),o.SpineUtils=o.HeroSkeleton=void 0;var c=t("../Modules/HeroModule/Data/PartType"),l=t("../Modules/HeroModule/Data/HeroType"),u=t("../Modules/HeroModule/Data/Part"),p=t("../Modules/CoreModule/Data/BaseData"),f=t("../Modules/NFTModule/Managers/NFTManager"),d=t("./PromiseUtils"),h=t("../Modules/CoreModule/Managers/ConfigManager"),y=t("../Modules/HeroModule/Configs/PartConfig"),g=t("../Modules/HeroModule/Managers/EditorManager"),v=sp.spine.Slot,b=sp.spine.SlotData,m=sp.spine.Bone,_=sp.spine.RegionAttachment,P=cc.Vec2,M=m.prototype.updateWorldTransformWith;m.prototype.updateWorldTransformWith=function(t,e,o,r,n,i,a){M.call(this,t,e,o,r,n,i,a),this.worldX+=this.offsetX||0,this.worldY+=this.offsetY||0};var C=function(t){function e(e,o,r){void 0===r&&(r=0);var n=t.call(this)||this;return n._partIds=[],n.drawing=!1,n.sk=e,n.tmpSk=o,n.setHeroTypeId(r),n}return n(e,t),Object.defineProperty(e.prototype,"skeleton",{get:function(){return this.sk._skeleton},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"tmpSkeleton",{get:function(){return this.tmpSk._skeleton},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"heroType",{get:function(){return l.heroTypeRepo().getById(this._heroTypeId)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"heroTypeId",{get:function(){return this._heroTypeId},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"partIds",{get:function(){return this._partIds},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"nftPartIds",{get:function(){return this._partIds.map(function(t){return t+f.PartIdOffset})},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"parts",{get:function(){return this.partIds.map(function(t){return u.partRepo().getById(t)})},enumerable:!1,configurable:!0}),e.prototype.setHeroTypeId=function(t){this._heroTypeId=t,this.removeExclusionParts(),this.sk.skeletonData=this.heroType.defaultSkeleton,this.removeNotExistParts(),this.adjustDrawOrder(),this.refresh().then()},e.prototype.addPart=function(t,e){if(void 0===e&&(e=!1),t&&!t.partType.isBackground){var o=this.parts.findIndex(function(e){return e.partTypeId==t.partTypeId});-1==o?this._partIds.push(t.id):this._partIds[o]=t.id,e||this.removeExclusionParts(t)}},e.prototype.removePart=function(t,e){var o=this;if(void 0===e&&(e=!1),t)if(e||t.partType.optional){var r=this.parts.findIndex(function(e){return e.partTypeId==t.partTypeId});this._partIds.splice(r,1),t.slotNames.forEach(function(t){var e,r;return null===(r=null===(e=o.skeleton)||void 0===e?void 0:e.findSlot(t))||void 0===r?void 0:r.setAttachment(null)})}else this.addPart(u.partRepo().getByPartTypeId(t.partTypeId))},e.prototype.findPart=function(t){var e="number"==typeof t?t:t.id;return this.parts.find(function(t){return t.partTypeId==e})},e.prototype.removeNotExistParts=function(){var t=this;c.partTypeRepo().find().forEach(function(e){if(e.special!=c.SpecialPartType.Background&&!t.parts.find(function(t){return t.partType==e})){var o=u.partRepo().find({partTypeId:e.id})[0];t.addPart(o,!0),t.removePart(o)}})},e.prototype.adjustDrawOrder=function(){var t,e=h.configMgr().config(y.default).slotOrders;null===(t=this.skeleton)||void 0===t||t.drawOrder.sort(function(t,o){return e[t.data.name]-e[o.data.name]})},e.prototype.calcScale=function(t){var e=t.heroType,o=this.heroType,r=t.partType,n=r.baseTypeId,i=o.scale/e.scale;if(-1==n)i*=g.editorMgr().getPHtScale(r.id,o.id,e.id);else{var a=r.basePartType,s=this.findPart(a),c=t.heroTypeId,l=null==s?void 0:s.heroTypeId;i*=g.editorMgr().getPHtScale(r.id,l,c)*g.editorMgr().getPtBptScale(t.oriId,null==s?void 0:s.oriId)}return i},e.prototype.calcOffset=function(t){var e=t.partType;if(-1==e.baseTypeId)return[0,0];var o=e.basePartType,r=this.findPart(o);return g.editorMgr().getPtBptOffset(t.oriId,null==r?void 0:r.oriId)},e.prototype.calcHidden=function(t){var e=t.partType;if(-1==e.baseTypeId)return[];var o=e.basePartType,r=this.findPart(o);return g.editorMgr().getPtBptHidden(t.oriId,null==r?void 0:r.oriId)},e.prototype.calcClothes6=function(t){var e=this.findPart(c.partTypeRepo().head);return g.editorMgr().getClothes6Problem(t.oriId,null==e?void 0:e.oriId)},e.prototype.isClothes6=function(t){return"clothes_6"==t||"clothes_1"==t},e.prototype.removeExclusionParts=function(t){var e=this;if(void 0===t)for(var o=0,r=c.partTypeRepo().rootPartTypes().map(function(t){return e.findPart(t)});o<r.length;o++){var n=r[o];n&&this.removeExclusionParts(n)}else for(var i=0,a=t.partType.subPartTypes;i<a.length;i++){var s=a[i],l=this.findPart(s);l&&(0==this.calcScale(l)?this.removePart(l):this.removeExclusionParts(l))}},e.prototype.findBone=function(t,e){return void 0===e&&(e=!1),t?"string"==typeof t?(e?this.tmpSk:this.sk).findBone(t):this.findBone(t.data.name,e):null},e.prototype.findAllChildren=function(t,e){void 0===e&&(e=!1);var o=this.findBone(t,e);if(!o)return[];for(var r=s([o],o.children),n=0,i=o.children;n<i.length;n++){var a=i[n];r=r.concat(this.findAllChildren(a,e))}return r},e.prototype.applyBone=function(t,e,o){var r,n=this;void 0===o&&(o=!0),"boolean"==typeof e?o=e:r=e;var i=r||this.findBone(t);if(i)return o&&w.assignBone(t,i),t.children.forEach(function(t){return n.applyBone(t)}),i},e.prototype.transformBone=function(t,e,o){void 0===e&&(e=1),void 0===o&&(o=[0,0]);var r=this.findBone(t);r&&(r.scaleX=r.data.scaleX*e,r.scaleY=r.data.scaleY*e,r.offsetX=o[0],r.offsetY=o[1])},e.prototype.findSlot=function(t,e){return void 0===e&&(e=!1),t?"string"==typeof t?(e?this.tmpSk:this.sk).findSlot(t):this.findSlot(t.data.name,e):null},e.prototype.applySlot=function(t,e){var o=e||this.findSlot(t);return o&&w.assignSlot(t,o),o},e.prototype.slotTouchTest=function(t,e){var o=this.findSlot(t);if(o){var r=o.bone.worldToLocal({x:e.x,y:e.y}),n=o.getAttachment();if(n){var i={x:r.x-n.x,y:r.y-n.y};console.log("test",t,{x:r.x,y:r.y},i,o,n);var a=Math.sqrt(i.x*i.x+i.y*i.y),s=(Math.atan(i.y/i.x)/Math.PI*180-n.rotation)/180*Math.PI,c=a*Math.cos(s),l=a*Math.sin(s),u=n.width*n.scaleX,p=n.height*n.scaleY;return c>=-u/2&&c<=u/2&&l>=-p/2&&l<=p/2?o:null}}},e.prototype.setAttachment=function(t,e){var o=t.getAttachment(),r=w.changeTexture2DToRegion(e.getTexture());o||t.setAttachment(o=new _(e.name)),o.region=r,o.setRegion(r),o.updateOffset()},e.prototype.refresh=function(t){return void 0===t&&(t=!1),i(this,void 0,void 0,function(){var e=this;return a(this,function(o){switch(o.label){case 0:return[4,d.PromiseUtils.waitFor(function(){return!e.drawing})];case 1:return o.sent(),this.drawing=!0,[4,this.drawParts(t)];case 2:return o.sent(),this.drawing=!1,[2]}})})},e.prototype.drawParts=function(t,e){return void 0===t&&(t=!1),void 0===e&&(e=!1),i(this,void 0,void 0,function(){var o,r,n,i,s,l,u,p,f,d,h,y,g=this;return a(this,function(a){switch(a.label){case 0:if("boolean"==typeof t)return[2,this.drawParts(null,t)];if(null!=(o=t))return[3,6];r=c.partTypeRepo().rootPartTypes(),n=r.map(function(t){return g.findPart(t)}),i=0,s=n,a.label=1;case 1:return i<s.length?(l=s[i])?[4,this.drawParts(l,e)]:[3,3]:[3,5];case 2:a.sent(),a.label=3;case 3:a.label=4;case 4:return i++,[3,1];case 5:return[3,11];case 6:return u=o.partType,[4,this.drawPart(o,e)];case 7:a.sent(),p=u.subPartTypes,f=0,d=p,a.label=8;case 8:return f<d.length?(h=d[f],(y=this.findPart(h))?[4,this.drawParts(y,e)]:[3,10]):[3,11];case 9:a.sent(),a.label=10;case 10:return f++,[3,8];case 11:return[2]}})})},e.prototype.drawPart=function(t,e){return void 0===e&&(e=!1),i(this,void 0,void 0,function(){var o,r,n,i,s,l,u,p,f,d,h,y,g,v,b,m,_,P,M,C,w=this;return a(this,function(a){switch(a.label){case 0:return o=this.tmpSk,[4,t.skeleton()];case 1:return o.skeletonData=a.sent(),r=this.calcScale(t),n=this.calcOffset(t),i=this.calcHidden(t),console.log("hidden",i),t.partType.special==c.SpecialPartType.Body&&this.applyBone(this.findBone("center",!0),!1),s=[],(l=t.boneNames).forEach(function(t){if(!s.includes(t)){var e=w.findAllChildren(t,!0);e.forEach(function(t){l.includes(t.data.name)&&(s.push(t.data.name),w.transformBone(t))});var o=e[0];w.applyBone(o,!1),w.transformBone(o,r,n)}}),(l=t.slotNames).forEach(function(t){var o=w.applySlot(w.findSlot(t,!0));i.includes(t)?o.color.a=o.data.color.a=e?.5:0:o&&(o.color.a=o.data.color.a=1)}),[4,t.allPictures()];case 2:return u=a.sent(),l.forEach(function(t){var e=w.findSlot(t),o=u.get(t);o&&w.setAttachment(e,o)}),t.partType.isClothes?(p="clothes_6",f="clothes_1",d=!!this.findSlot(p).getAttachment(),h=!!this.findSlot(f).getAttachment(),!d&&!h||d&&h||(y=this.calcClothes6(t),g=this.findBone(p,!0),v=this.findBone(f,!0),b=this.findSlot(p,!0),m=this.findSlot(f,!0),_=this.findBone(p),P=this.findBone(f),M=this.findSlot(p),C=this.findSlot(f),this.applyBone(g,y?P:_,!1),this.applyBone(v,y?_:P,!1),this.applySlot(b,y?C:M),this.applySlot(m,y?M:C)),[2]):[2]}})})},e}(p.BaseData);o.HeroSkeleton=C;var w=function(){function t(){}return t.getSlotNames=function(t){var e=[],o=h.configMgr().config(y.default),r=o.slotOrders,n=o.slotNameMap;return Object.keys(r).map(function(t){return[t,n[t]||t]}).forEach(function(o){t.name==o[1].split("_")[0]&&e.push(o[0])}),e},t.getSlotName=function(t,e){return void 0===e&&(e=0),t.name+"_"+e},t.assignSlot=function(t,e){var o;return e&&t!=e?(e.data=Object.assign({},e.data),["color","darkColor","blendMode"].forEach(function(o){return e.data[o]=t.data[o]}),e.setToSetupPose(),e.setAttachment(null===(o=t.getAttachment())||void 0===o?void 0:o.copy()),e):e},t.judgeDrawOrder=function(t,e){var o=e.drawOrder,r=e.findSlot(t.data.name);if(r)return o.indexOf(r);for(var n=t.getSkeleton().drawOrder,i=n.indexOf(t),a=0,s=o.length-1,c=i-1;c>=0;--c){var l=n[c].data.name;(u=e.findSlot(l))&&(a=Math.max(a,o.indexOf(u)))}for(c=i+1;c<n.length;++c){var u;l=n[c].data.name,(u=e.findSlot(l))&&(s=Math.min(s,o.indexOf(u)))}return Math.ceil((a+s)/2)},t.copySlotToSkeleton=function(t,e,o){void 0===o&&(o=this.judgeDrawOrder(t,e));var r=e.findSlot(t.data.name);if(!r){var n=e.findBone(t.bone.data.name);if(!n)return null;r=this.createSlot(e,n,t.data.name,o)}return r},t.createSlot=function(t,e,o,r){var n=t.slots.length,i=new b(n,o,e.data),a=new v(i,e);return void 0===r?t.drawOrder.push(a):t.drawOrder.splice(r,0,a),t.slots.push(a),a},t.copySlot=function(t,e,o){return this.createSlot(t,e.bone,o,t.drawOrder.indexOf(e)+1)},t.scaleAttachment=function(t,e,o,r){e.scaleX=o,e.scaleY=r,this.updateAttachmentOffset(t,e)},t.updateAttachmentOffset=function(t,e){var o=e.width/e.region.originalWidth*e.scaleX,r=e.height/e.region.originalHeight*e.scaleY,n=-e.width/2*e.scaleX+e.region.offsetX*o,i=-e.height/2*e.scaleY+e.region.offsetY*r,a=n+e.region.width*o,s=i+e.region.height*r,c=e.rotation*Math.PI/180,l=Math.cos(c),u=Math.sin(c),p=e.scaleX*e.x,f=e.scaleY*e.y,d=n*l+p,h=n*u,y=i*l+f,g=i*u,v=a*l+p,b=a*u,m=s*l+f,P=s*u,M=e.offset;M[_.OX1]=d-g,M[_.OY1]=y+h,M[_.OX2]=d-P,M[_.OY2]=m+h,M[_.OX3]=v-P,M[_.OY3]=m+b,M[_.OX4]=v-g,M[_.OY4]=y+b},t.getBoneNames=function(t){var e=[],o=h.configMgr().config(y.default),r=o.slotOrders,n=o.slotNameMap;return Object.keys(r).map(function(t){return[t,n[t]||t]}).forEach(function(o){t.name==o[1].split("_")[0]&&e.push(o[0])}),e},t.getBoneName=function(t,e){return void 0===e&&(e=0),t.name+"_"+e},t.boneDataWorldPos=function(t){t instanceof m&&(t=t.data);var e=P.ZERO.clone();do{e.x+=t.x,e.y+=t.y,t=t.parent}while(t.parent);return e},t.skeleton=function(t){return t._skeleton},t.findBoneParent=function(t,e){var o=t.parent;if(!o)return null;var r=e.findBone(o.data.name);return r?{bone:t,parent:o,sParent:r}:this.findBoneParent(o,e)},t.assignBone=function(t,e){return e&&t!=e?(e.data=Object.assign({},e.data),["x","y","length","rotation","scaleX","scaleY","shearX","shearY","color","transformMode","skinRequired"].forEach(function(o){return e.data[o]=t.data[o]}),e.setToSetupPose(),e):e},t.copyBoneToSkeleton=function(t,e){var o=e.findBone(t.data.name);if(o)return this.replaceBone(t,o,!1);var r=this.findBoneParent(t,e);return r?this.copyBone(r.bone,r.sParent):void 0},t.copyBone=function(t,e){var o=this,r=e.skeleton,n=new m(t.data,r,e);return t.children.forEach(function(t){return o.copyBone(t,n)}),e.children.push(n),r.bones.push(n),r.sortBone(n),n},t.replaceBone=function(t,e,o){var r=this;if(void 0===o&&(o=!0),!e.parent)throw"\u65e0\u6cd5\u66ff\u6362\u6839\u9aa8\u9abc";o&&this.assignBone(t,e),e.active=!0,e.children.forEach(function(t){return t.active=!1}),t.children.forEach(function(t){var o=t.data.name,n=e.children.find(function(t){return t.data.name==o});n?r.replaceBone(t,n):r.copyBone(t,e)})},t.addPart=function(t,e,o,r){var n=this,i=r.heroType;t.scale,i.scale,r.slotNames.forEach(function(t){var r,i=o.findSlot(t),a=e.findSlot(t);if(a)r=a.bone;else{if(!(r=e.findBone(i.bone.data.name)))return;a=n.createSlot(e,r,t)}var s=i.getAttachment().copy();a.setAttachment(s)})},t.removePart=function(t,e){e.slotNames.forEach(function(e){var o;return null===(o=t.findSlot(e))||void 0===o?void 0:o.setAttachment(null)})},t.changeTexture2DToRegion=function(t){var e=new sp.SkeletonTexture;e.setRealTexture(t);var o=new sp.spine.TextureAtlasPage;o.name=t.name,o.uWrap=sp.spine.TextureWrap.ClampToEdge,o.vWrap=sp.spine.TextureWrap.ClampToEdge,o.texture=e,o.texture.setWraps(o.uWrap,o.vWrap),o.width=t.width,o.height=t.height;var r=new sp.spine.TextureAtlasRegion;return r.page=o,r.width=t.width,r.height=t.height,r.originalWidth=t.width,r.originalHeight=t.height,r.rotate=!1,r.u=0,r.v=0,r.u2=1,r.v2=1,r.texture=e,r},t}();o.SpineUtils=w,cc._RF.pop()},{"../Modules/CoreModule/Data/BaseData":"BaseData","../Modules/CoreModule/Managers/ConfigManager":"ConfigManager","../Modules/HeroModule/Configs/PartConfig":"PartConfig","../Modules/HeroModule/Data/HeroType":"HeroType","../Modules/HeroModule/Data/Part":"Part","../Modules/HeroModule/Data/PartType":"PartType","../Modules/HeroModule/Managers/EditorManager":"EditorManager","../Modules/NFTModule/Managers/NFTManager":"NFTManager","./PromiseUtils":"PromiseUtils"}],StageProgressController:[function(t,e,o){"use strict";cc._RF.push(e,"753b1wncKZCJoPSj7Xi37f3","StageProgressController");var r,n=this&&this.__extends||(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),i=this&&this.__decorate||function(t,e,o,r){var n,i=arguments.length,a=i<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,o):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,o,r);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(a=(i<3?n(a):i>3?n(e,o,a):n(e,o))||a);return i>3&&a&&Object.defineProperty(e,o,a),a};Object.defineProperty(o,"__esModule",{value:!0});var a=cc.Label,s=cc.Animation,c=cc.Node,l=cc._decorator,u=l.ccclass,p=l.property,f=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.animation=null,e.value=null,e.enemies=[],e.speed=2.5,e.stageIndex=1,e.enemyIndex=0,e.isCurrent=!1,e.position=2,e}return n(e,t),e.prototype.start=function(){},e.prototype.init=function(t,e){void 0===e&&(e=2),this.stageIndex=t,this.value.string=this.stageIndex+"",this.position=e,this.node.x=80*e,this.node.y=0},e.prototype.update=function(t){this.updateNode(t),this.updateAnimation(),this.updateEnemies()},e.prototype.updateNode=function(t){this.node.x>80*this.position?this.node.x=Math.max(this.node.x-80*t*this.speed,80*this.position):this.node.x=Math.min(this.node.x+80*t*this.speed,80*this.position);var e=Math.abs(this.node.x);this.node.scale=1-3*e/1600,this.node.opacity=255-255*Math.pow(e/160,2)},e.prototype.updateAnimation=function(){Math.abs(this.node.x)<=32?this.isCurrent||(this.animation.play("stageEnter",0),this.isCurrent=!0):this.isCurrent&&(this.animation.play("stageLeave",0),this.isCurrent=!1)},e.prototype.updateEnemies=function(){var t=this;this.enemies.forEach(function(e,o){return e.active=o<t.enemyIndex})},e.prototype.nextStage=function(){this.position--,this.position<-2&&0==this.node.opacity&&this.node.destroy()},e.prototype.lastStage=function(){this.position++,this.position>2&&0==this.node.opacity&&this.node.destroy()},i([p(s)],e.prototype,"animation",void 0),i([p(a)],e.prototype,"value",void 0),i([p([c])],e.prototype,"enemies",void 0),i([p(Number)],e.prototype,"speed",void 0),i([u],e)}(cc.Component);o.default=f,cc._RF.pop()},{}],StarUpWindowDisplay:[function(t,e,o){"use strict";cc._RF.push(e,"78b56TlaBZIB5L/N8+3HpWt","StarUpWindowDisplay");var r,n=this&&this.__extends||(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),i=this&&this.__decorate||function(t,e,o,r){var n,i=arguments.length,a=i<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,o):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,o,r);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(a=(i<3?n(a):i>3?n(e,o,a):n(e,o))||a);return i>3&&a&&Object.defineProperty(e,o,a),a};Object.defineProperty(o,"__esModule",{value:!0});var a=t("../HeroInfoDisplay"),s=t("../../../../../Utils/NumberUtils"),c=t("../../../../PlayerModule/Managers/PlayerManager"),l=t("../../../../EconomicModule/Data/PlayerMoney"),u=cc.Sprite,p=cc.SpriteFrame,f=cc.Node,d=cc.Label,h=t("../../../../HeroModule/Managers/HeroManager"),y=cc.Button,g=t("../../../../../Scenes/BattleScene"),v=cc._decorator,b=v.ccclass,m=v.property,_=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.heroInfo=null,e.currentStarSprites=[],e.nextStarSprites=[],e.tipsValue=null,e.starPictures=[],e.skillPictureNodes=[],e.skillLevelNodes=[],e.fragmentLabel=null,e.starUpNode=null,e.starUpSprite=null,e.starUpButton=null,e.upgradePictures=[],e.cultivateController=null,e}return n(e,t),e.prototype.start=function(){this.cultivateController=g.battleScene().cultivateWindow,this.starUpSprite=this.starUpNode.getComponent(u),this.starUpButton=this.starUpNode.getComponent(y)},e.prototype.update=function(){this.cultivateController.refreshHero&&(this.heroInfo.refresh(),this.updateLabels(),this.updatePictures(),this.cultivateController.refreshHero=!1)},e.prototype.updateLabels=function(){var t=this.cultivateController.currentHero;if(t){this.tipsValue.string=20*t.star.level+"%";var e=c.playerMgr().getPlayerData(l.PlayerMoney).diamond;if(5!=t.star.level){var o=t.star.costs().diamond.value;this.fragmentLabel.string=e.toString()+"/"+o.toString()}else this.fragmentLabel.string=e.toString()+"/0"}},e.prototype.updatePictures=function(){var t=this,e=this.cultivateController.currentHero;if(e){this.currentStarSprites.forEach(function(o,r){o.spriteFrame=t.starPictures[r<e.star.level?1:0]}),this.nextStarSprites.forEach(function(o,r){o.spriteFrame=t.starPictures[r<e.star.level+1?1:0]}),this.skillLevelNodes.forEach(function(t,o){t.active=o>=e.star.level}),this.skillPictureNodes.forEach(function(t,o){t.active=o>=e.star.level});var o=e.star.conditions().judge();this.starUpButton.interactable=o,this.starUpSprite.spriteFrame=this.upgradePictures[o?0:1]}},e.prototype.onEnable=function(){this.heroInfo.node.active=!0,this.heroInfo.refresh()},e.prototype.onHeroChange=function(){this.cultivateController.refreshHero=!0},e.prototype.starUpBtn=function(){var t=this;h.heroMgr().starUp(this.cultivateController.currentHero).then(function(){t.onHeroChange(),t.heroInfo.playAnimation("effectStarUp")})},i([m(a.default)],e.prototype,"heroInfo",void 0),i([m([u])],e.prototype,"currentStarSprites",void 0),i([m([u])],e.prototype,"nextStarSprites",void 0),i([m(d)],e.prototype,"tipsValue",void 0),i([m([p])],e.prototype,"starPictures",void 0),i([m([f])],e.prototype,"skillPictureNodes",void 0),i([m([f])],e.prototype,"skillLevelNodes",void 0),i([m(d)],e.prototype,"fragmentLabel",void 0),i([m(f)],e.prototype,"starUpNode",void 0),i([m([p])],e.prototype,"upgradePictures",void 0),i([s.autoUnitConvert],e.prototype,"updateLabels",null),i([b],e)}(cc.Component);o.default=_,cc._RF.pop()},{"../../../../../Scenes/BattleScene":"BattleScene","../../../../../Utils/NumberUtils":"NumberUtils","../../../../EconomicModule/Data/PlayerMoney":"PlayerMoney","../../../../HeroModule/Managers/HeroManager":"HeroManager","../../../../PlayerModule/Managers/PlayerManager":"PlayerManager","../HeroInfoDisplay":"HeroInfoDisplay"}],StaticData:[function(t,e,o){"use strict";cc._RF.push(e,"697d0mK7GBBpJwZrPJYmaY5","StaticData");var r,n=this&&this.__extends||(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),i=this&&this.__decorate||function(t,e,o,r){var n,i=arguments.length,a=i<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,o):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,o,r);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(a=(i<3?n(a):i>3?n(e,o,a):n(e,o))||a);return i>3&&a&&Object.defineProperty(e,o,a),a};Object.defineProperty(o,"__esModule",{value:!0}),o.StaticData=o.data=void 0;var a=t("./BaseData"),s=t("../Managers/DataManager");o.data=function(t){return function(e){s.dataMgr().registerData(e,t).then()}};var c=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.id=-1,e.displayName=null,e}return n(e,t),Object.defineProperty(e.prototype,"dataId",{get:function(){return this.id},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"languageKey",{get:function(){return s.dataMgr().getDataName(this.constructor)},enumerable:!1,configurable:!0}),e.prototype.getDisplayName=function(){return this.displayName||"\\L["+(this.languageKey+this.id)+"]"},i([a.field,a.dataPK],e.prototype,"id",void 0),i([a.field(String)],e.prototype,"displayName",void 0),e}(a.GameData);o.StaticData=c,cc._RF.pop()},{"../Managers/DataManager":"DataManager","./BaseData":"BaseData"}],Status:[function(t,e){"use strict";cc._RF.push(e,"63b4ayMSBhB4oggL7Ocsyr7","Status"),cc._RF.pop()},{}],SummonWindowDisplay:[function(t,e,o){"use strict";cc._RF.push(e,"89c07r523VEBL2MY1Cz4ttl","SummonWindowDisplay");var r,n=this&&this.__extends||(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),i=this&&this.__decorate||function(t,e,o,r){var n,i=arguments.length,a=i<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,o):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,o,r);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(a=(i<3?n(a):i>3?n(e,o,a):n(e,o))||a);return i>3&&a&&Object.defineProperty(e,o,a),a};Object.defineProperty(o,"__esModule",{value:!0});var a=t("../HeroInfoDisplay"),s=cc.Label,c=t("../../../../../Scenes/BattleScene"),l=cc.Slider,u=cc._decorator,p=u.ccclass,f=u.property,d=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.heroInfo=null,e.stablePrice=null,e.USTDValues=[],e.USTDBalance=null,e.HCTValues=[],e.HCTBalance=null,e.pricePercent=null,e.priceSlider=null,e.cultivateController=null,e}return n(e,t),e.prototype.start=function(){this.cultivateController=c.battleScene().cultivateWindow},e.prototype.update=function(){this.updateLabels(),this.updatePictures()},e.prototype.updateLabels=function(){var t=this.priceSlider.progress;this.USTDValues.forEach(function(e){return e.string=Math.floor(20*t).toString()}),this.HCTValues.forEach(function(e){return e.string=Math.floor(400*t).toString()}),this.pricePercent.string=Math.floor(100*t)+"%"},e.prototype.updatePictures=function(){},e.prototype.onEnable=function(){this.heroInfo.node.active=!1},e.prototype.summonBtn=function(){},i([f(a.default)],e.prototype,"heroInfo",void 0),i([f(s)],e.prototype,"stablePrice",void 0),i([f(s)],e.prototype,"USTDValues",void 0),i([f(s)],e.prototype,"USTDBalance",void 0),i([f(s)],e.prototype,"HCTValues",void 0),i([f(s)],e.prototype,"HCTBalance",void 0),i([f(s)],e.prototype,"pricePercent",void 0),i([f(l)],e.prototype,"priceSlider",void 0),i([p],e)}(cc.Component);o.default=d,cc._RF.pop()},{"../../../../../Scenes/BattleScene":"BattleScene","../HeroInfoDisplay":"HeroInfoDisplay"}],TestAutoProfit:[function(t,e,o){"use strict";cc._RF.push(e,"491a93YS2pLpIyxEHCLo7ev","TestAutoProfit");var r,n=this&&this.__extends||(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),i=this&&this.__decorate||function(t,e,o,r){var n,i=arguments.length,a=i<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,o):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,o,r);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(a=(i<3?n(a):i>3?n(e,o,a):n(e,o))||a);return i>3&&a&&Object.defineProperty(e,o,a),a};Object.defineProperty(o,"__esModule",{value:!0});var a=t("../Modules/EconomicModule/Data/PlayerJob"),s=t("../Modules/PlayerModule/Managers/PlayerManager"),c=cc._decorator,l=c.ccclass,u=(c.property,function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.start=function(){},e.prototype.addTime=function(){s.playerMgr().getPlayerData(a.PlayerJob).autoProfitTime=15e3+Math.max(Date.now(),s.playerMgr().getPlayerData(a.PlayerJob).autoProfitTime)},i([l],e)}(cc.Component));o.default=u,cc._RF.pop()},{"../Modules/EconomicModule/Data/PlayerJob":"PlayerJob","../Modules/PlayerModule/Managers/PlayerManager":"PlayerManager"}],TestGetHero:[function(t,e,o){"use strict";cc._RF.push(e,"ba897u5B/RFEYJ8gfSHNK+D","TestGetHero");var r,n=this&&this.__extends||(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),i=this&&this.__decorate||function(t,e,o,r){var n,i=arguments.length,a=i<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,o):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,o,r);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(a=(i<3?n(a):i>3?n(e,o,a):n(e,o))||a);return i>3&&a&&Object.defineProperty(e,o,a),a},a=this&&this.__awaiter||function(t,e,o,r){return new(o||(o=Promise))(function(n,i){function a(t){try{c(r.next(t))}catch(e){i(e)}}function s(t){try{c(r.throw(t))}catch(e){i(e)}}function c(t){var e;t.done?n(t.value):(e=t.value,e instanceof o?e:new o(function(t){t(e)})).then(a,s)}c((r=r.apply(t,e||[])).next())})},s=this&&this.__generator||function(t,e){var o,r,n,i,a={label:0,sent:function(){if(1&n[0])throw n[1];return n[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(t){return function(e){return c([t,e])}}function c(i){if(o)throw new TypeError("Generator is already executing.");for(;a;)try{if(o=1,r&&(n=2&i[0]?r.return:i[0]?r.throw||((n=r.return)&&n.call(r),0):r.next)&&!(n=n.call(r,i[1])).done)return n;switch(r=0,n&&(i=[2&i[0],n.value]),i[0]){case 0:case 1:n=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,r=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(n=(n=a.trys).length>0&&n[n.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!n||i[1]>n[0]&&i[1]<n[3])){a.label=i[1];break}if(6===i[0]&&a.label<n[1]){a.label=n[1],n=i;break}if(n&&a.label<n[2]){a.label=n[2],a.ops.push(i);break}n[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(s){i=[6,s],r=0}finally{o=n=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}};Object.defineProperty(o,"__esModule",{value:!0});var c=t("../Modules/BattleModule/Components/BattleDisplay"),l=cc.Prefab,u=cc._decorator,p=u.ccclass,f=u.property,d=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.bd=null,e.hit=null,e.shouldUpdate=!1,e}return n(e,t),e.prototype.getOne=function(){console.log("One Hero:",h.heroMgr().getOneFromServer("140"))},e.prototype.getList=function(){console.log("Hero List:",h.heroMgr().getListFromServer())},e.prototype.getCount=function(){console.log("Hero Count",h.heroMgr().getCountFromServer())},e.prototype.trySynchronize=function(){h.heroMgr().synchronizeAllHeroes().then()},e.prototype.testBattle=function(){return a(this,void 0,void 0,function(){var t;return s(this,function(e){switch(e.label){case 0:return[4,h.heroMgr().getOneFromServer("99")];case 1:return e.sent(),[4,h.heroMgr().getOneFromServer("118")];case 2:return e.sent(),[4,h.heroMgr().getOneFromServer("121")];case 3:return e.sent(),[4,y.battleMgr().startMainBattle()];case 4:return t=e.sent(),this.bd.setItem(t),[2]}})})},e.prototype.testCopy=function(){return a(this,void 0,void 0,function(){var t;return s(this,function(e){switch(e.label){case 0:return[4,h.heroMgr().getOneFromServer("121")];case 1:return e.sent(),[4,y.battleMgr().startCopy()];case 2:return t=e.sent(),this.bd.setItem(t),[2]}})})},e.prototype.testHit=function(){var t=cc.instantiate(this.hit);t.parent=this.node,t.getComponent(v.default).setRange(200,200)},e.prototype.update=function(){},e.prototype.testRealBattle=function(){var t=this;h.heroMgr().getListFromServer().then(function(){t.testBattle().then()})},e.prototype.testRefreshRank=function(){g.HeroInterface.RefreshAllRank().then(function(t){return console.log(t)})},i([f(c.default)],e.prototype,"bd",void 0),i([f(l)],e.prototype,"hit",void 0),i([f(Boolean)],e.prototype,"shouldUpdate",void 0),i([p],e)}(cc.Component);o.default=d;var h=t("../Modules/HeroModule/Managers/HeroManager"),y=t("../Modules/BattleModule/Managers/BattleManager"),g=t("../Modules/HeroModule/Common/HeroCommon"),v=t("../Modules/BattleModule/Components/IndependentController/HitDamage");cc._RF.pop()},{"../Modules/BattleModule/Components/BattleDisplay":"BattleDisplay","../Modules/BattleModule/Components/IndependentController/HitDamage":"HitDamage","../Modules/BattleModule/Managers/BattleManager":"BattleManager","../Modules/HeroModule/Common/HeroCommon":"HeroCommon","../Modules/HeroModule/Managers/HeroManager":"HeroManager"}],TestHeroItem:[function(t,e,o){"use strict";cc._RF.push(e,"4ab36b9IrlAKoRA12Oz1FcG","TestHeroItem");var r,n=this&&this.__extends||(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),i=this&&this.__decorate||function(t,e,o,r){var n,i=arguments.length,a=i<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,o):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,o,r);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(a=(i<3?n(a):i>3?n(e,o,a):n(e,o))||a);return i>3&&a&&Object.defineProperty(e,o,a),a};Object.defineProperty(o,"__esModule",{value:!0});var a=t("../Modules/CoreModule/Data/BaseData"),s=cc._decorator,c=s.ccclass,l=(s.property,function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.name=null,e.atk=0,e.def=0,e.mhp=0,e.level=1,e.quality=0,e.stars=1,e.scissorsType=0,e}var o;return n(e,t),o=e,e.prototype.getRealUpgrade=function(){return 1e3*this.level+2500},e.prototype.getRealAttack=function(){return this.atk*this.level},e.prototype.getRealDefense=function(){return this.def*this.level},e.prototype.getRealHealth=function(){return this.mhp*this.level},e.testData=function(){var t=new o;return t.name="Little Y",t.atk=400,t.def=120,t.mhp=15e3,t.quality=Math.floor(4*Math.random()),t.stars=Math.floor(6*Math.random()),t.scissorsType=Math.floor(3*Math.random()),t},i([a.field],e.prototype,"name",void 0),i([a.field],e.prototype,"atk",void 0),i([a.field],e.prototype,"def",void 0),i([a.field],e.prototype,"mhp",void 0),i([a.field],e.prototype,"level",void 0),i([a.field],e.prototype,"quality",void 0),i([a.field],e.prototype,"stars",void 0),i([a.field],e.prototype,"scissorsType",void 0),o=i([c],e)}(a.BaseData));o.default=l,cc._RF.pop()},{"../Modules/CoreModule/Data/BaseData":"BaseData"}],TestPlatform:[function(t,e,o){"use strict";cc._RF.push(e,"220021sXw1KjqNP0Z0MYggo","TestPlatform");var r,n=this&&this.__extends||(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),i=this&&this.__decorate||function(t,e,o,r){var n,i=arguments.length,a=i<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,o):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,o,r);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(a=(i<3?n(a):i>3?n(e,o,a):n(e,o))||a);return i>3&&a&&Object.defineProperty(e,o,a),a},a=this&&this.__awaiter||function(t,e,o,r){return new(o||(o=Promise))(function(n,i){function a(t){try{c(r.next(t))}catch(e){i(e)}}function s(t){try{c(r.throw(t))}catch(e){i(e)}}function c(t){var e;t.done?n(t.value):(e=t.value,e instanceof o?e:new o(function(t){t(e)})).then(a,s)}c((r=r.apply(t,e||[])).next())})},s=this&&this.__generator||function(t,e){var o,r,n,i,a={label:0,sent:function(){if(1&n[0])throw n[1];return n[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(t){return function(e){return c([t,e])}}function c(i){if(o)throw new TypeError("Generator is already executing.");for(;a;)try{if(o=1,r&&(n=2&i[0]?r.return:i[0]?r.throw||((n=r.return)&&n.call(r),0):r.next)&&!(n=n.call(r,i[1])).done)return n;switch(r=0,n&&(i=[2&i[0],n.value]),i[0]){case 0:case 1:n=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,r=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(n=(n=a.trys).length>0&&n[n.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!n||i[1]>n[0]&&i[1]<n[3])){a.label=i[1];break}if(6===i[0]&&a.label<n[1]){a.label=n[1],n=i;break}if(n&&a.label<n[2]){a.label=n[2],a.ops.push(i);break}n[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(s){i=[6,s],r=0}finally{o=n=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}};Object.defineProperty(o,"__esModule",{value:!0}),o.TestPlatform=void 0;var c=t("./BasePlatform"),l=t("../Utils/MathUtils"),u=function(t){function e(e){return t.call(this,e)||this}return n(e,t),e.prototype.getOpenid=function(){return a(this,void 0,Promise,function(){var t;return s(this,function(){return(t=cc.sys.localStorage.getItem("openid"))||(t="test_"+l.MathUtils.randomString(),cc.sys.localStorage.setItem("openid",t)),[2,t]})})},e.prototype.getUserInfo=function(){return a(this,void 0,Promise,function(){return s(this,function(){return[2,{}]})})},e.prototype.doShowAds=function(){return a(this,void 0,Promise,function(){return s(this,function(e){switch(e.label){case 0:return[4,t.prototype.doShowAds.call(this)];case 1:return e.sent()?[4,new Promise(function(t){alert("\u5f53\u524d\u5e73\u53f0\u4e3a\u6d4f\u89c8\u5668\uff0c\u5047\u88c5\u8fd9\u662f\u5e7f\u544a\u7a97\u53e3\u3002\u5173\u95ed\u540e\u8fc72\u79d2\u5c31\u5f53\u4f5c\u770b\u5b8c\u4e86\u5e7f\u544a"),setTimeout(function(){return t(!0)},2e3)})]:[2,!1];case 2:return[2,e.sent()]}})})},i([c.platform("test")],e)}(c.BasePlatform);o.TestPlatform=u,cc._RF.pop()},{"../Utils/MathUtils":"MathUtils","./BasePlatform":"BasePlatform"}],TestSpine:[function(t,e,o){"use strict";cc._RF.push(e,"e69a8HAYWdJb4hgW7OfICpW","TestSpine");var r,n=this&&this.__extends||(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),i=this&&this.__decorate||function(t,e,o,r){var n,i=arguments.length,a=i<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,o):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,o,r);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(a=(i<3?n(a):i>3?n(e,o,a):n(e,o))||a);return i>3&&a&&Object.defineProperty(e,o,a),a};Object.defineProperty(o,"__esModule",{value:!0});var a=sp.Skeleton,s=cc.SpriteFrame,c=cc.EditBox,l=t("../Modules/HeroModule/Common/EditorCommon"),u=cc._decorator,p=u.ccclass,f=u.property,d=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.sk=null,e.pic1=null,e.pic2=null,e.source=null,e.out=null,e}return n(e,t),e.prototype.start=function(){},e.prototype.import=function(){l.EditorInterface.ImportParts({source:this.source.string,out:this.out.string,doImport:!0})},e.prototype.onTouchStart=function(t){var e=this.sk.node.getPosition(),o=t.currentTouch.getLocation().clone().sub(e);console.log("Delta",t,o.x,o.y,this.sk,cc),this.sk._skeleton.slots.forEach(function(t){var e=t.bone.worldToLocal({x:o.x,y:o.y}),r=t.getAttachment();if(r){var n=e.x-r.x,i=e.y-r.y,a=Math.sqrt(n*n+i*i),s=(Math.atan(i/n)/Math.PI*180-r.rotation)/180*Math.PI,c=a*Math.cos(s),l=a*Math.sin(s);c>=-r.width/2&&c<=r.width/2&&l>=-r.height/2&&l<=r.height/2?t.color.a=.5:t.color.a=1}})},e.prototype.color1=function(){console.log(1),this.sk.findSlot("head_1").getAttachment().setRegion(this.CreateRegion(this.pic1.getTexture()))},e.prototype.color2=function(){console.log(2),this.sk.findSlot("head_1").getAttachment().setRegion(this.CreateRegion(this.pic2.getTexture()))},e.prototype.CreateRegion=function(t){var e=new sp.SkeletonTexture;e.setRealTexture(t);var o=new sp.spine.TextureAtlasPage;o.name=t.name,o.uWrap=sp.spine.TextureWrap.ClampToEdge,o.vWrap=sp.spine.TextureWrap.ClampToEdge,o.texture=e,o.texture.setWraps(o.uWrap,o.vWrap),o.width=t.width,o.height=t.height;var r=new sp.spine.TextureAtlasRegion;return r.page=o,r.width=t.width,r.height=t.height,r.originalWidth=t.width,r.originalHeight=t.height,r.rotate=!1,r.u=0,r.v=0,r.u2=1,r.v2=1,r.texture=e,r},i([f(a)],e.prototype,"sk",void 0),i([f(s)],e.prototype,"pic1",void 0),i([f(s)],e.prototype,"pic2",void 0),i([f(c)],e.prototype,"source",void 0),i([f(c)],e.prototype,"out",void 0),i([p],e)}(cc.Component);o.default=d,cc._RF.pop()},{"../Modules/HeroModule/Common/EditorCommon":"EditorCommon"}],Trait:[function(t,e,o){"use strict";cc._RF.push(e,"e59aaAKywxAWoprf8ky7i6r","Trait");var r,n=this&&this.__extends||(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),i=this&&this.__decorate||function(t,e,o,r){var n,i=arguments.length,a=i<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,o):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,o,r);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(a=(i<3?n(a):i>3?n(e,o,a):n(e,o))||a);return i>3&&a&&Object.defineProperty(e,o,a),a},a=this&&this.__spreadArrays||function(){for(var t=0,e=0,o=arguments.length;e<o;e++)t+=arguments[e].length;var r=Array(t),n=0;for(e=0;e<o;e++)for(var i=arguments[e],a=0,s=i.length;a<s;a++,n++)r[n]=i[a];return r};Object.defineProperty(o,"__esModule",{value:!0}),o.TraitGroup=o.Trait=o.TraitType=void 0;var s,c=t("../../CoreModule/Data/BaseData");(function(t){t.None="None",t.BonusParam="BonusParam"})(s=o.TraitType||(o.TraitType={}));var l=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.idx=0,e.value=0,e.method="add",e}return n(e,t),i([c.field(Number)],e.prototype,"idx",void 0),i([c.field(Number)],e.prototype,"value",void 0),i([c.field(String)],e.prototype,"method",void 0),e}(c.BaseData),u=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.type=s.None,e.params=[],e.levelSettings=[],e}return n(e,t),e.create=function(t,o){var r=new e;return r.type=t,r.params=o,r},e.prototype.applyLevel=function(t){var o=this.params.slice();return this.levelSettings.forEach(function(e){switch(e.method){case"add":o[e.idx]+=e.value*t;break;case"mult":o[e.idx]*=e.value*t}}),e.create(this.type,o)},i([c.field(String)],e.prototype,"type",void 0),i([c.field([Object])],e.prototype,"params",void 0),i([c.field([l])],e.prototype,"levelSettings",void 0),e}(c.BaseData);o.Trait=u;var p=function(){function t(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.traits=[],this.traits=t}return t.prototype.add=function(){for(var t,e=[],o=0;o<arguments.length;o++)e[o]=arguments[o];(t=this.traits).push.apply(t,e)},t.prototype.filter=function(e,o,r){return new(t.bind.apply(t,a([void 0],this.traits.filter(function(t){return t.type==e&&(!o||t.params[o]==r)}))))},t.prototype.sum=function(t,e){return void 0===e&&(e=0),this.traits.reduce(function(e,o){return e+o.params[t]},e)},t.prototype.prod=function(t,e){return void 0===e&&(e=1),this.traits.reduce(function(e,o){return e*o.params[t]},e)},t}();o.TraitGroup=p,cc._RF.pop()},{"../../CoreModule/Data/BaseData":"BaseData"}],TransformUtils:[function(t,e,o){"use strict";cc._RF.push(e,"3c541cvOh1GgK/M70mtzMbD","TransformUtils"),Object.defineProperty(o,"__esModule",{value:!0});var r=cc._decorator,n=(r.ccclass,r.property,function(){function t(){}return t.getWorldPosition2=function(t){return null==t.parent?t.getPosition():t.parent.convertToWorldSpaceAR(t.getPosition())},t.getWorldPosition3=function(t){return null==t.parent?t.position:t.parent.convertToWorldSpaceAR(t.position)},t.getNodePosition2=function(t,e){return null==t.parent?e:t.parent.convertToNodeSpaceAR(e)},t}());o.default=n,cc._RF.pop()},{}],TypeUtils:[function(t,e,o){"use strict";cc._RF.push(e,"3974akXtYREUqg8aTT0QfEI","TypeUtils"),Object.defineProperty(o,"__esModule",{value:!0}),o.getMetaData=void 0,o.getMetaData=function(t,e,o){var r=t[e]||(t[e]=o);if((null==r?void 0:r.type)!=t){var n=r?Object.keys(r):[];t[e]=n.reduce(function(t,e){var o=r[e];return o instanceof Array?t[e]=o.slice(0):t[e]="object"==typeof o?Object.assign({},o):o,t},{}),t[e].type=t}return t[e]},cc._RF.pop()},{}],UpgradeWindowDisplay:[function(t,e,o){"use strict";cc._RF.push(e,"616c7U3kCdKuplP/omtWVCl","UpgradeWindowDisplay");var r,n=this&&this.__extends||(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),i=this&&this.__decorate||function(t,e,o,r){var n,i=arguments.length,a=i<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,o):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,o,r);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(a=(i<3?n(a):i>3?n(e,o,a):n(e,o))||a);return i>3&&a&&Object.defineProperty(e,o,a),a};Object.defineProperty(o,"__esModule",{value:!0});var a=cc.Label,s=cc.Sprite,c=cc.SpriteFrame,l=cc.Node,u=cc.Button,p=t("../../../../PlayerModule/Managers/PlayerManager"),f=t("../../../../EconomicModule/Data/PlayerMoney"),d=t("../../../../../Utils/NumberUtils"),h=t("../HeroInfoDisplay"),y=t("../../../../HeroModule/Managers/HeroManager"),g=t("../../../../../Scenes/BattleScene"),v=cc._decorator,b=v.ccclass,m=v.property,_=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.heroInfo=null,e.contentSelectCards=[],e.selectCardsPictures=[],e.heroProperty=null,e.heroGrow=null,e.skillsNode=null,e.attackLabel=null,e.defenceLabel=null,e.healthLabel=null,e.atkSpeedLabel=null,e.criticalLabel=null,e.evasionLabel=null,e.skillNames=[],e.skillLevels=[],e.skillDescriptions=[],e.medalLabel=null,e.upgradeNode=null,e.upgradeSprite=null,e.upgradeButton=null,e.upgradePictures=[],e.cultivateController=null,e}return n(e,t),e.prototype.start=function(){this.cultivateController=g.battleScene().cultivateWindow,this.upgradeSprite=this.upgradeNode.getComponent(s),this.upgradeButton=this.upgradeNode.getComponent(u)},e.prototype.update=function(){this.cultivateController.refreshHero&&(this.heroInfo.refresh(),this.updateLabels(),this.updatePictures(),this.cultivateController.refreshHero=!1)},e.prototype.updateLabels=function(){var t=this.cultivateController.currentHero;t&&(this.attackLabel.string=t.atk.toString(),this.defenceLabel.string=t.def.toString(),this.healthLabel.string=t.mhp.toString(),this.atkSpeedLabel.string=t.spd.toString(),this.criticalLabel.string=t.cri.toString(),this.evasionLabel.string=t.eva.toString(),this.skillLevels.forEach(function(e){e.string="Lv."+t.star.level}),this.medalLabel.string=p.playerMgr().getPlayerData(f.PlayerMoney).medal.toString())},e.prototype.updatePictures=function(){var t=this.cultivateController.currentHero;if(t){var e=t.strengthen.conditions().judge();this.upgradeButton.interactable=e,this.upgradeSprite.spriteFrame=this.upgradePictures[e?0:1]}},e.prototype.onEnable=function(){this.showHeroProperty(),this.heroInfo.node.active=!0,this.heroInfo.refresh()},e.prototype.onHeroChange=function(){this.cultivateController.refreshHero=!0},e.prototype.showHeroProperty=function(){this.contentSelectCards[0].spriteFrame=this.selectCardsPictures[1],this.contentSelectCards[1].spriteFrame=this.selectCardsPictures[0],this.contentSelectCards[1].node.parent=this.node,this.contentSelectCards[0].node.parent=this.contentSelectCards[1].node,this.contentSelectCards[0].node.x=-150,this.contentSelectCards[0].node.y=0,this.contentSelectCards[1].node.x=-60,this.contentSelectCards[1].node.y=-195,this.heroGrow.active=!1,this.skillsNode.y=170},e.prototype.showHeroGrow=function(){this.contentSelectCards[0].spriteFrame=this.selectCardsPictures[0],this.contentSelectCards[1].spriteFrame=this.selectCardsPictures[1],this.contentSelectCards[0].node.parent=this.node,this.contentSelectCards[1].node.parent=this.contentSelectCards[0].node,this.contentSelectCards[0].node.x=-210,this.contentSelectCards[0].node.y=-195,this.contentSelectCards[1].node.x=150,this.contentSelectCards[1].node.y=0,this.heroGrow.active=!0,this.skillsNode.y=140},e.prototype.upgradeBtn=function(){var t=this;y.heroMgr().strengthen(this.cultivateController.currentHero).then(function(){t.onHeroChange(),t.heroInfo.playAnimation("effectUpgrade")})},i([m(h.default)],e.prototype,"heroInfo",void 0),i([m([s])],e.prototype,"contentSelectCards",void 0),i([m([c])],e.prototype,"selectCardsPictures",void 0),i([m(l)],e.prototype,"heroProperty",void 0),i([m(l)],e.prototype,"heroGrow",void 0),i([m(l)],e.prototype,"skillsNode",void 0),i([m(a)],e.prototype,"attackLabel",void 0),i([m(a)],e.prototype,"defenceLabel",void 0),i([m(a)],e.prototype,"healthLabel",void 0),i([m(a)],e.prototype,"atkSpeedLabel",void 0),i([m(a)],e.prototype,"criticalLabel",void 0),i([m(a)],e.prototype,"evasionLabel",void 0),i([m([a])],e.prototype,"skillNames",void 0),i([m([a])],e.prototype,"skillLevels",void 0),i([m([a])],e.prototype,"skillDescriptions",void 0),i([m(a)],e.prototype,"medalLabel",void 0),i([m(l)],e.prototype,"upgradeNode",void 0),i([m([c])],e.prototype,"upgradePictures",void 0),i([d.autoUnitConvert],e.prototype,"updateLabels",null),i([b],e)}(cc.Component);o.default=_,cc._RF.pop()},{"../../../../../Scenes/BattleScene":"BattleScene","../../../../../Utils/NumberUtils":"NumberUtils","../../../../EconomicModule/Data/PlayerMoney":"PlayerMoney","../../../../HeroModule/Managers/HeroManager":"HeroManager","../../../../PlayerModule/Managers/PlayerManager":"PlayerManager","../HeroInfoDisplay":"HeroInfoDisplay"}],Vec1:[function(t,e,o){"use strict";cc._RF.push(e,"534e5DcdHBDDZ2omAyfx4tO","Vec1");var r,n=this&&this.__extends||(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)});Object.defineProperty(o,"__esModule",{value:!0}),o.Vec1=void 0;var i=cc.ValueType,a=cc.misc,s=cc.EPSILON,c=0,l=function(t){function e(o){void 0===o&&(o=0);var r=t.call(this)||this;return r.mag=e.prototype.len,r.magSqr=e.prototype.lengthSqr,r.subSelf=e.prototype.subtract,r.mulSelf=e.prototype.multiplyScalar,r.divSelf=e.prototype.divide,r.scaleSelf=e.prototype.multiply,r.negSelf=e.prototype.negate,r.y=0,r.x=o&&"object"==typeof o?o.x||0:o||0,r}return n(e,t),e.prototype.sub=function(t,o){return e.subtract(o||new e,this,t)},e.prototype.mul=function(t,o){return e.multiplyScalar(o||new e,this,t)},e.prototype.div=function(t,o){return e.multiplyScalar(o||new e,this,1/t)},e.prototype.scale=function(t,o){return e.multiply(o||new e,this,t)},e.prototype.neg=function(t){return e.negate(t||new e,this)},Object.defineProperty(e,"ONE",{get:function(){return new e(1)},enumerable:!1,configurable:!0}),Object.defineProperty(e,"ZERO",{get:function(){return new e(0)},enumerable:!1,configurable:!0}),Object.defineProperty(e,"RIGHT",{get:function(){return new e(1)},enumerable:!1,configurable:!0}),e.clone=function(t){return new e(t.x)},e.copy=function(t,e){return t.x=e.x,t},e.set=function(t,e){return t.x=e,t},e.add=function(t,e,o){return t.x=e.x+o.x,t},e.subtract=function(t,e,o){return t.x=e.x-o.x,t},e.multiply=function(t,e,o){return t.x=e.x*o.x,t},e.divide=function(t,e,o){return t.x=e.x/o.x,t},e.ceil=function(t,e){return t.x=Math.ceil(e.x),t},e.floor=function(t,e){return t.x=Math.floor(e.x),t},e.min=function(t,e,o){return t.x=Math.min(e.x,o.x),t},e.max=function(t,e,o){return t.x=Math.max(e.x,o.x),t},e.round=function(t,e){return t.x=Math.round(e.x),t},e.multiplyScalar=function(t,e,o){return t.x=e.x*o,t},e.scaleAndAdd=function(t,e,o,r){return t.x=e.x+o.x*r,t},e.distance=function(t,e){return e.x-t.x},e.squaredDistance=function(t,e){return(c=e.x-t.x)*c},e.len=function(t){return t.x},e.lengthSqr=function(t){return t.x*t.x},e.negate=function(t,e){return t.x=-e.x,t},e.inverse=function(t,e){return t.x=1/e.x,t},e.inverseSafe=function(t,e){return c=e.x,Math.abs(c)<s?t.x=0:t.x=1/c,t},e.normalize=function(t){return t.x=1,t},e.dot=function(t,e){return t.x*e.x},e.lerp=function(t,e,o,r){return c=e.x,t.x=c+r*(o.x-c),t},e.random=function(t,e){return e=e||1,t.x=Math.random()*e,t},e.transformMat3=function(t,e,o){c=e.x;var r=o.m;return t.x=r[0]*c+0*r[3]+r[6],t},e.transformMat4=function(t,e,o){c=e.x;var r=o.m;return t.x=r[0]*c+0*r[4]+r[12],t},e.strictEquals=function(t,e){return t.x===e.x},e.equals=function(t,e,o){return void 0===o&&(o=s),Math.abs(t.x-e.x)<=o*Math.max(1,Math.abs(t.x),Math.abs(e.x))},e.toArray=function(t,e,o){return void 0===o&&(o=0),t[o]=e.x,t},e.fromArray=function(t,e,o){return void 0===o&&(o=0),t.x=e[o],t},e.prototype.clone=function(){return new e(this.x)},e.prototype.set=function(t){return this.x=t.x,this},e.prototype.equals=function(t){return t&&this.x===t.x},e.prototype.fuzzyEquals=function(t,e){return this.x-e<=t.x&&t.x<=this.x+e},e.prototype.toString=function(){return"("+this.x.toFixed(2)+")"},e.prototype.lerp=function(t,o,r){var n=this.x;return(r=r||new e).x=n+(t.x-n)*o,r},e.prototype.clampf=function(t,e){return this.x=a.clampf(this.x,t.x,e.x),this.y=a.clampf(this.y,t.y,e.y),this},e.prototype.add=function(t,o){return(o=o||new e).x=this.x+t.x,o.y=this.y+t.y,o},e.prototype.addSelf=function(t){return this.x+=t.x,this.y+=t.y,this},e.prototype.subtract=function(t){return this.x-=t.x,this.y-=t.y,this},e.prototype.multiplyScalar=function(t){return this.x*=t,this.y*=t,this},e.prototype.multiply=function(t){return this.x*=t.x,this.y*=t.y,this},e.prototype.divide=function(t){return this.x/=t,this.y/=t,this},e.prototype.negate=function(){return this.x=-this.x,this.y=-this.y,this},e.prototype.dot=function(t){return this.x*t.x+this.y*t.y},e.prototype.cross=function(t){return this.x*t.y-this.y*t.x},e.prototype.len=function(){return Math.sqrt(this.x*this.x+this.y*this.y)},e.prototype.lengthSqr=function(){return this.x*this.x+this.y*this.y},e.prototype.normalizeSelf=function(){var t=this.x*this.x+this.y*this.y;if(1===t)return this;if(0===t)return this;var e=1/Math.sqrt(t);return this.x*=e,this.y*=e,this},e.prototype.normalize=function(t){return(t=t||new e).x=this.x,t.y=this.y,t.normalizeSelf(),t},e.prototype.angle=function(t){var e=this.magSqr(),o=t.magSqr();if(0===e||0===o)return console.warn("Can't get angle between zero vector"),0;var r=this.dot(t)/Math.sqrt(e*o);return r=a.clampf(r,-1,1),Math.acos(r)},e.prototype.signAngle=function(t){var e=this.angle(t);return this.cross(t)<0?-e:e},e.prototype.rotate=function(t,o){return(o=o||new e).x=this.x,o.y=this.y,o.rotateSelf(t)},e.prototype.rotateSelf=function(t){var e=Math.sin(t),o=Math.cos(t),r=this.x;return this.x=o*r-e*this.y,this.y=e*r+o*this.y,this},e.prototype.project=function(t){return t.multiplyScalar(this.dot(t)/t.dot(t))},e.prototype.transformMat4=function(t,o){return o=o||new e,e.transformMat4(o,this,t),o},e.prototype.maxAxis=function(){return Math.max(this.x,this.y)},e.sub=e.subtract,e.mul=e.multiply,e.scale=e.multiplyScalar,e.mag=e.len,e.squaredMagnitude=e.lengthSqr,e.div=e.divide,e.ONE_R=e.ONE,e.ZERO_R=e.ZERO,e.RIGHT_R=e.RIGHT,e}(i);o.Vec1=l,cc._RF.pop()},{}],VideoAutoPlay:[function(t,e,o){"use strict";cc._RF.push(e,"a5bd1M6/KpNQILBdffkFHPH","VideoAutoPlay");var r,n=this&&this.__extends||(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),i=this&&this.__decorate||function(t,e,o,r){var n,i=arguments.length,a=i<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,o):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,o,r);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(a=(i<3?n(a):i>3?n(e,o,a):n(e,o))||a);return i>3&&a&&Object.defineProperty(e,o,a),a};Object.defineProperty(o,"__esModule",{value:!0});var a=cc._decorator.requireComponent,s=cc.VideoPlayer,c=cc._decorator.menu,l=cc._decorator,u=l.ccclass,p=(l.property,function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.player=null,e}return n(e,t),e.prototype.start=function(){this.player=this.getComponent(s),this.player.node.on("ready-to-play",this.play,this),this.player.node.on("completed",this.replay,this)},e.prototype.play=function(){this.player&&this.player.play()},e.prototype.replay=function(){this.player.play()},i([u,a(s),c("\u5176\u4ed6\u7ec4\u4ef6/\u89c6\u9891\u81ea\u52a8\u64ad\u653e")],e)}(cc.Component));o.default=p,cc._RF.pop()},{}],WalletController:[function(t,e,o){"use strict";cc._RF.push(e,"b3efd4ppp9DwLFwoYUOK8re","WalletController");var r,n=this&&this.__extends||(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),i=this&&this.__decorate||function(t,e,o,r){var n,i=arguments.length,a=i<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,o):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,o,r);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(a=(i<3?n(a):i>3?n(e,o,a):n(e,o))||a);return i>3&&a&&Object.defineProperty(e,o,a),a};Object.defineProperty(o,"__esModule",{value:!0});var a=t("../../../Modules/NFTModule/Managers/NFTManager"),s=cc._decorator,c=s.ccclass,l=s.property,u=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.USTD=null,e}return n(e,t),e.prototype.start=function(){var t=this;a.nftMgr().getUSTDBalance().then(function(e){t.USTD.string=e.toString()})},i([l(cc.Label)],e.prototype,"USTD",void 0),i([c],e)}(cc.Component);o.default=u,cc._RF.pop()},{"../../../Modules/NFTModule/Managers/NFTManager":"NFTManager"}],gifshot:[function(t,e,o){"use strict";cc._RF.push(e,"772521h7lFJ461w675/Ki97","gifshot"),function(t,r,n,i){var a,s,c={URL:t.URL||t.webkitURL||t.mozURL||t.msURL,getUserMedia:(s=n.getUserMedia||n.webkitGetUserMedia||n.mozGetUserMedia||n.msGetUserMedia,s?s.bind(n):s),requestAnimFrame:t.requestAnimationFrame||t.webkitRequestAnimationFrame||t.mozRequestAnimationFrame||t.oRequestAnimationFrame||t.msRequestAnimationFrame,requestTimeout:function(t,e){if(t=t||c.noop,e=e||0,!c.requestAnimFrame)return setTimeout(t,e);var o=(new Date).getTime(),r=new Object,n=c.requestAnimFrame;return r.value=n(function i(){(new Date).getTime()-o>=e?t.call():r.value=n(i)}),r},Blob:t.Blob||t.BlobBuilder||t.WebKitBlobBuilder||t.MozBlobBuilder||t.MSBlobBuilder,btoa:(a=t.btoa||function(t){for(var e="",o=0,r=t.length,n="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",i=void 0,a=void 0,s=void 0,c=void 0,l=void 0,u=void 0,p=void 0;o<r;)c=(i=t.charCodeAt(o++))>>2,l=(3&i)<<4|(a=t.charCodeAt(o++))>>4,u=(15&a)<<2|(s=t.charCodeAt(o++))>>6,p=63&s,isNaN(a)?u=p=64:isNaN(s)&&(p=64),e=e+n.charAt(c)+n.charAt(l)+n.charAt(u)+n.charAt(p);return e},a?a.bind(t):c.noop),isObject:function(t){return t&&"[object Object]"===Object.prototype.toString.call(t)},isEmptyObject:function(t){return c.isObject(t)&&!Object.keys(t).length},isArray:function(t){return t&&Array.isArray(t)},isFunction:function(t){return t&&"function"==typeof t},isElement:function(t){return t&&1===t.nodeType},isString:function(t){return"string"==typeof t||"[object String]"===Object.prototype.toString.call(t)},isSupported:{canvas:function(){var t=r.createElement("canvas");return t&&t.getContext&&t.getContext("2d")},webworkers:function(){return t.Worker},blob:function(){return c.Blob},Uint8Array:function(){return t.Uint8Array},Uint32Array:function(){return t.Uint32Array},videoCodecs:function(){var t=r.createElement("video"),e={mp4:!1,h264:!1,ogv:!1,ogg:!1,webm:!1};try{t&&t.canPlayType&&(e.mp4=""!==t.canPlayType('video/mp4; codecs="mp4v.20.8"'),e.h264=""!==(t.canPlayType('video/mp4; codecs="avc1.42E01E"')||t.canPlayType('video/mp4; codecs="avc1.42E01E, mp4a.40.2"')),e.ogv=""!==t.canPlayType('video/ogg; codecs="theora"'),e.ogg=""!==t.canPlayType('video/ogg; codecs="theora"'),e.webm=-1!==t.canPlayType('video/webm; codecs="vp8, vorbis"'))}catch(o){}return e}()},noop:function(){},each:function(t,e){var o=void 0,r=void 0;if(c.isArray(t))for(o=-1,r=t.length;++o<r&&!1!==e(o,t[o]););else if(c.isObject(t))for(o in t)if(t.hasOwnProperty(o)&&!1===e(o,t[o]))break},mergeOptions:function(t,e){if(c.isObject(t)&&c.isObject(e)&&Object.keys){var o={};return c.each(t,function(e){o[e]=t[e]}),c.each(e,function(r){var n=e[r];c.isObject(n)&&t[r]?o[r]=c.mergeOptions(t[r],n):o[r]=n}),o}},setCSSAttr:function(t,e,o){c.isElement(t)&&(c.isString(e)&&c.isString(o)?t.style[e]=o:c.isObject(e)&&c.each(e,function(e,o){t.style[e]=o}))},removeElement:function(t){c.isElement(t)&&t.parentNode&&t.parentNode.removeChild(t)},createWebWorker:function(t){if(!c.isString(t))return{};try{var e=new c.Blob([t],{type:"text/javascript"}),o=c.URL.createObjectURL(e);return{objectUrl:o,worker:new Worker(o)}}catch(r){return""+r}},getExtension:function(t){return t.substr(t.lastIndexOf(".")+1,t.length)},getFontSize:function(){var t=arguments.length>0&&arguments[0]!==i?arguments[0]:{};if(!r.body||!1===t.resizeFont)return t.fontSize;var e=t.text,o=t.gifWidth,n=parseInt(t.fontSize,10),a=parseInt(t.minFontSize,10),s=r.createElement("div"),c=r.createElement("span");for(s.setAttribute("width",o),s.appendChild(c),c.innerHTML=e,c.style.fontSize=n+"px",c.style.textIndent="-9999px",c.style.visibility="hidden",r.body.appendChild(c);c.offsetWidth>o&&n>=a;)c.style.fontSize=--n+"px";return r.body.removeChild(c),n+"px"},webWorkerError:!1},l=Object.freeze({default:c}),u={validate:function(t){t=c.isObject(t)?t:{};var e={};return c.each(u.validators,function(o,r){var n=r.errorCode;if(!t[n]&&!r.condition)return(e=r).error=!0,!1}),delete e.condition,e},isValid:function(t){return!0!==u.validate(t).error},validators:[{condition:c.isFunction(c.getUserMedia),errorCode:"getUserMedia",errorMsg:"The getUserMedia API is not supported in your browser"},{condition:c.isSupported.canvas(),errorCode:"canvas",errorMsg:"Canvas elements are not supported in your browser"},{condition:c.isSupported.webworkers(),errorCode:"webworkers",errorMsg:"The Web Workers API is not supported in your browser"},{condition:c.isFunction(c.URL),errorCode:"window.URL",errorMsg:"The window.URL API is not supported in your browser"},{condition:c.isSupported.blob(),errorCode:"window.Blob",errorMsg:"The window.Blob File API is not supported in your browser"},{condition:c.isSupported.Uint8Array(),errorCode:"window.Uint8Array",errorMsg:"The window.Uint8Array function constructor is not supported in your browser"},{condition:c.isSupported.Uint32Array(),errorCode:"window.Uint32Array",errorMsg:"The window.Uint32Array function constructor is not supported in your browser"}],messages:{videoCodecs:{errorCode:"videocodec",errorMsg:"The video codec you are trying to use is not supported in your browser"}}},p=Object.freeze({default:u}),f=function(){},d={sampleInterval:10,numWorkers:2,filter:"",gifWidth:200,gifHeight:200,interval:.1,numFrames:10,frameDuration:1,keepCameraOn:!1,images:[],video:null,webcamVideoElement:null,cameraStream:null,text:"",fontWeight:"normal",fontSize:"16px",minFontSize:"10px",resizeFont:!1,fontFamily:"sans-serif",fontColor:"#ffffff",textAlign:"center",textBaseline:"bottom",textXCoordinate:null,textYCoordinate:null,progressCallback:f,completeCallback:f,saveRenderingContexts:!1,savedRenderingContexts:[],showFrameText:!0,crossOrigin:"Anonymous",waterMark:null,waterMarkHeight:null,waterMarkWidth:null,waterMarkXCoordinate:1,waterMarkYCoordinate:1},h=Object.freeze({default:d});function y(){return u.isValid()}function g(){var t,e,o,r,n,i=256,a=499,s=491,c=487,l=503,u=3*l,p=i-1,f=4,d=100,h=16,y=1<<h,g=10,v=10,b=y>>v,m=y<<g-v,_=6,P=(i>>3)*(1<<_),M=30,C=1024,w=256,O=1<<18,S=[],j=[],D=[],R=[];function T(){for(var t=[],e=new Array(i),o=0;o<i;o++)e[n[o][3]]=o;for(var r=0,a=0;a<i;a++){var s=e[a];t[r++]=n[s][0],t[r++]=n[s][1],t[r++]=n[s][2]}return t}function B(){var t,e,o,r,a,s,c,l;for(c=0,l=0,t=0;t<i;t++){for(o=t,r=(a=n[t])[1],e=t+1;e<i;e++)(s=n[e])[1]<r&&(o=e,r=s[1]);if(s=n[o],t!=o&&(e=s[0],s[0]=a[0],a[0]=e,e=s[1],s[1]=a[1],a[1]=e,e=s[2],s[2]=a[2],a[2]=e,e=s[3],s[3]=a[3],a[3]=e),r!=c){for(S[c]=l+t>>1,e=c+1;e<r;e++)S[e]=t;c=r,l=t}}for(S[c]=l+p>>1,e=c+1;e<256;e++)S[e]=p}function I(){var n,i,p,h,y,g,v,b,m,O,S,j,D,T;for(o<u&&(r=1),t=30+(r-1)/3,j=e,D=0,T=o,O=(S=o/(3*r))/d|0,b=C,(v=(g=P)>>_)<=1&&(v=0),n=0;n<v;n++)R[n]=b*((v*v-n*n)*w/(v*v));for(m=o<u?3:o%a!=0?3*a:o%s!=0?3*s:o%c!=0?3*c:3*l,n=0;n<S;)if(x(b,i=H(p=(255&j[D+0])<<f,h=(255&j[D+1])<<f,y=(255&j[D+2])<<f),p,h,y),0!==v&&k(v,i,p,h,y),(D+=m)>=T&&(D-=o),0===O&&(O=1),++n%O==0)for(b-=b/t,(v=(g-=g/M)>>_)<=1&&(v=0),i=0;i<v;i++)R[i]=b*((v*v-i*i)*w/(v*v))}function F(){var t;for(t=0;t<i;t++)n[t][0]>>=f,n[t][1]>>=f,n[t][2]>>=f,n[t][3]=t}function k(t,e,o,r,a){var s,c,l,u,p,f,d;for((l=e-t)<-1&&(l=-1),(u=e+t)>i&&(u=i),s=e+1,c=e-1,f=1;s<u||c>l;){if(p=R[f++],s<u){d=n[s++];try{d[0]-=p*(d[0]-o)/O|0,d[1]-=p*(d[1]-r)/O|0,d[2]-=p*(d[2]-a)/O|0}catch(h){}}if(c>l){d=n[c--];try{d[0]-=p*(d[0]-o)/O|0,d[1]-=p*(d[1]-r)/O|0,d[2]-=p*(d[2]-a)/O|0}catch(h){}}}}function x(t,e,o,r,i){var a=n[e],s=t/C;a[0]-=s*(a[0]-o)|0,a[1]-=s*(a[1]-r)|0,a[2]-=s*(a[2]-i)|0}function H(t,e,o){var r,a,s,c,l,u,p,d,y,_;for(y=d=~(1<<31),p=u=-1,r=0;r<i;r++)(a=(_=n[r])[0]-t)<0&&(a=-a),(s=_[1]-e)<0&&(s=-s),a+=s,(s=_[2]-o)<0&&(s=-s),(a+=s)<d&&(d=a,u=r),(c=a-(j[r]>>h-f))<y&&(y=c,p=r),l=D[r]>>v,D[r]-=l,j[r]+=l<<g;return D[u]+=b,j[u]-=m,p}return function(t,a,s){var c,l;for(e=t,o=a,r=s,n=new Array(i),c=0;c<i;c++)n[c]=new Array(4),(l=n[c])[0]=l[1]=l[2]=(c<<f+8)/i|0,D[c]=y/i|0,j[c]=0}.apply(this,arguments),{map:function(t,e,o){var r,a,s,c,l,u,p;for(l=1e3,p=-1,a=(r=S[e])-1;r<i||a>=0;)r<i&&((s=(u=n[r])[1]-e)>=l?r=i:(r++,s<0&&(s=-s),(c=u[0]-t)<0&&(c=-c),(s+=c)<l&&((c=u[2]-o)<0&&(c=-c),(s+=c)<l&&(l=s,p=u[3])))),a>=0&&((s=e-(u=n[a])[1])>=l?a=-1:(a--,s<0&&(s=-s),(c=u[0]-t)<0&&(c=-c),(s+=c)<l&&((c=u[2]-o)<0&&(c=-c),(s+=c)<l&&(l=s,p=u[3]))));return p},process:function(){return I(),F(),B(),T()}}}function v(){try{this.onmessage=function(e){var o,r=e.data||{};r.gifshot&&(o=t.run(r),postMessage(o))}}catch(e){}var t={dataToRGB:function(t,e,o){for(var r=e*o*4,n=0,i=[];n<r;)i.push(t[n++]),i.push(t[n++]),i.push(t[n++]),n++;return i},componentizedPaletteToArray:function(t){t=t||[];for(var e=[],o=0;o<t.length;o+=3){var r=t[o],n=t[o+1],i=t[o+2];e.push(r<<16|n<<8|i)}return e},processFrameWithQuantizer:function(t,e,o,r){for(var n=this.dataToRGB(t,e,o),i=new g(n,n.length,r),a=i.process(),s=new Uint32Array(this.componentizedPaletteToArray(a)),c=e*o,l=new Uint8Array(c),u=0,p=0;p<c;p++){var f=n[u++],d=n[u++],h=n[u++];l[p]=i.map(f,d,h)}return{pixels:l,palette:s}},run:function(t){var e=t=t||{},o=e.height,r=(e.palette,e.sampleInterval),n=e.width,i=t.data;return this.processFrameWithQuantizer(i,n,o,r)}};return t}function b(t,e,o,r){var n=0,a=(r=r===i?{}:r).loop===i?null:r.loop,s=r.palette===i?null:r.palette;if(e<=0||o<=0||e>65535||o>65535)throw"Width/Height invalid.";function c(t){var e=t.length;if(e<2||e>256||e&e-1)throw"Invalid code/color length, must be power of 2 and 2 .. 256.";return e}if(t[n++]=71,t[n++]=73,t[n++]=70,t[n++]=56,t[n++]=57,t[n++]=97,t[n++]=255&e,t[n++]=e>>8&255,t[n++]=255&o,t[n++]=o>>8&255,t[n++]=0|(null!==s?128:0),t[n++]=0,t[n++]=0,null!==a){if(a<0||a>65535)throw"Loop count invalid.";t[n++]=33,t[n++]=255,t[n++]=11,t[n++]=78,t[n++]=69,t[n++]=84,t[n++]=83,t[n++]=67,t[n++]=65,t[n++]=80,t[n++]=69,t[n++]=50,t[n++]=46,t[n++]=48,t[n++]=3,t[n++]=1,t[n++]=255&a,t[n++]=a>>8&255,t[n++]=0}var l=!1;function u(t,e,o,r){t[e++]=o;var n=e++,a=1<<o,s=a-1,c=a+1,l=c+1,u=o+1,p=0,f=0;function d(o){for(;p>=o;)t[e++]=255&f,f>>=8,p-=8,e===n+256&&(t[n]=255,n=e++)}function h(t){f|=t<<p,p+=u,d(8)}var y=r[0]&s,g={};h(a);for(var v=1,b=r.length;v<b;++v){var m=r[v]&s,_=y<<8|m,P=g[_];if(P===i){for(f|=y<<p,p+=u;p>=8;)t[e++]=255&f,f>>=8,p-=8,e===n+256&&(t[n]=255,n=e++);4096===l?(h(a),l=c+1,u=o+1,g={}):(l>=1<<u&&++u,g[_]=l++),y=m}else y=P}return h(y),h(c),d(1),n+1===e?t[n]=0:(t[n]=e-n-1,t[e++]=0),e}this.addFrame=function(e,o,r,a,p,f){if(!0===l&&(--n,l=!1),f=f===i?{}:f,e<0||o<0||e>65535||o>65535)throw"x/y invalid.";if(r<=0||a<=0||r>65535||a>65535)throw"Width/Height invalid.";if(p.length<r*a)throw"Not enough pixels for the frame size.";var d=!0,h=f.palette;if(h!==i&&null!==h||(d=!1,h=s),h===i||null===h)throw"Must supply either a local or global palette.";for(var y=c(h),g=0;y>>=1;)++g;y=1<<g;var v=f.delay===i?0:f.delay,b=f.disposal===i?0:f.disposal;if(b<0||b>3)throw"Disposal out of range.";var m=!1,_=0;if(f.transparent!==i&&null!==f.transparent&&(m=!0,(_=f.transparent)<0||_>=y))throw"Transparent color index.";if((0!==b||m||0!==v)&&(t[n++]=33,t[n++]=249,t[n++]=4,t[n++]=b<<2|(!0===m?1:0),t[n++]=255&v,t[n++]=v>>8&255,t[n++]=_,t[n++]=0),t[n++]=44,t[n++]=255&e,t[n++]=e>>8&255,t[n++]=255&o,t[n++]=o>>8&255,t[n++]=255&r,t[n++]=r>>8&255,t[n++]=255&a,t[n++]=a>>8&255,t[n++]=!0===d?128|g-1:0,!0===d)for(var P=0,M=h.length;P<M;++P){var C=h[P];t[n++]=C>>16&255,t[n++]=C>>8&255,t[n++]=255&C}n=u(t,n,g<2?2:g,p)},this.end=function(){return!1===l&&(t[n++]=59,l=!0),n}}var m=function(){},_=function(t){this.canvas=null,this.ctx=null,this.repeat=0,this.frames=[],this.numRenderedFrames=0,this.onRenderCompleteCallback=m,this.onRenderProgressCallback=m,this.workers=[],this.availableWorkers=[],this.generatingGIF=!1,this.options=t,this.initializeWebWorkers(t)};function P(t,e){t.getBase64GIF(function(t){e({error:!1,errorCode:"",errorMsg:"",image:t})})}function M(){var t=arguments.length>0&&arguments[0]!==i?arguments[0]:{},e=t.callback,o=t.images,n=t.options,a=t.imagesLength,s=u.validate({getUserMedia:!0,"window.URL":!0}),l=[],p=0,f=void 0,d=void 0;if(s.error)return e(s);function h(){c.each(l,function(t,e){e&&(e.text?d.addFrame(e.img,n,e.text):d.addFrame(e,n))}),P(d,e)}d=new _(n),c.each(o,function(t,o){var i=o;o.src&&(i=i.src),c.isElement(i)?(n.crossOrigin&&(i.crossOrigin=n.crossOrigin),l[t]=i,(p+=1)===a&&h()):c.isString(i)&&(f=new Image,n.crossOrigin&&(f.crossOrigin=n.crossOrigin),function(r){o.text&&(r.text=o.text),r.onerror=function(){var t=void 0;if(0==--a)return(t={}).error="None of the requested images was capable of being retrieved",e(t)},r.onload=function(){o.text?l[t]={img:r,text:r.text}:l[t]=r,(p+=1)===a&&h(),c.removeElement(r)},r.src=i}(f),c.setCSSAttr(f,{position:"fixed",opacity:"0"}),r.body.appendChild(f))})}_.prototype={workerMethods:v(),initializeWebWorkers:function(t){var e,o=g.toString()+"("+v.toString()+"());",n=void 0,i=void 0,a=void 0,s=-1,l="";for(e=t.numWorkers;++s<e;)n=c.createWebWorker(o),c.isObject(n)?(i=n.objectUrl,a=n.worker,this.workers.push({worker:a,objectUrl:i}),this.availableWorkers.push(a)):(l=n,c.webWorkerError=!!n);this.workerError=l,this.canvas=r.createElement("canvas"),this.canvas.width=t.gifWidth,this.canvas.height=t.gifHeight,this.ctx=this.canvas.getContext("2d"),this.frames=[]},getWorker:function(){return this.availableWorkers.pop()},freeWorker:function(t){this.availableWorkers.push(t)},byteMap:function(){for(var t=[],e=0;e<256;e++)t[e]=String.fromCharCode(e);return t}(),bufferToString:function(t){for(var e=t.length,o="",r=-1;++r<e;)o+=this.byteMap[t[r]];return o},onFrameFinished:function(t){var e=this,o=e.frames,r=!!(e.options.images||[]).length,n=o.every(function(t){return!t.beingProcessed&&t.done});e.numRenderedFrames++,r&&t(e.numRenderedFrames/o.length),e.onRenderProgressCallback(.75*e.numRenderedFrames/o.length),n?e.generatingGIF||e.generateGIF(o,e.onRenderCompleteCallback):c.requestTimeout(function(){e.processNextFrame()},1)},processFrame:function(t){var e=this,o=(this.options,this.options),r=o.progressCallback,n=o.sampleInterval,a=this.frames,s=void 0,c=void 0,l=function(){var t=arguments.length>0&&arguments[0]!==i?arguments[0]:{},o=t.data;delete s.data,s.pixels=Array.prototype.slice.call(o.pixels),s.palette=Array.prototype.slice.call(o.palette),s.done=!0,s.beingProcessed=!1,e.freeWorker(c),e.onFrameFinished(r)};(s=a[t]).beingProcessed||s.done?this.onFrameFinished():(s.sampleInterval=n,s.beingProcessed=!0,s.gifshot=!0,(c=this.getWorker())?(c.onmessage=l,c.postMessage(s)):l({data:e.workerMethods.run(s)}))},startRendering:function(t){this.onRenderCompleteCallback=t;for(var e=0;e<this.options.numWorkers&&e<this.frames.length;e++)this.processFrame(e)},processNextFrame:function(){for(var t=-1,e=0;e<this.frames.length;e++){var o=this.frames[e];if(!o.done&&!o.beingProcessed){t=e;break}}t>=0&&this.processFrame(t)},generateGIF:function(t,e){var o=[],r={loop:this.repeat},n=this.options,i=n.interval,a=n.frameDuration,s=!!n.images.length,l=n.gifHeight,u=n.gifWidth,p=new b(o,u,l,r),f=this.onRenderProgressCallback,d=s?100*i:0,h=void 0;this.generatingGIF=!0,c.each(t,function(e,o){var r=o.palette;f(.75+.25*o.position/t.length);for(var n=0;n<a;n++)p.addFrame(0,0,u,l,o.pixels,{palette:r,delay:d})}),p.end(),f(1),this.frames=[],this.generatingGIF=!1,c.isFunction(e)&&(h=this.bufferToString(o),e("data:image/gif;base64,"+c.btoa(h)))},setRepeat:function(t){this.repeat=t},addFrame:function(t,e,o){e=c.isObject(e)?e:{};var r=this.ctx,n=this.options,i=n.gifWidth,a=n.gifHeight,s=c.getFontSize(e),l=e,u=l.filter,p=l.fontColor,f=l.fontFamily,d=l.fontWeight,h=(l.gifHeight,l.gifWidth,l.text),y=l.textAlign,g=l.textBaseline,v=l.waterMark,b=l.waterMarkHeight,m=l.waterMarkWidth,_=l.waterMarkXCoordinate,P=l.waterMarkYCoordinate,M=e.textXCoordinate?e.textXCoordinate:"left"===y?1:"right"===y?i:i/2,C=e.textYCoordinate?e.textYCoordinate:"top"===g?1:"center"===g?a/2:a,w=d+" "+s+" "+f,O=o&&e.showFrameText?o:h,S=void 0;try{r.filter=u,r.drawImage(t,0,0,i,a),O&&(r.font=w,r.fillStyle=p,r.textAlign=y,r.textBaseline=g,r.fillText(O,M,C)),v&&r.drawImage(v,_,P,m,b),S=r.getImageData(0,0,i,a),this.addFrameImageData(S)}catch(j){return""+j}},addFrameImageData:function(){var t=arguments.length>0&&arguments[0]!==i?arguments[0]:{},e=this.frames,o=t.data;this.frames.push({data:o,width:t.width,height:t.height,palette:null,dithering:null,done:!1,beingProcessed:!1,position:e.length})},onRenderProgress:function(t){this.onRenderProgressCallback=t},isRendering:function(){return this.generatingGIF},getBase64GIF:function(t){var e=this;e.startRendering(function(o){e.destroyWorkers(),c.requestTimeout(function(){t(o)},0)})},destroyWorkers:function(){if(!this.workerError){var t=this.workers;c.each(t,function(t,e){var o=e.worker,r=e.objectUrl;o.terminate(),c.URL.revokeObjectURL(r)})}}};var C=function(){},w={getGIF:function(){var t=arguments.length>0&&arguments[0]!==i?arguments[0]:{},e=arguments[1];e=c.isFunction(e)?e:C;var o=r.createElement("canvas"),n=void 0,a=t.images,s=!!a.length,l=t.cameraStream,u=t.crop,p=t.filter,f=t.fontColor,d=t.fontFamily,h=t.fontWeight,y=t.keepCameraOn,g=(t.numWorkers,t.progressCallback),v=t.saveRenderingContexts,b=t.savedRenderingContexts,m=t.text,P=t.textAlign,M=t.textBaseline,w=t.videoElement,O=t.videoHeight,S=t.videoWidth,j=t.webcamVideoElement,D=t.waterMark,R=t.waterMarkHeight,T=t.waterMarkWidth,B=t.waterMarkXCoordinate,I=t.waterMarkYCoordinate,F=Number(t.gifWidth),k=Number(t.gifHeight),x=Number(t.interval),H=(Number(t.sampleInterval),s?0:1e3*x),L=[],A=b.length?b.length:t.numFrames,N=A,E=new _(t),U=c.getFontSize(t),G=t.textXCoordinate?t.textXCoordinate:"left"===P?1:"right"===P?F:F/2,W=t.textYCoordinate?t.textYCoordinate:"top"===M?1:"center"===M?k/2:k,V=h+" "+U+" "+d,q=u?Math.floor(u.scaledWidth/2):0,z=u?S-u.scaledWidth:0,K=u?Math.floor(u.scaledHeight/2):0,J=u?O-u.scaledHeight:0,Y=function t(){var o=N-1;function r(){var r;v&&L.push(n.getImageData(0,0,F,k)),D&&n.drawImage(D,B,I,T,R),m&&(n.font=V,n.fillStyle=f,n.textAlign=P,n.textBaseline=M,n.fillText(m,G,W)),r=n.getImageData(0,0,F,k),E.addFrameImageData(r),g((A-(N=o))/A),o>0&&c.requestTimeout(t,H),N||E.getBase64GIF(function(t){e({error:!1,errorCode:"",errorMsg:"",image:t,cameraStream:l,videoElement:w,webcamVideoElement:j,savedRenderingContexts:L,keepCameraOn:y})})}b.length?(n.putImageData(b[A-N],0,0),r()):function t(){try{z>S&&(z=S),J>O&&(J=O),q<0&&(q=0),K<0&&(K=0),n.filter=p,n.drawImage(w,q,K,z,J,0,0,F,k),r()}catch(e){if("NS_ERROR_NOT_AVAILABLE"!==e.name)throw e;c.requestTimeout(t,100)}}()};A=A!==i?A:10,x=x!==i?x:.1,o.width=F,o.height=k,n=o.getContext("2d"),function t(){b.length||0!==w.currentTime?Y():c.requestTimeout(t,100)}()},getCropDimensions:function(){var t=arguments.length>0&&arguments[0]!==i?arguments[0]:{},e=t.videoWidth,o=t.videoHeight,r=t.gifWidth,n=t.gifHeight,a={width:0,height:0,scaledWidth:0,scaledHeight:0};return e>o?(a.width=Math.round(e*(n/o))-r,a.scaledWidth=Math.round(a.width*(o/n))):(a.height=Math.round(o*(r/e))-n,a.scaledHeight=Math.round(a.height*(e/r))),a}},O={loadedData:!1,defaultVideoDimensions:{width:640,height:480},findVideoSize:function t(e){t.attempts=t.attempts||0;var o=e.cameraStream,r=e.completedCallback,n=e.videoElement;n&&(n.videoWidth>0&&n.videoHeight>0?(n.removeEventListener("loadeddata",O.findVideoSize),r({videoElement:n,cameraStream:o,videoWidth:n.videoWidth,videoHeight:n.videoHeight})):t.attempts<10?(t.attempts+=1,c.requestTimeout(function(){O.findVideoSize(e)},400)):r({videoElement:n,cameraStream:o,videoWidth:O.defaultVideoDimensions.width,videoHeight:O.defaultVideoDimensions.height}))},onStreamingTimeout:function(t){c.isFunction(t)&&t({error:!0,errorCode:"getUserMedia",errorMsg:"There was an issue with the getUserMedia API - Timed out while trying to start streaming",image:null,cameraStream:{}})},stream:function(t){var e=c.isArray(t.existingVideo)?t.existingVideo[0]:t.existingVideo,o=t.cameraStream,r=t.completedCallback,n=t.streamedCallback,i=t.videoElement;if(c.isFunction(n)&&n(),e){if(c.isString(e))i.src=e,i.innerHTML='<source src="'+e+'" type="video/'+c.getExtension(e)+'" />';else if(e instanceof Blob){try{i.src=c.URL.createObjectURL(e)}catch(a){}i.innerHTML='<source src="'+e+'" type="'+e.type+'" />'}}else if(i.mozSrcObject)i.mozSrcObject=o;else if(c.URL)try{i.srcObject=o,i.src=c.URL.createObjectURL(o)}catch(a){i.srcObject=o}i.play(),c.requestTimeout(function t(){t.count=t.count||0,!0===O.loadedData?(O.findVideoSize({videoElement:i,cameraStream:o,completedCallback:r}),O.loadedData=!1):(t.count+=1)>10?O.findVideoSize({videoElement:i,cameraStream:o,completedCallback:r}):t()},0)},startStreaming:function(t){var e=c.isFunction(t.error)?t.error:c.noop,o=c.isFunction(t.streamed)?t.streamed:c.noop,n=c.isFunction(t.completed)?t.completed:c.noop,i=t.crossOrigin,a=t.existingVideo,s=t.lastCameraStream,l=t.options,u=t.webcamVideoElement,p=c.isElement(a)?a:u||r.createElement("video");i&&(p.crossOrigin=l.crossOrigin),p.autoplay=!0,p.loop=!0,p.muted=!0,p.addEventListener("loadeddata",function(){O.loadedData=!0,l.offset&&(p.currentTime=l.offset)}),a?O.stream({videoElement:p,existingVideo:a,completedCallback:n}):s?O.stream({videoElement:p,cameraStream:s,streamedCallback:o,completedCallback:n}):c.getUserMedia({video:!0},function(t){O.stream({videoElement:p,cameraStream:t,streamedCallback:o,completedCallback:n})},e)},startVideoStreaming:function(t){var e=arguments.length>1&&arguments[1]!==i?arguments[1]:{},o=e.timeout!==i?e.timeout:0,r=e.callback,n=e.webcamVideoElement,a=void 0;o>0&&(a=c.requestTimeout(function(){O.onStreamingTimeout(r)},1e4)),O.startStreaming({error:function(){r({error:!0,errorCode:"getUserMedia",errorMsg:"There was an issue with the getUserMedia API - the user probably denied permission",image:null,cameraStream:{}})},streamed:function(){clearTimeout(a)},completed:function(){var e=arguments.length>0&&arguments[0]!==i?arguments[0]:{},o=e.cameraStream,r=e.videoElement,n=e.videoHeight,a=e.videoWidth;t({cameraStream:o,videoElement:r,videoHeight:n,videoWidth:a})},lastCameraStream:e.lastCameraStream,webcamVideoElement:n,crossOrigin:e.crossOrigin,options:e})},stopVideoStreaming:function(t){var e=t=c.isObject(t)?t:{},o=e.keepCameraOn,r=e.videoElement,n=e.webcamVideoElement,i=t.cameraStream||{},a=i.getTracks&&i.getTracks()||[],s=!!a.length,l=a[0];!o&&s&&c.isFunction(l.stop)&&l.stop(),c.isElement(r)&&!n&&(r.pause(),c.isFunction(c.URL.revokeObjectURL)&&!c.webWorkerError&&r.src&&c.URL.revokeObjectURL(r.src),c.removeElement(r))}};function S(t){t=c.isObject(t)?t:{},O.stopVideoStreaming(t)}function j(t,e){var o=t.options||{},n=o.images,i=o.video,a=Number(o.gifWidth),s=Number(o.gifHeight),l=(Number(o.numFrames),t.cameraStream),u=t.videoElement,p=t.videoWidth,f=t.videoHeight,d=w.getCropDimensions({videoWidth:p,videoHeight:f,gifHeight:s,gifWidth:a}),h=e;o.crop=d,o.videoElement=u,o.videoWidth=p,o.videoHeight=f,o.cameraStream=l,c.isElement(u)&&(u.width=a+d.width,u.height=s+d.height,o.webcamVideoElement||(c.setCSSAttr(u,{position:"fixed",opacity:"0"}),r.body.appendChild(u)),u.play(),w.getGIF(o,function(t){n&&n.length||i&&i.length||S(t),h(t)}))}function D(){var t=arguments.length>0&&arguments[0]!==i?arguments[0]:{},e=t.callback,o=t.existingVideo,r=t.options,n=u.validate({getUserMedia:!0,"window.URL":!0}),a=void 0,s=void 0;if(n.error)return e(n);if(c.isElement(o)&&o.src){if(s=o.src,a=c.getExtension(s),!c.isSupported.videoCodecs[a])return e(u.messages.videoCodecs)}else c.isArray(o)&&c.each(o,function(t,e){if(a=e instanceof Blob?e.type.substr(e.type.lastIndexOf("/")+1,e.length):e.substr(e.lastIndexOf(".")+1,e.length),c.isSupported.videoCodecs[a])return o=e,!1});O.startStreaming({completed:function(t){t.options=r||{},j(t,e)},existingVideo:o,crossOrigin:r.crossOrigin,options:r})}function R(){var t=arguments.length>0&&arguments[0]!==i?arguments[0]:{},e=t.callback,o=t.lastCameraStream,r=t.options,n=t.webcamVideoElement;if(!y())return e(u.validate());r.savedRenderingContexts.length?w.getGIF(r,function(t){e(t)}):O.startVideoStreaming(function(){var t=arguments.length>0&&arguments[0]!==i?arguments[0]:{};t.options=r||{},j(t,e)},{lastCameraStream:o,callback:e,webcamVideoElement:n,crossOrigin:r.crossOrigin})}function T(t,e){if(e=c.isFunction(t)?t:e,t=c.isObject(t)?t:{},c.isFunction(e)){var o=c.mergeOptions(d,t)||{},r=t.cameraStream,n=o.images,i=n?n.length:0,a=o.video,s=o.webcamVideoElement;o=c.mergeOptions(o,{gifWidth:Math.floor(o.gifWidth),gifHeight:Math.floor(o.gifHeight)}),i?M({images:n,imagesLength:i,callback:e,options:o}):a?D({existingVideo:a,callback:e,options:o}):R({lastCameraStream:r,callback:e,webcamVideoElement:s,options:o})}}var B={utils:l,error:p,defaultOptions:h,createGIF:T,takeSnapShot:function(t,e){if(e=c.isFunction(t)?t:e,t=c.isObject(t)?t:{},c.isFunction(e)){var o=c.mergeOptions(d,t);T(c.mergeOptions(o,{interval:.1,numFrames:1,gifWidth:Math.floor(o.gifWidth),gifHeight:Math.floor(o.gifHeight)}),e)}},stopVideoStreaming:S,isSupported:function(){return u.isValid()},isWebCamGIFSupported:y,isExistingVideoGIFSupported:function(t){var e=!1;if(c.isArray(t)&&t.length){if(c.each(t,function(t,o){c.isSupported.videoCodecs[o]&&(e=!0)}),!e)return!1}else if(c.isString(t)&&t.length&&!c.isSupported.videoCodecs[t])return!1;return u.isValid({getUserMedia:!0})},isExistingImagesGIFSupported:function(){return u.isValid({getUserMedia:!0})},VERSION:"0.4.5"};"function"==typeof define&&define.amd?define([],function(){return B}):void 0!==o?e.exports=B:t.gifshot=B}("undefined"!=typeof window?window:{},"undefined"!=typeof document?document:{createElement:function(){}},"undefined"!=typeof window?window.navigator:{}),cc._RF.pop()},{}]},{},["BattleCommon","BattleAnimationsController","BattleDisplay","BattlerDisplay","BottomListHeroContainer","CompositingWindowDisplay","HeroCompositingContainer","HeroCompositingDisplay","HeroQualitySiftSelection","HeroQualitySiftSelectionGroup","CultivateSelection","CultivateSelectionGroup","CultivateWindowController","HeroInfoDisplay","StarUpWindowDisplay","SummonWindowDisplay","UpgradeWindowDisplay","HeroWithAvatar","HeroGroupContainer","HeroGroupDisplay","HeroGroupHeroContainer","HeroInBagContainer","HeroInBagDisplay","HeroInTeamContainer","HeroInTeamDisplay","HeroItemContainer","HeroItemDisplay","HeroPageController","ButtonFlash","ClickAnimation","DoublePicturesButton","HitDamage","RadiusMask","RandomAnimation","JobContainer","JobDisplay","PlayerInfoDisplay","MainMenuController","MainMenuItemSelection","MainMenuItemSelectionGroup","BattleRewardContainer","BattleRewardDisplay","MainBattleDisplay","SpeedButtonController","HeroSelectContainer","HeroSelectDisplay","PVPBattleDisplay","PVPRoomDisplay","PVPWindowController","PlayerCardContainer","PlayerCardDisplay","RankItemContainer","RankItemDisplay","SelectedHeroDisplay","SkillContainer","SkillDisplay","SettlementWindowController","StageProgressController","BattleConfig","Action","Battle","Battler","Effect","HeroGroup","Motion","MotionGroup","PVPRoom","PlayerBattle","Result","Status","Trait","BattleManager","BattleProcessor","ColorAssembler","MotionProcessor","ResultProcessor","Vec1","CopyCommon","Copy","Enemy","PlayerCopy","CopyManager","CoreCommon","AlertWindow","ISelectableObject","ItemContainer","ItemDisplay","LanguageSwitch","LoadingMask","LocalizedLabel","LocalizedSprite","SelectableGroup","SelectableObject","BaseConfig","BaseData","BaseRepository","DynamicData","StaticData","AlertManager","AssetBundleManager","BaseManager","ConfigManager","DataManager","GameManager","I18nManager","LoadingManager","NetworkManager","PlatformManager","SceneManager","DataLoader","MessageQueue","ParamCodec","ScrollviewFilter","SingletonUtils","EconomicCommon","Job","PlayerJob","PlayerMoney","EconomicManager","MoneyConditionProcessor","MoneyRewardProcessor","EditorCommon","HeroCommon","HeroSystemConfig","PartConfig","Hero","HeroSystem","HeroType","Param","Part","PartInfo","PartType","Quality","Skill","EditorManager","HeroManager","PartManager","NFTCommon","NFTManager","NFTCreator","PlayerCommon","Condition","Player","Reward","PlayerManager","ConditionProcessor","RewardProcessor","RankCommon","PlayerRank","RankRecord","BasePlatform","TestPlatform","BaseScene","BattleScene","MyTeamFrame","CanvasAdapter","CreatedWindow","AnimationPlayer","GlobalEditor","GlobalEditorCell","GlobalEditorLine","ImportWindow","SingleEditor","HeroTypeContainer","HeroTypeSelectionGroup","PartColorsContainer","PartTypeContainer","PartTypeSelectionGroup","PartsContainer","PartsSelectionGroup","HeroTypeDisplay","HeroTypeSelection","PartTypeDisplay","PartTypeSelection","PartsDisplay","PartsSelection","PreviewPictureDisplay","VideoAutoPlay","WalletController","SelectorScene","TestAutoProfit","TestGetHero","TestHeroItem","TestSpine","AnimationBridge","BaseContext","DateUtils","DecoratorUtils","EventBus","GIFUtils","MathUtils","NumberUtils","PromiseUtils","SpineUtils","TransformUtils","TypeUtils","gifshot"]);